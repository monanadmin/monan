<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MPAS-analisys: src/core_atmosphere/physics/physics_wrf/module_ra_cam_support.F Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="logoMonanColor_75x75.png"/></td>
  <td id="projectalign">
   <div id="projectname">MPAS-analisys<span id="projectnumber">&#160;teste</span>
   </div>
   <div id="projectbrief">teste</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_c53e21b94733dd8451b4d2db251c70bc.html">core_atmosphere</a></li><li class="navelem"><a class="el" href="dir_195703cd1d38332c0a06b72eede84187.html">physics</a></li><li class="navelem"><a class="el" href="dir_bc4ff68999f89a5d7c146546ef3424c5.html">physics_wrf</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle"><div class="title">module_ra_cam_support.F</div></div>
</div><!--header-->
<div class="contents">
<a href="module__ra__cam__support_8F.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html">    1</a></span><span class="keyword">MODULE</span> <a class="code hl_namespace" href="namespacemodule__ra__cam__support.html">module_ra_cam_support</a></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span><span class="preprocessor">#if defined(mpas)</span></div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span><span class="preprocessor"></span><span class="comment">! added mpas_atmphys_utilities so that we can call subroutine physics_abort in subroutine</span></div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span><span class="comment">! background.</span></div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span><span class="comment">! Laura D. Fowler (birch.ucar.edu) / 2013-07-01.</span></div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span>  <span class="keywordtype">use </span><a class="code hl_namespace" href="namespacempas__atmphys__utilities.html">mpas_atmphys_utilities</a></div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span><span class="preprocessor"></span>  <span class="keywordtype">implicit none</span></div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">    9</a></span>      <span class="keywordtype">integer</span>, <span class="keywordtype">parameter</span> :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a> = 8</div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#ae37da462721fdcab8b04e1bbbbdefc93">   10</a></span><span class="keywordtype">      real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>), <span class="keywordtype">parameter</span>:: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ae37da462721fdcab8b04e1bbbbdefc93">inf</a> = 1.e20 <span class="comment">! CAM sets this differently in infnan.F90</span></div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a6c542f18b6fd92c5ef302d352efea2e8">   11</a></span>      <span class="keywordtype">integer</span>, <span class="keywordtype">parameter</span>:: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a6c542f18b6fd92c5ef302d352efea2e8">bigint</a> = int(o<span class="stringliteral">&#39;17777777777&#39;</span>)      <span class="comment">! largest possible 32-bit integer </span></div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span> </div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a4fc00dfce828f96801018ff9aa3df540">   13</a></span>      <span class="keywordtype">integer</span> :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a4fc00dfce828f96801018ff9aa3df540">ixcldliq</a> </div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a36a1b928736da9a5af232513245cc91c">   14</a></span>      <span class="keywordtype">integer</span> :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a36a1b928736da9a5af232513245cc91c">ixcldice</a></div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span><span class="comment">!     integer :: levsiz    ! size of level dimension on dataset</span></div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#aeb5ccbe33dbb2a183e6407b4b8644d7b">   16</a></span>      <span class="keywordtype">integer</span>, <span class="keywordtype">parameter</span> :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#aeb5ccbe33dbb2a183e6407b4b8644d7b">nbands</a> = 2          <span class="comment">! Number of spectral bands</span></div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span><span class="comment">!     integer, parameter :: naer_all = 12 + 1</span></div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span><span class="comment">!     integer, parameter :: naer = 10 + 1</span></div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a24f95ffae31c24f1e91116ff45710b90">   19</a></span>      <span class="keywordtype">integer</span>, <span class="keywordtype">parameter</span> :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a24f95ffae31c24f1e91116ff45710b90">naer_all</a> = 12</div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a9832dcdaf6a335c97892558d45bc608d">   20</a></span>      <span class="keywordtype">integer</span>, <span class="keywordtype">parameter</span> :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a9832dcdaf6a335c97892558d45bc608d">naer</a> = 10</div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#ae5789daee4a0d08666d1a0af3526f07c">   21</a></span>      <span class="keywordtype">integer</span>, <span class="keywordtype">parameter</span> :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ae5789daee4a0d08666d1a0af3526f07c">bnd_nbr_lw</a>=7 </div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a6f6deafe37ef978d01301e8d2fe1177b">   22</a></span>      <span class="keywordtype">integer</span>, <span class="keywordtype">parameter</span> :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a6f6deafe37ef978d01301e8d2fe1177b">ndstsz</a> = 4    <span class="comment">! number of dust size bins</span></div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a863b1d9602abdd9946b40135690a4db5">   23</a></span>      <span class="keywordtype">integer</span> :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a863b1d9602abdd9946b40135690a4db5">idxsul</a></div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a521884c838130d3a7fce69511e4708a0">   24</a></span>      <span class="keywordtype">integer</span> :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a521884c838130d3a7fce69511e4708a0">idxsslt</a></div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a130c6997ed212e28b4c576707a7e82ad">   25</a></span>      <span class="keywordtype">integer</span> :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a130c6997ed212e28b4c576707a7e82ad">idxdustfirst</a></div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a35f5066746b13db0893d19b839574bc9">   26</a></span>      <span class="keywordtype">integer</span> :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a35f5066746b13db0893d19b839574bc9">idxcarbonfirst</a></div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a6169752cdbc54265aba357093feb3e77">   27</a></span>      <span class="keywordtype">integer</span> :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a6169752cdbc54265aba357093feb3e77">idxocpho</a></div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a24d476dd94afaa7f4e36e5856f37194c">   28</a></span>      <span class="keywordtype">integer</span> :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a24d476dd94afaa7f4e36e5856f37194c">idxbcpho</a></div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#ad82655074f7b9f4590d239dd3df48bf8">   29</a></span>      <span class="keywordtype">integer</span> :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ad82655074f7b9f4590d239dd3df48bf8">idxocphi</a></div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a9c057f8d1d1eca09482693db2df3b5e6">   30</a></span>      <span class="keywordtype">integer</span> :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a9c057f8d1d1eca09482693db2df3b5e6">idxbcphi</a></div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#ab377fd834d670fed20ad3f59d359f8a7">   31</a></span>      <span class="keywordtype">integer</span> :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ab377fd834d670fed20ad3f59d359f8a7">idxbg</a>  </div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a027edc99883f6383db3e8108e2d28bce">   32</a></span>      <span class="keywordtype">integer</span> :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a027edc99883f6383db3e8108e2d28bce">idxvolc</a></div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span> </div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#ab50efdf4518f1ed0df7adc0e8839b4bd">   34</a></span>  <span class="keywordtype">integer</span> :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ab50efdf4518f1ed0df7adc0e8839b4bd">mxaerl</a>                            <span class="comment">! Maximum level of background aerosol</span></div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span> </div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span><span class="comment">! indices to sections of array that represent</span></div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span><span class="comment">! groups of aerosols</span></div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span> </div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#ae44324bed6778856144ccf65c0b8bf34">   39</a></span>  <span class="keywordtype">integer</span>, <span class="keywordtype">parameter</span> :: &amp;</div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span>      <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#acf3acb40440157c2ff3dab3ebcde1546">numdust</a>         = 4, &amp;</div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno">   41</span>      <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ae44324bed6778856144ccf65c0b8bf34">numcarbon</a>      = 4</div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span> </div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span><span class="comment">! portion of each species group to use in computation</span></div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span><span class="comment">! of relative radiative forcing.</span></div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span> </div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a4098d4672dba23f66f732f3e0195dfd1">   46</a></span><span class="keywordtype">  real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>) :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a4098d4672dba23f66f732f3e0195dfd1">sulscl_rf</a>  = 0._r8 <span class="comment">!</span></div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a9084c0a881dd139972347d6c86b4a7ed">   47</a></span><span class="keywordtype">  real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>) :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a9084c0a881dd139972347d6c86b4a7ed">carscl_rf</a>  = 0._r8</div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a5971b22b001ecc165f9c3eb2222b9225">   48</a></span><span class="keywordtype">  real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>) :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a5971b22b001ecc165f9c3eb2222b9225">ssltscl_rf</a> = 0._r8</div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a45931081332eeb6af5a457003dfc59bc">   49</a></span><span class="keywordtype">  real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>) :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a45931081332eeb6af5a457003dfc59bc">dustscl_rf</a> = 0._r8</div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#ac271b0b48df7c1f38bb4ae5a507cfeb5">   50</a></span><span class="keywordtype">  real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>) :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ac271b0b48df7c1f38bb4ae5a507cfeb5">bgscl_rf</a>   = 0._r8</div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#ac14abc1728ad2feb7b32e3634c901fec">   51</a></span><span class="keywordtype">  real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>) :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ac14abc1728ad2feb7b32e3634c901fec">volcscl_rf</a> = 0._r8</div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span> </div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span><span class="comment">! &quot;background&quot; aerosol species mmr.</span></div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a390a0bf0137854ad1b9f0e455aab7503">   54</a></span><span class="keywordtype">  real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>) :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a390a0bf0137854ad1b9f0e455aab7503">tauback</a> = 0._r8</div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span> </div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span><span class="comment">! portion of each species group to use in computation</span></div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span><span class="comment">! of aerosol forcing in driving the climate</span></div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#abd55a533deea6b6e4f418fbdb8ab7f6f">   58</a></span><span class="keywordtype">  real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>) :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#abd55a533deea6b6e4f418fbdb8ab7f6f">sulscl</a>  = 1._r8</div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a0183c64b88e8ab41234d01725523454f">   59</a></span><span class="keywordtype">  real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>) :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a0183c64b88e8ab41234d01725523454f">carscl</a>  = 1._r8</div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a02a9ac601d0bc3f5408141218044d38e">   60</a></span><span class="keywordtype">  real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>) :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a02a9ac601d0bc3f5408141218044d38e">ssltscl</a> = 1._r8</div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a1b3671cb014fbdf0e5cf156dbd5bd316">   61</a></span><span class="keywordtype">  real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>) :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a1b3671cb014fbdf0e5cf156dbd5bd316">dustscl</a> = 1._r8</div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a59a5f8093c36f54b739fac17bb9f2158">   62</a></span><span class="keywordtype">  real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>) :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a59a5f8093c36f54b739fac17bb9f2158">volcscl</a> = 1._r8</div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span> </div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span><span class="comment">!From volcrad.F90 module</span></div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#ab8d1d8a7610c7eaeeacf4a192b988181">   65</a></span>     <span class="keywordtype">integer</span>, <span class="keywordtype">parameter</span> :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ab8d1d8a7610c7eaeeacf4a192b988181">idx_lw_0500_0650</a>=3</div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#ae90583401bc762ffcf004ff27792f3ef">   66</a></span>     <span class="keywordtype">integer</span>, <span class="keywordtype">parameter</span> :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ae90583401bc762ffcf004ff27792f3ef">idx_lw_0650_0800</a>=4</div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a3641bbffc5b9d01322506476442a962a">   67</a></span>     <span class="keywordtype">integer</span>, <span class="keywordtype">parameter</span> :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a3641bbffc5b9d01322506476442a962a">idx_lw_0800_1000</a>=5</div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a619b4abbc0ae813bf2c8709cef491d8e">   68</a></span>     <span class="keywordtype">integer</span>, <span class="keywordtype">parameter</span> :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a619b4abbc0ae813bf2c8709cef491d8e">idx_lw_1000_1200</a>=6</div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#ab20c3561d003d8e16f6984f564247561">   69</a></span>     <span class="keywordtype">integer</span>, <span class="keywordtype">parameter</span> :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ab20c3561d003d8e16f6984f564247561">idx_lw_1200_2000</a>=7</div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span> </div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span><span class="comment">! First two values represent the overlap of volcanics with the non-window</span></div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span><span class="comment">! (0-800, 1200-2200 cm^-1) and window (800-1200 cm^-1) regions.|  Coefficients</span></div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span><span class="comment">! were derived using crm_volc_minimize.pro with spectral flux optimization</span></div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span><span class="comment">! on first iteration, total heating rate on subsequent iterations (2-9).</span></div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span><span class="comment">! Five profiles for HLS, HLW, MLS, MLW, and TRO conditions were given equal</span></div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span><span class="comment">! weight.  RMS heating rate errors for a visible stratospheric optical</span></div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span><span class="comment">! depth of 1.0 are 0.02948 K/day.</span></div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span><span class="comment">!</span></div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a7d51028d356ee61ee8035150a78772fd">   79</a></span><span class="keywordtype">      real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>) :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a7d51028d356ee61ee8035150a78772fd">abs_cff_mss_aer</a>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ae5789daee4a0d08666d1a0af3526f07c">bnd_nbr_lw</a>) = &amp;</div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span>         (/ 70.257384, 285.282943, &amp;</div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span>         1.0273851e+02, 6.3073303e+01, 1.2039569e+02, &amp;</div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span>         3.6343643e+02, 2.7138528e+02 /)</div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span> </div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span><span class="comment">!From radae.F90 module</span></div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a05e16d6e3700a843bf571654f96df2bf">   85</a></span><span class="keywordtype">      real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>), <span class="keywordtype">parameter</span>:: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a05e16d6e3700a843bf571654f96df2bf">min_tp_h2o</a> = 160.0        <span class="comment">! min T_p for pre-calculated abs/emis</span></div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a58b17088862aad966a0754297dccecce">   86</a></span><span class="keywordtype">      real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>), <span class="keywordtype">parameter</span>:: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a58b17088862aad966a0754297dccecce">max_tp_h2o</a> = 349.999999   <span class="comment">! max T_p for pre-calculated abs/emis</span></div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#aa8d90207a324d0393c24c16a30ca27c7">   87</a></span><span class="keywordtype">      real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>), <span class="keywordtype">parameter</span>:: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#aa8d90207a324d0393c24c16a30ca27c7">dtp_h2o</a> = 21.111111111111 <span class="comment">! difference in adjacent elements of tp_h2o</span></div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#afcb6aa7f6f9b2c8b6044fafb594227b3">   88</a></span><span class="keywordtype">      real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>), <span class="keywordtype">parameter</span>:: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#afcb6aa7f6f9b2c8b6044fafb594227b3">min_te_h2o</a> = -120.0       <span class="comment">! min T_e-T_p for pre-calculated abs/emis</span></div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a98a967fd7677839c0f9325474ffd4e7d">   89</a></span><span class="keywordtype">      real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>), <span class="keywordtype">parameter</span>:: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a98a967fd7677839c0f9325474ffd4e7d">max_te_h2o</a> = 79.999999    <span class="comment">! max T_e-T_p for pre-calculated abs/emis</span></div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#afe5f9155c49637822e4b098ba9b0915b">   90</a></span><span class="keywordtype">      real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>), <span class="keywordtype">parameter</span>:: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#afe5f9155c49637822e4b098ba9b0915b">dte_h2o</a>  = 10.0           <span class="comment">! difference in adjacent elements of te_h2o</span></div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a9fbf8fa3ff5c3f81b52acba8c9dbba9e">   91</a></span><span class="keywordtype">      real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>), <span class="keywordtype">parameter</span>:: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a9fbf8fa3ff5c3f81b52acba8c9dbba9e">min_rh_h2o</a> = 0.0          <span class="comment">! min RH for pre-calculated abs/emis</span></div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a6f1af3e9e0a69d213a9308ccc9d2ef73">   92</a></span><span class="keywordtype">      real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>), <span class="keywordtype">parameter</span>:: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a6f1af3e9e0a69d213a9308ccc9d2ef73">max_rh_h2o</a> = 1.19999999   <span class="comment">! max RH for pre-calculated abs/emis</span></div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#adcf21b1a03a4c8b5ff94b19c220423df">   93</a></span><span class="keywordtype">      real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>), <span class="keywordtype">parameter</span>:: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#adcf21b1a03a4c8b5ff94b19c220423df">drh_h2o</a> = 0.2             <span class="comment">! difference in adjacent elements of RH</span></div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a93ec1bf1a4e587cbf80f1fb84effc8d6">   94</a></span><span class="keywordtype">      real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>), <span class="keywordtype">parameter</span>:: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a93ec1bf1a4e587cbf80f1fb84effc8d6">min_lu_h2o</a> = -8.0         <span class="comment">! min log_10(U) for pre-calculated abs/emis</span></div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a973752fffe2e4a34e2f547d1058fbe37">   95</a></span><span class="keywordtype">      real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>), <span class="keywordtype">parameter</span>:: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a973752fffe2e4a34e2f547d1058fbe37">min_u_h2o</a>  = 1.0e-8       <span class="comment">! min pressure-weighted path-length</span></div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#ac0fcb5c36668744361912382fd62c678">   96</a></span><span class="keywordtype">      real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>), <span class="keywordtype">parameter</span>:: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ac0fcb5c36668744361912382fd62c678">max_lu_h2o</a> =  3.9999999   <span class="comment">! max log_10(U) for pre-calculated abs/emis</span></div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a9a7551f5f201c61f375a1a1856199809">   97</a></span><span class="keywordtype">      real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>), <span class="keywordtype">parameter</span>:: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a9a7551f5f201c61f375a1a1856199809">dlu_h2o</a>  = 0.5            <span class="comment">! difference in adjacent elements of lu_h2o</span></div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a2f81c5a52f48e33d222b077587809d66">   98</a></span><span class="keywordtype">      real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>), <span class="keywordtype">parameter</span>:: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a2f81c5a52f48e33d222b077587809d66">min_lp_h2o</a> = -3.0         <span class="comment">! min log_10(P) for pre-calculated abs/emis</span></div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a14789330a713385f62a77c3f58d63d74">   99</a></span><span class="keywordtype">      real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>), <span class="keywordtype">parameter</span>:: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a14789330a713385f62a77c3f58d63d74">min_p_h2o</a> = 1.0e-3        <span class="comment">! min log_10(P) for pre-calculated abs/emis</span></div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a61750fd4c9efc4e3d1e94b50f7c6eb97">  100</a></span><span class="keywordtype">      real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>), <span class="keywordtype">parameter</span>:: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a61750fd4c9efc4e3d1e94b50f7c6eb97">max_lp_h2o</a> = -0.0000001   <span class="comment">! max log_10(P) for pre-calculated abs/emis</span></div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#abc2b6b74a45ecb8c24839914fea65634">  101</a></span><span class="keywordtype">      real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>), <span class="keywordtype">parameter</span>:: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#abc2b6b74a45ecb8c24839914fea65634">dlp_h2o</a> = 0.3333333333333 <span class="comment">! difference in adjacent elements of lp_h2o</span></div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#ab587516ccf64d1db61024800e91ac542">  102</a></span>      <span class="keywordtype">integer</span>, <span class="keywordtype">parameter</span> :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ab587516ccf64d1db61024800e91ac542">n_u</a> = 25   <span class="comment">! Number of U in abs/emis tables</span></div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#aec56701dbac922ebd91bc83adcee8d1f">  103</a></span>      <span class="keywordtype">integer</span>, <span class="keywordtype">parameter</span> :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#aec56701dbac922ebd91bc83adcee8d1f">n_p</a> = 10   <span class="comment">! Number of P in abs/emis tables</span></div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#afe6a7aacfe7cfae29eab344c2edd48d4">  104</a></span>      <span class="keywordtype">integer</span>, <span class="keywordtype">parameter</span> :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#afe6a7aacfe7cfae29eab344c2edd48d4">n_tp</a> = 10  <span class="comment">! Number of T_p in abs/emis tables</span></div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a38c37461e43d0edd8fe972d628baab63">  105</a></span>      <span class="keywordtype">integer</span>, <span class="keywordtype">parameter</span> :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a38c37461e43d0edd8fe972d628baab63">n_te</a> = 21  <span class="comment">! Number of T_e in abs/emis tables</span></div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#ad0e87da888c73200c4c5103ff11e1641">  106</a></span>      <span class="keywordtype">integer</span>, <span class="keywordtype">parameter</span> :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ad0e87da888c73200c4c5103ff11e1641">n_rh</a> = 7   <span class="comment">! Number of RH in abs/emis tables</span></div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#ad3fcaf53dce141c715c1280f85a18a57">  107</a></span><span class="keywordtype">      real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>):: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ad3fcaf53dce141c715c1280f85a18a57">c16</a>,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#acbd9c87ec89867da86831dddc3c84346">c17</a>,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a91608f04c175c53bf3e87fbf7f71b476">c26</a>,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a7ae868238a2cdfc0aa70b65d1596dafe">c27</a>,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a0b6730ade826553952e2962a79766017">c28</a>,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ad9b75c3e27e4a2ed773f89f9e8ab0a3f">c29</a>,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a07f134f5565dcff0d054824cfe1113c7">c30</a>,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a3dbef7f2c9ce5cd74b83171c4c8f9de5">c31</a></div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a2f304c7866466736faac432614d5483c">  108</a></span><span class="keywordtype">      real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>):: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a2f304c7866466736faac432614d5483c">fwcoef</a>      <span class="comment">! Farwing correction constant</span></div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a087748a09967fff52683677c502cc639">  109</a></span><span class="keywordtype">      real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>):: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a087748a09967fff52683677c502cc639">fwc1</a>,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a0ac4d7c3fe1cd44ede623405b82b40b9">fwc2</a>   <span class="comment">! Farwing correction constants</span></div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#ae0a6100d31d7cf309cb86c7352961d4b">  110</a></span><span class="keywordtype">      real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>):: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ae0a6100d31d7cf309cb86c7352961d4b">fc1</a>         <span class="comment">! Farwing correction constant</span></div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#abbfa35151362a083fe9ec53131b7c960">  111</a></span><span class="keywordtype">      real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>):: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#abbfa35151362a083fe9ec53131b7c960">amco2</a> <span class="comment">! Molecular weight of co2   (g/mol)</span></div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#ad454810cad51890d5647d6d88d3c468d">  112</a></span><span class="keywordtype">      real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>):: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ad454810cad51890d5647d6d88d3c468d">amd</a>   <span class="comment">! Molecular weight of dry air (g/mol)</span></div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a1bb9cc2ee75f4fa1900929f2ce84f756">  113</a></span><span class="keywordtype">      real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>):: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a1bb9cc2ee75f4fa1900929f2ce84f756">p0</a>    <span class="comment">! Standard pressure (dynes/cm**2)</span></div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span> </div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span><span class="comment">! These are now allocatable. JM 20090612</span></div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#aac6a79b831ca54a536990b02b931911d">  116</a></span><span class="keywordtype">  real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>), <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:,:,:,:,:)</span>  :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#aac6a79b831ca54a536990b02b931911d">ah2onw</a>   <span class="comment">! (n_p, n_tp, n_u, n_te, n_rh)   ! absorptivity (non-window)</span></div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a08e2e0a2a63d08f3ac7e0f7be4a624c0">  117</a></span><span class="keywordtype">  real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>), <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:,:,:,:,:)</span>  :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a08e2e0a2a63d08f3ac7e0f7be4a624c0">eh2onw</a>   <span class="comment">! (n_p, n_tp, n_u, n_te, n_rh)   ! emissivity   (non-window)</span></div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a42d26f57bb7571b24fa14953d728e81f">  118</a></span><span class="keywordtype">  real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>), <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:,:,:,:,:)</span>  :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a42d26f57bb7571b24fa14953d728e81f">ah2ow</a>    <span class="comment">! (n_p, n_tp, n_u, n_te, n_rh)    ! absorptivity (window, for adjacent layers)</span></div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#add3ef9cf636adb1adb208324bcab8dff">  119</a></span><span class="keywordtype">  real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>), <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:,:,:,:,:)</span>  :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#add3ef9cf636adb1adb208324bcab8dff">cn_ah2ow</a> <span class="comment">! (n_p, n_tp, n_u, n_te, n_rh)    ! continuum transmission for absorptivity (window)</span></div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a2105f6a3c7e4c2675255dfeba4840206">  120</a></span><span class="keywordtype">  real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>), <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:,:,:,:,:)</span>  :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a2105f6a3c7e4c2675255dfeba4840206">cn_eh2ow</a> <span class="comment">! (n_p, n_tp, n_u, n_te, n_rh)    ! continuum transmission for emissivity   (window)</span></div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#aec3b699656f159d10f9f19feafa18ab4">  121</a></span><span class="keywordtype">  real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>), <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:,:,:,:,:)</span>  :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#aec3b699656f159d10f9f19feafa18ab4">ln_ah2ow</a> <span class="comment">! (n_p, n_tp, n_u, n_te, n_rh)    ! line-only transmission for absorptivity (window)</span></div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#aba5fb70a3463906359ac16c4389cbd35">  122</a></span><span class="keywordtype">  real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>), <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:,:,:,:,:)</span>  :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#aba5fb70a3463906359ac16c4389cbd35">ln_eh2ow</a> <span class="comment">! (n_p, n_tp, n_u, n_te, n_rh)    ! line-only transmission for emissivity   (window)</span></div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span> </div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno">  124</span><span class="comment">!</span></div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno">  125</span><span class="comment">! Constant coefficients for water vapor overlap with trace gases.</span></div>
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno">  126</span><span class="comment">! Reference: Ramanathan, V. and  P.Downey, 1986: A Nonisothermal</span></div>
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno">  127</span><span class="comment">!            Emissivity and Absorptivity Formulation for Water Vapor</span></div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno">  128</span><span class="comment">!            Journal of Geophysical Research, vol. 91., D8, pp 8649-8666</span></div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno">  129</span><span class="comment">!</span></div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#ac75dcc2f540085827d996bc8528ffb49">  130</a></span><span class="keywordtype">  real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>):: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ac75dcc2f540085827d996bc8528ffb49">coefh</a>(2,4) = reshape(  &amp;</div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno">  131</span>         (/ (/5.46557e+01,-7.30387e-02/), &amp;</div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno">  132</span>            (/1.09311e+02,-1.46077e-01/), &amp;</div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno">  133</span>            (/5.11479e+01,-6.82615e-02/), &amp;</div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno">  134</span>            (/1.02296e+02,-1.36523e-01/) /), (/2,4/) )</div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span><span class="comment">!</span></div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a2fcd0e1d72a765566ee6f0e4f9aeb071">  136</a></span><span class="keywordtype">  real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>):: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a2fcd0e1d72a765566ee6f0e4f9aeb071">coefj</a>(3,2) = reshape( &amp;</div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno">  137</span>            (/ (/2.82096e-02,2.47836e-04,1.16904e-06/), &amp;</div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span>               (/9.27379e-02,8.04454e-04,6.88844e-06/) /), (/3,2/) )</div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span><span class="comment">!</span></div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a0cf8abb99d0e97c5cefb8c8a80b6ac24">  140</a></span><span class="keywordtype">  real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>):: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a0cf8abb99d0e97c5cefb8c8a80b6ac24">coefk</a>(3,2) = reshape( &amp;</div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span>            (/ (/2.48852e-01,2.09667e-03,2.60377e-06/) , &amp;</div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno">  142</span>               (/1.03594e+00,6.58620e-03,4.04456e-06/) /), (/3,2/) )</div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno">  143</span> </div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#adfcdb079e72f875038e1b90d88badd3b">  144</a></span>  <span class="keywordtype">integer</span>, <span class="keywordtype">parameter</span> :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#adfcdb079e72f875038e1b90d88badd3b">ntemp</a> = 192 <span class="comment">! Number of temperatures in H2O sat. table for Tp</span></div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a3ce1d55cd319df40cff8150984cc7e91">  145</a></span><span class="keywordtype">  real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>) :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a3ce1d55cd319df40cff8150984cc7e91">estblh2o</a>(0:<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#adfcdb079e72f875038e1b90d88badd3b">ntemp</a>)       <span class="comment">! saturation vapor pressure for H2O for Tp rang</span></div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a201fd10fb05cb12f2ad93ec9539aebc8">  146</a></span>  <span class="keywordtype">integer</span>, <span class="keywordtype">parameter</span> :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a201fd10fb05cb12f2ad93ec9539aebc8">o_fa</a> = 6   <span class="comment">! Degree+1 of poly of T_e for absorptivity as U-&gt;inf.</span></div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#ada82b90edfe225a35c5388aa87963f0b">  147</a></span>  <span class="keywordtype">integer</span>, <span class="keywordtype">parameter</span> :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ada82b90edfe225a35c5388aa87963f0b">o_fe</a> = 6   <span class="comment">! Degree+1 of poly of T_e for emissivity as U-&gt;inf.</span></div>
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno">  148</span> </div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span><span class="comment">!-----------------------------------------------------------------------------</span></div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno">  150</span><span class="comment">! Data for f in C/H/E fit -- value of A and E as U-&gt;infinity</span></div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span><span class="comment">! New C/LT/E fit (Hitran 2K, CKD 2.4) -- no change</span></div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span><span class="comment">!     These values are determined by integrals of Planck functions or</span></div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span><span class="comment">!     derivatives of Planck functions only.</span></div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span><span class="comment">!-----------------------------------------------------------------------------</span></div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span><span class="comment">!</span></div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span><span class="comment">! fa/fe coefficients for 2 bands (0-800 &amp; 1200-2200, 800-1200 cm^-1)</span></div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span><span class="comment">!</span></div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno">  158</span><span class="comment">! Coefficients of polynomial for f_a in T_e</span></div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span><span class="comment">!</span></div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a7c2f0dc7751078ac5b0b47c69d3d8a60">  160</a></span><span class="keywordtype">  real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>), <span class="keywordtype">parameter</span>:: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a7c2f0dc7751078ac5b0b47c69d3d8a60">fat</a>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a201fd10fb05cb12f2ad93ec9539aebc8">o_fa</a>,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#aeb5ccbe33dbb2a183e6407b4b8644d7b">nbands</a>) = reshape( (/ &amp;</div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span>       (/-1.06665373e-01,  2.90617375e-02, -2.70642049e-04,   &amp;   <span class="comment">! 0-800&amp;1200-2200 cm^-1</span></div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span>          1.07595511e-06, -1.97419681e-09,  1.37763374e-12/), &amp;   <span class="comment">!   0-800&amp;1200-2200 cm^-1</span></div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span>       (/ 1.10666537e+00, -2.90617375e-02,  2.70642049e-04,   &amp;   <span class="comment">! 800-1200 cm^-1</span></div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno">  164</span>         -1.07595511e-06,  1.97419681e-09, -1.37763374e-12/) /) &amp; <span class="comment">!   800-1200 cm^-1</span></div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span>       , (/<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a201fd10fb05cb12f2ad93ec9539aebc8">o_fa</a>,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#aeb5ccbe33dbb2a183e6407b4b8644d7b">nbands</a>/) )</div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span><span class="comment">!</span></div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno">  167</span><span class="comment">! Coefficients of polynomial for f_e in T_e</span></div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span><span class="comment">!</span></div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a9e392879ac2abab803fe2a16cb920d6c">  169</a></span><span class="keywordtype">  real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>), <span class="keywordtype">parameter</span>:: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a9e392879ac2abab803fe2a16cb920d6c">fet</a>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ada82b90edfe225a35c5388aa87963f0b">o_fe</a>,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#aeb5ccbe33dbb2a183e6407b4b8644d7b">nbands</a>) = reshape( (/ &amp;</div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span>      (/3.46148163e-01,  1.51240299e-02, -1.21846479e-04,   &amp;   <span class="comment">! 0-800&amp;1200-2200 cm^-1</span></div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno">  171</span>        4.04970123e-07, -6.15368936e-10,  3.52415071e-13/), &amp;   <span class="comment">!   0-800&amp;1200-2200 cm^-1</span></div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno">  172</span>      (/6.53851837e-01, -1.51240299e-02,  1.21846479e-04,   &amp;   <span class="comment">! 800-1200 cm^-1</span></div>
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno">  173</span>       -4.04970123e-07,  6.15368936e-10, -3.52415071e-13/) /) &amp; <span class="comment">!   800-1200 cm^-1</span></div>
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno">  174</span>      , (/<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a201fd10fb05cb12f2ad93ec9539aebc8">o_fa</a>,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#aeb5ccbe33dbb2a183e6407b4b8644d7b">nbands</a>/) )</div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno">  175</span> </div>
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno">  176</span> </div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#ad3f1a3043da7349342bf4f8b0f4178af">  177</a></span><span class="keywordtype">      real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>) ::  <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ad3f1a3043da7349342bf4f8b0f4178af">gravit</a>     <span class="comment">! Acceleration of gravity (cgs)</span></div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a02a6fd3379ca9f88aedc856917d393ee">  178</a></span><span class="keywordtype">      real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>) ::  <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a02a6fd3379ca9f88aedc856917d393ee">rga</a>        <span class="comment">! 1./gravit</span></div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a89418dd7797528310a5f90613aad0804">  179</a></span><span class="keywordtype">      real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>) ::  <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a89418dd7797528310a5f90613aad0804">gravmks</a>    <span class="comment">! Acceleration of gravity (mks)</span></div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a601da5d1916ef5ff2acfdbd3e6631643">  180</a></span><span class="keywordtype">      real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>) ::  <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a601da5d1916ef5ff2acfdbd3e6631643">cpair</a>      <span class="comment">! Specific heat of dry air</span></div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#ad1a3c3e4002c37ba64642c27d7b963ba">  181</a></span><span class="keywordtype">      real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>) ::  <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ad1a3c3e4002c37ba64642c27d7b963ba">epsilo</a>     <span class="comment">! Ratio of mol. wght of H2O to dry air</span></div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#af7e662e829862c7d94128b48616ae04b">  182</a></span><span class="keywordtype">      real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>) ::  <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#af7e662e829862c7d94128b48616ae04b">epsqs</a>      <span class="comment">! Ratio of mol. wght of H2O to dry air</span></div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#aedb55b03e1395012ec29e1914a2df7cc">  183</a></span><span class="keywordtype">      real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>) ::  <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#aedb55b03e1395012ec29e1914a2df7cc">sslp</a>       <span class="comment">! Standard sea-level pressure</span></div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a1d3aedbb07ddd76fbe919f80ad7d8f40">  184</a></span><span class="keywordtype">      real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>) ::  <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a1d3aedbb07ddd76fbe919f80ad7d8f40">stebol</a>     <span class="comment">! Stefan-Boltzmann&#39;s constant</span></div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#abc4231d9935087dc214c8a629167ff8c">  185</a></span><span class="keywordtype">      real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>) ::  <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#abc4231d9935087dc214c8a629167ff8c">rgsslp</a>     <span class="comment">! 0.5/(gravit*sslp)</span></div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a3302213173442f385c5ddb46d252c41f">  186</a></span><span class="keywordtype">      real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>) ::  <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a3302213173442f385c5ddb46d252c41f">dpfo3</a>      <span class="comment">! Voigt correction factor for O3</span></div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a5e62f9ce314a5b32db8ca6283d47dda9">  187</a></span><span class="keywordtype">      real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>) ::  <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a5e62f9ce314a5b32db8ca6283d47dda9">dpfco2</a>     <span class="comment">! Voigt correction factor for CO2</span></div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a0f42e6165f18772a89612e762798b41e">  188</a></span><span class="keywordtype">      real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>) ::  <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a0f42e6165f18772a89612e762798b41e">dayspy</a>     <span class="comment">! Number of days per 1 year</span></div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#af11c957c451e4f7284f282c6424be96b">  189</a></span><span class="keywordtype">      real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>) ::  <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#af11c957c451e4f7284f282c6424be96b">pie</a>        <span class="comment">! 3.14.....</span></div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a455077c905b075fb0c227ed4d0e73e09">  190</a></span><span class="keywordtype">      real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>) ::  <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a455077c905b075fb0c227ed4d0e73e09">mwdry</a>      <span class="comment">! molecular weight dry air ~ kg/kmole (shr_const_mwdair)</span></div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a6baae65a4d24acd4f21fe63ec6383207">  191</a></span><span class="keywordtype">      real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>) ::  <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a6baae65a4d24acd4f21fe63ec6383207">scon</a>       <span class="comment">! solar constant (not used in WRF)</span></div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a4888774864252c2e557495881ddbaa40">  192</a></span><span class="keywordtype">      real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>) ::  <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a4888774864252c2e557495881ddbaa40">co2mmr</a></div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a54962ae853da73335f745d7f188d8aa2">  193</a></span><span class="keywordtype">real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>) ::   <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a54962ae853da73335f745d7f188d8aa2">mwco2</a>              <span class="comment">! molecular weight of carbon dioxide</span></div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a3c5fc31d42f05094136cd2dec4f563ec">  194</a></span><span class="keywordtype">real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>) ::   <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a3c5fc31d42f05094136cd2dec4f563ec">mwh2o</a>              <span class="comment">! molecular weight water vapor (shr_const_mwwv)</span></div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#ab7bc2f468a9159a04d16b9500722c011">  195</a></span><span class="keywordtype">real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>) ::   <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ab7bc2f468a9159a04d16b9500722c011">mwch4</a>              <span class="comment">! molecular weight ch4</span></div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#add7004a1eda30f04d0a373345ef26e17">  196</a></span><span class="keywordtype">real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>) ::   <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#add7004a1eda30f04d0a373345ef26e17">mwn2o</a>              <span class="comment">! molecular weight n2o</span></div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#ad555b898a8fc2a940cac8f504a89a01a">  197</a></span><span class="keywordtype">real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>) ::   <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ad555b898a8fc2a940cac8f504a89a01a">mwf11</a>              <span class="comment">! molecular weight cfc11</span></div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#acbe8f15ae2e2e188768922ae6c0f5958">  198</a></span><span class="keywordtype">real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>) ::   <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#acbe8f15ae2e2e188768922ae6c0f5958">mwf12</a>              <span class="comment">! molecular weight cfc12</span></div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a54ecd7cfe228dfaee0defa871d2ab152">  199</a></span><span class="keywordtype">real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>) ::   <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a54ecd7cfe228dfaee0defa871d2ab152">cappa</a>              <span class="comment">! R/Cp</span></div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a09f581223422f76e63d062171eea6d90">  200</a></span><span class="keywordtype">real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>) ::   <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a09f581223422f76e63d062171eea6d90">rair</a>               <span class="comment">! Gas constant for dry air (J/K/kg)</span></div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a4e848e3e0511ebba4d1541494c416613">  201</a></span><span class="keywordtype">real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>) ::   <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a4e848e3e0511ebba4d1541494c416613">tmelt</a>              <span class="comment">! freezing T of fresh water ~ K</span></div>
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a2a77d630c6bbf754a49438adeee81233">  202</a></span><span class="keywordtype">real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>) ::   <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a2a77d630c6bbf754a49438adeee81233">r_universal</a>        <span class="comment">! Universal gas constant ~ J/K/kmole</span></div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a5015a287bd422630ce9207d3cf048d9e">  203</a></span><span class="keywordtype">real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>) ::   <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a5015a287bd422630ce9207d3cf048d9e">latvap</a>             <span class="comment">! latent heat of evaporation ~ J/kg</span></div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a7dbaac2569bfd72fec6fb1c09a41ff04">  204</a></span><span class="keywordtype">real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>) ::   <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a7dbaac2569bfd72fec6fb1c09a41ff04">latice</a>             <span class="comment">! latent heat of fusion ~ J/kg</span></div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a6259bce15c4a4f5204905e9234e16336">  205</a></span><span class="keywordtype">real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>) ::   <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a6259bce15c4a4f5204905e9234e16336">zvir</a>               <span class="comment">! R_V/R_D - 1.</span></div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#ade898261c4d5956cba8ee44692928f2b">  206</a></span>  <span class="keywordtype">integer</span> <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ade898261c4d5956cba8ee44692928f2b">plenest</a>  <span class="comment">! length of saturation vapor pressure table</span></div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno">  207</span>  parameter(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ade898261c4d5956cba8ee44692928f2b">plenest</a>=250)</div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span><span class="comment">! </span></div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span><span class="comment">! Table of saturation vapor pressure values es from tmin degrees</span></div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span><span class="comment">! to tmax+1 degrees k in one degree increments.  ttrice defines the</span></div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span><span class="comment">! transition region where es is a combination of ice &amp; water values</span></div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span><span class="comment">!</span></div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a753905688ac0510d00957932c5b24c69">  213</a></span><span class="keywordtype">real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>) <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a753905688ac0510d00957932c5b24c69">estbl</a>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ade898261c4d5956cba8ee44692928f2b">plenest</a>)      <span class="comment">! table values of saturation vapor pressure</span></div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#ab7607052d159e3c4918a4be06574a590">  214</a></span><span class="keywordtype">real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>) <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ab7607052d159e3c4918a4be06574a590">tmin</a>       <span class="comment">! min temperature (K) for table</span></div>
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#ac550f97473b686550bc1aae97e282cff">  215</a></span><span class="keywordtype">real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>) <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ac550f97473b686550bc1aae97e282cff">tmax</a>       <span class="comment">! max temperature (K) for table</span></div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a9959643d725aaab6c2bc49ef8233f17d">  216</a></span><span class="keywordtype">real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>) <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a9959643d725aaab6c2bc49ef8233f17d">pcf</a>(6)     <span class="comment">! polynomial coeffs -&gt; es transition water to ice</span></div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno">  217</span><span class="comment">!real(r8), allocatable :: pin(:)           ! ozone pressure level (levsiz)</span></div>
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno">  218</span><span class="comment">!real(r8), allocatable :: ozmix(:,:,:)     ! mixing ratio</span></div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span><span class="comment">!real(r8), allocatable, target :: abstot_3d(:,:,:,:) ! Non-adjacent layer absorptivites</span></div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span><span class="comment">!real(r8), allocatable, target :: absnxt_3d(:,:,:,:) ! Nearest layer absorptivities</span></div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span><span class="comment">!real(r8), allocatable, target :: emstot_3d(:,:,:)   ! Total emissivity</span></div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span> </div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span><span class="comment">!From aer_optics.F90 module</span></div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#ac44b8b41ab99cff1db5eedbdd196a269">  224</a></span><span class="keywordtype">integer</span>, <span class="keywordtype">parameter</span> :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ac44b8b41ab99cff1db5eedbdd196a269">idxvis</a> = 8     <span class="comment">! index to visible band</span></div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#af8b5f8546f90cdfab31c24668e0996c2">  225</a></span><span class="keywordtype">integer</span>, <span class="keywordtype">parameter</span> :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#af8b5f8546f90cdfab31c24668e0996c2">nrh</a> = 1000   <span class="comment">! number of relative humidity values for look-up-table</span></div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a73b4d94aeace16bc74068bafda784831">  226</a></span><span class="keywordtype">integer</span>, <span class="keywordtype">parameter</span> :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a73b4d94aeace16bc74068bafda784831">nspint</a> = 19   <span class="comment">! number of spectral intervals</span></div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno">  227</span> </div>
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno">  228</span><span class="comment">! These are now allocatable,  JM 20090612</span></div>
<div class="line"><a id="l00229" name="l00229"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a6547194c35aef1b906c011b0ba56e4cf">  229</a></span><span class="keywordtype">real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>), <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:,:)</span> :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a6547194c35aef1b906c011b0ba56e4cf">ksul</a>    <span class="comment">! (nrh, nspint)    ! sulfate specific extinction  ( m^2 g-1 )</span></div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#ae509dcf829ddf2991fb22062c1800de9">  230</a></span><span class="keywordtype">real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>), <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:,:)</span> :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ae509dcf829ddf2991fb22062c1800de9">wsul</a>    <span class="comment">! (nrh, nspint)    ! sulfate single scattering albedo</span></div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#ab0a88e85acf8aacb2a33d58a5c490d3e">  231</a></span><span class="keywordtype">real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>), <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:,:)</span> :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ab0a88e85acf8aacb2a33d58a5c490d3e">gsul</a>    <span class="comment">! (nrh, nspint)    ! sulfate asymmetry parameter</span></div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a20408f7ac63d867f91e77786c442a6d0">  232</a></span><span class="keywordtype">real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>), <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:,:)</span> :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a20408f7ac63d867f91e77786c442a6d0">ksslt</a>   <span class="comment">! (nrh, nspint)   ! sea-salt specific extinction  ( m^2 g-1 )</span></div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a013d9c7b7e12d40bf7c4beae240c71a5">  233</a></span><span class="keywordtype">real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>), <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:,:)</span> :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a013d9c7b7e12d40bf7c4beae240c71a5">wsslt</a>   <span class="comment">! (nrh, nspint)   ! sea-salt single scattering albedo</span></div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a597b13016a0f27c53709bafdf3a4169a">  234</a></span><span class="keywordtype">real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>), <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:,:)</span> :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a597b13016a0f27c53709bafdf3a4169a">gsslt</a>   <span class="comment">! (nrh, nspint)   ! sea-salt asymmetry parameter</span></div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a119e6bcbd1c35c9fa8e6bd724e6da1b7">  235</a></span><span class="keywordtype">real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>), <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:,:)</span> :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a119e6bcbd1c35c9fa8e6bd724e6da1b7">kcphil</a>  <span class="comment">! (nrh, nspint)  ! hydrophilic carbon specific extinction  ( m^2 g-1 )</span></div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#ac19f8c9902dc190eda33b665d428806f">  236</a></span><span class="keywordtype">real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>), <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:,:)</span> :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ac19f8c9902dc190eda33b665d428806f">wcphil</a>  <span class="comment">! (nrh, nspint)  ! hydrophilic carbon single scattering albedo</span></div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a417d3c687b803b9fa520768498503e07">  237</a></span><span class="keywordtype">real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>), <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:,:)</span> :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a417d3c687b803b9fa520768498503e07">gcphil</a>  <span class="comment">! (nrh, nspint)  ! hydrophilic carbon asymmetry parameter</span></div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span> </div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a7333bd6e64880f7c8a34daa55e2a9007">  239</a></span><span class="keywordtype">real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>) :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a7333bd6e64880f7c8a34daa55e2a9007">kbg</a>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a73b4d94aeace16bc74068bafda784831">nspint</a>)          <span class="comment">! background specific extinction  ( m^2 g-1 )</span></div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a61a7b14a17925acd1b5ee1ef5b89af87">  240</a></span><span class="keywordtype">real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>) :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a61a7b14a17925acd1b5ee1ef5b89af87">wbg</a>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a73b4d94aeace16bc74068bafda784831">nspint</a>)          <span class="comment">! background single scattering albedo</span></div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a79996b6b720ac8bae0022f7597e0d185">  241</a></span><span class="keywordtype">real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>) :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a79996b6b720ac8bae0022f7597e0d185">gbg</a>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a73b4d94aeace16bc74068bafda784831">nspint</a>)          <span class="comment">! background asymmetry parameter</span></div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#ab9698de3d9583b47b9f0f79888243a02">  242</a></span><span class="keywordtype">real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>) :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ab9698de3d9583b47b9f0f79888243a02">kcphob</a>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a73b4d94aeace16bc74068bafda784831">nspint</a>)       <span class="comment">! hydrophobic carbon specific extinction  ( m^2 g-1 )</span></div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#ac9af610840dfd4a05d682ad8299a849e">  243</a></span><span class="keywordtype">real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>) :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ac9af610840dfd4a05d682ad8299a849e">wcphob</a>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a73b4d94aeace16bc74068bafda784831">nspint</a>)       <span class="comment">! hydrophobic carbon single scattering albedo</span></div>
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a66ee794a307b383eda1904b5304cfd73">  244</a></span><span class="keywordtype">real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>) :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a66ee794a307b383eda1904b5304cfd73">gcphob</a>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a73b4d94aeace16bc74068bafda784831">nspint</a>)       <span class="comment">! hydrophobic carbon asymmetry parameter</span></div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#aeda61c0a1796f1009ab1ae2aaa2b11b7">  245</a></span><span class="keywordtype">real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>) :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#aeda61c0a1796f1009ab1ae2aaa2b11b7">kcb</a>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a73b4d94aeace16bc74068bafda784831">nspint</a>)          <span class="comment">! black carbon specific extinction  ( m^2 g-1 )</span></div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a93c8608518cbf7ff45ee5f58d8e6a7be">  246</a></span><span class="keywordtype">real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>) :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a93c8608518cbf7ff45ee5f58d8e6a7be">wcb</a>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a73b4d94aeace16bc74068bafda784831">nspint</a>)          <span class="comment">! black carbon single scattering albedo</span></div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a47269dd12293e86f1bb796d58d63fc8d">  247</a></span><span class="keywordtype">real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>) :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a47269dd12293e86f1bb796d58d63fc8d">gcb</a>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a73b4d94aeace16bc74068bafda784831">nspint</a>)          <span class="comment">! black carbon asymmetry parameter</span></div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#ab9dd87c1ef6ee3ff07ca0030fd642122">  248</a></span><span class="keywordtype">real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>) :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ab9dd87c1ef6ee3ff07ca0030fd642122">kvolc</a>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a73b4d94aeace16bc74068bafda784831">nspint</a>)        <span class="comment">! volcanic specific extinction  ( m^2 g-1)</span></div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#afc14045c968e1826a6cecfe78f987844">  249</a></span><span class="keywordtype">real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>) :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#afc14045c968e1826a6cecfe78f987844">wvolc</a>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a73b4d94aeace16bc74068bafda784831">nspint</a>)        <span class="comment">! volcanic single scattering albedo</span></div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a8c0779f635e8038371f30b2e384cedca">  250</a></span><span class="keywordtype">real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>) :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8c0779f635e8038371f30b2e384cedca">gvolc</a>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a73b4d94aeace16bc74068bafda784831">nspint</a>)        <span class="comment">! volcanic asymmetry parameter</span></div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno">  251</span> </div>
<div class="line"><a id="l00252" name="l00252"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a03ea99448698668710d5d8c1bfb893c7">  252</a></span><span class="keywordtype">real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>) :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a03ea99448698668710d5d8c1bfb893c7">kdst</a>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a6f6deafe37ef978d01301e8d2fe1177b">ndstsz</a>, <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a73b4d94aeace16bc74068bafda784831">nspint</a>) <span class="comment">! dust specific extinction  ( m^2 g-1 )</span></div>
<div class="line"><a id="l00253" name="l00253"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a94051f36288fce3a6dd41f8190fd5743">  253</a></span><span class="keywordtype">real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>) :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a94051f36288fce3a6dd41f8190fd5743">wdst</a>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a6f6deafe37ef978d01301e8d2fe1177b">ndstsz</a>, <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a73b4d94aeace16bc74068bafda784831">nspint</a>) <span class="comment">! dust single scattering albedo</span></div>
<div class="line"><a id="l00254" name="l00254"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a7339eabd703a5c422dea9f3771fa52ac">  254</a></span><span class="keywordtype">real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>) :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a7339eabd703a5c422dea9f3771fa52ac">gdst</a>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a6f6deafe37ef978d01301e8d2fe1177b">ndstsz</a>, <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a73b4d94aeace16bc74068bafda784831">nspint</a>) <span class="comment">! dust asymmetry parameter</span></div>
<div class="line"><a id="l00255" name="l00255"></a><span class="lineno">  255</span><span class="comment">!</span></div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno">  256</span><span class="comment">!From comozp.F90 module</span></div>
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#ab8a0687da829019bc834c68800c09a88">  257</a></span><span class="keywordtype">      real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>) <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ab8a0687da829019bc834c68800c09a88">cplos</a>    <span class="comment">! constant for ozone path length integral</span></div>
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a9adf2e225e8f61abf989b024fd390325">  258</a></span><span class="keywordtype">      real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>) <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a9adf2e225e8f61abf989b024fd390325">cplol</a>    <span class="comment">! constant for ozone path length integral</span></div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno">  259</span> </div>
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno">  260</span><span class="comment">!From ghg_surfvals.F90 module</span></div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#ad2f718780e3faf1a8cd0d84ea66fc597">  261</a></span><span class="keywordtype">   real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>) :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ad2f718780e3faf1a8cd0d84ea66fc597">co2vmr</a> = 3.550e-4         <span class="comment">! co2   volume mixing ratio</span></div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#ac18daa0d2170ae2a3f814fd448134dea">  262</a></span><span class="keywordtype">   real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>) :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ac18daa0d2170ae2a3f814fd448134dea">n2ovmr</a> = 0.311e-6         <span class="comment">! n2o   volume mixing ratio</span></div>
<div class="line"><a id="l00263" name="l00263"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a99553d746383c4fea61ef51ba54a3ce9">  263</a></span><span class="keywordtype">   real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>) :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a99553d746383c4fea61ef51ba54a3ce9">ch4vmr</a> = 1.714e-6         <span class="comment">! ch4   volume mixing ratio</span></div>
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a81d6927b3227403fd19023efa755e3ee">  264</a></span><span class="keywordtype">   real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>) :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a81d6927b3227403fd19023efa755e3ee">f11vmr</a> = 0.280e-9         <span class="comment">! cfc11 volume mixing ratio</span></div>
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a281f8f573adfae5e50a6d3d6cd879792">  265</a></span><span class="keywordtype">   real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>) :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a281f8f573adfae5e50a6d3d6cd879792">f12vmr</a> = 0.503e-9         <span class="comment">! cfc12 volume mixing ratio</span></div>
<div class="line"><a id="l00266" name="l00266"></a><span class="lineno">  266</span> </div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a0902f94f024705cbfd239e44b64f8883">  267</a></span><span class="keywordtype">integer</span>, <span class="keywordtype">parameter</span> :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a0902f94f024705cbfd239e44b64f8883">cyr</a> = 233  <span class="comment">! number of years of co2 data</span></div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno">  268</span> </div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a783c25660954e30ad1debe6710645383">  269</a></span>   <span class="keywordtype">integer</span>  :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a783c25660954e30ad1debe6710645383">yrdata</a>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a0902f94f024705cbfd239e44b64f8883">cyr</a>) = &amp;</div>
<div class="line"><a id="l00270" name="l00270"></a><span class="lineno">  270</span> (/ 1869, 1870, 1871, 1872, 1873, 1874, 1875, &amp;</div>
<div class="line"><a id="l00271" name="l00271"></a><span class="lineno">  271</span>    1876, 1877, 1878, 1879, 1880, 1881, 1882, &amp;</div>
<div class="line"><a id="l00272" name="l00272"></a><span class="lineno">  272</span>    1883, 1884, 1885, 1886, 1887, 1888, 1889, &amp;</div>
<div class="line"><a id="l00273" name="l00273"></a><span class="lineno">  273</span>    1890, 1891, 1892, 1893, 1894, 1895, 1896, &amp;</div>
<div class="line"><a id="l00274" name="l00274"></a><span class="lineno">  274</span>    1897, 1898, 1899, 1900, 1901, 1902, 1903, &amp;</div>
<div class="line"><a id="l00275" name="l00275"></a><span class="lineno">  275</span>    1904, 1905, 1906, 1907, 1908, 1909, 1910, &amp;</div>
<div class="line"><a id="l00276" name="l00276"></a><span class="lineno">  276</span>    1911, 1912, 1913, 1914, 1915, 1916, 1917, &amp;</div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno">  277</span>    1918, 1919, 1920, 1921, 1922, 1923, 1924, &amp;</div>
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno">  278</span>    1925, 1926, 1927, 1928, 1929, 1930, 1931, &amp;</div>
<div class="line"><a id="l00279" name="l00279"></a><span class="lineno">  279</span>    1932, 1933, 1934, 1935, 1936, 1937, 1938, &amp;</div>
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno">  280</span>    1939, 1940, 1941, 1942, 1943, 1944, 1945, &amp;</div>
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno">  281</span>    1946, 1947, 1948, 1949, 1950, 1951, 1952, &amp;</div>
<div class="line"><a id="l00282" name="l00282"></a><span class="lineno">  282</span>    1953, 1954, 1955, 1956, 1957, 1958, 1959, &amp;</div>
<div class="line"><a id="l00283" name="l00283"></a><span class="lineno">  283</span>    1960, 1961, 1962, 1963, 1964, 1965, 1966, &amp;</div>
<div class="line"><a id="l00284" name="l00284"></a><span class="lineno">  284</span>    1967, 1968, 1969, 1970, 1971, 1972, 1973, &amp;</div>
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno">  285</span>    1974, 1975, 1976, 1977, 1978, 1979, 1980, &amp;</div>
<div class="line"><a id="l00286" name="l00286"></a><span class="lineno">  286</span>    1981, 1982, 1983, 1984, 1985, 1986, 1987, &amp;</div>
<div class="line"><a id="l00287" name="l00287"></a><span class="lineno">  287</span>    1988, 1989, 1990, 1991, 1992, 1993, 1994, &amp;</div>
<div class="line"><a id="l00288" name="l00288"></a><span class="lineno">  288</span>    1995, 1996, 1997, 1998, 1999, 2000, 2001, &amp;</div>
<div class="line"><a id="l00289" name="l00289"></a><span class="lineno">  289</span>    2002, 2003, 2004, 2005, 2006, 2007, 2008, &amp;</div>
<div class="line"><a id="l00290" name="l00290"></a><span class="lineno">  290</span>    2009, 2010, 2011, 2012, 2013, 2014, 2015, &amp;</div>
<div class="line"><a id="l00291" name="l00291"></a><span class="lineno">  291</span>    2016, 2017, 2018, 2019, 2020, 2021, 2022, &amp;</div>
<div class="line"><a id="l00292" name="l00292"></a><span class="lineno">  292</span>    2023, 2024, 2025, 2026, 2027, 2028, 2029, &amp;</div>
<div class="line"><a id="l00293" name="l00293"></a><span class="lineno">  293</span>    2030, 2031, 2032, 2033, 2034, 2035, 2036, &amp;</div>
<div class="line"><a id="l00294" name="l00294"></a><span class="lineno">  294</span>    2037, 2038, 2039, 2040, 2041, 2042, 2043, &amp;</div>
<div class="line"><a id="l00295" name="l00295"></a><span class="lineno">  295</span>    2044, 2045, 2046, 2047, 2048, 2049, 2050, &amp;</div>
<div class="line"><a id="l00296" name="l00296"></a><span class="lineno">  296</span>    2051, 2052, 2053, 2054, 2055, 2056, 2057, &amp;</div>
<div class="line"><a id="l00297" name="l00297"></a><span class="lineno">  297</span>    2058, 2059, 2060, 2061, 2062, 2063, 2064, &amp;</div>
<div class="line"><a id="l00298" name="l00298"></a><span class="lineno">  298</span>    2065, 2066, 2067, 2068, 2069, 2070, 2071, &amp;</div>
<div class="line"><a id="l00299" name="l00299"></a><span class="lineno">  299</span>    2072, 2073, 2074, 2075, 2076, 2077, 2078, &amp;</div>
<div class="line"><a id="l00300" name="l00300"></a><span class="lineno">  300</span>    2079, 2080, 2081, 2082, 2083, 2084, 2085, &amp;</div>
<div class="line"><a id="l00301" name="l00301"></a><span class="lineno">  301</span>    2086, 2087, 2088, 2089, 2090, 2091, 2092, &amp;</div>
<div class="line"><a id="l00302" name="l00302"></a><span class="lineno">  302</span>    2093, 2094, 2095, 2096, 2097, 2098, 2099, &amp;</div>
<div class="line"><a id="l00303" name="l00303"></a><span class="lineno">  303</span>    2100, 2101                               /)</div>
<div class="line"><a id="l00304" name="l00304"></a><span class="lineno">  304</span> </div>
<div class="line"><a id="l00305" name="l00305"></a><span class="lineno">  305</span><span class="comment">! A2 future scenario</span></div>
<div class="line"><a id="l00306" name="l00306"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a1c7bb97c83a485602d50b5b1a89acae0">  306</a></span><span class="keywordtype">    real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>)  :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a1c7bb97c83a485602d50b5b1a89acae0">co2</a>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a0902f94f024705cbfd239e44b64f8883">cyr</a>) = &amp;</div>
<div class="line"><a id="l00307" name="l00307"></a><span class="lineno">  307</span> (/ 289.263, 289.263, 289.416, 289.577, 289.745, 289.919, 290.102, &amp;</div>
<div class="line"><a id="l00308" name="l00308"></a><span class="lineno">  308</span>    290.293, 290.491, 290.696, 290.909, 291.129, 291.355, 291.587, 291.824, &amp;</div>
<div class="line"><a id="l00309" name="l00309"></a><span class="lineno">  309</span>    292.066, 292.313, 292.563, 292.815, 293.071, 293.328, 293.586, 293.843, &amp;</div>
<div class="line"><a id="l00310" name="l00310"></a><span class="lineno">  310</span>    294.098, 294.35, 294.598, 294.842, 295.082, 295.32, 295.558, 295.797,   &amp;</div>
<div class="line"><a id="l00311" name="l00311"></a><span class="lineno">  311</span>    296.038, 296.284, 296.535, 296.794, 297.062, 297.338, 297.62, 297.91,   &amp;</div>
<div class="line"><a id="l00312" name="l00312"></a><span class="lineno">  312</span>    298.204, 298.504, 298.806, 299.111, 299.419, 299.729, 300.04, 300.352,  &amp;</div>
<div class="line"><a id="l00313" name="l00313"></a><span class="lineno">  313</span>    300.666, 300.98, 301.294, 301.608, 301.923, 302.237, 302.551, 302.863,  &amp;</div>
<div class="line"><a id="l00314" name="l00314"></a><span class="lineno">  314</span>    303.172, 303.478, 303.779, 304.075, 304.366, 304.651, 304.93, 305.206,  &amp;</div>
<div class="line"><a id="l00315" name="l00315"></a><span class="lineno">  315</span>    305.478, 305.746, 306.013, 306.28, 306.546, 306.815, 307.087, 307.365,  &amp;</div>
<div class="line"><a id="l00316" name="l00316"></a><span class="lineno">  316</span>    307.65, 307.943, 308.246, 308.56, 308.887, 309.228, 309.584, 309.956,   &amp;</div>
<div class="line"><a id="l00317" name="l00317"></a><span class="lineno">  317</span>    310.344, 310.749, 311.172, 311.614, 312.077, 312.561, 313.068, 313.599, &amp;</div>
<div class="line"><a id="l00318" name="l00318"></a><span class="lineno">  318</span>    314.154, 314.737, 315.347, 315.984, 316.646, 317.328, 318.026, 318.742, &amp;</div>
<div class="line"><a id="l00319" name="l00319"></a><span class="lineno">  319</span>    319.489, 320.282, 321.133, 322.045, 323.021, 324.06, 325.155, 326.299,  &amp;</div>
<div class="line"><a id="l00320" name="l00320"></a><span class="lineno">  320</span>    327.484, 328.698, 329.933, 331.194, 332.499, 333.854, 335.254, 336.69,  &amp;</div>
<div class="line"><a id="l00321" name="l00321"></a><span class="lineno">  321</span>    338.15, 339.628, 341.125, 342.65, 344.206, 345.797, 347.397, 348.98,    &amp;</div>
<div class="line"><a id="l00322" name="l00322"></a><span class="lineno">  322</span>    350.551, 352.1, 354.3637, 355.7772, 357.1601, 358.5306, 359.9046,       &amp;</div>
<div class="line"><a id="l00323" name="l00323"></a><span class="lineno">  323</span>    361.4157, 363.0445, 364.7761, 366.6064, 368.5322, 370.534, 372.5798,    &amp;</div>
<div class="line"><a id="l00324" name="l00324"></a><span class="lineno">  324</span>    374.6564, 376.7656, 378.9087, 381.0864, 383.2994, 385.548, 387.8326,    &amp;</div>
<div class="line"><a id="l00325" name="l00325"></a><span class="lineno">  325</span>    390.1536, 392.523, 394.9625, 397.4806, 400.075, 402.7444, 405.4875,     &amp;</div>
<div class="line"><a id="l00326" name="l00326"></a><span class="lineno">  326</span>    408.3035, 411.1918, 414.1518, 417.1831, 420.2806, 423.4355, 426.6442,   &amp;</div>
<div class="line"><a id="l00327" name="l00327"></a><span class="lineno">  327</span>    429.9076, 433.2261, 436.6002, 440.0303, 443.5168, 447.06, 450.6603,     &amp;</div>
<div class="line"><a id="l00328" name="l00328"></a><span class="lineno">  328</span>    454.3059, 457.9756, 461.6612, 465.3649, 469.0886, 472.8335, 476.6008,   &amp;</div>
<div class="line"><a id="l00329" name="l00329"></a><span class="lineno">  329</span>    480.3916, 484.2069, 488.0473, 491.9184, 495.8295, 499.7849, 503.7843,   &amp;</div>
<div class="line"><a id="l00330" name="l00330"></a><span class="lineno">  330</span>    507.8278, 511.9155, 516.0476, 520.2243, 524.4459, 528.7127, 533.0213,   &amp;</div>
<div class="line"><a id="l00331" name="l00331"></a><span class="lineno">  331</span>    537.3655, 541.7429, 546.1544, 550.6005, 555.0819, 559.5991, 564.1525,   &amp;</div>
<div class="line"><a id="l00332" name="l00332"></a><span class="lineno">  332</span>    568.7429, 573.3701, 578.0399, 582.7611, 587.5379, 592.3701, 597.2572,   &amp;</div>
<div class="line"><a id="l00333" name="l00333"></a><span class="lineno">  333</span>    602.1997, 607.1975, 612.2507, 617.3596, 622.524, 627.7528, 633.0616,    &amp;</div>
<div class="line"><a id="l00334" name="l00334"></a><span class="lineno">  334</span>    638.457, 643.9384, 649.505, 655.1568, 660.8936, 666.7153, 672.6219,     &amp;</div>
<div class="line"><a id="l00335" name="l00335"></a><span class="lineno">  335</span>    678.6133, 684.6945, 690.8745, 697.1569, 703.5416, 710.0284, 716.6172,   &amp;</div>
<div class="line"><a id="l00336" name="l00336"></a><span class="lineno">  336</span>    723.308, 730.1008, 736.9958, 743.993, 751.0975, 758.3183, 765.6594,     &amp;</div>
<div class="line"><a id="l00337" name="l00337"></a><span class="lineno">  337</span>    773.1207, 780.702, 788.4033, 796.2249, 804.1667, 812.2289, 820.4118,    &amp;</div>
<div class="line"><a id="l00338" name="l00338"></a><span class="lineno">  338</span>    828.6444, 828.6444 /)</div>
<div class="line"><a id="l00339" name="l00339"></a><span class="lineno">  339</span> </div>
<div class="line"><a id="l00340" name="l00340"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a1a12feb1033e5148328277eb0a083ab3">  340</a></span>      <span class="keywordtype">integer</span>  :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a1a12feb1033e5148328277eb0a083ab3">ntoplw</a>      <span class="comment">! top level to solve for longwave cooling (WRF sets this to 1 for model top below 10 mb)</span></div>
<div class="line"><a id="l00341" name="l00341"></a><span class="lineno">  341</span> </div>
<div class="line"><a id="l00342" name="l00342"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a23c78317414125c627ac5c180f91a508">  342</a></span>      <span class="keywordtype">logical</span> :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a23c78317414125c627ac5c180f91a508">masterproc</a> = .true.</div>
<div class="line"><a id="l00343" name="l00343"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a44b597fef2b9c66cd7f1e345ca48b2db">  343</a></span>      <span class="keywordtype">logical</span> :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a44b597fef2b9c66cd7f1e345ca48b2db">ozncyc</a>            <span class="comment">! true =&gt; cycle ozone dataset</span></div>
<div class="line"><a id="l00344" name="l00344"></a><span class="lineno">  344</span><span class="comment">!     logical :: dosw              ! True =&gt; shortwave calculation this timestep</span></div>
<div class="line"><a id="l00345" name="l00345"></a><span class="lineno">  345</span><span class="comment">!     logical :: dolw              ! True =&gt; longwave calculation this timestep</span></div>
<div class="line"><a id="l00346" name="l00346"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a81065323490e9ddac085451828f92a9c">  346</a></span>      <span class="keywordtype">logical</span> :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a81065323490e9ddac085451828f92a9c">indirect</a>          <span class="comment">! True =&gt; include indirect radiative effects of sulfate aerosols</span></div>
<div class="line"><a id="l00347" name="l00347"></a><span class="lineno">  347</span><span class="comment">!     logical :: doabsems          ! True =&gt; abs/emiss calculation this timestep</span></div>
<div class="line"><a id="l00348" name="l00348"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#ad4a1e2f21340939aa3c4b9dbca9177da">  348</a></span>      <span class="keywordtype">logical</span> :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ad4a1e2f21340939aa3c4b9dbca9177da">radforce</a>   = .false.          <span class="comment">! True =&gt; calculate aerosol shortwave forcing</span></div>
<div class="line"><a id="l00349" name="l00349"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a83f5be2ce9583619a25730f91f3ff2f0">  349</a></span>      <span class="keywordtype">logical</span> :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a83f5be2ce9583619a25730f91f3ff2f0">trace_gas</a>=.false.             <span class="comment">! set true for chemistry</span></div>
<div class="line"><a id="l00350" name="l00350"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a362aff727bf79120acd003d8242e216b">  350</a></span>      <span class="keywordtype">logical</span> :: <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a362aff727bf79120acd003d8242e216b">strat_volcanic</a>   = .false.    <span class="comment">! True =&gt; volcanic aerosol mass available</span></div>
<div class="line"><a id="l00351" name="l00351"></a><span class="lineno">  351</span> </div>
<div class="line"><a id="l00352" name="l00352"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a55540415fe1cc156dd9204bb7129de14">  352</a></span><span class="keywordtype">    real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>) <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a55540415fe1cc156dd9204bb7129de14">retab</a>(95)</div>
<div class="line"><a id="l00353" name="l00353"></a><span class="lineno">  353</span>    <span class="comment">!</span></div>
<div class="line"><a id="l00354" name="l00354"></a><span class="lineno">  354</span>    <span class="comment">!       Tabulated values of re(T) in the temperature interval</span></div>
<div class="line"><a id="l00355" name="l00355"></a><span class="lineno">  355</span>    <span class="comment">!       180 K -- 274 K; hexagonal columns assumed:</span></div>
<div class="line"><a id="l00356" name="l00356"></a><span class="lineno">  356</span>    <span class="comment">!</span></div>
<div class="line"><a id="l00357" name="l00357"></a><span class="lineno">  357</span>    <span class="keyword">data</span> <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a55540415fe1cc156dd9204bb7129de14">retab</a> /                        &amp;</div>
<div class="line"><a id="l00358" name="l00358"></a><span class="lineno">  358</span>         5.92779, 6.26422, 6.61973, 6.99539, 7.39234,   &amp;</div>
<div class="line"><a id="l00359" name="l00359"></a><span class="lineno">  359</span>         7.81177, 8.25496, 8.72323, 9.21800, 9.74075, 10.2930,  &amp;</div>
<div class="line"><a id="l00360" name="l00360"></a><span class="lineno">  360</span>         10.8765, 11.4929, 12.1440, 12.8317, 13.5581, 14.2319,  &amp;</div>
<div class="line"><a id="l00361" name="l00361"></a><span class="lineno">  361</span>         15.0351, 15.8799, 16.7674, 17.6986, 18.6744, 19.6955,  &amp;</div>
<div class="line"><a id="l00362" name="l00362"></a><span class="lineno">  362</span>         20.7623, 21.8757, 23.0364, 24.2452, 25.5034, 26.8125,  &amp;</div>
<div class="line"><a id="l00363" name="l00363"></a><span class="lineno">  363</span>         27.7895, 28.6450, 29.4167, 30.1088, 30.7306, 31.2943,  &amp;</div>
<div class="line"><a id="l00364" name="l00364"></a><span class="lineno">  364</span>         31.8151, 32.3077, 32.7870, 33.2657, 33.7540, 34.2601,  &amp;</div>
<div class="line"><a id="l00365" name="l00365"></a><span class="lineno">  365</span>         34.7892, 35.3442, 35.9255, 36.5316, 37.1602, 37.8078,  &amp;</div>
<div class="line"><a id="l00366" name="l00366"></a><span class="lineno">  366</span>         38.4720, 39.1508, 39.8442, 40.5552, 41.2912, 42.0635,  &amp;</div>
<div class="line"><a id="l00367" name="l00367"></a><span class="lineno">  367</span>         42.8876, 43.7863, 44.7853, 45.9170, 47.2165, 48.7221,  &amp;</div>
<div class="line"><a id="l00368" name="l00368"></a><span class="lineno">  368</span>         50.4710, 52.4980, 54.8315, 57.4898, 60.4785, 63.7898,  &amp;</div>
<div class="line"><a id="l00369" name="l00369"></a><span class="lineno">  369</span>         65.5604, 71.2885, 75.4113, 79.7368, 84.2351, 88.8833,  &amp;</div>
<div class="line"><a id="l00370" name="l00370"></a><span class="lineno">  370</span>         93.6658, 98.5739, 103.603, 108.752, 114.025, 119.424,  &amp;</div>
<div class="line"><a id="l00371" name="l00371"></a><span class="lineno">  371</span>         124.954, 130.630, 136.457, 142.446, 148.608, 154.956,  &amp;</div>
<div class="line"><a id="l00372" name="l00372"></a><span class="lineno">  372</span>         161.503, 168.262, 175.248, 182.473, 189.952, 197.699,  &amp;</div>
<div class="line"><a id="l00373" name="l00373"></a><span class="lineno">  373</span>         205.728, 214.055, 222.694, 231.661, 240.971, 250.639/  </div>
<div class="line"><a id="l00374" name="l00374"></a><span class="lineno">  374</span>    <span class="comment">!</span></div>
<div class="line"><a id="l00375" name="l00375"></a><span class="lineno">  375</span>    <span class="keywordtype">save</span> <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a55540415fe1cc156dd9204bb7129de14">retab</a></div>
<div class="line"><a id="l00376" name="l00376"></a><span class="lineno">  376</span><span class="keyword">contains</span></div>
<div class="line"><a id="l00377" name="l00377"></a><span class="lineno">  377</span> </div>
<div class="line"><a id="l00378" name="l00378"></a><span class="lineno">  378</span> </div>
<div class="line"><a id="l00379" name="l00379"></a><span class="lineno">  379</span> </div>
<div class="line"><a id="l00380" name="l00380"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#ab971029f3ceb20868140fc1cf031221c">  380</a></span><span class="keyword">subroutine </span><a class="code hl_function" href="namespacemodule__ra__cam__support.html#ab971029f3ceb20868140fc1cf031221c">sortarray</a>(n, ain, indxa) </div>
<div class="line"><a id="l00381" name="l00381"></a><span class="lineno">  381</span><span class="comment">!-----------------------------------------------</span></div>
<div class="line"><a id="l00382" name="l00382"></a><span class="lineno">  382</span><span class="comment">!</span></div>
<div class="line"><a id="l00383" name="l00383"></a><span class="lineno">  383</span><span class="comment">! Purpose:</span></div>
<div class="line"><a id="l00384" name="l00384"></a><span class="lineno">  384</span><span class="comment">!       Sort an array</span></div>
<div class="line"><a id="l00385" name="l00385"></a><span class="lineno">  385</span><span class="comment">! Alogrithm:</span></div>
<div class="line"><a id="l00386" name="l00386"></a><span class="lineno">  386</span><span class="comment">!       Based on Shell&#39;s sorting method.</span></div>
<div class="line"><a id="l00387" name="l00387"></a><span class="lineno">  387</span><span class="comment">!</span></div>
<div class="line"><a id="l00388" name="l00388"></a><span class="lineno">  388</span><span class="comment">! Author: T. Craig</span></div>
<div class="line"><a id="l00389" name="l00389"></a><span class="lineno">  389</span><span class="comment">!-----------------------------------------------</span></div>
<div class="line"><a id="l00390" name="l00390"></a><span class="lineno">  390</span><span class="comment">!  use shr_kind_mod, only: r8 =&gt; shr_kind_r8</span></div>
<div class="line"><a id="l00391" name="l00391"></a><span class="lineno">  391</span>   <span class="keywordtype">implicit none</span></div>
<div class="line"><a id="l00392" name="l00392"></a><span class="lineno">  392</span><span class="comment">!</span></div>
<div class="line"><a id="l00393" name="l00393"></a><span class="lineno">  393</span><span class="comment">!  Arguments</span></div>
<div class="line"><a id="l00394" name="l00394"></a><span class="lineno">  394</span><span class="comment">!</span></div>
<div class="line"><a id="l00395" name="l00395"></a><span class="lineno">  395</span>   <span class="keywordtype">integer</span> , <span class="keywordtype">intent(in)</span> :: n             <span class="comment">! total number of elements</span></div>
<div class="line"><a id="l00396" name="l00396"></a><span class="lineno">  396</span>   <span class="keywordtype">integer</span> , <span class="keywordtype">intent(inout)</span> :: indxa(n)   <span class="comment">! array of integers</span></div>
<div class="line"><a id="l00397" name="l00397"></a><span class="lineno">  397</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(inout)</span> :: ain(n)     <span class="comment">! array to sort</span></div>
<div class="line"><a id="l00398" name="l00398"></a><span class="lineno">  398</span><span class="comment">!</span></div>
<div class="line"><a id="l00399" name="l00399"></a><span class="lineno">  399</span><span class="comment">!  local variables</span></div>
<div class="line"><a id="l00400" name="l00400"></a><span class="lineno">  400</span><span class="comment">!</span></div>
<div class="line"><a id="l00401" name="l00401"></a><span class="lineno">  401</span>   <span class="keywordtype">integer</span> :: i, j                <span class="comment">! Loop indices</span></div>
<div class="line"><a id="l00402" name="l00402"></a><span class="lineno">  402</span>   <span class="keywordtype">integer</span> :: ni                  <span class="comment">! Starting increment</span></div>
<div class="line"><a id="l00403" name="l00403"></a><span class="lineno">  403</span>   <span class="keywordtype">integer</span> :: itmp                <span class="comment">! Temporary index</span></div>
<div class="line"><a id="l00404" name="l00404"></a><span class="lineno">  404</span><span class="keywordtype">   real</span>(r8):: atmp                <span class="comment">! Temporary value to swap</span></div>
<div class="line"><a id="l00405" name="l00405"></a><span class="lineno">  405</span> </div>
<div class="line"><a id="l00406" name="l00406"></a><span class="lineno">  406</span>   ni = 1 </div>
<div class="line"><a id="l00407" name="l00407"></a><span class="lineno">  407</span>   <span class="keywordflow">do</span> <span class="keywordflow">while</span>(.true.) </div>
<div class="line"><a id="l00408" name="l00408"></a><span class="lineno">  408</span>      ni = 3*ni + 1 </div>
<div class="line"><a id="l00409" name="l00409"></a><span class="lineno">  409</span>      <span class="keywordflow">if</span> (ni &lt;= n) cycle  </div>
<div class="line"><a id="l00410" name="l00410"></a><span class="lineno">  410</span>      <span class="keywordflow">exit</span>  </div>
<div class="line"><a id="l00411" name="l00411"></a><span class="lineno">  411</span><span class="keywordflow">   end do</span> </div>
<div class="line"><a id="l00412" name="l00412"></a><span class="lineno">  412</span> </div>
<div class="line"><a id="l00413" name="l00413"></a><span class="lineno">  413</span>   <span class="keywordflow">do</span> <span class="keywordflow">while</span>(.true.) </div>
<div class="line"><a id="l00414" name="l00414"></a><span class="lineno">  414</span>      ni = ni/3 </div>
<div class="line"><a id="l00415" name="l00415"></a><span class="lineno">  415</span>      <span class="keywordflow">do</span> i = ni + 1, n </div>
<div class="line"><a id="l00416" name="l00416"></a><span class="lineno">  416</span>         atmp = ain(i) </div>
<div class="line"><a id="l00417" name="l00417"></a><span class="lineno">  417</span>         itmp = indxa(i) </div>
<div class="line"><a id="l00418" name="l00418"></a><span class="lineno">  418</span>         j = i </div>
<div class="line"><a id="l00419" name="l00419"></a><span class="lineno">  419</span>         <span class="keywordflow">do</span> <span class="keywordflow">while</span>(.true.) </div>
<div class="line"><a id="l00420" name="l00420"></a><span class="lineno">  420</span>            <span class="keywordflow">if</span> (ain(j-ni) &lt;= atmp) <span class="keywordflow">exit</span>  </div>
<div class="line"><a id="l00421" name="l00421"></a><span class="lineno">  421</span>            ain(j) = ain(j-ni) </div>
<div class="line"><a id="l00422" name="l00422"></a><span class="lineno">  422</span>            indxa(j) = indxa(j-ni) </div>
<div class="line"><a id="l00423" name="l00423"></a><span class="lineno">  423</span>            j = j - ni </div>
<div class="line"><a id="l00424" name="l00424"></a><span class="lineno">  424</span>            <span class="keywordflow">if</span> (j &gt; ni) cycle  </div>
<div class="line"><a id="l00425" name="l00425"></a><span class="lineno">  425</span>            <span class="keywordflow">exit</span>  </div>
<div class="line"><a id="l00426" name="l00426"></a><span class="lineno">  426</span><span class="keywordflow">         end do</span> </div>
<div class="line"><a id="l00427" name="l00427"></a><span class="lineno">  427</span>         ain(j) = atmp </div>
<div class="line"><a id="l00428" name="l00428"></a><span class="lineno">  428</span>         indxa(j) = itmp </div>
<div class="line"><a id="l00429" name="l00429"></a><span class="lineno">  429</span><span class="keywordflow">      end do</span> </div>
<div class="line"><a id="l00430" name="l00430"></a><span class="lineno">  430</span>      <span class="keywordflow">if</span> (ni &gt; 1) cycle  </div>
<div class="line"><a id="l00431" name="l00431"></a><span class="lineno">  431</span>      <span class="keywordflow">exit</span>  </div>
<div class="line"><a id="l00432" name="l00432"></a><span class="lineno">  432</span><span class="keywordflow">   end do</span> </div>
<div class="line"><a id="l00433" name="l00433"></a><span class="lineno">  433</span>   <span class="keywordflow">return</span>  </div>
<div class="line"><a id="l00434" name="l00434"></a><span class="lineno">  434</span> </div>
<div class="line"><a id="l00435" name="l00435"></a><span class="lineno">  435</span><span class="keyword">end subroutine </span><a class="code hl_function" href="namespacemodule__ra__cam__support.html#ab971029f3ceb20868140fc1cf031221c">sortarray</a></div>
<div class="line"><a id="l00436" name="l00436"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a6ba6e133f2dd9a8b43558a6ea0d4af0f">  436</a></span><span class="keyword">subroutine </span><a class="code hl_function" href="namespacemodule__ra__cam__support.html#a6ba6e133f2dd9a8b43558a6ea0d4af0f">trcab</a>(lchnk   ,ncol    ,pcols, pverp,               &amp;</div>
<div class="line"><a id="l00437" name="l00437"></a><span class="lineno">  437</span>                 k1      ,k2      ,ucfc11  ,ucfc12  ,un2o0   , &amp;</div>
<div class="line"><a id="l00438" name="l00438"></a><span class="lineno">  438</span>                 un2o1   ,uch4    ,uco211  ,uco212  ,uco213  , &amp;</div>
<div class="line"><a id="l00439" name="l00439"></a><span class="lineno">  439</span>                 uco221  ,uco222  ,uco223  ,bn2o0   ,bn2o1   , &amp;</div>
<div class="line"><a id="l00440" name="l00440"></a><span class="lineno">  440</span>                 bch4    ,to3co2  ,pnm     ,dw      ,pnew    , &amp;</div>
<div class="line"><a id="l00441" name="l00441"></a><span class="lineno">  441</span>                 s2c     ,uptype  ,dplh2o  ,abplnk1 ,tco2    , &amp;</div>
<div class="line"><a id="l00442" name="l00442"></a><span class="lineno">  442</span>                 th2o    ,to3     ,abstrc  , &amp;</div>
<div class="line"><a id="l00443" name="l00443"></a><span class="lineno">  443</span>                 aer_trn_ttl)</div>
<div class="line"><a id="l00444" name="l00444"></a><span class="lineno">  444</span><span class="comment">!----------------------------------------------------------------------- </span></div>
<div class="line"><a id="l00445" name="l00445"></a><span class="lineno">  445</span><span class="comment">! </span></div>
<div class="line"><a id="l00446" name="l00446"></a><span class="lineno">  446</span><span class="comment">! Purpose: </span></div>
<div class="line"><a id="l00447" name="l00447"></a><span class="lineno">  447</span><span class="comment">! Calculate absorptivity for non nearest layers for CH4, N2O, CFC11 and</span></div>
<div class="line"><a id="l00448" name="l00448"></a><span class="lineno">  448</span><span class="comment">! CFC12.</span></div>
<div class="line"><a id="l00449" name="l00449"></a><span class="lineno">  449</span><span class="comment">! </span></div>
<div class="line"><a id="l00450" name="l00450"></a><span class="lineno">  450</span><span class="comment">! Method: </span></div>
<div class="line"><a id="l00451" name="l00451"></a><span class="lineno">  451</span><span class="comment">! See CCM3 description for equations.</span></div>
<div class="line"><a id="l00452" name="l00452"></a><span class="lineno">  452</span><span class="comment">! </span></div>
<div class="line"><a id="l00453" name="l00453"></a><span class="lineno">  453</span><span class="comment">! Author: J. Kiehl</span></div>
<div class="line"><a id="l00454" name="l00454"></a><span class="lineno">  454</span><span class="comment">! </span></div>
<div class="line"><a id="l00455" name="l00455"></a><span class="lineno">  455</span><span class="comment">!-----------------------------------------------------------------------</span></div>
<div class="line"><a id="l00456" name="l00456"></a><span class="lineno">  456</span><span class="comment">!  use shr_kind_mod, only: r8 =&gt; shr_kind_r8</span></div>
<div class="line"><a id="l00457" name="l00457"></a><span class="lineno">  457</span><span class="comment">!  use ppgrid</span></div>
<div class="line"><a id="l00458" name="l00458"></a><span class="lineno">  458</span><span class="comment">!  use volcrad</span></div>
<div class="line"><a id="l00459" name="l00459"></a><span class="lineno">  459</span> </div>
<div class="line"><a id="l00460" name="l00460"></a><span class="lineno">  460</span>   <span class="keywordtype">implicit none</span></div>
<div class="line"><a id="l00461" name="l00461"></a><span class="lineno">  461</span> </div>
<div class="line"><a id="l00462" name="l00462"></a><span class="lineno">  462</span><span class="comment">!------------------------------Arguments--------------------------------</span></div>
<div class="line"><a id="l00463" name="l00463"></a><span class="lineno">  463</span><span class="comment">!</span></div>
<div class="line"><a id="l00464" name="l00464"></a><span class="lineno">  464</span><span class="comment">! Input arguments</span></div>
<div class="line"><a id="l00465" name="l00465"></a><span class="lineno">  465</span><span class="comment">!</span></div>
<div class="line"><a id="l00466" name="l00466"></a><span class="lineno">  466</span>   <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: lchnk                    <span class="comment">! chunk identifier</span></div>
<div class="line"><a id="l00467" name="l00467"></a><span class="lineno">  467</span>   <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: ncol                     <span class="comment">! number of atmospheric columns</span></div>
<div class="line"><a id="l00468" name="l00468"></a><span class="lineno">  468</span>   <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: pcols, pverp</div>
<div class="line"><a id="l00469" name="l00469"></a><span class="lineno">  469</span>   <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: k1,k2                    <span class="comment">! level indices</span></div>
<div class="line"><a id="l00470" name="l00470"></a><span class="lineno">  470</span><span class="comment">!</span></div>
<div class="line"><a id="l00471" name="l00471"></a><span class="lineno">  471</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: to3co2(pcols)           <span class="comment">! pressure weighted temperature</span></div>
<div class="line"><a id="l00472" name="l00472"></a><span class="lineno">  472</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: pnm(pcols,pverp)        <span class="comment">! interface pressures</span></div>
<div class="line"><a id="l00473" name="l00473"></a><span class="lineno">  473</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: ucfc11(pcols,pverp)     <span class="comment">! CFC11 path length</span></div>
<div class="line"><a id="l00474" name="l00474"></a><span class="lineno">  474</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: ucfc12(pcols,pverp)     <span class="comment">! CFC12 path length</span></div>
<div class="line"><a id="l00475" name="l00475"></a><span class="lineno">  475</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: un2o0(pcols,pverp)      <span class="comment">! N2O path length</span></div>
<div class="line"><a id="l00476" name="l00476"></a><span class="lineno">  476</span><span class="comment">!</span></div>
<div class="line"><a id="l00477" name="l00477"></a><span class="lineno">  477</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: un2o1(pcols,pverp)      <span class="comment">! N2O path length (hot band)</span></div>
<div class="line"><a id="l00478" name="l00478"></a><span class="lineno">  478</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: uch4(pcols,pverp)       <span class="comment">! CH4 path length</span></div>
<div class="line"><a id="l00479" name="l00479"></a><span class="lineno">  479</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: uco211(pcols,pverp)     <span class="comment">! CO2 9.4 micron band path length</span></div>
<div class="line"><a id="l00480" name="l00480"></a><span class="lineno">  480</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: uco212(pcols,pverp)     <span class="comment">! CO2 9.4 micron band path length</span></div>
<div class="line"><a id="l00481" name="l00481"></a><span class="lineno">  481</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: uco213(pcols,pverp)     <span class="comment">! CO2 9.4 micron band path length</span></div>
<div class="line"><a id="l00482" name="l00482"></a><span class="lineno">  482</span><span class="comment">!</span></div>
<div class="line"><a id="l00483" name="l00483"></a><span class="lineno">  483</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: uco221(pcols,pverp)     <span class="comment">! CO2 10.4 micron band path length</span></div>
<div class="line"><a id="l00484" name="l00484"></a><span class="lineno">  484</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: uco222(pcols,pverp)     <span class="comment">! CO2 10.4 micron band path length</span></div>
<div class="line"><a id="l00485" name="l00485"></a><span class="lineno">  485</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: uco223(pcols,pverp)     <span class="comment">! CO2 10.4 micron band path length</span></div>
<div class="line"><a id="l00486" name="l00486"></a><span class="lineno">  486</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: bn2o0(pcols,pverp)      <span class="comment">! pressure factor for n2o</span></div>
<div class="line"><a id="l00487" name="l00487"></a><span class="lineno">  487</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: bn2o1(pcols,pverp)      <span class="comment">! pressure factor for n2o</span></div>
<div class="line"><a id="l00488" name="l00488"></a><span class="lineno">  488</span><span class="comment">!</span></div>
<div class="line"><a id="l00489" name="l00489"></a><span class="lineno">  489</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: bch4(pcols,pverp)       <span class="comment">! pressure factor for ch4</span></div>
<div class="line"><a id="l00490" name="l00490"></a><span class="lineno">  490</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: dw(pcols)               <span class="comment">! h2o path length</span></div>
<div class="line"><a id="l00491" name="l00491"></a><span class="lineno">  491</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: pnew(pcols)             <span class="comment">! pressure</span></div>
<div class="line"><a id="l00492" name="l00492"></a><span class="lineno">  492</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: s2c(pcols,pverp)        <span class="comment">! continuum path length</span></div>
<div class="line"><a id="l00493" name="l00493"></a><span class="lineno">  493</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: uptype(pcols,pverp)     <span class="comment">! p-type h2o path length</span></div>
<div class="line"><a id="l00494" name="l00494"></a><span class="lineno">  494</span><span class="comment">!</span></div>
<div class="line"><a id="l00495" name="l00495"></a><span class="lineno">  495</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: dplh2o(pcols)           <span class="comment">! p squared h2o path length</span></div>
<div class="line"><a id="l00496" name="l00496"></a><span class="lineno">  496</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: abplnk1(14,pcols,pverp) <span class="comment">! Planck factor</span></div>
<div class="line"><a id="l00497" name="l00497"></a><span class="lineno">  497</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: tco2(pcols)             <span class="comment">! co2 transmission factor</span></div>
<div class="line"><a id="l00498" name="l00498"></a><span class="lineno">  498</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: th2o(pcols)             <span class="comment">! h2o transmission factor</span></div>
<div class="line"><a id="l00499" name="l00499"></a><span class="lineno">  499</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: to3(pcols)              <span class="comment">! o3 transmission factor</span></div>
<div class="line"><a id="l00500" name="l00500"></a><span class="lineno">  500</span> </div>
<div class="line"><a id="l00501" name="l00501"></a><span class="lineno">  501</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: aer_trn_ttl(pcols,pverp,pverp,bnd_nbr_LW) <span class="comment">! aer trn.</span></div>
<div class="line"><a id="l00502" name="l00502"></a><span class="lineno">  502</span> </div>
<div class="line"><a id="l00503" name="l00503"></a><span class="lineno">  503</span><span class="comment">!</span></div>
<div class="line"><a id="l00504" name="l00504"></a><span class="lineno">  504</span><span class="comment">!  Output Arguments</span></div>
<div class="line"><a id="l00505" name="l00505"></a><span class="lineno">  505</span><span class="comment">!</span></div>
<div class="line"><a id="l00506" name="l00506"></a><span class="lineno">  506</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(out)</span> :: abstrc(pcols)           <span class="comment">! total trace gas absorptivity</span></div>
<div class="line"><a id="l00507" name="l00507"></a><span class="lineno">  507</span><span class="comment">!</span></div>
<div class="line"><a id="l00508" name="l00508"></a><span class="lineno">  508</span><span class="comment">!--------------------------Local Variables------------------------------</span></div>
<div class="line"><a id="l00509" name="l00509"></a><span class="lineno">  509</span><span class="comment">!</span></div>
<div class="line"><a id="l00510" name="l00510"></a><span class="lineno">  510</span>   <span class="keywordtype">integer</span>  i,l                     <span class="comment">! loop counters</span></div>
<div class="line"><a id="l00511" name="l00511"></a><span class="lineno">  511</span> </div>
<div class="line"><a id="l00512" name="l00512"></a><span class="lineno">  512</span><span class="keywordtype">   real</span>(r8) sqti(pcols)             <span class="comment">! square root of mean temp</span></div>
<div class="line"><a id="l00513" name="l00513"></a><span class="lineno">  513</span><span class="keywordtype">   real</span>(r8) du1                     <span class="comment">! cfc11 path length</span></div>
<div class="line"><a id="l00514" name="l00514"></a><span class="lineno">  514</span><span class="keywordtype">   real</span>(r8) du2                     <span class="comment">! cfc12 path length</span></div>
<div class="line"><a id="l00515" name="l00515"></a><span class="lineno">  515</span><span class="keywordtype">   real</span>(r8) acfc1                   <span class="comment">! cfc11 absorptivity 798 cm-1</span></div>
<div class="line"><a id="l00516" name="l00516"></a><span class="lineno">  516</span><span class="keywordtype">   real</span>(r8) acfc2                   <span class="comment">! cfc11 absorptivity 846 cm-1</span></div>
<div class="line"><a id="l00517" name="l00517"></a><span class="lineno">  517</span><span class="comment">!</span></div>
<div class="line"><a id="l00518" name="l00518"></a><span class="lineno">  518</span><span class="keywordtype">   real</span>(r8) acfc3                   <span class="comment">! cfc11 absorptivity 933 cm-1</span></div>
<div class="line"><a id="l00519" name="l00519"></a><span class="lineno">  519</span><span class="keywordtype">   real</span>(r8) acfc4                   <span class="comment">! cfc11 absorptivity 1085 cm-1</span></div>
<div class="line"><a id="l00520" name="l00520"></a><span class="lineno">  520</span><span class="keywordtype">   real</span>(r8) acfc5                   <span class="comment">! cfc12 absorptivity 889 cm-1</span></div>
<div class="line"><a id="l00521" name="l00521"></a><span class="lineno">  521</span><span class="keywordtype">   real</span>(r8) acfc6                   <span class="comment">! cfc12 absorptivity 923 cm-1</span></div>
<div class="line"><a id="l00522" name="l00522"></a><span class="lineno">  522</span><span class="keywordtype">   real</span>(r8) acfc7                   <span class="comment">! cfc12 absorptivity 1102 cm-1</span></div>
<div class="line"><a id="l00523" name="l00523"></a><span class="lineno">  523</span><span class="comment">!</span></div>
<div class="line"><a id="l00524" name="l00524"></a><span class="lineno">  524</span><span class="keywordtype">   real</span>(r8) acfc8                   <span class="comment">! cfc12 absorptivity 1161 cm-1</span></div>
<div class="line"><a id="l00525" name="l00525"></a><span class="lineno">  525</span><span class="keywordtype">   real</span>(r8) du01                    <span class="comment">! n2o path length</span></div>
<div class="line"><a id="l00526" name="l00526"></a><span class="lineno">  526</span><span class="keywordtype">   real</span>(r8) dbeta01                 <span class="comment">! n2o pressure factor</span></div>
<div class="line"><a id="l00527" name="l00527"></a><span class="lineno">  527</span><span class="keywordtype">   real</span>(r8) dbeta11                 <span class="comment">!         &quot;</span></div>
<div class="line"><a id="l00528" name="l00528"></a><span class="lineno">  528</span><span class="keywordtype">   real</span>(r8) an2o1                   <span class="comment">! absorptivity of 1285 cm-1 n2o band</span></div>
<div class="line"><a id="l00529" name="l00529"></a><span class="lineno">  529</span><span class="comment">!</span></div>
<div class="line"><a id="l00530" name="l00530"></a><span class="lineno">  530</span><span class="keywordtype">   real</span>(r8) du02                    <span class="comment">! n2o path length</span></div>
<div class="line"><a id="l00531" name="l00531"></a><span class="lineno">  531</span><span class="keywordtype">   real</span>(r8) dbeta02                 <span class="comment">! n2o pressure factor</span></div>
<div class="line"><a id="l00532" name="l00532"></a><span class="lineno">  532</span><span class="keywordtype">   real</span>(r8) an2o2                   <span class="comment">! absorptivity of 589 cm-1 n2o band</span></div>
<div class="line"><a id="l00533" name="l00533"></a><span class="lineno">  533</span><span class="keywordtype">   real</span>(r8) du03                    <span class="comment">! n2o path length</span></div>
<div class="line"><a id="l00534" name="l00534"></a><span class="lineno">  534</span><span class="keywordtype">   real</span>(r8) dbeta03                 <span class="comment">! n2o pressure factor</span></div>
<div class="line"><a id="l00535" name="l00535"></a><span class="lineno">  535</span><span class="comment">!</span></div>
<div class="line"><a id="l00536" name="l00536"></a><span class="lineno">  536</span><span class="keywordtype">   real</span>(r8) an2o3                   <span class="comment">! absorptivity of 1168 cm-1 n2o band</span></div>
<div class="line"><a id="l00537" name="l00537"></a><span class="lineno">  537</span><span class="keywordtype">   real</span>(r8) duch4                   <span class="comment">! ch4 path length</span></div>
<div class="line"><a id="l00538" name="l00538"></a><span class="lineno">  538</span><span class="keywordtype">   real</span>(r8) dbetac                  <span class="comment">! ch4 pressure factor</span></div>
<div class="line"><a id="l00539" name="l00539"></a><span class="lineno">  539</span><span class="keywordtype">   real</span>(r8) ach4                    <span class="comment">! absorptivity of 1306 cm-1 ch4 band</span></div>
<div class="line"><a id="l00540" name="l00540"></a><span class="lineno">  540</span><span class="keywordtype">   real</span>(r8) du11                    <span class="comment">! co2 path length</span></div>
<div class="line"><a id="l00541" name="l00541"></a><span class="lineno">  541</span><span class="comment">!</span></div>
<div class="line"><a id="l00542" name="l00542"></a><span class="lineno">  542</span><span class="keywordtype">   real</span>(r8) du12                    <span class="comment">!       &quot;</span></div>
<div class="line"><a id="l00543" name="l00543"></a><span class="lineno">  543</span><span class="keywordtype">   real</span>(r8) du13                    <span class="comment">!       &quot;</span></div>
<div class="line"><a id="l00544" name="l00544"></a><span class="lineno">  544</span><span class="keywordtype">   real</span>(r8) dbetc1                  <span class="comment">! co2 pressure factor</span></div>
<div class="line"><a id="l00545" name="l00545"></a><span class="lineno">  545</span><span class="keywordtype">   real</span>(r8) dbetc2                  <span class="comment">! co2 pressure factor</span></div>
<div class="line"><a id="l00546" name="l00546"></a><span class="lineno">  546</span><span class="keywordtype">   real</span>(r8) aco21                   <span class="comment">! absorptivity of 1064 cm-1 band</span></div>
<div class="line"><a id="l00547" name="l00547"></a><span class="lineno">  547</span><span class="comment">!</span></div>
<div class="line"><a id="l00548" name="l00548"></a><span class="lineno">  548</span><span class="keywordtype">   real</span>(r8) du21                    <span class="comment">! co2 path length</span></div>
<div class="line"><a id="l00549" name="l00549"></a><span class="lineno">  549</span><span class="keywordtype">   real</span>(r8) du22                    <span class="comment">!       &quot;</span></div>
<div class="line"><a id="l00550" name="l00550"></a><span class="lineno">  550</span><span class="keywordtype">   real</span>(r8) du23                    <span class="comment">!       &quot;</span></div>
<div class="line"><a id="l00551" name="l00551"></a><span class="lineno">  551</span><span class="keywordtype">   real</span>(r8) aco22                   <span class="comment">! absorptivity of 961 cm-1 band</span></div>
<div class="line"><a id="l00552" name="l00552"></a><span class="lineno">  552</span><span class="keywordtype">   real</span>(r8) tt(pcols)               <span class="comment">! temp. factor for h2o overlap factor</span></div>
<div class="line"><a id="l00553" name="l00553"></a><span class="lineno">  553</span><span class="comment">!</span></div>
<div class="line"><a id="l00554" name="l00554"></a><span class="lineno">  554</span><span class="keywordtype">   real</span>(r8) psi1                    <span class="comment">!                 &quot;</span></div>
<div class="line"><a id="l00555" name="l00555"></a><span class="lineno">  555</span><span class="keywordtype">   real</span>(r8) phi1                    <span class="comment">!                 &quot;</span></div>
<div class="line"><a id="l00556" name="l00556"></a><span class="lineno">  556</span><span class="keywordtype">   real</span>(r8) p1                      <span class="comment">! h2o overlap factor</span></div>
<div class="line"><a id="l00557" name="l00557"></a><span class="lineno">  557</span><span class="keywordtype">   real</span>(r8) w1                      <span class="comment">!        &quot;</span></div>
<div class="line"><a id="l00558" name="l00558"></a><span class="lineno">  558</span><span class="keywordtype">   real</span>(r8) ds2c(pcols)             <span class="comment">! continuum path length</span></div>
<div class="line"><a id="l00559" name="l00559"></a><span class="lineno">  559</span><span class="comment">!</span></div>
<div class="line"><a id="l00560" name="l00560"></a><span class="lineno">  560</span><span class="keywordtype">   real</span>(r8) duptyp(pcols)           <span class="comment">! p-type path length</span></div>
<div class="line"><a id="l00561" name="l00561"></a><span class="lineno">  561</span><span class="keywordtype">   real</span>(r8) tw(pcols,6)             <span class="comment">! h2o transmission factor</span></div>
<div class="line"><a id="l00562" name="l00562"></a><span class="lineno">  562</span><span class="keywordtype">   real</span>(r8) g1(6)                   <span class="comment">!         &quot;</span></div>
<div class="line"><a id="l00563" name="l00563"></a><span class="lineno">  563</span><span class="keywordtype">   real</span>(r8) g2(6)                   <span class="comment">!         &quot;</span></div>
<div class="line"><a id="l00564" name="l00564"></a><span class="lineno">  564</span><span class="keywordtype">   real</span>(r8) g3(6)                   <span class="comment">!         &quot;</span></div>
<div class="line"><a id="l00565" name="l00565"></a><span class="lineno">  565</span><span class="comment">!</span></div>
<div class="line"><a id="l00566" name="l00566"></a><span class="lineno">  566</span><span class="keywordtype">   real</span>(r8) g4(6)                   <span class="comment">!         &quot;</span></div>
<div class="line"><a id="l00567" name="l00567"></a><span class="lineno">  567</span><span class="keywordtype">   real</span>(r8) ab(6)                   <span class="comment">! h2o temp. factor</span></div>
<div class="line"><a id="l00568" name="l00568"></a><span class="lineno">  568</span><span class="keywordtype">   real</span>(r8) bb(6)                   <span class="comment">!         &quot;</span></div>
<div class="line"><a id="l00569" name="l00569"></a><span class="lineno">  569</span><span class="keywordtype">   real</span>(r8) abp(6)                  <span class="comment">!         &quot;</span></div>
<div class="line"><a id="l00570" name="l00570"></a><span class="lineno">  570</span><span class="keywordtype">   real</span>(r8) bbp(6)                  <span class="comment">!         &quot;</span></div>
<div class="line"><a id="l00571" name="l00571"></a><span class="lineno">  571</span><span class="comment">!</span></div>
<div class="line"><a id="l00572" name="l00572"></a><span class="lineno">  572</span><span class="keywordtype">   real</span>(r8) tcfc3                   <span class="comment">! transmission for cfc11 band</span></div>
<div class="line"><a id="l00573" name="l00573"></a><span class="lineno">  573</span><span class="keywordtype">   real</span>(r8) tcfc4                   <span class="comment">! transmission for cfc11 band</span></div>
<div class="line"><a id="l00574" name="l00574"></a><span class="lineno">  574</span><span class="keywordtype">   real</span>(r8) tcfc6                   <span class="comment">! transmission for cfc12 band</span></div>
<div class="line"><a id="l00575" name="l00575"></a><span class="lineno">  575</span><span class="keywordtype">   real</span>(r8) tcfc7                   <span class="comment">! transmission for cfc12 band</span></div>
<div class="line"><a id="l00576" name="l00576"></a><span class="lineno">  576</span><span class="keywordtype">   real</span>(r8) tcfc8                   <span class="comment">! transmission for cfc12 band</span></div>
<div class="line"><a id="l00577" name="l00577"></a><span class="lineno">  577</span><span class="comment">!</span></div>
<div class="line"><a id="l00578" name="l00578"></a><span class="lineno">  578</span><span class="keywordtype">   real</span>(r8) tlw                     <span class="comment">! h2o transmission</span></div>
<div class="line"><a id="l00579" name="l00579"></a><span class="lineno">  579</span><span class="keywordtype">   real</span>(r8) tch4                    <span class="comment">! ch4 transmission</span></div>
<div class="line"><a id="l00580" name="l00580"></a><span class="lineno">  580</span><span class="comment">!</span></div>
<div class="line"><a id="l00581" name="l00581"></a><span class="lineno">  581</span><span class="comment">!--------------------------Data Statements------------------------------</span></div>
<div class="line"><a id="l00582" name="l00582"></a><span class="lineno">  582</span><span class="comment">!</span></div>
<div class="line"><a id="l00583" name="l00583"></a><span class="lineno">  583</span>   <span class="keyword">data</span> g1 /0.0468556,0.0397454,0.0407664,0.0304380,0.0540398,0.0321962/</div>
<div class="line"><a id="l00584" name="l00584"></a><span class="lineno">  584</span>   <span class="keyword">data</span> g2 /14.4832,4.30242,5.23523,3.25342,0.698935,16.5599/</div>
<div class="line"><a id="l00585" name="l00585"></a><span class="lineno">  585</span>   <span class="keyword">data</span> g3 /26.1898,18.4476,15.3633,12.1927,9.14992,8.07092/</div>
<div class="line"><a id="l00586" name="l00586"></a><span class="lineno">  586</span>   <span class="keyword">data</span> g4 /0.0261782,0.0369516,0.0307266,0.0243854,0.0182932,0.0161418/</div>
<div class="line"><a id="l00587" name="l00587"></a><span class="lineno">  587</span>   <span class="keyword">data</span> ab /3.0857e-2,2.3524e-2,1.7310e-2,2.6661e-2,2.8074e-2,2.2915e-2/</div>
<div class="line"><a id="l00588" name="l00588"></a><span class="lineno">  588</span>   <span class="keyword">data</span> bb /-1.3512e-4,-6.8320e-5,-3.2609e-5,-1.0228e-5,-9.5743e-5,-1.0304e-4/</div>
<div class="line"><a id="l00589" name="l00589"></a><span class="lineno">  589</span>   <span class="keyword">data</span> abp/2.9129e-2,2.4101e-2,1.9821e-2,2.6904e-2,2.9458e-2,1.9892e-2/</div>
<div class="line"><a id="l00590" name="l00590"></a><span class="lineno">  590</span>   <span class="keyword">data</span> bbp/-1.3139e-4,-5.5688e-5,-4.6380e-5,-8.0362e-5,-1.0115e-4,-8.8061e-5/</div>
<div class="line"><a id="l00591" name="l00591"></a><span class="lineno">  591</span><span class="comment">!</span></div>
<div class="line"><a id="l00592" name="l00592"></a><span class="lineno">  592</span><span class="comment">!--------------------------Statement Functions--------------------------</span></div>
<div class="line"><a id="l00593" name="l00593"></a><span class="lineno">  593</span><span class="comment">!</span></div>
<div class="line"><a id="l00594" name="l00594"></a><span class="lineno">  594</span><span class="keywordtype">   real</span>(r8) func, u, b</div>
<div class="line"><a id="l00595" name="l00595"></a><span class="lineno">  595</span>   func(u,b) = u/sqrt(4.0 + u*(1.0 + 1.0 / b))</div>
<div class="line"><a id="l00596" name="l00596"></a><span class="lineno">  596</span><span class="comment">!</span></div>
<div class="line"><a id="l00597" name="l00597"></a><span class="lineno">  597</span><span class="comment">!------------------------------------------------------------------------</span></div>
<div class="line"><a id="l00598" name="l00598"></a><span class="lineno">  598</span><span class="comment">!</span></div>
<div class="line"><a id="l00599" name="l00599"></a><span class="lineno">  599</span>   <span class="keywordflow">do</span> i = 1,ncol</div>
<div class="line"><a id="l00600" name="l00600"></a><span class="lineno">  600</span>      sqti(i) = sqrt(to3co2(i))</div>
<div class="line"><a id="l00601" name="l00601"></a><span class="lineno">  601</span><span class="comment">!</span></div>
<div class="line"><a id="l00602" name="l00602"></a><span class="lineno">  602</span><span class="comment">! h2o transmission</span></div>
<div class="line"><a id="l00603" name="l00603"></a><span class="lineno">  603</span><span class="comment">!</span></div>
<div class="line"><a id="l00604" name="l00604"></a><span class="lineno">  604</span>      tt(i) = abs(to3co2(i) - 250.0)</div>
<div class="line"><a id="l00605" name="l00605"></a><span class="lineno">  605</span>      ds2c(i) = abs(s2c(i,k1) - s2c(i,k2))</div>
<div class="line"><a id="l00606" name="l00606"></a><span class="lineno">  606</span>      duptyp(i) = abs(uptype(i,k1) - uptype(i,k2))</div>
<div class="line"><a id="l00607" name="l00607"></a><span class="lineno">  607</span><span class="keywordflow">   end do</span></div>
<div class="line"><a id="l00608" name="l00608"></a><span class="lineno">  608</span><span class="comment">!</span></div>
<div class="line"><a id="l00609" name="l00609"></a><span class="lineno">  609</span>   <span class="keywordflow">do</span> l = 1,6</div>
<div class="line"><a id="l00610" name="l00610"></a><span class="lineno">  610</span>      <span class="keywordflow">do</span> i = 1,ncol</div>
<div class="line"><a id="l00611" name="l00611"></a><span class="lineno">  611</span>         psi1 = exp(abp(l)*tt(i) + bbp(l)*tt(i)*tt(i))</div>
<div class="line"><a id="l00612" name="l00612"></a><span class="lineno">  612</span>         phi1 = exp(ab(l)*tt(i) + bb(l)*tt(i)*tt(i))</div>
<div class="line"><a id="l00613" name="l00613"></a><span class="lineno">  613</span>         p1 = pnew(i)*(psi1/phi1)/<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#aedb55b03e1395012ec29e1914a2df7cc">sslp</a></div>
<div class="line"><a id="l00614" name="l00614"></a><span class="lineno">  614</span>         w1 = dw(i)*phi1</div>
<div class="line"><a id="l00615" name="l00615"></a><span class="lineno">  615</span>         tw(i,l) = exp(-g1(l)*p1*(sqrt(1.0 + g2(l)*(w1/p1)) - 1.0) - &amp;</div>
<div class="line"><a id="l00616" name="l00616"></a><span class="lineno">  616</span>                   g3(l)*ds2c(i)-g4(l)*duptyp(i))</div>
<div class="line"><a id="l00617" name="l00617"></a><span class="lineno">  617</span><span class="keywordflow">      end do</span></div>
<div class="line"><a id="l00618" name="l00618"></a><span class="lineno">  618</span><span class="keywordflow">   end do</span></div>
<div class="line"><a id="l00619" name="l00619"></a><span class="lineno">  619</span><span class="comment">!</span></div>
<div class="line"><a id="l00620" name="l00620"></a><span class="lineno">  620</span>   <span class="keywordflow">do</span> i=1,ncol</div>
<div class="line"><a id="l00621" name="l00621"></a><span class="lineno">  621</span>      tw(i,1)=tw(i,1)*(0.7*aer_trn_ttl(i,k1,k2,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ae90583401bc762ffcf004ff27792f3ef">idx_lw_0650_0800</a>)+&amp;<span class="comment">! l=1: 0750--0820 cm-1</span></div>
<div class="line"><a id="l00622" name="l00622"></a><span class="lineno">  622</span>                       0.3*aer_trn_ttl(i,k1,k2,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a3641bbffc5b9d01322506476442a962a">idx_lw_0800_1000</a>)) </div>
<div class="line"><a id="l00623" name="l00623"></a><span class="lineno">  623</span>      tw(i,2)=tw(i,2)*aer_trn_ttl(i,k1,k2,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a3641bbffc5b9d01322506476442a962a">idx_lw_0800_1000</a>) <span class="comment">! l=2: 0820--0880 cm-1</span></div>
<div class="line"><a id="l00624" name="l00624"></a><span class="lineno">  624</span>      tw(i,3)=tw(i,3)*aer_trn_ttl(i,k1,k2,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a3641bbffc5b9d01322506476442a962a">idx_lw_0800_1000</a>) <span class="comment">! l=3: 0880--0900 cm-1</span></div>
<div class="line"><a id="l00625" name="l00625"></a><span class="lineno">  625</span>      tw(i,4)=tw(i,4)*aer_trn_ttl(i,k1,k2,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a3641bbffc5b9d01322506476442a962a">idx_lw_0800_1000</a>) <span class="comment">! l=4: 0900--1000 cm-1</span></div>
<div class="line"><a id="l00626" name="l00626"></a><span class="lineno">  626</span>      tw(i,5)=tw(i,5)*aer_trn_ttl(i,k1,k2,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a619b4abbc0ae813bf2c8709cef491d8e">idx_lw_1000_1200</a>) <span class="comment">! l=5: 1000--1120 cm-1</span></div>
<div class="line"><a id="l00627" name="l00627"></a><span class="lineno">  627</span>      tw(i,6)=tw(i,6)*aer_trn_ttl(i,k1,k2,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a619b4abbc0ae813bf2c8709cef491d8e">idx_lw_1000_1200</a>) <span class="comment">! l=6: 1120--1170 cm-1</span></div>
<div class="line"><a id="l00628" name="l00628"></a><span class="lineno">  628</span><span class="keywordflow">   end do</span>                    <span class="comment">! end loop over lon</span></div>
<div class="line"><a id="l00629" name="l00629"></a><span class="lineno">  629</span>   <span class="keywordflow">do</span> i = 1,ncol</div>
<div class="line"><a id="l00630" name="l00630"></a><span class="lineno">  630</span>      du1 = abs(ucfc11(i,k1) - ucfc11(i,k2))</div>
<div class="line"><a id="l00631" name="l00631"></a><span class="lineno">  631</span>      du2 = abs(ucfc12(i,k1) - ucfc12(i,k2))</div>
<div class="line"><a id="l00632" name="l00632"></a><span class="lineno">  632</span><span class="comment">!</span></div>
<div class="line"><a id="l00633" name="l00633"></a><span class="lineno">  633</span><span class="comment">! cfc transmissions</span></div>
<div class="line"><a id="l00634" name="l00634"></a><span class="lineno">  634</span><span class="comment">!</span></div>
<div class="line"><a id="l00635" name="l00635"></a><span class="lineno">  635</span>      tcfc3 = exp(-175.005*du1)</div>
<div class="line"><a id="l00636" name="l00636"></a><span class="lineno">  636</span>      tcfc4 = exp(-1202.18*du1)</div>
<div class="line"><a id="l00637" name="l00637"></a><span class="lineno">  637</span>      tcfc6 = exp(-5786.73*du2)</div>
<div class="line"><a id="l00638" name="l00638"></a><span class="lineno">  638</span>      tcfc7 = exp(-2873.51*du2)</div>
<div class="line"><a id="l00639" name="l00639"></a><span class="lineno">  639</span>      tcfc8 = exp(-2085.59*du2)</div>
<div class="line"><a id="l00640" name="l00640"></a><span class="lineno">  640</span><span class="comment">!</span></div>
<div class="line"><a id="l00641" name="l00641"></a><span class="lineno">  641</span><span class="comment">! Absorptivity for CFC11 bands</span></div>
<div class="line"><a id="l00642" name="l00642"></a><span class="lineno">  642</span><span class="comment">!</span></div>
<div class="line"><a id="l00643" name="l00643"></a><span class="lineno">  643</span>      acfc1 =  50.0*(1.0 - exp(-54.09*du1))*tw(i,1)*abplnk1(7,i,k2)</div>
<div class="line"><a id="l00644" name="l00644"></a><span class="lineno">  644</span>      acfc2 =  60.0*(1.0 - exp(-5130.03*du1))*tw(i,2)*abplnk1(8,i,k2)</div>
<div class="line"><a id="l00645" name="l00645"></a><span class="lineno">  645</span>      acfc3 =  60.0*(1.0 - tcfc3)*tw(i,4)*tcfc6*abplnk1(9,i,k2)</div>
<div class="line"><a id="l00646" name="l00646"></a><span class="lineno">  646</span>      acfc4 = 100.0*(1.0 - tcfc4)*tw(i,5)*abplnk1(10,i,k2)</div>
<div class="line"><a id="l00647" name="l00647"></a><span class="lineno">  647</span><span class="comment">!</span></div>
<div class="line"><a id="l00648" name="l00648"></a><span class="lineno">  648</span><span class="comment">! Absorptivity for CFC12 bands</span></div>
<div class="line"><a id="l00649" name="l00649"></a><span class="lineno">  649</span><span class="comment">!</span></div>
<div class="line"><a id="l00650" name="l00650"></a><span class="lineno">  650</span>      acfc5 = 45.0*(1.0 - exp(-1272.35*du2))*tw(i,3)*abplnk1(11,i,k2)</div>
<div class="line"><a id="l00651" name="l00651"></a><span class="lineno">  651</span>      acfc6 = 50.0*(1.0 - tcfc6)* tw(i,4) * abplnk1(12,i,k2)</div>
<div class="line"><a id="l00652" name="l00652"></a><span class="lineno">  652</span>      acfc7 = 80.0*(1.0 - tcfc7)* tw(i,5) * tcfc4*abplnk1(13,i,k2)</div>
<div class="line"><a id="l00653" name="l00653"></a><span class="lineno">  653</span>      acfc8 = 70.0*(1.0 - tcfc8)* tw(i,6) * abplnk1(14,i,k2)</div>
<div class="line"><a id="l00654" name="l00654"></a><span class="lineno">  654</span><span class="comment">!</span></div>
<div class="line"><a id="l00655" name="l00655"></a><span class="lineno">  655</span><span class="comment">! Emissivity for CH4 band 1306 cm-1</span></div>
<div class="line"><a id="l00656" name="l00656"></a><span class="lineno">  656</span><span class="comment">!</span></div>
<div class="line"><a id="l00657" name="l00657"></a><span class="lineno">  657</span>      tlw = exp(-1.0*sqrt(dplh2o(i)))</div>
<div class="line"><a id="l00658" name="l00658"></a><span class="lineno">  658</span>      tlw=tlw*aer_trn_ttl(i,k1,k2,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ab20c3561d003d8e16f6984f564247561">idx_lw_1200_2000</a>)</div>
<div class="line"><a id="l00659" name="l00659"></a><span class="lineno">  659</span>      duch4 = abs(uch4(i,k1) - uch4(i,k2))</div>
<div class="line"><a id="l00660" name="l00660"></a><span class="lineno">  660</span>      dbetac = abs(bch4(i,k1) - bch4(i,k2))/duch4</div>
<div class="line"><a id="l00661" name="l00661"></a><span class="lineno">  661</span>      ach4 = 6.00444*sqti(i)*log(1.0 + func(duch4,dbetac))*tlw*abplnk1(3,i,k2)</div>
<div class="line"><a id="l00662" name="l00662"></a><span class="lineno">  662</span>      tch4 = 1.0/(1.0 + 0.02*func(duch4,dbetac))</div>
<div class="line"><a id="l00663" name="l00663"></a><span class="lineno">  663</span><span class="comment">!</span></div>
<div class="line"><a id="l00664" name="l00664"></a><span class="lineno">  664</span><span class="comment">! Absorptivity for N2O bands</span></div>
<div class="line"><a id="l00665" name="l00665"></a><span class="lineno">  665</span><span class="comment">!</span></div>
<div class="line"><a id="l00666" name="l00666"></a><span class="lineno">  666</span>      du01 = abs(un2o0(i,k1) - un2o0(i,k2))</div>
<div class="line"><a id="l00667" name="l00667"></a><span class="lineno">  667</span>      du11 = abs(un2o1(i,k1) - un2o1(i,k2))</div>
<div class="line"><a id="l00668" name="l00668"></a><span class="lineno">  668</span>      dbeta01 = abs(bn2o0(i,k1) - bn2o0(i,k2))/du01</div>
<div class="line"><a id="l00669" name="l00669"></a><span class="lineno">  669</span>      dbeta11 = abs(bn2o1(i,k1) - bn2o1(i,k2))/du11</div>
<div class="line"><a id="l00670" name="l00670"></a><span class="lineno">  670</span><span class="comment">!</span></div>
<div class="line"><a id="l00671" name="l00671"></a><span class="lineno">  671</span><span class="comment">! 1285 cm-1 band</span></div>
<div class="line"><a id="l00672" name="l00672"></a><span class="lineno">  672</span><span class="comment">!</span></div>
<div class="line"><a id="l00673" name="l00673"></a><span class="lineno">  673</span>      an2o1 = 2.35558*sqti(i)*log(1.0 + func(du01,dbeta01) &amp;</div>
<div class="line"><a id="l00674" name="l00674"></a><span class="lineno">  674</span>              + func(du11,dbeta11))*tlw*tch4*abplnk1(4,i,k2)</div>
<div class="line"><a id="l00675" name="l00675"></a><span class="lineno">  675</span>      du02 = 0.100090*du01</div>
<div class="line"><a id="l00676" name="l00676"></a><span class="lineno">  676</span>      du12 = 0.0992746*du11</div>
<div class="line"><a id="l00677" name="l00677"></a><span class="lineno">  677</span>      dbeta02 = 0.964282*dbeta01</div>
<div class="line"><a id="l00678" name="l00678"></a><span class="lineno">  678</span><span class="comment">!</span></div>
<div class="line"><a id="l00679" name="l00679"></a><span class="lineno">  679</span><span class="comment">! 589 cm-1 band</span></div>
<div class="line"><a id="l00680" name="l00680"></a><span class="lineno">  680</span><span class="comment">!</span></div>
<div class="line"><a id="l00681" name="l00681"></a><span class="lineno">  681</span>      an2o2 = 2.65581*sqti(i)*log(1.0 + func(du02,dbeta02) + &amp;</div>
<div class="line"><a id="l00682" name="l00682"></a><span class="lineno">  682</span>              func(du12,dbeta02))*th2o(i)*tco2(i)*abplnk1(5,i,k2)</div>
<div class="line"><a id="l00683" name="l00683"></a><span class="lineno">  683</span>      du03 = 0.0333767*du01</div>
<div class="line"><a id="l00684" name="l00684"></a><span class="lineno">  684</span>      dbeta03 = 0.982143*dbeta01</div>
<div class="line"><a id="l00685" name="l00685"></a><span class="lineno">  685</span><span class="comment">!</span></div>
<div class="line"><a id="l00686" name="l00686"></a><span class="lineno">  686</span><span class="comment">! 1168 cm-1 band</span></div>
<div class="line"><a id="l00687" name="l00687"></a><span class="lineno">  687</span><span class="comment">!</span></div>
<div class="line"><a id="l00688" name="l00688"></a><span class="lineno">  688</span>      an2o3 = 2.54034*sqti(i)*log(1.0 + func(du03,dbeta03))* &amp;</div>
<div class="line"><a id="l00689" name="l00689"></a><span class="lineno">  689</span>              tw(i,6)*tcfc8*abplnk1(6,i,k2)</div>
<div class="line"><a id="l00690" name="l00690"></a><span class="lineno">  690</span><span class="comment">!</span></div>
<div class="line"><a id="l00691" name="l00691"></a><span class="lineno">  691</span><span class="comment">! Emissivity for 1064 cm-1 band of CO2</span></div>
<div class="line"><a id="l00692" name="l00692"></a><span class="lineno">  692</span><span class="comment">!</span></div>
<div class="line"><a id="l00693" name="l00693"></a><span class="lineno">  693</span>      du11 = abs(uco211(i,k1) - uco211(i,k2))</div>
<div class="line"><a id="l00694" name="l00694"></a><span class="lineno">  694</span>      du12 = abs(uco212(i,k1) - uco212(i,k2))</div>
<div class="line"><a id="l00695" name="l00695"></a><span class="lineno">  695</span>      du13 = abs(uco213(i,k1) - uco213(i,k2))</div>
<div class="line"><a id="l00696" name="l00696"></a><span class="lineno">  696</span>      dbetc1 = 2.97558*abs(pnm(i,k1) + pnm(i,k2))/(2.0*<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#aedb55b03e1395012ec29e1914a2df7cc">sslp</a>*sqti(i))</div>
<div class="line"><a id="l00697" name="l00697"></a><span class="lineno">  697</span>      dbetc2 = 2.0*dbetc1</div>
<div class="line"><a id="l00698" name="l00698"></a><span class="lineno">  698</span>      aco21 = 3.7571*sqti(i)*log(1.0 + func(du11,dbetc1) &amp;</div>
<div class="line"><a id="l00699" name="l00699"></a><span class="lineno">  699</span>              + func(du12,dbetc2) + func(du13,dbetc2)) &amp;</div>
<div class="line"><a id="l00700" name="l00700"></a><span class="lineno">  700</span>              *to3(i)*tw(i,5)*tcfc4*tcfc7*abplnk1(2,i,k2)</div>
<div class="line"><a id="l00701" name="l00701"></a><span class="lineno">  701</span><span class="comment">!</span></div>
<div class="line"><a id="l00702" name="l00702"></a><span class="lineno">  702</span><span class="comment">! Emissivity for 961 cm-1 band</span></div>
<div class="line"><a id="l00703" name="l00703"></a><span class="lineno">  703</span><span class="comment">!</span></div>
<div class="line"><a id="l00704" name="l00704"></a><span class="lineno">  704</span>      du21 = abs(uco221(i,k1) - uco221(i,k2))</div>
<div class="line"><a id="l00705" name="l00705"></a><span class="lineno">  705</span>      du22 = abs(uco222(i,k1) - uco222(i,k2))</div>
<div class="line"><a id="l00706" name="l00706"></a><span class="lineno">  706</span>      du23 = abs(uco223(i,k1) - uco223(i,k2))</div>
<div class="line"><a id="l00707" name="l00707"></a><span class="lineno">  707</span>      aco22 = 3.8443*sqti(i)*log(1.0 + func(du21,dbetc1) &amp;</div>
<div class="line"><a id="l00708" name="l00708"></a><span class="lineno">  708</span>              + func(du22,dbetc1) + func(du23,dbetc2)) &amp;</div>
<div class="line"><a id="l00709" name="l00709"></a><span class="lineno">  709</span>              *tw(i,4)*tcfc3*tcfc6*abplnk1(1,i,k2)</div>
<div class="line"><a id="l00710" name="l00710"></a><span class="lineno">  710</span><span class="comment">!</span></div>
<div class="line"><a id="l00711" name="l00711"></a><span class="lineno">  711</span><span class="comment">! total trace gas absorptivity</span></div>
<div class="line"><a id="l00712" name="l00712"></a><span class="lineno">  712</span><span class="comment">!</span></div>
<div class="line"><a id="l00713" name="l00713"></a><span class="lineno">  713</span>      abstrc(i) = acfc1 + acfc2 + acfc3 + acfc4 + acfc5 + acfc6 + &amp;</div>
<div class="line"><a id="l00714" name="l00714"></a><span class="lineno">  714</span>                  acfc7 + acfc8 + an2o1 + an2o2 + an2o3 + ach4 + &amp;</div>
<div class="line"><a id="l00715" name="l00715"></a><span class="lineno">  715</span>                  aco21 + aco22</div>
<div class="line"><a id="l00716" name="l00716"></a><span class="lineno">  716</span><span class="keywordflow">   end do</span></div>
<div class="line"><a id="l00717" name="l00717"></a><span class="lineno">  717</span><span class="comment">!</span></div>
<div class="line"><a id="l00718" name="l00718"></a><span class="lineno">  718</span>   <span class="keywordflow">return</span></div>
<div class="line"><a id="l00719" name="l00719"></a><span class="lineno">  719</span><span class="comment">!</span></div>
<div class="line"><a id="l00720" name="l00720"></a><span class="lineno">  720</span><span class="keyword">end subroutine </span><a class="code hl_function" href="namespacemodule__ra__cam__support.html#a6ba6e133f2dd9a8b43558a6ea0d4af0f">trcab</a></div>
<div class="line"><a id="l00721" name="l00721"></a><span class="lineno">  721</span> </div>
<div class="line"><a id="l00722" name="l00722"></a><span class="lineno">  722</span> </div>
<div class="line"><a id="l00723" name="l00723"></a><span class="lineno">  723</span> </div>
<div class="line"><a id="l00724" name="l00724"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a6b84aa6684de2807653f5f8cf8784cd6">  724</a></span><span class="keyword">subroutine </span><a class="code hl_function" href="namespacemodule__ra__cam__support.html#a6b84aa6684de2807653f5f8cf8784cd6">trcabn</a>(lchnk   ,ncol    ,pcols, pverp,               &amp;</div>
<div class="line"><a id="l00725" name="l00725"></a><span class="lineno">  725</span>                  k2      ,kn      ,ucfc11  ,ucfc12  ,un2o0   , &amp;</div>
<div class="line"><a id="l00726" name="l00726"></a><span class="lineno">  726</span>                  un2o1   ,uch4    ,uco211  ,uco212  ,uco213  , &amp;</div>
<div class="line"><a id="l00727" name="l00727"></a><span class="lineno">  727</span>                  uco221  ,uco222  ,uco223  ,tbar    ,bplnk   , &amp;</div>
<div class="line"><a id="l00728" name="l00728"></a><span class="lineno">  728</span>                  winpl   ,pinpl   ,tco2    ,th2o    ,to3     , &amp;</div>
<div class="line"><a id="l00729" name="l00729"></a><span class="lineno">  729</span>                  uptype  ,dw      ,s2c     ,up2     ,pnew    , &amp;</div>
<div class="line"><a id="l00730" name="l00730"></a><span class="lineno">  730</span>                  abstrc  ,uinpl   , &amp;</div>
<div class="line"><a id="l00731" name="l00731"></a><span class="lineno">  731</span>                  aer_trn_ngh)</div>
<div class="line"><a id="l00732" name="l00732"></a><span class="lineno">  732</span><span class="comment">!----------------------------------------------------------------------- </span></div>
<div class="line"><a id="l00733" name="l00733"></a><span class="lineno">  733</span><span class="comment">! </span></div>
<div class="line"><a id="l00734" name="l00734"></a><span class="lineno">  734</span><span class="comment">! Purpose: </span></div>
<div class="line"><a id="l00735" name="l00735"></a><span class="lineno">  735</span><span class="comment">! Calculate nearest layer absorptivity due to CH4, N2O, CFC11 and CFC12</span></div>
<div class="line"><a id="l00736" name="l00736"></a><span class="lineno">  736</span><span class="comment">! </span></div>
<div class="line"><a id="l00737" name="l00737"></a><span class="lineno">  737</span><span class="comment">! Method: </span></div>
<div class="line"><a id="l00738" name="l00738"></a><span class="lineno">  738</span><span class="comment">! Equations in CCM3 description</span></div>
<div class="line"><a id="l00739" name="l00739"></a><span class="lineno">  739</span><span class="comment">! </span></div>
<div class="line"><a id="l00740" name="l00740"></a><span class="lineno">  740</span><span class="comment">! Author: J. Kiehl</span></div>
<div class="line"><a id="l00741" name="l00741"></a><span class="lineno">  741</span><span class="comment">! </span></div>
<div class="line"><a id="l00742" name="l00742"></a><span class="lineno">  742</span><span class="comment">!-----------------------------------------------------------------------</span></div>
<div class="line"><a id="l00743" name="l00743"></a><span class="lineno">  743</span><span class="comment">!</span></div>
<div class="line"><a id="l00744" name="l00744"></a><span class="lineno">  744</span><span class="comment">!  use shr_kind_mod, only: r8 =&gt; shr_kind_r8</span></div>
<div class="line"><a id="l00745" name="l00745"></a><span class="lineno">  745</span><span class="comment">!  use ppgrid</span></div>
<div class="line"><a id="l00746" name="l00746"></a><span class="lineno">  746</span><span class="comment">!  use volcrad</span></div>
<div class="line"><a id="l00747" name="l00747"></a><span class="lineno">  747</span> </div>
<div class="line"><a id="l00748" name="l00748"></a><span class="lineno">  748</span>   <span class="keywordtype">implicit none</span></div>
<div class="line"><a id="l00749" name="l00749"></a><span class="lineno">  749</span> </div>
<div class="line"><a id="l00750" name="l00750"></a><span class="lineno">  750</span><span class="comment">!------------------------------Arguments--------------------------------</span></div>
<div class="line"><a id="l00751" name="l00751"></a><span class="lineno">  751</span><span class="comment">!</span></div>
<div class="line"><a id="l00752" name="l00752"></a><span class="lineno">  752</span><span class="comment">! Input arguments</span></div>
<div class="line"><a id="l00753" name="l00753"></a><span class="lineno">  753</span><span class="comment">!</span></div>
<div class="line"><a id="l00754" name="l00754"></a><span class="lineno">  754</span>   <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: lchnk                 <span class="comment">! chunk identifier</span></div>
<div class="line"><a id="l00755" name="l00755"></a><span class="lineno">  755</span>   <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: ncol                  <span class="comment">! number of atmospheric columns</span></div>
<div class="line"><a id="l00756" name="l00756"></a><span class="lineno">  756</span>   <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: pcols, pverp</div>
<div class="line"><a id="l00757" name="l00757"></a><span class="lineno">  757</span>   <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: k2                    <span class="comment">! level index</span></div>
<div class="line"><a id="l00758" name="l00758"></a><span class="lineno">  758</span>   <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: kn                    <span class="comment">! level index</span></div>
<div class="line"><a id="l00759" name="l00759"></a><span class="lineno">  759</span><span class="comment">!</span></div>
<div class="line"><a id="l00760" name="l00760"></a><span class="lineno">  760</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: tbar(pcols,4)        <span class="comment">! pressure weighted temperature</span></div>
<div class="line"><a id="l00761" name="l00761"></a><span class="lineno">  761</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: ucfc11(pcols,pverp)  <span class="comment">! CFC11 path length</span></div>
<div class="line"><a id="l00762" name="l00762"></a><span class="lineno">  762</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: ucfc12(pcols,pverp)  <span class="comment">! CFC12 path length</span></div>
<div class="line"><a id="l00763" name="l00763"></a><span class="lineno">  763</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: un2o0(pcols,pverp)   <span class="comment">! N2O path length</span></div>
<div class="line"><a id="l00764" name="l00764"></a><span class="lineno">  764</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: un2o1(pcols,pverp)   <span class="comment">! N2O path length (hot band)</span></div>
<div class="line"><a id="l00765" name="l00765"></a><span class="lineno">  765</span><span class="comment">!</span></div>
<div class="line"><a id="l00766" name="l00766"></a><span class="lineno">  766</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: uch4(pcols,pverp)    <span class="comment">! CH4 path length</span></div>
<div class="line"><a id="l00767" name="l00767"></a><span class="lineno">  767</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: uco211(pcols,pverp)  <span class="comment">! CO2 9.4 micron band path length</span></div>
<div class="line"><a id="l00768" name="l00768"></a><span class="lineno">  768</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: uco212(pcols,pverp)  <span class="comment">! CO2 9.4 micron band path length</span></div>
<div class="line"><a id="l00769" name="l00769"></a><span class="lineno">  769</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: uco213(pcols,pverp)  <span class="comment">! CO2 9.4 micron band path length</span></div>
<div class="line"><a id="l00770" name="l00770"></a><span class="lineno">  770</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: uco221(pcols,pverp)  <span class="comment">! CO2 10.4 micron band path length</span></div>
<div class="line"><a id="l00771" name="l00771"></a><span class="lineno">  771</span><span class="comment">!</span></div>
<div class="line"><a id="l00772" name="l00772"></a><span class="lineno">  772</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: uco222(pcols,pverp)  <span class="comment">! CO2 10.4 micron band path length</span></div>
<div class="line"><a id="l00773" name="l00773"></a><span class="lineno">  773</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: uco223(pcols,pverp)  <span class="comment">! CO2 10.4 micron band path length</span></div>
<div class="line"><a id="l00774" name="l00774"></a><span class="lineno">  774</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: bplnk(14,pcols,4)    <span class="comment">! weighted Planck fnc. for absorptivity</span></div>
<div class="line"><a id="l00775" name="l00775"></a><span class="lineno">  775</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: winpl(pcols,4)       <span class="comment">! fractional path length</span></div>
<div class="line"><a id="l00776" name="l00776"></a><span class="lineno">  776</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: pinpl(pcols,4)       <span class="comment">! pressure factor for subdivided layer</span></div>
<div class="line"><a id="l00777" name="l00777"></a><span class="lineno">  777</span><span class="comment">!</span></div>
<div class="line"><a id="l00778" name="l00778"></a><span class="lineno">  778</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: tco2(pcols)          <span class="comment">! co2 transmission</span></div>
<div class="line"><a id="l00779" name="l00779"></a><span class="lineno">  779</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: th2o(pcols)          <span class="comment">! h2o transmission</span></div>
<div class="line"><a id="l00780" name="l00780"></a><span class="lineno">  780</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: to3(pcols)           <span class="comment">! o3 transmission</span></div>
<div class="line"><a id="l00781" name="l00781"></a><span class="lineno">  781</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: dw(pcols)            <span class="comment">! h2o path length</span></div>
<div class="line"><a id="l00782" name="l00782"></a><span class="lineno">  782</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: pnew(pcols)          <span class="comment">! pressure factor</span></div>
<div class="line"><a id="l00783" name="l00783"></a><span class="lineno">  783</span><span class="comment">!</span></div>
<div class="line"><a id="l00784" name="l00784"></a><span class="lineno">  784</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: s2c(pcols,pverp)     <span class="comment">! h2o continuum factor</span></div>
<div class="line"><a id="l00785" name="l00785"></a><span class="lineno">  785</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: uptype(pcols,pverp)  <span class="comment">! p-type path length</span></div>
<div class="line"><a id="l00786" name="l00786"></a><span class="lineno">  786</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: up2(pcols)           <span class="comment">! p squared path length</span></div>
<div class="line"><a id="l00787" name="l00787"></a><span class="lineno">  787</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: uinpl(pcols,4)       <span class="comment">! Nearest layer subdivision factor</span></div>
<div class="line"><a id="l00788" name="l00788"></a><span class="lineno">  788</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: aer_trn_ngh(pcols,bnd_nbr_LW) </div>
<div class="line"><a id="l00789" name="l00789"></a><span class="lineno">  789</span>                             <span class="comment">! [fraction] Total transmission between </span></div>
<div class="line"><a id="l00790" name="l00790"></a><span class="lineno">  790</span>                             <span class="comment">!            nearest neighbor sub-levels</span></div>
<div class="line"><a id="l00791" name="l00791"></a><span class="lineno">  791</span><span class="comment">!</span></div>
<div class="line"><a id="l00792" name="l00792"></a><span class="lineno">  792</span><span class="comment">!  Output Arguments</span></div>
<div class="line"><a id="l00793" name="l00793"></a><span class="lineno">  793</span><span class="comment">!</span></div>
<div class="line"><a id="l00794" name="l00794"></a><span class="lineno">  794</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(out)</span> :: abstrc(pcols)        <span class="comment">! total trace gas absorptivity</span></div>
<div class="line"><a id="l00795" name="l00795"></a><span class="lineno">  795</span> </div>
<div class="line"><a id="l00796" name="l00796"></a><span class="lineno">  796</span><span class="comment">!</span></div>
<div class="line"><a id="l00797" name="l00797"></a><span class="lineno">  797</span><span class="comment">!--------------------------Local Variables------------------------------</span></div>
<div class="line"><a id="l00798" name="l00798"></a><span class="lineno">  798</span><span class="comment">!</span></div>
<div class="line"><a id="l00799" name="l00799"></a><span class="lineno">  799</span>   <span class="keywordtype">integer</span> i,l                   <span class="comment">! loop counters</span></div>
<div class="line"><a id="l00800" name="l00800"></a><span class="lineno">  800</span><span class="comment">!</span></div>
<div class="line"><a id="l00801" name="l00801"></a><span class="lineno">  801</span><span class="keywordtype">   real</span>(r8) sqti(pcols)          <span class="comment">! square root of mean temp</span></div>
<div class="line"><a id="l00802" name="l00802"></a><span class="lineno">  802</span><span class="keywordtype">   real</span>(r8) rsqti(pcols)         <span class="comment">! reciprocal of sqti</span></div>
<div class="line"><a id="l00803" name="l00803"></a><span class="lineno">  803</span><span class="keywordtype">   real</span>(r8) du1                  <span class="comment">! cfc11 path length</span></div>
<div class="line"><a id="l00804" name="l00804"></a><span class="lineno">  804</span><span class="keywordtype">   real</span>(r8) du2                  <span class="comment">! cfc12 path length</span></div>
<div class="line"><a id="l00805" name="l00805"></a><span class="lineno">  805</span><span class="keywordtype">   real</span>(r8) acfc1                <span class="comment">! absorptivity of cfc11 798 cm-1 band</span></div>
<div class="line"><a id="l00806" name="l00806"></a><span class="lineno">  806</span><span class="comment">!</span></div>
<div class="line"><a id="l00807" name="l00807"></a><span class="lineno">  807</span><span class="keywordtype">   real</span>(r8) acfc2                <span class="comment">! absorptivity of cfc11 846 cm-1 band</span></div>
<div class="line"><a id="l00808" name="l00808"></a><span class="lineno">  808</span><span class="keywordtype">   real</span>(r8) acfc3                <span class="comment">! absorptivity of cfc11 933 cm-1 band</span></div>
<div class="line"><a id="l00809" name="l00809"></a><span class="lineno">  809</span><span class="keywordtype">   real</span>(r8) acfc4                <span class="comment">! absorptivity of cfc11 1085 cm-1 band</span></div>
<div class="line"><a id="l00810" name="l00810"></a><span class="lineno">  810</span><span class="keywordtype">   real</span>(r8) acfc5                <span class="comment">! absorptivity of cfc11 889 cm-1 band</span></div>
<div class="line"><a id="l00811" name="l00811"></a><span class="lineno">  811</span><span class="keywordtype">   real</span>(r8) acfc6                <span class="comment">! absorptivity of cfc11 923 cm-1 band</span></div>
<div class="line"><a id="l00812" name="l00812"></a><span class="lineno">  812</span><span class="comment">!</span></div>
<div class="line"><a id="l00813" name="l00813"></a><span class="lineno">  813</span><span class="keywordtype">   real</span>(r8) acfc7                <span class="comment">! absorptivity of cfc11 1102 cm-1 band</span></div>
<div class="line"><a id="l00814" name="l00814"></a><span class="lineno">  814</span><span class="keywordtype">   real</span>(r8) acfc8                <span class="comment">! absorptivity of cfc11 1161 cm-1 band</span></div>
<div class="line"><a id="l00815" name="l00815"></a><span class="lineno">  815</span><span class="keywordtype">   real</span>(r8) du01                 <span class="comment">! n2o path length</span></div>
<div class="line"><a id="l00816" name="l00816"></a><span class="lineno">  816</span><span class="keywordtype">   real</span>(r8) dbeta01              <span class="comment">! n2o pressure factors</span></div>
<div class="line"><a id="l00817" name="l00817"></a><span class="lineno">  817</span><span class="keywordtype">   real</span>(r8) dbeta11              <span class="comment">!        &quot;</span></div>
<div class="line"><a id="l00818" name="l00818"></a><span class="lineno">  818</span><span class="comment">!</span></div>
<div class="line"><a id="l00819" name="l00819"></a><span class="lineno">  819</span><span class="keywordtype">   real</span>(r8)  an2o1               <span class="comment">! absorptivity of the 1285 cm-1 n2o band</span></div>
<div class="line"><a id="l00820" name="l00820"></a><span class="lineno">  820</span><span class="keywordtype">   real</span>(r8) du02                 <span class="comment">! n2o path length</span></div>
<div class="line"><a id="l00821" name="l00821"></a><span class="lineno">  821</span><span class="keywordtype">   real</span>(r8) dbeta02              <span class="comment">! n2o pressure factor</span></div>
<div class="line"><a id="l00822" name="l00822"></a><span class="lineno">  822</span><span class="keywordtype">   real</span>(r8) an2o2                <span class="comment">! absorptivity of the 589 cm-1 n2o band</span></div>
<div class="line"><a id="l00823" name="l00823"></a><span class="lineno">  823</span><span class="keywordtype">   real</span>(r8) du03                 <span class="comment">! n2o path length</span></div>
<div class="line"><a id="l00824" name="l00824"></a><span class="lineno">  824</span><span class="comment">!</span></div>
<div class="line"><a id="l00825" name="l00825"></a><span class="lineno">  825</span><span class="keywordtype">   real</span>(r8) dbeta03              <span class="comment">! n2o pressure factor</span></div>
<div class="line"><a id="l00826" name="l00826"></a><span class="lineno">  826</span><span class="keywordtype">   real</span>(r8) an2o3                <span class="comment">! absorptivity of the 1168 cm-1 n2o band</span></div>
<div class="line"><a id="l00827" name="l00827"></a><span class="lineno">  827</span><span class="keywordtype">   real</span>(r8) duch4                <span class="comment">! ch4 path length</span></div>
<div class="line"><a id="l00828" name="l00828"></a><span class="lineno">  828</span><span class="keywordtype">   real</span>(r8) dbetac               <span class="comment">! ch4 pressure factor</span></div>
<div class="line"><a id="l00829" name="l00829"></a><span class="lineno">  829</span><span class="keywordtype">   real</span>(r8) ach4                 <span class="comment">! absorptivity of the 1306 cm-1 ch4 band</span></div>
<div class="line"><a id="l00830" name="l00830"></a><span class="lineno">  830</span><span class="comment">!</span></div>
<div class="line"><a id="l00831" name="l00831"></a><span class="lineno">  831</span><span class="keywordtype">   real</span>(r8) du11                 <span class="comment">! co2 path length</span></div>
<div class="line"><a id="l00832" name="l00832"></a><span class="lineno">  832</span><span class="keywordtype">   real</span>(r8) du12                 <span class="comment">!       &quot;</span></div>
<div class="line"><a id="l00833" name="l00833"></a><span class="lineno">  833</span><span class="keywordtype">   real</span>(r8) du13                 <span class="comment">!       &quot;</span></div>
<div class="line"><a id="l00834" name="l00834"></a><span class="lineno">  834</span><span class="keywordtype">   real</span>(r8) dbetc1               <span class="comment">! co2 pressure factor</span></div>
<div class="line"><a id="l00835" name="l00835"></a><span class="lineno">  835</span><span class="keywordtype">   real</span>(r8) dbetc2               <span class="comment">! co2 pressure factor</span></div>
<div class="line"><a id="l00836" name="l00836"></a><span class="lineno">  836</span><span class="comment">!</span></div>
<div class="line"><a id="l00837" name="l00837"></a><span class="lineno">  837</span><span class="keywordtype">   real</span>(r8) aco21                <span class="comment">! absorptivity of the 1064 cm-1 co2 band</span></div>
<div class="line"><a id="l00838" name="l00838"></a><span class="lineno">  838</span><span class="keywordtype">   real</span>(r8) du21                 <span class="comment">! co2 path length</span></div>
<div class="line"><a id="l00839" name="l00839"></a><span class="lineno">  839</span><span class="keywordtype">   real</span>(r8) du22                 <span class="comment">!       &quot;</span></div>
<div class="line"><a id="l00840" name="l00840"></a><span class="lineno">  840</span><span class="keywordtype">   real</span>(r8) du23                 <span class="comment">!       &quot;</span></div>
<div class="line"><a id="l00841" name="l00841"></a><span class="lineno">  841</span><span class="keywordtype">   real</span>(r8) aco22                <span class="comment">! absorptivity of the 961 cm-1 co2 band</span></div>
<div class="line"><a id="l00842" name="l00842"></a><span class="lineno">  842</span><span class="comment">!</span></div>
<div class="line"><a id="l00843" name="l00843"></a><span class="lineno">  843</span><span class="keywordtype">   real</span>(r8) tt(pcols)            <span class="comment">! temp. factor for h2o overlap</span></div>
<div class="line"><a id="l00844" name="l00844"></a><span class="lineno">  844</span><span class="keywordtype">   real</span>(r8) psi1                 <span class="comment">!          &quot;</span></div>
<div class="line"><a id="l00845" name="l00845"></a><span class="lineno">  845</span><span class="keywordtype">   real</span>(r8) phi1                 <span class="comment">!          &quot;</span></div>
<div class="line"><a id="l00846" name="l00846"></a><span class="lineno">  846</span><span class="keywordtype">   real</span>(r8) p1                   <span class="comment">! factor for h2o overlap</span></div>
<div class="line"><a id="l00847" name="l00847"></a><span class="lineno">  847</span><span class="keywordtype">   real</span>(r8) w1                   <span class="comment">!          &quot;</span></div>
<div class="line"><a id="l00848" name="l00848"></a><span class="lineno">  848</span><span class="comment">!</span></div>
<div class="line"><a id="l00849" name="l00849"></a><span class="lineno">  849</span><span class="keywordtype">   real</span>(r8) ds2c(pcols)          <span class="comment">! continuum path length</span></div>
<div class="line"><a id="l00850" name="l00850"></a><span class="lineno">  850</span><span class="keywordtype">   real</span>(r8) duptyp(pcols)        <span class="comment">! p-type path length</span></div>
<div class="line"><a id="l00851" name="l00851"></a><span class="lineno">  851</span><span class="keywordtype">   real</span>(r8) tw(pcols,6)          <span class="comment">! h2o transmission overlap</span></div>
<div class="line"><a id="l00852" name="l00852"></a><span class="lineno">  852</span><span class="keywordtype">   real</span>(r8) g1(6)                <span class="comment">! h2o overlap factor</span></div>
<div class="line"><a id="l00853" name="l00853"></a><span class="lineno">  853</span><span class="keywordtype">   real</span>(r8) g2(6)                <span class="comment">!         &quot;</span></div>
<div class="line"><a id="l00854" name="l00854"></a><span class="lineno">  854</span><span class="comment">!</span></div>
<div class="line"><a id="l00855" name="l00855"></a><span class="lineno">  855</span><span class="keywordtype">   real</span>(r8) g3(6)                <span class="comment">!         &quot;</span></div>
<div class="line"><a id="l00856" name="l00856"></a><span class="lineno">  856</span><span class="keywordtype">   real</span>(r8) g4(6)                <span class="comment">!         &quot;</span></div>
<div class="line"><a id="l00857" name="l00857"></a><span class="lineno">  857</span><span class="keywordtype">   real</span>(r8) ab(6)                <span class="comment">! h2o temp. factor</span></div>
<div class="line"><a id="l00858" name="l00858"></a><span class="lineno">  858</span><span class="keywordtype">   real</span>(r8) bb(6)                <span class="comment">!         &quot;</span></div>
<div class="line"><a id="l00859" name="l00859"></a><span class="lineno">  859</span><span class="keywordtype">   real</span>(r8) abp(6)               <span class="comment">!         &quot;</span></div>
<div class="line"><a id="l00860" name="l00860"></a><span class="lineno">  860</span><span class="comment">!</span></div>
<div class="line"><a id="l00861" name="l00861"></a><span class="lineno">  861</span><span class="keywordtype">   real</span>(r8) bbp(6)               <span class="comment">!         &quot;</span></div>
<div class="line"><a id="l00862" name="l00862"></a><span class="lineno">  862</span><span class="keywordtype">   real</span>(r8) tcfc3                <span class="comment">! transmission of cfc11 band</span></div>
<div class="line"><a id="l00863" name="l00863"></a><span class="lineno">  863</span><span class="keywordtype">   real</span>(r8) tcfc4                <span class="comment">! transmission of cfc11 band</span></div>
<div class="line"><a id="l00864" name="l00864"></a><span class="lineno">  864</span><span class="keywordtype">   real</span>(r8) tcfc6                <span class="comment">! transmission of cfc12 band</span></div>
<div class="line"><a id="l00865" name="l00865"></a><span class="lineno">  865</span><span class="keywordtype">   real</span>(r8) tcfc7                <span class="comment">!         &quot;</span></div>
<div class="line"><a id="l00866" name="l00866"></a><span class="lineno">  866</span><span class="comment">!</span></div>
<div class="line"><a id="l00867" name="l00867"></a><span class="lineno">  867</span><span class="keywordtype">   real</span>(r8) tcfc8                <span class="comment">!         &quot;</span></div>
<div class="line"><a id="l00868" name="l00868"></a><span class="lineno">  868</span><span class="keywordtype">   real</span>(r8) tlw                  <span class="comment">! h2o transmission</span></div>
<div class="line"><a id="l00869" name="l00869"></a><span class="lineno">  869</span><span class="keywordtype">   real</span>(r8) tch4                 <span class="comment">! ch4 transmission</span></div>
<div class="line"><a id="l00870" name="l00870"></a><span class="lineno">  870</span><span class="comment">!</span></div>
<div class="line"><a id="l00871" name="l00871"></a><span class="lineno">  871</span><span class="comment">!--------------------------Data Statements------------------------------</span></div>
<div class="line"><a id="l00872" name="l00872"></a><span class="lineno">  872</span><span class="comment">!</span></div>
<div class="line"><a id="l00873" name="l00873"></a><span class="lineno">  873</span>   <span class="keyword">data</span> g1 /0.0468556,0.0397454,0.0407664,0.0304380,0.0540398,0.0321962/</div>
<div class="line"><a id="l00874" name="l00874"></a><span class="lineno">  874</span>   <span class="keyword">data</span> g2 /14.4832,4.30242,5.23523,3.25342,0.698935,16.5599/</div>
<div class="line"><a id="l00875" name="l00875"></a><span class="lineno">  875</span>   <span class="keyword">data</span> g3 /26.1898,18.4476,15.3633,12.1927,9.14992,8.07092/</div>
<div class="line"><a id="l00876" name="l00876"></a><span class="lineno">  876</span>   <span class="keyword">data</span> g4 /0.0261782,0.0369516,0.0307266,0.0243854,0.0182932,0.0161418/</div>
<div class="line"><a id="l00877" name="l00877"></a><span class="lineno">  877</span>   <span class="keyword">data</span> ab /3.0857e-2,2.3524e-2,1.7310e-2,2.6661e-2,2.8074e-2,2.2915e-2/</div>
<div class="line"><a id="l00878" name="l00878"></a><span class="lineno">  878</span>   <span class="keyword">data</span> bb /-1.3512e-4,-6.8320e-5,-3.2609e-5,-1.0228e-5,-9.5743e-5,-1.0304e-4/</div>
<div class="line"><a id="l00879" name="l00879"></a><span class="lineno">  879</span>   <span class="keyword">data</span> abp/2.9129e-2,2.4101e-2,1.9821e-2,2.6904e-2,2.9458e-2,1.9892e-2/</div>
<div class="line"><a id="l00880" name="l00880"></a><span class="lineno">  880</span>   <span class="keyword">data</span> bbp/-1.3139e-4,-5.5688e-5,-4.6380e-5,-8.0362e-5,-1.0115e-4,-8.8061e-5/</div>
<div class="line"><a id="l00881" name="l00881"></a><span class="lineno">  881</span><span class="comment">!</span></div>
<div class="line"><a id="l00882" name="l00882"></a><span class="lineno">  882</span><span class="comment">!--------------------------Statement Functions--------------------------</span></div>
<div class="line"><a id="l00883" name="l00883"></a><span class="lineno">  883</span><span class="comment">!</span></div>
<div class="line"><a id="l00884" name="l00884"></a><span class="lineno">  884</span><span class="keywordtype">   real</span>(r8) func, u, b</div>
<div class="line"><a id="l00885" name="l00885"></a><span class="lineno">  885</span>   func(u,b) = u/sqrt(4.0 + u*(1.0 + 1.0 / b))</div>
<div class="line"><a id="l00886" name="l00886"></a><span class="lineno">  886</span><span class="comment">!</span></div>
<div class="line"><a id="l00887" name="l00887"></a><span class="lineno">  887</span><span class="comment">!------------------------------------------------------------------</span></div>
<div class="line"><a id="l00888" name="l00888"></a><span class="lineno">  888</span><span class="comment">!</span></div>
<div class="line"><a id="l00889" name="l00889"></a><span class="lineno">  889</span>   <span class="keywordflow">do</span> i = 1,ncol</div>
<div class="line"><a id="l00890" name="l00890"></a><span class="lineno">  890</span>      sqti(i) = sqrt(tbar(i,kn))</div>
<div class="line"><a id="l00891" name="l00891"></a><span class="lineno">  891</span>      rsqti(i) = 1. / sqti(i)</div>
<div class="line"><a id="l00892" name="l00892"></a><span class="lineno">  892</span><span class="comment">!</span></div>
<div class="line"><a id="l00893" name="l00893"></a><span class="lineno">  893</span><span class="comment">! h2o transmission</span></div>
<div class="line"><a id="l00894" name="l00894"></a><span class="lineno">  894</span><span class="comment">!</span></div>
<div class="line"><a id="l00895" name="l00895"></a><span class="lineno">  895</span>      tt(i) = abs(tbar(i,kn) - 250.0)</div>
<div class="line"><a id="l00896" name="l00896"></a><span class="lineno">  896</span>      ds2c(i) = abs(s2c(i,k2+1) - s2c(i,k2))*uinpl(i,kn)</div>
<div class="line"><a id="l00897" name="l00897"></a><span class="lineno">  897</span>      duptyp(i) = abs(uptype(i,k2+1) - uptype(i,k2))*uinpl(i,kn)</div>
<div class="line"><a id="l00898" name="l00898"></a><span class="lineno">  898</span><span class="keywordflow">   end do</span></div>
<div class="line"><a id="l00899" name="l00899"></a><span class="lineno">  899</span><span class="comment">!</span></div>
<div class="line"><a id="l00900" name="l00900"></a><span class="lineno">  900</span>   <span class="keywordflow">do</span> l = 1,6</div>
<div class="line"><a id="l00901" name="l00901"></a><span class="lineno">  901</span>      <span class="keywordflow">do</span> i = 1,ncol</div>
<div class="line"><a id="l00902" name="l00902"></a><span class="lineno">  902</span>         psi1 = exp(abp(l)*tt(i)+bbp(l)*tt(i)*tt(i))</div>
<div class="line"><a id="l00903" name="l00903"></a><span class="lineno">  903</span>         phi1 = exp(ab(l)*tt(i)+bb(l)*tt(i)*tt(i))</div>
<div class="line"><a id="l00904" name="l00904"></a><span class="lineno">  904</span>         p1 = pnew(i) * (psi1/phi1) / <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#aedb55b03e1395012ec29e1914a2df7cc">sslp</a></div>
<div class="line"><a id="l00905" name="l00905"></a><span class="lineno">  905</span>         w1 = dw(i) * winpl(i,kn) * phi1</div>
<div class="line"><a id="l00906" name="l00906"></a><span class="lineno">  906</span>         tw(i,l) = exp(- g1(l)*p1*(sqrt(1.0+g2(l)*(w1/p1))-1.0) &amp;</div>
<div class="line"><a id="l00907" name="l00907"></a><span class="lineno">  907</span>                   - g3(l)*ds2c(i)-g4(l)*duptyp(i))</div>
<div class="line"><a id="l00908" name="l00908"></a><span class="lineno">  908</span><span class="keywordflow">      end do</span></div>
<div class="line"><a id="l00909" name="l00909"></a><span class="lineno">  909</span><span class="keywordflow">   end do</span></div>
<div class="line"><a id="l00910" name="l00910"></a><span class="lineno">  910</span><span class="comment">!</span></div>
<div class="line"><a id="l00911" name="l00911"></a><span class="lineno">  911</span>   <span class="keywordflow">do</span> i=1,ncol</div>
<div class="line"><a id="l00912" name="l00912"></a><span class="lineno">  912</span>      tw(i,1)=tw(i,1)*(0.7*aer_trn_ngh(i,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ae90583401bc762ffcf004ff27792f3ef">idx_lw_0650_0800</a>)+&amp;<span class="comment">! l=1: 0750--0820 cm-1</span></div>
<div class="line"><a id="l00913" name="l00913"></a><span class="lineno">  913</span>                       0.3*aer_trn_ngh(i,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a3641bbffc5b9d01322506476442a962a">idx_lw_0800_1000</a>))</div>
<div class="line"><a id="l00914" name="l00914"></a><span class="lineno">  914</span>      tw(i,2)=tw(i,2)*aer_trn_ngh(i,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a3641bbffc5b9d01322506476442a962a">idx_lw_0800_1000</a>) <span class="comment">! l=2: 0820--0880 cm-1</span></div>
<div class="line"><a id="l00915" name="l00915"></a><span class="lineno">  915</span>      tw(i,3)=tw(i,3)*aer_trn_ngh(i,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a3641bbffc5b9d01322506476442a962a">idx_lw_0800_1000</a>) <span class="comment">! l=3: 0880--0900 cm-1</span></div>
<div class="line"><a id="l00916" name="l00916"></a><span class="lineno">  916</span>      tw(i,4)=tw(i,4)*aer_trn_ngh(i,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a3641bbffc5b9d01322506476442a962a">idx_lw_0800_1000</a>) <span class="comment">! l=4: 0900--1000 cm-1</span></div>
<div class="line"><a id="l00917" name="l00917"></a><span class="lineno">  917</span>      tw(i,5)=tw(i,5)*aer_trn_ngh(i,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a619b4abbc0ae813bf2c8709cef491d8e">idx_lw_1000_1200</a>) <span class="comment">! l=5: 1000--1120 cm-1</span></div>
<div class="line"><a id="l00918" name="l00918"></a><span class="lineno">  918</span>      tw(i,6)=tw(i,6)*aer_trn_ngh(i,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a619b4abbc0ae813bf2c8709cef491d8e">idx_lw_1000_1200</a>) <span class="comment">! l=6: 1120--1170 cm-1</span></div>
<div class="line"><a id="l00919" name="l00919"></a><span class="lineno">  919</span><span class="keywordflow">   end do</span>                    <span class="comment">! end loop over lon</span></div>
<div class="line"><a id="l00920" name="l00920"></a><span class="lineno">  920</span> </div>
<div class="line"><a id="l00921" name="l00921"></a><span class="lineno">  921</span>   <span class="keywordflow">do</span> i = 1,ncol</div>
<div class="line"><a id="l00922" name="l00922"></a><span class="lineno">  922</span><span class="comment">!</span></div>
<div class="line"><a id="l00923" name="l00923"></a><span class="lineno">  923</span>      du1 = abs(ucfc11(i,k2+1) - ucfc11(i,k2)) * winpl(i,kn)</div>
<div class="line"><a id="l00924" name="l00924"></a><span class="lineno">  924</span>      du2 = abs(ucfc12(i,k2+1) - ucfc12(i,k2)) * winpl(i,kn)</div>
<div class="line"><a id="l00925" name="l00925"></a><span class="lineno">  925</span><span class="comment">!</span></div>
<div class="line"><a id="l00926" name="l00926"></a><span class="lineno">  926</span><span class="comment">! cfc transmissions</span></div>
<div class="line"><a id="l00927" name="l00927"></a><span class="lineno">  927</span><span class="comment">!</span></div>
<div class="line"><a id="l00928" name="l00928"></a><span class="lineno">  928</span>      tcfc3 = exp(-175.005*du1)</div>
<div class="line"><a id="l00929" name="l00929"></a><span class="lineno">  929</span>      tcfc4 = exp(-1202.18*du1)</div>
<div class="line"><a id="l00930" name="l00930"></a><span class="lineno">  930</span>      tcfc6 = exp(-5786.73*du2)</div>
<div class="line"><a id="l00931" name="l00931"></a><span class="lineno">  931</span>      tcfc7 = exp(-2873.51*du2)</div>
<div class="line"><a id="l00932" name="l00932"></a><span class="lineno">  932</span>      tcfc8 = exp(-2085.59*du2)</div>
<div class="line"><a id="l00933" name="l00933"></a><span class="lineno">  933</span><span class="comment">!</span></div>
<div class="line"><a id="l00934" name="l00934"></a><span class="lineno">  934</span><span class="comment">! Absorptivity for CFC11 bands</span></div>
<div class="line"><a id="l00935" name="l00935"></a><span class="lineno">  935</span><span class="comment">!</span></div>
<div class="line"><a id="l00936" name="l00936"></a><span class="lineno">  936</span>      acfc1 = 50.0*(1.0 - exp(-54.09*du1)) * tw(i,1)*bplnk(7,i,kn)</div>
<div class="line"><a id="l00937" name="l00937"></a><span class="lineno">  937</span>      acfc2 = 60.0*(1.0 - exp(-5130.03*du1))*tw(i,2)*bplnk(8,i,kn)</div>
<div class="line"><a id="l00938" name="l00938"></a><span class="lineno">  938</span>      acfc3 = 60.0*(1.0 - tcfc3)*tw(i,4)*tcfc6 * bplnk(9,i,kn)</div>
<div class="line"><a id="l00939" name="l00939"></a><span class="lineno">  939</span>      acfc4 = 100.0*(1.0 - tcfc4)* tw(i,5) * bplnk(10,i,kn)</div>
<div class="line"><a id="l00940" name="l00940"></a><span class="lineno">  940</span><span class="comment">!</span></div>
<div class="line"><a id="l00941" name="l00941"></a><span class="lineno">  941</span><span class="comment">! Absorptivity for CFC12 bands</span></div>
<div class="line"><a id="l00942" name="l00942"></a><span class="lineno">  942</span><span class="comment">!</span></div>
<div class="line"><a id="l00943" name="l00943"></a><span class="lineno">  943</span>      acfc5 = 45.0*(1.0 - exp(-1272.35*du2))*tw(i,3)*bplnk(11,i,kn)</div>
<div class="line"><a id="l00944" name="l00944"></a><span class="lineno">  944</span>      acfc6 = 50.0*(1.0 - tcfc6)*tw(i,4)*bplnk(12,i,kn)</div>
<div class="line"><a id="l00945" name="l00945"></a><span class="lineno">  945</span>      acfc7 = 80.0*(1.0 - tcfc7)* tw(i,5)*tcfc4 *bplnk(13,i,kn)</div>
<div class="line"><a id="l00946" name="l00946"></a><span class="lineno">  946</span>      acfc8 = 70.0*(1.0 - tcfc8)*tw(i,6)*bplnk(14,i,kn)</div>
<div class="line"><a id="l00947" name="l00947"></a><span class="lineno">  947</span><span class="comment">!</span></div>
<div class="line"><a id="l00948" name="l00948"></a><span class="lineno">  948</span><span class="comment">! Absorptivity for CH4 band 1306 cm-1</span></div>
<div class="line"><a id="l00949" name="l00949"></a><span class="lineno">  949</span><span class="comment">!</span></div>
<div class="line"><a id="l00950" name="l00950"></a><span class="lineno">  950</span>      tlw = exp(-1.0*sqrt(up2(i)))</div>
<div class="line"><a id="l00951" name="l00951"></a><span class="lineno">  951</span>      tlw=tlw*aer_trn_ngh(i,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ab20c3561d003d8e16f6984f564247561">idx_lw_1200_2000</a>)</div>
<div class="line"><a id="l00952" name="l00952"></a><span class="lineno">  952</span>      duch4 = abs(uch4(i,k2+1) - uch4(i,k2)) * winpl(i,kn)</div>
<div class="line"><a id="l00953" name="l00953"></a><span class="lineno">  953</span>      dbetac = 2.94449 * pinpl(i,kn) * rsqti(i) / <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#aedb55b03e1395012ec29e1914a2df7cc">sslp</a></div>
<div class="line"><a id="l00954" name="l00954"></a><span class="lineno">  954</span>      ach4 = 6.00444*sqti(i)*log(1.0 + func(duch4,dbetac)) * tlw * bplnk(3,i,kn)</div>
<div class="line"><a id="l00955" name="l00955"></a><span class="lineno">  955</span>      tch4 = 1.0/(1.0 + 0.02*func(duch4,dbetac))</div>
<div class="line"><a id="l00956" name="l00956"></a><span class="lineno">  956</span><span class="comment">!</span></div>
<div class="line"><a id="l00957" name="l00957"></a><span class="lineno">  957</span><span class="comment">! Absorptivity for N2O bands</span></div>
<div class="line"><a id="l00958" name="l00958"></a><span class="lineno">  958</span><span class="comment">!</span></div>
<div class="line"><a id="l00959" name="l00959"></a><span class="lineno">  959</span>      du01 = abs(un2o0(i,k2+1) - un2o0(i,k2)) * winpl(i,kn)</div>
<div class="line"><a id="l00960" name="l00960"></a><span class="lineno">  960</span>      du11 = abs(un2o1(i,k2+1) - un2o1(i,k2)) * winpl(i,kn)</div>
<div class="line"><a id="l00961" name="l00961"></a><span class="lineno">  961</span>      dbeta01 = 19.399 *  pinpl(i,kn) * rsqti(i) / <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#aedb55b03e1395012ec29e1914a2df7cc">sslp</a></div>
<div class="line"><a id="l00962" name="l00962"></a><span class="lineno">  962</span>      dbeta11 = dbeta01</div>
<div class="line"><a id="l00963" name="l00963"></a><span class="lineno">  963</span><span class="comment">!</span></div>
<div class="line"><a id="l00964" name="l00964"></a><span class="lineno">  964</span><span class="comment">! 1285 cm-1 band</span></div>
<div class="line"><a id="l00965" name="l00965"></a><span class="lineno">  965</span><span class="comment">!</span></div>
<div class="line"><a id="l00966" name="l00966"></a><span class="lineno">  966</span>      an2o1 = 2.35558*sqti(i)*log(1.0 + func(du01,dbeta01) &amp;</div>
<div class="line"><a id="l00967" name="l00967"></a><span class="lineno">  967</span>              + func(du11,dbeta11)) * tlw * tch4 * bplnk(4,i,kn)</div>
<div class="line"><a id="l00968" name="l00968"></a><span class="lineno">  968</span>      du02 = 0.100090*du01</div>
<div class="line"><a id="l00969" name="l00969"></a><span class="lineno">  969</span>      du12 = 0.0992746*du11</div>
<div class="line"><a id="l00970" name="l00970"></a><span class="lineno">  970</span>      dbeta02 = 0.964282*dbeta01</div>
<div class="line"><a id="l00971" name="l00971"></a><span class="lineno">  971</span><span class="comment">!</span></div>
<div class="line"><a id="l00972" name="l00972"></a><span class="lineno">  972</span><span class="comment">! 589 cm-1 band</span></div>
<div class="line"><a id="l00973" name="l00973"></a><span class="lineno">  973</span><span class="comment">!</span></div>
<div class="line"><a id="l00974" name="l00974"></a><span class="lineno">  974</span>      an2o2 = 2.65581*sqti(i)*log(1.0 + func(du02,dbeta02) &amp;</div>
<div class="line"><a id="l00975" name="l00975"></a><span class="lineno">  975</span>              +  func(du12,dbeta02)) * tco2(i) * th2o(i) * bplnk(5,i,kn)</div>
<div class="line"><a id="l00976" name="l00976"></a><span class="lineno">  976</span>      du03 = 0.0333767*du01</div>
<div class="line"><a id="l00977" name="l00977"></a><span class="lineno">  977</span>      dbeta03 = 0.982143*dbeta01</div>
<div class="line"><a id="l00978" name="l00978"></a><span class="lineno">  978</span><span class="comment">!</span></div>
<div class="line"><a id="l00979" name="l00979"></a><span class="lineno">  979</span><span class="comment">! 1168 cm-1 band</span></div>
<div class="line"><a id="l00980" name="l00980"></a><span class="lineno">  980</span><span class="comment">!</span></div>
<div class="line"><a id="l00981" name="l00981"></a><span class="lineno">  981</span>      an2o3 = 2.54034*sqti(i)*log(1.0 + func(du03,dbeta03)) * &amp;</div>
<div class="line"><a id="l00982" name="l00982"></a><span class="lineno">  982</span>              tw(i,6) * tcfc8 * bplnk(6,i,kn)</div>
<div class="line"><a id="l00983" name="l00983"></a><span class="lineno">  983</span><span class="comment">!</span></div>
<div class="line"><a id="l00984" name="l00984"></a><span class="lineno">  984</span><span class="comment">! Absorptivity for 1064 cm-1 band of CO2</span></div>
<div class="line"><a id="l00985" name="l00985"></a><span class="lineno">  985</span><span class="comment">!</span></div>
<div class="line"><a id="l00986" name="l00986"></a><span class="lineno">  986</span>      du11 = abs(uco211(i,k2+1) - uco211(i,k2)) * winpl(i,kn)</div>
<div class="line"><a id="l00987" name="l00987"></a><span class="lineno">  987</span>      du12 = abs(uco212(i,k2+1) - uco212(i,k2)) * winpl(i,kn)</div>
<div class="line"><a id="l00988" name="l00988"></a><span class="lineno">  988</span>      du13 = abs(uco213(i,k2+1) - uco213(i,k2)) * winpl(i,kn)</div>
<div class="line"><a id="l00989" name="l00989"></a><span class="lineno">  989</span>      dbetc1 = 2.97558 * pinpl(i,kn) * rsqti(i) / <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#aedb55b03e1395012ec29e1914a2df7cc">sslp</a></div>
<div class="line"><a id="l00990" name="l00990"></a><span class="lineno">  990</span>      dbetc2 = 2.0 * dbetc1</div>
<div class="line"><a id="l00991" name="l00991"></a><span class="lineno">  991</span>      aco21 = 3.7571*sqti(i)*log(1.0 + func(du11,dbetc1) &amp;</div>
<div class="line"><a id="l00992" name="l00992"></a><span class="lineno">  992</span>              + func(du12,dbetc2) + func(du13,dbetc2)) &amp;</div>
<div class="line"><a id="l00993" name="l00993"></a><span class="lineno">  993</span>              * to3(i) * tw(i,5) * tcfc4 * tcfc7 * bplnk(2,i,kn)</div>
<div class="line"><a id="l00994" name="l00994"></a><span class="lineno">  994</span><span class="comment">!</span></div>
<div class="line"><a id="l00995" name="l00995"></a><span class="lineno">  995</span><span class="comment">! Absorptivity for 961 cm-1 band of co2</span></div>
<div class="line"><a id="l00996" name="l00996"></a><span class="lineno">  996</span><span class="comment">!</span></div>
<div class="line"><a id="l00997" name="l00997"></a><span class="lineno">  997</span>      du21 = abs(uco221(i,k2+1) - uco221(i,k2)) * winpl(i,kn)</div>
<div class="line"><a id="l00998" name="l00998"></a><span class="lineno">  998</span>      du22 = abs(uco222(i,k2+1) - uco222(i,k2)) * winpl(i,kn)</div>
<div class="line"><a id="l00999" name="l00999"></a><span class="lineno">  999</span>      du23 = abs(uco223(i,k2+1) - uco223(i,k2)) * winpl(i,kn)</div>
<div class="line"><a id="l01000" name="l01000"></a><span class="lineno"> 1000</span>      aco22 = 3.8443*sqti(i)*log(1.0 + func(du21,dbetc1) &amp;</div>
<div class="line"><a id="l01001" name="l01001"></a><span class="lineno"> 1001</span>              + func(du22,dbetc1) + func(du23,dbetc2)) &amp;</div>
<div class="line"><a id="l01002" name="l01002"></a><span class="lineno"> 1002</span>              * tw(i,4) * tcfc3 * tcfc6 * bplnk(1,i,kn)</div>
<div class="line"><a id="l01003" name="l01003"></a><span class="lineno"> 1003</span><span class="comment">!</span></div>
<div class="line"><a id="l01004" name="l01004"></a><span class="lineno"> 1004</span><span class="comment">! total trace gas absorptivity</span></div>
<div class="line"><a id="l01005" name="l01005"></a><span class="lineno"> 1005</span><span class="comment">!</span></div>
<div class="line"><a id="l01006" name="l01006"></a><span class="lineno"> 1006</span>      abstrc(i) = acfc1 + acfc2 + acfc3 + acfc4 + acfc5 + acfc6 + &amp;</div>
<div class="line"><a id="l01007" name="l01007"></a><span class="lineno"> 1007</span>                  acfc7 + acfc8 + an2o1 + an2o2 + an2o3 + ach4 + &amp;</div>
<div class="line"><a id="l01008" name="l01008"></a><span class="lineno"> 1008</span>                  aco21 + aco22</div>
<div class="line"><a id="l01009" name="l01009"></a><span class="lineno"> 1009</span><span class="keywordflow">   end do</span></div>
<div class="line"><a id="l01010" name="l01010"></a><span class="lineno"> 1010</span><span class="comment">!</span></div>
<div class="line"><a id="l01011" name="l01011"></a><span class="lineno"> 1011</span>   <span class="keywordflow">return</span></div>
<div class="line"><a id="l01012" name="l01012"></a><span class="lineno"> 1012</span><span class="comment">!</span></div>
<div class="line"><a id="l01013" name="l01013"></a><span class="lineno"> 1013</span><span class="keyword">end subroutine </span><a class="code hl_function" href="namespacemodule__ra__cam__support.html#a6b84aa6684de2807653f5f8cf8784cd6">trcabn</a></div>
<div class="line"><a id="l01014" name="l01014"></a><span class="lineno"> 1014</span> </div>
<div class="line"><a id="l01015" name="l01015"></a><span class="lineno"> 1015</span> </div>
<div class="line"><a id="l01016" name="l01016"></a><span class="lineno"> 1016</span> </div>
<div class="line"><a id="l01017" name="l01017"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a77341b9c752243caedf506fd54162e1c"> 1017</a></span><span class="keyword">subroutine </span><a class="code hl_function" href="namespacemodule__ra__cam__support.html#a77341b9c752243caedf506fd54162e1c">trcems</a>(lchnk   ,ncol    ,pcols, pverp,               &amp;</div>
<div class="line"><a id="l01018" name="l01018"></a><span class="lineno"> 1018</span>                  k       ,co2t    ,pnm     ,ucfc11  ,ucfc12  , &amp;</div>
<div class="line"><a id="l01019" name="l01019"></a><span class="lineno"> 1019</span>                  un2o0   ,un2o1   ,bn2o0   ,bn2o1   ,uch4    , &amp;</div>
<div class="line"><a id="l01020" name="l01020"></a><span class="lineno"> 1020</span>                  bch4    ,uco211  ,uco212  ,uco213  ,uco221  , &amp;</div>
<div class="line"><a id="l01021" name="l01021"></a><span class="lineno"> 1021</span>                  uco222  ,uco223  ,uptype  ,w       ,s2c     , &amp;</div>
<div class="line"><a id="l01022" name="l01022"></a><span class="lineno"> 1022</span>                  up2     ,emplnk  ,th2o    ,tco2    ,to3     , &amp;</div>
<div class="line"><a id="l01023" name="l01023"></a><span class="lineno"> 1023</span>                  emstrc  , &amp;</div>
<div class="line"><a id="l01024" name="l01024"></a><span class="lineno"> 1024</span>                 aer_trn_ttl)</div>
<div class="line"><a id="l01025" name="l01025"></a><span class="lineno"> 1025</span><span class="comment">!----------------------------------------------------------------------- </span></div>
<div class="line"><a id="l01026" name="l01026"></a><span class="lineno"> 1026</span><span class="comment">! </span></div>
<div class="line"><a id="l01027" name="l01027"></a><span class="lineno"> 1027</span><span class="comment">! Purpose: </span></div>
<div class="line"><a id="l01028" name="l01028"></a><span class="lineno"> 1028</span><span class="comment">!  Calculate emissivity for CH4, N2O, CFC11 and CFC12 bands.</span></div>
<div class="line"><a id="l01029" name="l01029"></a><span class="lineno"> 1029</span><span class="comment">! </span></div>
<div class="line"><a id="l01030" name="l01030"></a><span class="lineno"> 1030</span><span class="comment">! Method: </span></div>
<div class="line"><a id="l01031" name="l01031"></a><span class="lineno"> 1031</span><span class="comment">!  See CCM3 Description for equations.</span></div>
<div class="line"><a id="l01032" name="l01032"></a><span class="lineno"> 1032</span><span class="comment">! </span></div>
<div class="line"><a id="l01033" name="l01033"></a><span class="lineno"> 1033</span><span class="comment">! Author: J. Kiehl</span></div>
<div class="line"><a id="l01034" name="l01034"></a><span class="lineno"> 1034</span><span class="comment">! </span></div>
<div class="line"><a id="l01035" name="l01035"></a><span class="lineno"> 1035</span><span class="comment">!-----------------------------------------------------------------------</span></div>
<div class="line"><a id="l01036" name="l01036"></a><span class="lineno"> 1036</span><span class="comment">!  use shr_kind_mod, only: r8 =&gt; shr_kind_r8</span></div>
<div class="line"><a id="l01037" name="l01037"></a><span class="lineno"> 1037</span><span class="comment">!  use ppgrid</span></div>
<div class="line"><a id="l01038" name="l01038"></a><span class="lineno"> 1038</span><span class="comment">!  use volcrad</span></div>
<div class="line"><a id="l01039" name="l01039"></a><span class="lineno"> 1039</span> </div>
<div class="line"><a id="l01040" name="l01040"></a><span class="lineno"> 1040</span>   <span class="keywordtype">implicit none</span></div>
<div class="line"><a id="l01041" name="l01041"></a><span class="lineno"> 1041</span> </div>
<div class="line"><a id="l01042" name="l01042"></a><span class="lineno"> 1042</span><span class="comment">!</span></div>
<div class="line"><a id="l01043" name="l01043"></a><span class="lineno"> 1043</span><span class="comment">!------------------------------Arguments--------------------------------</span></div>
<div class="line"><a id="l01044" name="l01044"></a><span class="lineno"> 1044</span><span class="comment">!</span></div>
<div class="line"><a id="l01045" name="l01045"></a><span class="lineno"> 1045</span><span class="comment">! Input arguments</span></div>
<div class="line"><a id="l01046" name="l01046"></a><span class="lineno"> 1046</span><span class="comment">!</span></div>
<div class="line"><a id="l01047" name="l01047"></a><span class="lineno"> 1047</span>   <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: lchnk                 <span class="comment">! chunk identifier</span></div>
<div class="line"><a id="l01048" name="l01048"></a><span class="lineno"> 1048</span>   <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: ncol                  <span class="comment">! number of atmospheric columns</span></div>
<div class="line"><a id="l01049" name="l01049"></a><span class="lineno"> 1049</span>   <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: pcols, pverp</div>
<div class="line"><a id="l01050" name="l01050"></a><span class="lineno"> 1050</span> </div>
<div class="line"><a id="l01051" name="l01051"></a><span class="lineno"> 1051</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: co2t(pcols,pverp)    <span class="comment">! pressure weighted temperature</span></div>
<div class="line"><a id="l01052" name="l01052"></a><span class="lineno"> 1052</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: pnm(pcols,pverp)     <span class="comment">! interface pressure</span></div>
<div class="line"><a id="l01053" name="l01053"></a><span class="lineno"> 1053</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: ucfc11(pcols,pverp)  <span class="comment">! CFC11 path length</span></div>
<div class="line"><a id="l01054" name="l01054"></a><span class="lineno"> 1054</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: ucfc12(pcols,pverp)  <span class="comment">! CFC12 path length</span></div>
<div class="line"><a id="l01055" name="l01055"></a><span class="lineno"> 1055</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: un2o0(pcols,pverp)   <span class="comment">! N2O path length</span></div>
<div class="line"><a id="l01056" name="l01056"></a><span class="lineno"> 1056</span><span class="comment">!</span></div>
<div class="line"><a id="l01057" name="l01057"></a><span class="lineno"> 1057</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: un2o1(pcols,pverp)   <span class="comment">! N2O path length (hot band)</span></div>
<div class="line"><a id="l01058" name="l01058"></a><span class="lineno"> 1058</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: uch4(pcols,pverp)    <span class="comment">! CH4 path length</span></div>
<div class="line"><a id="l01059" name="l01059"></a><span class="lineno"> 1059</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: uco211(pcols,pverp)  <span class="comment">! CO2 9.4 micron band path length</span></div>
<div class="line"><a id="l01060" name="l01060"></a><span class="lineno"> 1060</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: uco212(pcols,pverp)  <span class="comment">! CO2 9.4 micron band path length</span></div>
<div class="line"><a id="l01061" name="l01061"></a><span class="lineno"> 1061</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: uco213(pcols,pverp)  <span class="comment">! CO2 9.4 micron band path length</span></div>
<div class="line"><a id="l01062" name="l01062"></a><span class="lineno"> 1062</span><span class="comment">!</span></div>
<div class="line"><a id="l01063" name="l01063"></a><span class="lineno"> 1063</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: uco221(pcols,pverp)  <span class="comment">! CO2 10.4 micron band path length</span></div>
<div class="line"><a id="l01064" name="l01064"></a><span class="lineno"> 1064</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: uco222(pcols,pverp)  <span class="comment">! CO2 10.4 micron band path length</span></div>
<div class="line"><a id="l01065" name="l01065"></a><span class="lineno"> 1065</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: uco223(pcols,pverp)  <span class="comment">! CO2 10.4 micron band path length</span></div>
<div class="line"><a id="l01066" name="l01066"></a><span class="lineno"> 1066</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: uptype(pcols,pverp)  <span class="comment">! continuum path length</span></div>
<div class="line"><a id="l01067" name="l01067"></a><span class="lineno"> 1067</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: bn2o0(pcols,pverp)   <span class="comment">! pressure factor for n2o</span></div>
<div class="line"><a id="l01068" name="l01068"></a><span class="lineno"> 1068</span><span class="comment">!</span></div>
<div class="line"><a id="l01069" name="l01069"></a><span class="lineno"> 1069</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: bn2o1(pcols,pverp)   <span class="comment">! pressure factor for n2o</span></div>
<div class="line"><a id="l01070" name="l01070"></a><span class="lineno"> 1070</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: bch4(pcols,pverp)    <span class="comment">! pressure factor for ch4</span></div>
<div class="line"><a id="l01071" name="l01071"></a><span class="lineno"> 1071</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: emplnk(14,pcols)     <span class="comment">! emissivity Planck factor</span></div>
<div class="line"><a id="l01072" name="l01072"></a><span class="lineno"> 1072</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: th2o(pcols)          <span class="comment">! water vapor overlap factor</span></div>
<div class="line"><a id="l01073" name="l01073"></a><span class="lineno"> 1073</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: tco2(pcols)          <span class="comment">! co2 overlap factor</span></div>
<div class="line"><a id="l01074" name="l01074"></a><span class="lineno"> 1074</span><span class="comment">!</span></div>
<div class="line"><a id="l01075" name="l01075"></a><span class="lineno"> 1075</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: to3(pcols)           <span class="comment">! o3 overlap factor</span></div>
<div class="line"><a id="l01076" name="l01076"></a><span class="lineno"> 1076</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: s2c(pcols,pverp)     <span class="comment">! h2o continuum path length</span></div>
<div class="line"><a id="l01077" name="l01077"></a><span class="lineno"> 1077</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: w(pcols,pverp)       <span class="comment">! h2o path length</span></div>
<div class="line"><a id="l01078" name="l01078"></a><span class="lineno"> 1078</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: up2(pcols)           <span class="comment">! pressure squared h2o path length</span></div>
<div class="line"><a id="l01079" name="l01079"></a><span class="lineno"> 1079</span><span class="comment">!</span></div>
<div class="line"><a id="l01080" name="l01080"></a><span class="lineno"> 1080</span>   <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: k                 <span class="comment">! level index</span></div>
<div class="line"><a id="l01081" name="l01081"></a><span class="lineno"> 1081</span> </div>
<div class="line"><a id="l01082" name="l01082"></a><span class="lineno"> 1082</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: aer_trn_ttl(pcols,pverp,pverp,bnd_nbr_LW) <span class="comment">! aer trn.</span></div>
<div class="line"><a id="l01083" name="l01083"></a><span class="lineno"> 1083</span> </div>
<div class="line"><a id="l01084" name="l01084"></a><span class="lineno"> 1084</span><span class="comment">!</span></div>
<div class="line"><a id="l01085" name="l01085"></a><span class="lineno"> 1085</span><span class="comment">!  Output Arguments</span></div>
<div class="line"><a id="l01086" name="l01086"></a><span class="lineno"> 1086</span><span class="comment">!</span></div>
<div class="line"><a id="l01087" name="l01087"></a><span class="lineno"> 1087</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(out)</span> :: emstrc(pcols,pverp)  <span class="comment">! total trace gas emissivity</span></div>
<div class="line"><a id="l01088" name="l01088"></a><span class="lineno"> 1088</span> </div>
<div class="line"><a id="l01089" name="l01089"></a><span class="lineno"> 1089</span><span class="comment">!</span></div>
<div class="line"><a id="l01090" name="l01090"></a><span class="lineno"> 1090</span><span class="comment">!--------------------------Local Variables------------------------------</span></div>
<div class="line"><a id="l01091" name="l01091"></a><span class="lineno"> 1091</span><span class="comment">!</span></div>
<div class="line"><a id="l01092" name="l01092"></a><span class="lineno"> 1092</span>   <span class="keywordtype">integer</span> i,l               <span class="comment">! loop counters</span></div>
<div class="line"><a id="l01093" name="l01093"></a><span class="lineno"> 1093</span><span class="comment">!</span></div>
<div class="line"><a id="l01094" name="l01094"></a><span class="lineno"> 1094</span><span class="keywordtype">   real</span>(r8) sqti(pcols)          <span class="comment">! square root of mean temp</span></div>
<div class="line"><a id="l01095" name="l01095"></a><span class="lineno"> 1095</span><span class="keywordtype">   real</span>(r8) ecfc1                <span class="comment">! emissivity of cfc11 798 cm-1 band</span></div>
<div class="line"><a id="l01096" name="l01096"></a><span class="lineno"> 1096</span><span class="keywordtype">   real</span>(r8) ecfc2                <span class="comment">!     &quot;      &quot;    &quot;   846 cm-1 band</span></div>
<div class="line"><a id="l01097" name="l01097"></a><span class="lineno"> 1097</span><span class="keywordtype">   real</span>(r8) ecfc3                <span class="comment">!     &quot;      &quot;    &quot;   933 cm-1 band</span></div>
<div class="line"><a id="l01098" name="l01098"></a><span class="lineno"> 1098</span><span class="keywordtype">   real</span>(r8) ecfc4                <span class="comment">!     &quot;      &quot;    &quot;   1085 cm-1 band</span></div>
<div class="line"><a id="l01099" name="l01099"></a><span class="lineno"> 1099</span><span class="comment">!</span></div>
<div class="line"><a id="l01100" name="l01100"></a><span class="lineno"> 1100</span><span class="keywordtype">   real</span>(r8) ecfc5                <span class="comment">!     &quot;      &quot;  cfc12 889 cm-1 band</span></div>
<div class="line"><a id="l01101" name="l01101"></a><span class="lineno"> 1101</span><span class="keywordtype">   real</span>(r8) ecfc6                <span class="comment">!     &quot;      &quot;    &quot;   923 cm-1 band</span></div>
<div class="line"><a id="l01102" name="l01102"></a><span class="lineno"> 1102</span><span class="keywordtype">   real</span>(r8) ecfc7                <span class="comment">!     &quot;      &quot;    &quot;   1102 cm-1 band</span></div>
<div class="line"><a id="l01103" name="l01103"></a><span class="lineno"> 1103</span><span class="keywordtype">   real</span>(r8) ecfc8                <span class="comment">!     &quot;      &quot;    &quot;   1161 cm-1 band</span></div>
<div class="line"><a id="l01104" name="l01104"></a><span class="lineno"> 1104</span><span class="keywordtype">   real</span>(r8) u01                  <span class="comment">! n2o path length</span></div>
<div class="line"><a id="l01105" name="l01105"></a><span class="lineno"> 1105</span><span class="comment">!</span></div>
<div class="line"><a id="l01106" name="l01106"></a><span class="lineno"> 1106</span><span class="keywordtype">   real</span>(r8) u11                  <span class="comment">! n2o path length</span></div>
<div class="line"><a id="l01107" name="l01107"></a><span class="lineno"> 1107</span><span class="keywordtype">   real</span>(r8) beta01               <span class="comment">! n2o pressure factor</span></div>
<div class="line"><a id="l01108" name="l01108"></a><span class="lineno"> 1108</span><span class="keywordtype">   real</span>(r8) beta11               <span class="comment">! n2o pressure factor</span></div>
<div class="line"><a id="l01109" name="l01109"></a><span class="lineno"> 1109</span><span class="keywordtype">   real</span>(r8) en2o1                <span class="comment">! emissivity of the 1285 cm-1 N2O band</span></div>
<div class="line"><a id="l01110" name="l01110"></a><span class="lineno"> 1110</span><span class="keywordtype">   real</span>(r8) u02                  <span class="comment">! n2o path length</span></div>
<div class="line"><a id="l01111" name="l01111"></a><span class="lineno"> 1111</span><span class="comment">!</span></div>
<div class="line"><a id="l01112" name="l01112"></a><span class="lineno"> 1112</span><span class="keywordtype">   real</span>(r8) u12                  <span class="comment">! n2o path length</span></div>
<div class="line"><a id="l01113" name="l01113"></a><span class="lineno"> 1113</span><span class="keywordtype">   real</span>(r8) beta02               <span class="comment">! n2o pressure factor</span></div>
<div class="line"><a id="l01114" name="l01114"></a><span class="lineno"> 1114</span><span class="keywordtype">   real</span>(r8) en2o2                <span class="comment">! emissivity of the 589 cm-1 N2O band</span></div>
<div class="line"><a id="l01115" name="l01115"></a><span class="lineno"> 1115</span><span class="keywordtype">   real</span>(r8) u03                  <span class="comment">! n2o path length</span></div>
<div class="line"><a id="l01116" name="l01116"></a><span class="lineno"> 1116</span><span class="keywordtype">   real</span>(r8) beta03               <span class="comment">! n2o pressure factor</span></div>
<div class="line"><a id="l01117" name="l01117"></a><span class="lineno"> 1117</span><span class="comment">!</span></div>
<div class="line"><a id="l01118" name="l01118"></a><span class="lineno"> 1118</span><span class="keywordtype">   real</span>(r8) en2o3                <span class="comment">! emissivity of the 1168 cm-1 N2O band</span></div>
<div class="line"><a id="l01119" name="l01119"></a><span class="lineno"> 1119</span><span class="keywordtype">   real</span>(r8) betac                <span class="comment">! ch4 pressure factor</span></div>
<div class="line"><a id="l01120" name="l01120"></a><span class="lineno"> 1120</span><span class="keywordtype">   real</span>(r8) ech4                 <span class="comment">! emissivity of 1306 cm-1 CH4 band</span></div>
<div class="line"><a id="l01121" name="l01121"></a><span class="lineno"> 1121</span><span class="keywordtype">   real</span>(r8) betac1               <span class="comment">! co2 pressure factor</span></div>
<div class="line"><a id="l01122" name="l01122"></a><span class="lineno"> 1122</span><span class="keywordtype">   real</span>(r8) betac2               <span class="comment">! co2 pressure factor</span></div>
<div class="line"><a id="l01123" name="l01123"></a><span class="lineno"> 1123</span><span class="comment">!</span></div>
<div class="line"><a id="l01124" name="l01124"></a><span class="lineno"> 1124</span><span class="keywordtype">   real</span>(r8) eco21                <span class="comment">! emissivity of 1064 cm-1 CO2 band</span></div>
<div class="line"><a id="l01125" name="l01125"></a><span class="lineno"> 1125</span><span class="keywordtype">   real</span>(r8) eco22                <span class="comment">! emissivity of 961 cm-1 CO2 band</span></div>
<div class="line"><a id="l01126" name="l01126"></a><span class="lineno"> 1126</span><span class="keywordtype">   real</span>(r8) tt(pcols)            <span class="comment">! temp. factor for h2o overlap factor</span></div>
<div class="line"><a id="l01127" name="l01127"></a><span class="lineno"> 1127</span><span class="keywordtype">   real</span>(r8) psi1                 <span class="comment">! narrow band h2o temp. factor</span></div>
<div class="line"><a id="l01128" name="l01128"></a><span class="lineno"> 1128</span><span class="keywordtype">   real</span>(r8) phi1                 <span class="comment">!             &quot;</span></div>
<div class="line"><a id="l01129" name="l01129"></a><span class="lineno"> 1129</span><span class="comment">!</span></div>
<div class="line"><a id="l01130" name="l01130"></a><span class="lineno"> 1130</span><span class="keywordtype">   real</span>(r8) p1                   <span class="comment">! h2o line overlap factor</span></div>
<div class="line"><a id="l01131" name="l01131"></a><span class="lineno"> 1131</span><span class="keywordtype">   real</span>(r8) w1                   <span class="comment">!          &quot;</span></div>
<div class="line"><a id="l01132" name="l01132"></a><span class="lineno"> 1132</span><span class="keywordtype">   real</span>(r8) tw(pcols,6)          <span class="comment">! h2o transmission overlap</span></div>
<div class="line"><a id="l01133" name="l01133"></a><span class="lineno"> 1133</span><span class="keywordtype">   real</span>(r8) g1(6)                <span class="comment">! h2o overlap factor</span></div>
<div class="line"><a id="l01134" name="l01134"></a><span class="lineno"> 1134</span><span class="keywordtype">   real</span>(r8) g2(6)                <span class="comment">!          &quot;</span></div>
<div class="line"><a id="l01135" name="l01135"></a><span class="lineno"> 1135</span><span class="comment">!</span></div>
<div class="line"><a id="l01136" name="l01136"></a><span class="lineno"> 1136</span><span class="keywordtype">   real</span>(r8) g3(6)                <span class="comment">!          &quot;</span></div>
<div class="line"><a id="l01137" name="l01137"></a><span class="lineno"> 1137</span><span class="keywordtype">   real</span>(r8) g4(6)                <span class="comment">!          &quot;</span></div>
<div class="line"><a id="l01138" name="l01138"></a><span class="lineno"> 1138</span><span class="keywordtype">   real</span>(r8) ab(6)                <span class="comment">!          &quot;</span></div>
<div class="line"><a id="l01139" name="l01139"></a><span class="lineno"> 1139</span><span class="keywordtype">   real</span>(r8) bb(6)                <span class="comment">!          &quot;</span></div>
<div class="line"><a id="l01140" name="l01140"></a><span class="lineno"> 1140</span><span class="keywordtype">   real</span>(r8) abp(6)               <span class="comment">!          &quot;</span></div>
<div class="line"><a id="l01141" name="l01141"></a><span class="lineno"> 1141</span><span class="comment">!</span></div>
<div class="line"><a id="l01142" name="l01142"></a><span class="lineno"> 1142</span><span class="keywordtype">   real</span>(r8) bbp(6)               <span class="comment">!          &quot;</span></div>
<div class="line"><a id="l01143" name="l01143"></a><span class="lineno"> 1143</span><span class="keywordtype">   real</span>(r8) tcfc3                <span class="comment">! transmission for cfc11 band</span></div>
<div class="line"><a id="l01144" name="l01144"></a><span class="lineno"> 1144</span><span class="keywordtype">   real</span>(r8) tcfc4                <span class="comment">!          &quot;</span></div>
<div class="line"><a id="l01145" name="l01145"></a><span class="lineno"> 1145</span><span class="keywordtype">   real</span>(r8) tcfc6                <span class="comment">! transmission for cfc12 band</span></div>
<div class="line"><a id="l01146" name="l01146"></a><span class="lineno"> 1146</span><span class="keywordtype">   real</span>(r8) tcfc7                <span class="comment">!          &quot;</span></div>
<div class="line"><a id="l01147" name="l01147"></a><span class="lineno"> 1147</span><span class="comment">!</span></div>
<div class="line"><a id="l01148" name="l01148"></a><span class="lineno"> 1148</span><span class="keywordtype">   real</span>(r8) tcfc8                <span class="comment">!          &quot;</span></div>
<div class="line"><a id="l01149" name="l01149"></a><span class="lineno"> 1149</span><span class="keywordtype">   real</span>(r8) tlw                  <span class="comment">! h2o overlap factor</span></div>
<div class="line"><a id="l01150" name="l01150"></a><span class="lineno"> 1150</span><span class="keywordtype">   real</span>(r8) tch4                 <span class="comment">! ch4 overlap factor</span></div>
<div class="line"><a id="l01151" name="l01151"></a><span class="lineno"> 1151</span><span class="comment">!</span></div>
<div class="line"><a id="l01152" name="l01152"></a><span class="lineno"> 1152</span><span class="comment">!--------------------------Data Statements------------------------------</span></div>
<div class="line"><a id="l01153" name="l01153"></a><span class="lineno"> 1153</span><span class="comment">!</span></div>
<div class="line"><a id="l01154" name="l01154"></a><span class="lineno"> 1154</span>   <span class="keyword">data</span> g1 /0.0468556,0.0397454,0.0407664,0.0304380,0.0540398,0.0321962/</div>
<div class="line"><a id="l01155" name="l01155"></a><span class="lineno"> 1155</span>   <span class="keyword">data</span> g2 /14.4832,4.30242,5.23523,3.25342,0.698935,16.5599/</div>
<div class="line"><a id="l01156" name="l01156"></a><span class="lineno"> 1156</span>   <span class="keyword">data</span> g3 /26.1898,18.4476,15.3633,12.1927,9.14992,8.07092/</div>
<div class="line"><a id="l01157" name="l01157"></a><span class="lineno"> 1157</span>   <span class="keyword">data</span> g4 /0.0261782,0.0369516,0.0307266,0.0243854,0.0182932,0.0161418/</div>
<div class="line"><a id="l01158" name="l01158"></a><span class="lineno"> 1158</span>   <span class="keyword">data</span> ab /3.0857e-2,2.3524e-2,1.7310e-2,2.6661e-2,2.8074e-2,2.2915e-2/</div>
<div class="line"><a id="l01159" name="l01159"></a><span class="lineno"> 1159</span>   <span class="keyword">data</span> bb /-1.3512e-4,-6.8320e-5,-3.2609e-5,-1.0228e-5,-9.5743e-5,-1.0304e-4/</div>
<div class="line"><a id="l01160" name="l01160"></a><span class="lineno"> 1160</span>   <span class="keyword">data</span> abp/2.9129e-2,2.4101e-2,1.9821e-2,2.6904e-2,2.9458e-2,1.9892e-2/</div>
<div class="line"><a id="l01161" name="l01161"></a><span class="lineno"> 1161</span>   <span class="keyword">data</span> bbp/-1.3139e-4,-5.5688e-5,-4.6380e-5,-8.0362e-5,-1.0115e-4,-8.8061e-5/</div>
<div class="line"><a id="l01162" name="l01162"></a><span class="lineno"> 1162</span><span class="comment">!</span></div>
<div class="line"><a id="l01163" name="l01163"></a><span class="lineno"> 1163</span><span class="comment">!--------------------------Statement Functions--------------------------</span></div>
<div class="line"><a id="l01164" name="l01164"></a><span class="lineno"> 1164</span><span class="comment">!</span></div>
<div class="line"><a id="l01165" name="l01165"></a><span class="lineno"> 1165</span><span class="keywordtype">   real</span>(r8) func, u, b</div>
<div class="line"><a id="l01166" name="l01166"></a><span class="lineno"> 1166</span>   func(u,b) = u/sqrt(4.0 + u*(1.0 + 1.0 / b))</div>
<div class="line"><a id="l01167" name="l01167"></a><span class="lineno"> 1167</span><span class="comment">!</span></div>
<div class="line"><a id="l01168" name="l01168"></a><span class="lineno"> 1168</span><span class="comment">!-----------------------------------------------------------------------</span></div>
<div class="line"><a id="l01169" name="l01169"></a><span class="lineno"> 1169</span><span class="comment">!</span></div>
<div class="line"><a id="l01170" name="l01170"></a><span class="lineno"> 1170</span>   <span class="keywordflow">do</span> i = 1,ncol</div>
<div class="line"><a id="l01171" name="l01171"></a><span class="lineno"> 1171</span>      sqti(i) = sqrt(co2t(i,k))</div>
<div class="line"><a id="l01172" name="l01172"></a><span class="lineno"> 1172</span><span class="comment">!</span></div>
<div class="line"><a id="l01173" name="l01173"></a><span class="lineno"> 1173</span><span class="comment">! Transmission for h2o</span></div>
<div class="line"><a id="l01174" name="l01174"></a><span class="lineno"> 1174</span><span class="comment">!</span></div>
<div class="line"><a id="l01175" name="l01175"></a><span class="lineno"> 1175</span>      tt(i) = abs(co2t(i,k) - 250.0)</div>
<div class="line"><a id="l01176" name="l01176"></a><span class="lineno"> 1176</span><span class="keywordflow">   end do</span></div>
<div class="line"><a id="l01177" name="l01177"></a><span class="lineno"> 1177</span><span class="comment">!</span></div>
<div class="line"><a id="l01178" name="l01178"></a><span class="lineno"> 1178</span>   <span class="keywordflow">do</span> l = 1,6</div>
<div class="line"><a id="l01179" name="l01179"></a><span class="lineno"> 1179</span>      <span class="keywordflow">do</span> i = 1,ncol</div>
<div class="line"><a id="l01180" name="l01180"></a><span class="lineno"> 1180</span>         psi1 = exp(abp(l)*tt(i)+bbp(l)*tt(i)*tt(i))</div>
<div class="line"><a id="l01181" name="l01181"></a><span class="lineno"> 1181</span>         phi1 = exp(ab(l)*tt(i)+bb(l)*tt(i)*tt(i))</div>
<div class="line"><a id="l01182" name="l01182"></a><span class="lineno"> 1182</span>         p1 = pnm(i,k) * (psi1/phi1) / <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#aedb55b03e1395012ec29e1914a2df7cc">sslp</a></div>
<div class="line"><a id="l01183" name="l01183"></a><span class="lineno"> 1183</span>         w1 = w(i,k) * phi1</div>
<div class="line"><a id="l01184" name="l01184"></a><span class="lineno"> 1184</span>         tw(i,l) = exp(- g1(l)*p1*(sqrt(1.0+g2(l)*(w1/p1))-1.0) &amp;</div>
<div class="line"><a id="l01185" name="l01185"></a><span class="lineno"> 1185</span>                   - g3(l)*s2c(i,k)-g4(l)*uptype(i,k))</div>
<div class="line"><a id="l01186" name="l01186"></a><span class="lineno"> 1186</span><span class="keywordflow">      end do</span></div>
<div class="line"><a id="l01187" name="l01187"></a><span class="lineno"> 1187</span><span class="keywordflow">   end do</span></div>
<div class="line"><a id="l01188" name="l01188"></a><span class="lineno"> 1188</span> </div>
<div class="line"><a id="l01189" name="l01189"></a><span class="lineno"> 1189</span><span class="comment">!     Overlap H2O tranmission with STRAER continuum in 6 trace gas </span></div>
<div class="line"><a id="l01190" name="l01190"></a><span class="lineno"> 1190</span><span class="comment">!                 subbands</span></div>
<div class="line"><a id="l01191" name="l01191"></a><span class="lineno"> 1191</span> </div>
<div class="line"><a id="l01192" name="l01192"></a><span class="lineno"> 1192</span>      <span class="keywordflow">do</span> i=1,ncol</div>
<div class="line"><a id="l01193" name="l01193"></a><span class="lineno"> 1193</span>         tw(i,1)=tw(i,1)*(0.7*aer_trn_ttl(i,k,1,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ae90583401bc762ffcf004ff27792f3ef">idx_lw_0650_0800</a>)+&amp;<span class="comment">! l=1: 0750--0820 cm-1</span></div>
<div class="line"><a id="l01194" name="l01194"></a><span class="lineno"> 1194</span>                          0.3*aer_trn_ttl(i,k,1,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a3641bbffc5b9d01322506476442a962a">idx_lw_0800_1000</a>))</div>
<div class="line"><a id="l01195" name="l01195"></a><span class="lineno"> 1195</span>         tw(i,2)=tw(i,2)*aer_trn_ttl(i,k,1,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a3641bbffc5b9d01322506476442a962a">idx_lw_0800_1000</a>) <span class="comment">! l=2: 0820--0880 cm-1</span></div>
<div class="line"><a id="l01196" name="l01196"></a><span class="lineno"> 1196</span>         tw(i,3)=tw(i,3)*aer_trn_ttl(i,k,1,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a3641bbffc5b9d01322506476442a962a">idx_lw_0800_1000</a>) <span class="comment">! l=3: 0880--0900 cm-1</span></div>
<div class="line"><a id="l01197" name="l01197"></a><span class="lineno"> 1197</span>         tw(i,4)=tw(i,4)*aer_trn_ttl(i,k,1,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a3641bbffc5b9d01322506476442a962a">idx_lw_0800_1000</a>) <span class="comment">! l=4: 0900--1000 cm-1</span></div>
<div class="line"><a id="l01198" name="l01198"></a><span class="lineno"> 1198</span>         tw(i,5)=tw(i,5)*aer_trn_ttl(i,k,1,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a619b4abbc0ae813bf2c8709cef491d8e">idx_lw_1000_1200</a>) <span class="comment">! l=5: 1000--1120 cm-1</span></div>
<div class="line"><a id="l01199" name="l01199"></a><span class="lineno"> 1199</span>         tw(i,6)=tw(i,6)*aer_trn_ttl(i,k,1,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a619b4abbc0ae813bf2c8709cef491d8e">idx_lw_1000_1200</a>) <span class="comment">! l=6: 1120--1170 cm-1</span></div>
<div class="line"><a id="l01200" name="l01200"></a><span class="lineno"> 1200</span><span class="keywordflow">      end do</span>                    <span class="comment">! end loop over lon</span></div>
<div class="line"><a id="l01201" name="l01201"></a><span class="lineno"> 1201</span><span class="comment">!</span></div>
<div class="line"><a id="l01202" name="l01202"></a><span class="lineno"> 1202</span>   <span class="keywordflow">do</span> i = 1,ncol</div>
<div class="line"><a id="l01203" name="l01203"></a><span class="lineno"> 1203</span><span class="comment">!</span></div>
<div class="line"><a id="l01204" name="l01204"></a><span class="lineno"> 1204</span><span class="comment">! transmission due to cfc bands</span></div>
<div class="line"><a id="l01205" name="l01205"></a><span class="lineno"> 1205</span><span class="comment">!</span></div>
<div class="line"><a id="l01206" name="l01206"></a><span class="lineno"> 1206</span>      tcfc3 = exp(-175.005*ucfc11(i,k))</div>
<div class="line"><a id="l01207" name="l01207"></a><span class="lineno"> 1207</span>      tcfc4 = exp(-1202.18*ucfc11(i,k))</div>
<div class="line"><a id="l01208" name="l01208"></a><span class="lineno"> 1208</span>      tcfc6 = exp(-5786.73*ucfc12(i,k))</div>
<div class="line"><a id="l01209" name="l01209"></a><span class="lineno"> 1209</span>      tcfc7 = exp(-2873.51*ucfc12(i,k))</div>
<div class="line"><a id="l01210" name="l01210"></a><span class="lineno"> 1210</span>      tcfc8 = exp(-2085.59*ucfc12(i,k))</div>
<div class="line"><a id="l01211" name="l01211"></a><span class="lineno"> 1211</span><span class="comment">!</span></div>
<div class="line"><a id="l01212" name="l01212"></a><span class="lineno"> 1212</span><span class="comment">! Emissivity for CFC11 bands</span></div>
<div class="line"><a id="l01213" name="l01213"></a><span class="lineno"> 1213</span><span class="comment">!</span></div>
<div class="line"><a id="l01214" name="l01214"></a><span class="lineno"> 1214</span>      ecfc1 = 50.0*(1.0 - exp(-54.09*ucfc11(i,k))) * tw(i,1) * emplnk(7,i)</div>
<div class="line"><a id="l01215" name="l01215"></a><span class="lineno"> 1215</span>      ecfc2 = 60.0*(1.0 - exp(-5130.03*ucfc11(i,k)))* tw(i,2) * emplnk(8,i)</div>
<div class="line"><a id="l01216" name="l01216"></a><span class="lineno"> 1216</span>      ecfc3 = 60.0*(1.0 - tcfc3)*tw(i,4)*tcfc6*emplnk(9,i)</div>
<div class="line"><a id="l01217" name="l01217"></a><span class="lineno"> 1217</span>      ecfc4 = 100.0*(1.0 - tcfc4)*tw(i,5)*emplnk(10,i)</div>
<div class="line"><a id="l01218" name="l01218"></a><span class="lineno"> 1218</span><span class="comment">!</span></div>
<div class="line"><a id="l01219" name="l01219"></a><span class="lineno"> 1219</span><span class="comment">! Emissivity for CFC12 bands</span></div>
<div class="line"><a id="l01220" name="l01220"></a><span class="lineno"> 1220</span><span class="comment">!</span></div>
<div class="line"><a id="l01221" name="l01221"></a><span class="lineno"> 1221</span>      ecfc5 = 45.0*(1.0 - exp(-1272.35*ucfc12(i,k)))*tw(i,3)*emplnk(11,i)</div>
<div class="line"><a id="l01222" name="l01222"></a><span class="lineno"> 1222</span>      ecfc6 = 50.0*(1.0 - tcfc6)*tw(i,4)*emplnk(12,i)</div>
<div class="line"><a id="l01223" name="l01223"></a><span class="lineno"> 1223</span>      ecfc7 = 80.0*(1.0 - tcfc7)*tw(i,5)* tcfc4 * emplnk(13,i)</div>
<div class="line"><a id="l01224" name="l01224"></a><span class="lineno"> 1224</span>      ecfc8 = 70.0*(1.0 - tcfc8)*tw(i,6) * emplnk(14,i)</div>
<div class="line"><a id="l01225" name="l01225"></a><span class="lineno"> 1225</span><span class="comment">!</span></div>
<div class="line"><a id="l01226" name="l01226"></a><span class="lineno"> 1226</span><span class="comment">! Emissivity for CH4 band 1306 cm-1</span></div>
<div class="line"><a id="l01227" name="l01227"></a><span class="lineno"> 1227</span><span class="comment">!</span></div>
<div class="line"><a id="l01228" name="l01228"></a><span class="lineno"> 1228</span>      tlw = exp(-1.0*sqrt(up2(i)))</div>
<div class="line"><a id="l01229" name="l01229"></a><span class="lineno"> 1229</span> </div>
<div class="line"><a id="l01230" name="l01230"></a><span class="lineno"> 1230</span><span class="comment">!     Overlap H2O vibration rotation band with STRAER continuum </span></div>
<div class="line"><a id="l01231" name="l01231"></a><span class="lineno"> 1231</span><span class="comment">!             for CH4 1306 cm-1 and N2O 1285 cm-1 bands</span></div>
<div class="line"><a id="l01232" name="l01232"></a><span class="lineno"> 1232</span> </div>
<div class="line"><a id="l01233" name="l01233"></a><span class="lineno"> 1233</span>            tlw=tlw*aer_trn_ttl(i,k,1,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ab20c3561d003d8e16f6984f564247561">idx_lw_1200_2000</a>)</div>
<div class="line"><a id="l01234" name="l01234"></a><span class="lineno"> 1234</span>      betac = bch4(i,k)/uch4(i,k)</div>
<div class="line"><a id="l01235" name="l01235"></a><span class="lineno"> 1235</span>      ech4 = 6.00444*sqti(i)*log(1.0 + func(uch4(i,k),betac)) *tlw * emplnk(3,i)</div>
<div class="line"><a id="l01236" name="l01236"></a><span class="lineno"> 1236</span>      tch4 = 1.0/(1.0 + 0.02*func(uch4(i,k),betac))</div>
<div class="line"><a id="l01237" name="l01237"></a><span class="lineno"> 1237</span><span class="comment">!</span></div>
<div class="line"><a id="l01238" name="l01238"></a><span class="lineno"> 1238</span><span class="comment">! Emissivity for N2O bands</span></div>
<div class="line"><a id="l01239" name="l01239"></a><span class="lineno"> 1239</span><span class="comment">!</span></div>
<div class="line"><a id="l01240" name="l01240"></a><span class="lineno"> 1240</span>      u01 = un2o0(i,k)</div>
<div class="line"><a id="l01241" name="l01241"></a><span class="lineno"> 1241</span>      u11 = un2o1(i,k)</div>
<div class="line"><a id="l01242" name="l01242"></a><span class="lineno"> 1242</span>      beta01 = bn2o0(i,k)/un2o0(i,k)</div>
<div class="line"><a id="l01243" name="l01243"></a><span class="lineno"> 1243</span>      beta11 = bn2o1(i,k)/un2o1(i,k)</div>
<div class="line"><a id="l01244" name="l01244"></a><span class="lineno"> 1244</span><span class="comment">!</span></div>
<div class="line"><a id="l01245" name="l01245"></a><span class="lineno"> 1245</span><span class="comment">! 1285 cm-1 band</span></div>
<div class="line"><a id="l01246" name="l01246"></a><span class="lineno"> 1246</span><span class="comment">!</span></div>
<div class="line"><a id="l01247" name="l01247"></a><span class="lineno"> 1247</span>      en2o1 = 2.35558*sqti(i)*log(1.0 + func(u01,beta01) + &amp;</div>
<div class="line"><a id="l01248" name="l01248"></a><span class="lineno"> 1248</span>              func(u11,beta11))*tlw*tch4*emplnk(4,i)</div>
<div class="line"><a id="l01249" name="l01249"></a><span class="lineno"> 1249</span>      u02 = 0.100090*u01</div>
<div class="line"><a id="l01250" name="l01250"></a><span class="lineno"> 1250</span>      u12 = 0.0992746*u11</div>
<div class="line"><a id="l01251" name="l01251"></a><span class="lineno"> 1251</span>      beta02 = 0.964282*beta01</div>
<div class="line"><a id="l01252" name="l01252"></a><span class="lineno"> 1252</span><span class="comment">!</span></div>
<div class="line"><a id="l01253" name="l01253"></a><span class="lineno"> 1253</span><span class="comment">! 589 cm-1 band</span></div>
<div class="line"><a id="l01254" name="l01254"></a><span class="lineno"> 1254</span><span class="comment">!</span></div>
<div class="line"><a id="l01255" name="l01255"></a><span class="lineno"> 1255</span>      en2o2 = 2.65581*sqti(i)*log(1.0 + func(u02,beta02) + &amp;</div>
<div class="line"><a id="l01256" name="l01256"></a><span class="lineno"> 1256</span>              func(u12,beta02)) * tco2(i) * th2o(i) * emplnk(5,i)</div>
<div class="line"><a id="l01257" name="l01257"></a><span class="lineno"> 1257</span>      u03 = 0.0333767*u01</div>
<div class="line"><a id="l01258" name="l01258"></a><span class="lineno"> 1258</span>      beta03 = 0.982143*beta01</div>
<div class="line"><a id="l01259" name="l01259"></a><span class="lineno"> 1259</span><span class="comment">!</span></div>
<div class="line"><a id="l01260" name="l01260"></a><span class="lineno"> 1260</span><span class="comment">! 1168 cm-1 band</span></div>
<div class="line"><a id="l01261" name="l01261"></a><span class="lineno"> 1261</span><span class="comment">!</span></div>
<div class="line"><a id="l01262" name="l01262"></a><span class="lineno"> 1262</span>      en2o3 = 2.54034*sqti(i)*log(1.0 + func(u03,beta03)) * &amp;</div>
<div class="line"><a id="l01263" name="l01263"></a><span class="lineno"> 1263</span>              tw(i,6) * tcfc8 * emplnk(6,i)</div>
<div class="line"><a id="l01264" name="l01264"></a><span class="lineno"> 1264</span><span class="comment">!</span></div>
<div class="line"><a id="l01265" name="l01265"></a><span class="lineno"> 1265</span><span class="comment">! Emissivity for 1064 cm-1 band of CO2</span></div>
<div class="line"><a id="l01266" name="l01266"></a><span class="lineno"> 1266</span><span class="comment">!</span></div>
<div class="line"><a id="l01267" name="l01267"></a><span class="lineno"> 1267</span>      betac1 = 2.97558*pnm(i,k) / (<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#aedb55b03e1395012ec29e1914a2df7cc">sslp</a>*sqti(i))</div>
<div class="line"><a id="l01268" name="l01268"></a><span class="lineno"> 1268</span>      betac2 = 2.0 * betac1</div>
<div class="line"><a id="l01269" name="l01269"></a><span class="lineno"> 1269</span>      eco21 = 3.7571*sqti(i)*log(1.0 + func(uco211(i,k),betac1) &amp;</div>
<div class="line"><a id="l01270" name="l01270"></a><span class="lineno"> 1270</span>              + func(uco212(i,k),betac2) + func(uco213(i,k),betac2)) &amp;</div>
<div class="line"><a id="l01271" name="l01271"></a><span class="lineno"> 1271</span>              * to3(i) * tw(i,5) * tcfc4 * tcfc7 * emplnk(2,i)</div>
<div class="line"><a id="l01272" name="l01272"></a><span class="lineno"> 1272</span><span class="comment">!</span></div>
<div class="line"><a id="l01273" name="l01273"></a><span class="lineno"> 1273</span><span class="comment">! Emissivity for 961 cm-1 band</span></div>
<div class="line"><a id="l01274" name="l01274"></a><span class="lineno"> 1274</span><span class="comment">!</span></div>
<div class="line"><a id="l01275" name="l01275"></a><span class="lineno"> 1275</span>      eco22 = 3.8443*sqti(i)*log(1.0 + func(uco221(i,k),betac1) &amp;</div>
<div class="line"><a id="l01276" name="l01276"></a><span class="lineno"> 1276</span>              + func(uco222(i,k),betac1) + func(uco223(i,k),betac2)) &amp;</div>
<div class="line"><a id="l01277" name="l01277"></a><span class="lineno"> 1277</span>              * tw(i,4) * tcfc3 * tcfc6 * emplnk(1,i)</div>
<div class="line"><a id="l01278" name="l01278"></a><span class="lineno"> 1278</span><span class="comment">!</span></div>
<div class="line"><a id="l01279" name="l01279"></a><span class="lineno"> 1279</span><span class="comment">! total trace gas emissivity</span></div>
<div class="line"><a id="l01280" name="l01280"></a><span class="lineno"> 1280</span><span class="comment">!</span></div>
<div class="line"><a id="l01281" name="l01281"></a><span class="lineno"> 1281</span>      emstrc(i,k) = ecfc1 + ecfc2 + ecfc3 + ecfc4 + ecfc5 +ecfc6 + &amp;</div>
<div class="line"><a id="l01282" name="l01282"></a><span class="lineno"> 1282</span>                    ecfc7 + ecfc8 + en2o1 + en2o2 + en2o3 + ech4 + &amp;</div>
<div class="line"><a id="l01283" name="l01283"></a><span class="lineno"> 1283</span>                    eco21 + eco22</div>
<div class="line"><a id="l01284" name="l01284"></a><span class="lineno"> 1284</span><span class="keywordflow">   end do</span></div>
<div class="line"><a id="l01285" name="l01285"></a><span class="lineno"> 1285</span><span class="comment">!</span></div>
<div class="line"><a id="l01286" name="l01286"></a><span class="lineno"> 1286</span>   <span class="keywordflow">return</span></div>
<div class="line"><a id="l01287" name="l01287"></a><span class="lineno"> 1287</span><span class="comment">!</span></div>
<div class="line"><a id="l01288" name="l01288"></a><span class="lineno"> 1288</span><span class="keyword">end subroutine </span><a class="code hl_function" href="namespacemodule__ra__cam__support.html#a77341b9c752243caedf506fd54162e1c">trcems</a></div>
<div class="line"><a id="l01289" name="l01289"></a><span class="lineno"> 1289</span> </div>
<div class="line"><a id="l01290" name="l01290"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a0bdd4bd6e389e15e2c8f955f8b37870a"> 1290</a></span><span class="keyword">subroutine </span><a class="code hl_function" href="namespacemodule__ra__cam__support.html#a0bdd4bd6e389e15e2c8f955f8b37870a">trcmix</a>(lchnk   ,ncol     ,pcols, pver, &amp;</div>
<div class="line"><a id="l01291" name="l01291"></a><span class="lineno"> 1291</span>                  pmid    ,clat, n2o      ,ch4     ,          &amp;</div>
<div class="line"><a id="l01292" name="l01292"></a><span class="lineno"> 1292</span>                  cfc11   , cfc12   )</div>
<div class="line"><a id="l01293" name="l01293"></a><span class="lineno"> 1293</span><span class="comment">!----------------------------------------------------------------------- </span></div>
<div class="line"><a id="l01294" name="l01294"></a><span class="lineno"> 1294</span><span class="comment">! </span></div>
<div class="line"><a id="l01295" name="l01295"></a><span class="lineno"> 1295</span><span class="comment">! Purpose: </span></div>
<div class="line"><a id="l01296" name="l01296"></a><span class="lineno"> 1296</span><span class="comment">! Specify zonal mean mass mixing ratios of CH4, N2O, CFC11 and</span></div>
<div class="line"><a id="l01297" name="l01297"></a><span class="lineno"> 1297</span><span class="comment">! CFC12</span></div>
<div class="line"><a id="l01298" name="l01298"></a><span class="lineno"> 1298</span><span class="comment">! </span></div>
<div class="line"><a id="l01299" name="l01299"></a><span class="lineno"> 1299</span><span class="comment">! Method: </span></div>
<div class="line"><a id="l01300" name="l01300"></a><span class="lineno"> 1300</span><span class="comment">! Distributions assume constant mixing ratio in the troposphere</span></div>
<div class="line"><a id="l01301" name="l01301"></a><span class="lineno"> 1301</span><span class="comment">! and a decrease of mixing ratio in the stratosphere. Tropopause</span></div>
<div class="line"><a id="l01302" name="l01302"></a><span class="lineno"> 1302</span><span class="comment">! defined by ptrop. The scale height of the particular trace gas</span></div>
<div class="line"><a id="l01303" name="l01303"></a><span class="lineno"> 1303</span><span class="comment">! depends on latitude. This assumption produces a more realistic</span></div>
<div class="line"><a id="l01304" name="l01304"></a><span class="lineno"> 1304</span><span class="comment">! stratospheric distribution of the various trace gases.</span></div>
<div class="line"><a id="l01305" name="l01305"></a><span class="lineno"> 1305</span><span class="comment">! </span></div>
<div class="line"><a id="l01306" name="l01306"></a><span class="lineno"> 1306</span><span class="comment">! Author: J. Kiehl</span></div>
<div class="line"><a id="l01307" name="l01307"></a><span class="lineno"> 1307</span><span class="comment">! </span></div>
<div class="line"><a id="l01308" name="l01308"></a><span class="lineno"> 1308</span><span class="comment">!-----------------------------------------------------------------------</span></div>
<div class="line"><a id="l01309" name="l01309"></a><span class="lineno"> 1309</span><span class="comment">!  use shr_kind_mod, only: r8 =&gt; shr_kind_r8</span></div>
<div class="line"><a id="l01310" name="l01310"></a><span class="lineno"> 1310</span><span class="comment">!  use ppgrid</span></div>
<div class="line"><a id="l01311" name="l01311"></a><span class="lineno"> 1311</span><span class="comment">!  use phys_grid,    only: get_rlat_all_p</span></div>
<div class="line"><a id="l01312" name="l01312"></a><span class="lineno"> 1312</span><span class="comment">!  use physconst,    only: mwdry, mwch4, mwn2o, mwf11, mwf12</span></div>
<div class="line"><a id="l01313" name="l01313"></a><span class="lineno"> 1313</span><span class="comment">!  use ghg_surfvals, only: ch4vmr, n2ovmr, f11vmr, f12vmr</span></div>
<div class="line"><a id="l01314" name="l01314"></a><span class="lineno"> 1314</span> </div>
<div class="line"><a id="l01315" name="l01315"></a><span class="lineno"> 1315</span>   <span class="keywordtype">implicit none</span></div>
<div class="line"><a id="l01316" name="l01316"></a><span class="lineno"> 1316</span> </div>
<div class="line"><a id="l01317" name="l01317"></a><span class="lineno"> 1317</span><span class="comment">!-----------------------------Arguments---------------------------------</span></div>
<div class="line"><a id="l01318" name="l01318"></a><span class="lineno"> 1318</span><span class="comment">!</span></div>
<div class="line"><a id="l01319" name="l01319"></a><span class="lineno"> 1319</span><span class="comment">! Input</span></div>
<div class="line"><a id="l01320" name="l01320"></a><span class="lineno"> 1320</span><span class="comment">!</span></div>
<div class="line"><a id="l01321" name="l01321"></a><span class="lineno"> 1321</span>   <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: lchnk                    <span class="comment">! chunk identifier</span></div>
<div class="line"><a id="l01322" name="l01322"></a><span class="lineno"> 1322</span>   <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: ncol                     <span class="comment">! number of atmospheric columns</span></div>
<div class="line"><a id="l01323" name="l01323"></a><span class="lineno"> 1323</span>   <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: pcols, pver</div>
<div class="line"><a id="l01324" name="l01324"></a><span class="lineno"> 1324</span> </div>
<div class="line"><a id="l01325" name="l01325"></a><span class="lineno"> 1325</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: pmid(pcols,pver)        <span class="comment">! model pressures</span></div>
<div class="line"><a id="l01326" name="l01326"></a><span class="lineno"> 1326</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: clat(pcols)             <span class="comment">! latitude in radians for columns</span></div>
<div class="line"><a id="l01327" name="l01327"></a><span class="lineno"> 1327</span><span class="comment">!</span></div>
<div class="line"><a id="l01328" name="l01328"></a><span class="lineno"> 1328</span><span class="comment">! Output</span></div>
<div class="line"><a id="l01329" name="l01329"></a><span class="lineno"> 1329</span><span class="comment">!</span></div>
<div class="line"><a id="l01330" name="l01330"></a><span class="lineno"> 1330</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(out)</span> :: n2o(pcols,pver)         <span class="comment">! nitrous oxide mass mixing ratio</span></div>
<div class="line"><a id="l01331" name="l01331"></a><span class="lineno"> 1331</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(out)</span> :: ch4(pcols,pver)         <span class="comment">! methane mass mixing ratio</span></div>
<div class="line"><a id="l01332" name="l01332"></a><span class="lineno"> 1332</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(out)</span> :: cfc11(pcols,pver)       <span class="comment">! cfc11 mass mixing ratio</span></div>
<div class="line"><a id="l01333" name="l01333"></a><span class="lineno"> 1333</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(out)</span> :: cfc12(pcols,pver)       <span class="comment">! cfc12 mass mixing ratio</span></div>
<div class="line"><a id="l01334" name="l01334"></a><span class="lineno"> 1334</span> </div>
<div class="line"><a id="l01335" name="l01335"></a><span class="lineno"> 1335</span><span class="comment">!</span></div>
<div class="line"><a id="l01336" name="l01336"></a><span class="lineno"> 1336</span><span class="comment">!--------------------------Local Variables------------------------------</span></div>
<div class="line"><a id="l01337" name="l01337"></a><span class="lineno"> 1337</span> </div>
<div class="line"><a id="l01338" name="l01338"></a><span class="lineno"> 1338</span><span class="keywordtype">   real</span>(r8) :: rmwn2o       <span class="comment">! ratio of molecular weight n2o   to dry air</span></div>
<div class="line"><a id="l01339" name="l01339"></a><span class="lineno"> 1339</span><span class="keywordtype">   real</span>(r8) :: rmwch4       <span class="comment">! ratio of molecular weight ch4   to dry air</span></div>
<div class="line"><a id="l01340" name="l01340"></a><span class="lineno"> 1340</span><span class="keywordtype">   real</span>(r8) :: rmwf11       <span class="comment">! ratio of molecular weight cfc11 to dry air</span></div>
<div class="line"><a id="l01341" name="l01341"></a><span class="lineno"> 1341</span><span class="keywordtype">   real</span>(r8) :: rmwf12       <span class="comment">! ratio of molecular weight cfc12 to dry air</span></div>
<div class="line"><a id="l01342" name="l01342"></a><span class="lineno"> 1342</span><span class="comment">!</span></div>
<div class="line"><a id="l01343" name="l01343"></a><span class="lineno"> 1343</span>   <span class="keywordtype">integer</span> i                <span class="comment">! longitude loop index</span></div>
<div class="line"><a id="l01344" name="l01344"></a><span class="lineno"> 1344</span>   <span class="keywordtype">integer</span> k                <span class="comment">! level index</span></div>
<div class="line"><a id="l01345" name="l01345"></a><span class="lineno"> 1345</span><span class="comment">!</span></div>
<div class="line"><a id="l01346" name="l01346"></a><span class="lineno"> 1346</span><span class="comment">!  real(r8) clat(pcols)         ! latitude in radians for columns</span></div>
<div class="line"><a id="l01347" name="l01347"></a><span class="lineno"> 1347</span><span class="keywordtype">   real</span>(r8) coslat(pcols)       <span class="comment">! cosine of latitude</span></div>
<div class="line"><a id="l01348" name="l01348"></a><span class="lineno"> 1348</span><span class="keywordtype">   real</span>(r8) dlat                <span class="comment">! latitude in degrees</span></div>
<div class="line"><a id="l01349" name="l01349"></a><span class="lineno"> 1349</span><span class="keywordtype">   real</span>(r8) ptrop               <span class="comment">! pressure level of tropopause</span></div>
<div class="line"><a id="l01350" name="l01350"></a><span class="lineno"> 1350</span><span class="keywordtype">   real</span>(r8) pratio              <span class="comment">! pressure divided by ptrop</span></div>
<div class="line"><a id="l01351" name="l01351"></a><span class="lineno"> 1351</span><span class="comment">!</span></div>
<div class="line"><a id="l01352" name="l01352"></a><span class="lineno"> 1352</span><span class="keywordtype">   real</span>(r8) xn2o                <span class="comment">! pressure scale height for n2o</span></div>
<div class="line"><a id="l01353" name="l01353"></a><span class="lineno"> 1353</span><span class="keywordtype">   real</span>(r8) xch4                <span class="comment">! pressure scale height for ch4</span></div>
<div class="line"><a id="l01354" name="l01354"></a><span class="lineno"> 1354</span><span class="keywordtype">   real</span>(r8) xcfc11              <span class="comment">! pressure scale height for cfc11</span></div>
<div class="line"><a id="l01355" name="l01355"></a><span class="lineno"> 1355</span><span class="keywordtype">   real</span>(r8) xcfc12              <span class="comment">! pressure scale height for cfc12</span></div>
<div class="line"><a id="l01356" name="l01356"></a><span class="lineno"> 1356</span><span class="comment">!</span></div>
<div class="line"><a id="l01357" name="l01357"></a><span class="lineno"> 1357</span><span class="keywordtype">   real</span>(r8) ch40                <span class="comment">! tropospheric mass mixing ratio for ch4</span></div>
<div class="line"><a id="l01358" name="l01358"></a><span class="lineno"> 1358</span><span class="keywordtype">   real</span>(r8) n2o0                <span class="comment">! tropospheric mass mixing ratio for n2o</span></div>
<div class="line"><a id="l01359" name="l01359"></a><span class="lineno"> 1359</span><span class="keywordtype">   real</span>(r8) cfc110              <span class="comment">! tropospheric mass mixing ratio for cfc11</span></div>
<div class="line"><a id="l01360" name="l01360"></a><span class="lineno"> 1360</span><span class="keywordtype">   real</span>(r8) cfc120              <span class="comment">! tropospheric mass mixing ratio for cfc12</span></div>
<div class="line"><a id="l01361" name="l01361"></a><span class="lineno"> 1361</span><span class="comment">!</span></div>
<div class="line"><a id="l01362" name="l01362"></a><span class="lineno"> 1362</span><span class="comment">!-----------------------------------------------------------------------</span></div>
<div class="line"><a id="l01363" name="l01363"></a><span class="lineno"> 1363</span>   rmwn2o = <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#add7004a1eda30f04d0a373345ef26e17">mwn2o</a>/<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a455077c905b075fb0c227ed4d0e73e09">mwdry</a>      <span class="comment">! ratio of molecular weight n2o   to dry air</span></div>
<div class="line"><a id="l01364" name="l01364"></a><span class="lineno"> 1364</span>   rmwch4 = <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ab7bc2f468a9159a04d16b9500722c011">mwch4</a>/<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a455077c905b075fb0c227ed4d0e73e09">mwdry</a>      <span class="comment">! ratio of molecular weight ch4   to dry air</span></div>
<div class="line"><a id="l01365" name="l01365"></a><span class="lineno"> 1365</span>   rmwf11 = <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ad555b898a8fc2a940cac8f504a89a01a">mwf11</a>/<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a455077c905b075fb0c227ed4d0e73e09">mwdry</a>      <span class="comment">! ratio of molecular weight cfc11 to dry air</span></div>
<div class="line"><a id="l01366" name="l01366"></a><span class="lineno"> 1366</span>   rmwf12 = <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#acbe8f15ae2e2e188768922ae6c0f5958">mwf12</a>/<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a455077c905b075fb0c227ed4d0e73e09">mwdry</a>      <span class="comment">! ratio of molecular weight cfc12 to dry air</span></div>
<div class="line"><a id="l01367" name="l01367"></a><span class="lineno"> 1367</span><span class="comment">!</span></div>
<div class="line"><a id="l01368" name="l01368"></a><span class="lineno"> 1368</span><span class="comment">! get latitudes</span></div>
<div class="line"><a id="l01369" name="l01369"></a><span class="lineno"> 1369</span><span class="comment">!</span></div>
<div class="line"><a id="l01370" name="l01370"></a><span class="lineno"> 1370</span><span class="comment">!  call get_rlat_all_p(lchnk, ncol, clat)</span></div>
<div class="line"><a id="l01371" name="l01371"></a><span class="lineno"> 1371</span>   <span class="keywordflow">do</span> i = 1, ncol</div>
<div class="line"><a id="l01372" name="l01372"></a><span class="lineno"> 1372</span>      coslat(i) = cos(clat(i))</div>
<div class="line"><a id="l01373" name="l01373"></a><span class="lineno"> 1373</span><span class="keywordflow">   end do</span></div>
<div class="line"><a id="l01374" name="l01374"></a><span class="lineno"> 1374</span><span class="comment">!</span></div>
<div class="line"><a id="l01375" name="l01375"></a><span class="lineno"> 1375</span><span class="comment">! set tropospheric mass mixing ratios</span></div>
<div class="line"><a id="l01376" name="l01376"></a><span class="lineno"> 1376</span><span class="comment">!</span></div>
<div class="line"><a id="l01377" name="l01377"></a><span class="lineno"> 1377</span>   ch40   = rmwch4 * <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a99553d746383c4fea61ef51ba54a3ce9">ch4vmr</a></div>
<div class="line"><a id="l01378" name="l01378"></a><span class="lineno"> 1378</span>   n2o0   = rmwn2o * <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ac18daa0d2170ae2a3f814fd448134dea">n2ovmr</a></div>
<div class="line"><a id="l01379" name="l01379"></a><span class="lineno"> 1379</span>   cfc110 = rmwf11 * <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a81d6927b3227403fd19023efa755e3ee">f11vmr</a></div>
<div class="line"><a id="l01380" name="l01380"></a><span class="lineno"> 1380</span>   cfc120 = rmwf12 * <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a281f8f573adfae5e50a6d3d6cd879792">f12vmr</a></div>
<div class="line"><a id="l01381" name="l01381"></a><span class="lineno"> 1381</span> </div>
<div class="line"><a id="l01382" name="l01382"></a><span class="lineno"> 1382</span>   <span class="keywordflow">do</span> i = 1, ncol</div>
<div class="line"><a id="l01383" name="l01383"></a><span class="lineno"> 1383</span>      coslat(i) = cos(clat(i))</div>
<div class="line"><a id="l01384" name="l01384"></a><span class="lineno"> 1384</span><span class="keywordflow">   end do</span></div>
<div class="line"><a id="l01385" name="l01385"></a><span class="lineno"> 1385</span><span class="comment">!</span></div>
<div class="line"><a id="l01386" name="l01386"></a><span class="lineno"> 1386</span>   <span class="keywordflow">do</span> k = 1,pver</div>
<div class="line"><a id="l01387" name="l01387"></a><span class="lineno"> 1387</span>      <span class="keywordflow">do</span> i = 1,ncol</div>
<div class="line"><a id="l01388" name="l01388"></a><span class="lineno"> 1388</span><span class="comment">!</span></div>
<div class="line"><a id="l01389" name="l01389"></a><span class="lineno"> 1389</span><span class="comment">!        set stratospheric scale height factor for gases</span></div>
<div class="line"><a id="l01390" name="l01390"></a><span class="lineno"> 1390</span>         dlat = abs(57.2958 * clat(i))</div>
<div class="line"><a id="l01391" name="l01391"></a><span class="lineno"> 1391</span>         <span class="keywordflow">if</span>(dlat.le.45.0) <span class="keywordflow">then</span></div>
<div class="line"><a id="l01392" name="l01392"></a><span class="lineno"> 1392</span>            xn2o = 0.3478 + 0.00116 * dlat</div>
<div class="line"><a id="l01393" name="l01393"></a><span class="lineno"> 1393</span>            xch4 = 0.2353</div>
<div class="line"><a id="l01394" name="l01394"></a><span class="lineno"> 1394</span>            xcfc11 = 0.7273 + 0.00606 * dlat</div>
<div class="line"><a id="l01395" name="l01395"></a><span class="lineno"> 1395</span>            xcfc12 = 0.4000 + 0.00222 * dlat</div>
<div class="line"><a id="l01396" name="l01396"></a><span class="lineno"> 1396</span>         <span class="keywordflow">else</span></div>
<div class="line"><a id="l01397" name="l01397"></a><span class="lineno"> 1397</span>            xn2o = 0.4000 + 0.013333 * (dlat - 45)</div>
<div class="line"><a id="l01398" name="l01398"></a><span class="lineno"> 1398</span>            xch4 = 0.2353 + 0.0225489 * (dlat - 45)</div>
<div class="line"><a id="l01399" name="l01399"></a><span class="lineno"> 1399</span>            xcfc11 = 1.00 + 0.013333 * (dlat - 45)</div>
<div class="line"><a id="l01400" name="l01400"></a><span class="lineno"> 1400</span>            xcfc12 = 0.50 + 0.024444 * (dlat - 45)</div>
<div class="line"><a id="l01401" name="l01401"></a><span class="lineno"> 1401</span><span class="keywordflow">         end if</span></div>
<div class="line"><a id="l01402" name="l01402"></a><span class="lineno"> 1402</span><span class="comment">!</span></div>
<div class="line"><a id="l01403" name="l01403"></a><span class="lineno"> 1403</span><span class="comment">!        pressure of tropopause</span></div>
<div class="line"><a id="l01404" name="l01404"></a><span class="lineno"> 1404</span>         ptrop = 250.0e2 - 150.0e2*coslat(i)**2.0</div>
<div class="line"><a id="l01405" name="l01405"></a><span class="lineno"> 1405</span><span class="comment">!</span></div>
<div class="line"><a id="l01406" name="l01406"></a><span class="lineno"> 1406</span><span class="comment">!        determine output mass mixing ratios</span></div>
<div class="line"><a id="l01407" name="l01407"></a><span class="lineno"> 1407</span>         <span class="keywordflow">if</span> (pmid(i,k) &gt;= ptrop) <span class="keywordflow">then</span></div>
<div class="line"><a id="l01408" name="l01408"></a><span class="lineno"> 1408</span>            ch4(i,k) = ch40</div>
<div class="line"><a id="l01409" name="l01409"></a><span class="lineno"> 1409</span>            n2o(i,k) = n2o0</div>
<div class="line"><a id="l01410" name="l01410"></a><span class="lineno"> 1410</span>            cfc11(i,k) = cfc110</div>
<div class="line"><a id="l01411" name="l01411"></a><span class="lineno"> 1411</span>            cfc12(i,k) = cfc120</div>
<div class="line"><a id="l01412" name="l01412"></a><span class="lineno"> 1412</span>         <span class="keywordflow">else</span></div>
<div class="line"><a id="l01413" name="l01413"></a><span class="lineno"> 1413</span>            pratio = pmid(i,k)/ptrop</div>
<div class="line"><a id="l01414" name="l01414"></a><span class="lineno"> 1414</span>            ch4(i,k) = ch40 * (pratio)**xch4</div>
<div class="line"><a id="l01415" name="l01415"></a><span class="lineno"> 1415</span>            n2o(i,k) = n2o0 * (pratio)**xn2o</div>
<div class="line"><a id="l01416" name="l01416"></a><span class="lineno"> 1416</span>            cfc11(i,k) = cfc110 * (pratio)**xcfc11</div>
<div class="line"><a id="l01417" name="l01417"></a><span class="lineno"> 1417</span>            cfc12(i,k) = cfc120 * (pratio)**xcfc12</div>
<div class="line"><a id="l01418" name="l01418"></a><span class="lineno"> 1418</span><span class="keywordflow">         end if</span></div>
<div class="line"><a id="l01419" name="l01419"></a><span class="lineno"> 1419</span><span class="keywordflow">      end do</span></div>
<div class="line"><a id="l01420" name="l01420"></a><span class="lineno"> 1420</span><span class="keywordflow">   end do</span></div>
<div class="line"><a id="l01421" name="l01421"></a><span class="lineno"> 1421</span><span class="comment">!</span></div>
<div class="line"><a id="l01422" name="l01422"></a><span class="lineno"> 1422</span>   <span class="keywordflow">return</span></div>
<div class="line"><a id="l01423" name="l01423"></a><span class="lineno"> 1423</span><span class="comment">!</span></div>
<div class="line"><a id="l01424" name="l01424"></a><span class="lineno"> 1424</span><span class="keyword">end subroutine </span><a class="code hl_function" href="namespacemodule__ra__cam__support.html#a0bdd4bd6e389e15e2c8f955f8b37870a">trcmix</a></div>
<div class="line"><a id="l01425" name="l01425"></a><span class="lineno"> 1425</span> </div>
<div class="line"><a id="l01426" name="l01426"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#acb962f2259880f6eff6a0e78e1f4d744"> 1426</a></span><span class="keyword">subroutine </span><a class="code hl_function" href="namespacemodule__ra__cam__support.html#acb962f2259880f6eff6a0e78e1f4d744">trcplk</a>(lchnk   ,ncol    ,pcols, pver, pverp,         &amp;</div>
<div class="line"><a id="l01427" name="l01427"></a><span class="lineno"> 1427</span>                  tint    ,tlayr   ,tplnke  ,emplnk  ,abplnk1 , &amp;</div>
<div class="line"><a id="l01428" name="l01428"></a><span class="lineno"> 1428</span>                  abplnk2 )</div>
<div class="line"><a id="l01429" name="l01429"></a><span class="lineno"> 1429</span><span class="comment">!----------------------------------------------------------------------- </span></div>
<div class="line"><a id="l01430" name="l01430"></a><span class="lineno"> 1430</span><span class="comment">! </span></div>
<div class="line"><a id="l01431" name="l01431"></a><span class="lineno"> 1431</span><span class="comment">! Purpose: </span></div>
<div class="line"><a id="l01432" name="l01432"></a><span class="lineno"> 1432</span><span class="comment">!   Calculate Planck factors for absorptivity and emissivity of</span></div>
<div class="line"><a id="l01433" name="l01433"></a><span class="lineno"> 1433</span><span class="comment">!   CH4, N2O, CFC11 and CFC12</span></div>
<div class="line"><a id="l01434" name="l01434"></a><span class="lineno"> 1434</span><span class="comment">! </span></div>
<div class="line"><a id="l01435" name="l01435"></a><span class="lineno"> 1435</span><span class="comment">! Method: </span></div>
<div class="line"><a id="l01436" name="l01436"></a><span class="lineno"> 1436</span><span class="comment">!   Planck function and derivative evaluated at the band center.</span></div>
<div class="line"><a id="l01437" name="l01437"></a><span class="lineno"> 1437</span><span class="comment">! </span></div>
<div class="line"><a id="l01438" name="l01438"></a><span class="lineno"> 1438</span><span class="comment">! Author: J. Kiehl</span></div>
<div class="line"><a id="l01439" name="l01439"></a><span class="lineno"> 1439</span><span class="comment">! </span></div>
<div class="line"><a id="l01440" name="l01440"></a><span class="lineno"> 1440</span><span class="comment">!-----------------------------------------------------------------------</span></div>
<div class="line"><a id="l01441" name="l01441"></a><span class="lineno"> 1441</span><span class="comment">!  use shr_kind_mod, only: r8 =&gt; shr_kind_r8</span></div>
<div class="line"><a id="l01442" name="l01442"></a><span class="lineno"> 1442</span><span class="comment">!  use ppgrid</span></div>
<div class="line"><a id="l01443" name="l01443"></a><span class="lineno"> 1443</span> </div>
<div class="line"><a id="l01444" name="l01444"></a><span class="lineno"> 1444</span>   <span class="keywordtype">implicit none</span></div>
<div class="line"><a id="l01445" name="l01445"></a><span class="lineno"> 1445</span><span class="comment">!------------------------------Arguments--------------------------------</span></div>
<div class="line"><a id="l01446" name="l01446"></a><span class="lineno"> 1446</span><span class="comment">!</span></div>
<div class="line"><a id="l01447" name="l01447"></a><span class="lineno"> 1447</span><span class="comment">! Input arguments</span></div>
<div class="line"><a id="l01448" name="l01448"></a><span class="lineno"> 1448</span><span class="comment">!</span></div>
<div class="line"><a id="l01449" name="l01449"></a><span class="lineno"> 1449</span>   <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: lchnk                <span class="comment">! chunk identifier</span></div>
<div class="line"><a id="l01450" name="l01450"></a><span class="lineno"> 1450</span>   <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: ncol                 <span class="comment">! number of atmospheric columns</span></div>
<div class="line"><a id="l01451" name="l01451"></a><span class="lineno"> 1451</span>   <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: pcols, pver, pverp</div>
<div class="line"><a id="l01452" name="l01452"></a><span class="lineno"> 1452</span> </div>
<div class="line"><a id="l01453" name="l01453"></a><span class="lineno"> 1453</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: tint(pcols,pverp)   <span class="comment">! interface temperatures</span></div>
<div class="line"><a id="l01454" name="l01454"></a><span class="lineno"> 1454</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: tlayr(pcols,pverp)  <span class="comment">! k-1 level temperatures</span></div>
<div class="line"><a id="l01455" name="l01455"></a><span class="lineno"> 1455</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: tplnke(pcols)       <span class="comment">! Top Layer temperature</span></div>
<div class="line"><a id="l01456" name="l01456"></a><span class="lineno"> 1456</span><span class="comment">!</span></div>
<div class="line"><a id="l01457" name="l01457"></a><span class="lineno"> 1457</span><span class="comment">! output arguments</span></div>
<div class="line"><a id="l01458" name="l01458"></a><span class="lineno"> 1458</span><span class="comment">!</span></div>
<div class="line"><a id="l01459" name="l01459"></a><span class="lineno"> 1459</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(out)</span> :: emplnk(14,pcols)         <span class="comment">! emissivity Planck factor</span></div>
<div class="line"><a id="l01460" name="l01460"></a><span class="lineno"> 1460</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(out)</span> :: abplnk1(14,pcols,pverp)  <span class="comment">! non-nearest layer Plack factor</span></div>
<div class="line"><a id="l01461" name="l01461"></a><span class="lineno"> 1461</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(out)</span> :: abplnk2(14,pcols,pverp)  <span class="comment">! nearest layer factor</span></div>
<div class="line"><a id="l01462" name="l01462"></a><span class="lineno"> 1462</span> </div>
<div class="line"><a id="l01463" name="l01463"></a><span class="lineno"> 1463</span><span class="comment">!</span></div>
<div class="line"><a id="l01464" name="l01464"></a><span class="lineno"> 1464</span><span class="comment">!--------------------------Local Variables------------------------------</span></div>
<div class="line"><a id="l01465" name="l01465"></a><span class="lineno"> 1465</span><span class="comment">!</span></div>
<div class="line"><a id="l01466" name="l01466"></a><span class="lineno"> 1466</span>   <span class="keywordtype">integer</span> wvl                   <span class="comment">! wavelength index</span></div>
<div class="line"><a id="l01467" name="l01467"></a><span class="lineno"> 1467</span>   <span class="keywordtype">integer</span> i,k                   <span class="comment">! loop counters</span></div>
<div class="line"><a id="l01468" name="l01468"></a><span class="lineno"> 1468</span><span class="comment">!</span></div>
<div class="line"><a id="l01469" name="l01469"></a><span class="lineno"> 1469</span><span class="keywordtype">   real</span>(r8) f1(14)                   <span class="comment">! Planck function factor</span></div>
<div class="line"><a id="l01470" name="l01470"></a><span class="lineno"> 1470</span><span class="keywordtype">   real</span>(r8) f2(14)                   <span class="comment">!        &quot;</span></div>
<div class="line"><a id="l01471" name="l01471"></a><span class="lineno"> 1471</span><span class="keywordtype">   real</span>(r8) f3(14)                   <span class="comment">!        &quot;</span></div>
<div class="line"><a id="l01472" name="l01472"></a><span class="lineno"> 1472</span><span class="comment">!</span></div>
<div class="line"><a id="l01473" name="l01473"></a><span class="lineno"> 1473</span><span class="comment">!--------------------------Data Statements------------------------------</span></div>
<div class="line"><a id="l01474" name="l01474"></a><span class="lineno"> 1474</span><span class="comment">!</span></div>
<div class="line"><a id="l01475" name="l01475"></a><span class="lineno"> 1475</span>   <span class="keyword">data</span> f1 /5.85713e8,7.94950e8,1.47009e9,1.40031e9,1.34853e8, &amp;</div>
<div class="line"><a id="l01476" name="l01476"></a><span class="lineno"> 1476</span>            1.05158e9,3.35370e8,3.99601e8,5.35994e8,8.42955e8, &amp;</div>
<div class="line"><a id="l01477" name="l01477"></a><span class="lineno"> 1477</span>            4.63682e8,5.18944e8,8.83202e8,1.03279e9/</div>
<div class="line"><a id="l01478" name="l01478"></a><span class="lineno"> 1478</span>   <span class="keyword">data</span> f2 /2.02493e11,3.04286e11,6.90698e11,6.47333e11, &amp;</div>
<div class="line"><a id="l01479" name="l01479"></a><span class="lineno"> 1479</span>            2.85744e10,4.41862e11,9.62780e10,1.21618e11, &amp;</div>
<div class="line"><a id="l01480" name="l01480"></a><span class="lineno"> 1480</span>            1.79905e11,3.29029e11,1.48294e11,1.72315e11, &amp;</div>
<div class="line"><a id="l01481" name="l01481"></a><span class="lineno"> 1481</span>            3.50140e11,4.31364e11/</div>
<div class="line"><a id="l01482" name="l01482"></a><span class="lineno"> 1482</span>   <span class="keyword">data</span> f3 /1383.0,1531.0,1879.0,1849.0,848.0,1681.0, &amp;</div>
<div class="line"><a id="l01483" name="l01483"></a><span class="lineno"> 1483</span>            1148.0,1217.0,1343.0,1561.0,1279.0,1328.0, &amp;</div>
<div class="line"><a id="l01484" name="l01484"></a><span class="lineno"> 1484</span>            1586.0,1671.0/</div>
<div class="line"><a id="l01485" name="l01485"></a><span class="lineno"> 1485</span><span class="comment">!</span></div>
<div class="line"><a id="l01486" name="l01486"></a><span class="lineno"> 1486</span><span class="comment">!-----------------------------------------------------------------------</span></div>
<div class="line"><a id="l01487" name="l01487"></a><span class="lineno"> 1487</span><span class="comment">!</span></div>
<div class="line"><a id="l01488" name="l01488"></a><span class="lineno"> 1488</span><span class="comment">! Calculate emissivity Planck factor</span></div>
<div class="line"><a id="l01489" name="l01489"></a><span class="lineno"> 1489</span><span class="comment">!</span></div>
<div class="line"><a id="l01490" name="l01490"></a><span class="lineno"> 1490</span>   <span class="keywordflow">do</span> wvl = 1,14</div>
<div class="line"><a id="l01491" name="l01491"></a><span class="lineno"> 1491</span>      <span class="keywordflow">do</span> i = 1,ncol</div>
<div class="line"><a id="l01492" name="l01492"></a><span class="lineno"> 1492</span>         emplnk(wvl,i) = f1(wvl)/(tplnke(i)**4.0*(exp(f3(wvl)/tplnke(i))-1.0))</div>
<div class="line"><a id="l01493" name="l01493"></a><span class="lineno"> 1493</span><span class="keywordflow">      end do</span></div>
<div class="line"><a id="l01494" name="l01494"></a><span class="lineno"> 1494</span><span class="keywordflow">   end do</span></div>
<div class="line"><a id="l01495" name="l01495"></a><span class="lineno"> 1495</span><span class="comment">!</span></div>
<div class="line"><a id="l01496" name="l01496"></a><span class="lineno"> 1496</span><span class="comment">! Calculate absorptivity Planck factor for tint and tlayr temperatures</span></div>
<div class="line"><a id="l01497" name="l01497"></a><span class="lineno"> 1497</span><span class="comment">!</span></div>
<div class="line"><a id="l01498" name="l01498"></a><span class="lineno"> 1498</span>   <span class="keywordflow">do</span> wvl = 1,14</div>
<div class="line"><a id="l01499" name="l01499"></a><span class="lineno"> 1499</span>      <span class="keywordflow">do</span> k = <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a1a12feb1033e5148328277eb0a083ab3">ntoplw</a>, pverp</div>
<div class="line"><a id="l01500" name="l01500"></a><span class="lineno"> 1500</span>         <span class="keywordflow">do</span> i = 1, ncol</div>
<div class="line"><a id="l01501" name="l01501"></a><span class="lineno"> 1501</span><span class="comment">!</span></div>
<div class="line"><a id="l01502" name="l01502"></a><span class="lineno"> 1502</span><span class="comment">! non-nearlest layer function</span></div>
<div class="line"><a id="l01503" name="l01503"></a><span class="lineno"> 1503</span><span class="comment">!</span></div>
<div class="line"><a id="l01504" name="l01504"></a><span class="lineno"> 1504</span>            abplnk1(wvl,i,k) = (f2(wvl)*exp(f3(wvl)/tint(i,k)))  &amp;</div>
<div class="line"><a id="l01505" name="l01505"></a><span class="lineno"> 1505</span>                               /(tint(i,k)**5.0*(exp(f3(wvl)/tint(i,k))-1.0)**2.0)</div>
<div class="line"><a id="l01506" name="l01506"></a><span class="lineno"> 1506</span><span class="comment">!</span></div>
<div class="line"><a id="l01507" name="l01507"></a><span class="lineno"> 1507</span><span class="comment">! nearest layer function</span></div>
<div class="line"><a id="l01508" name="l01508"></a><span class="lineno"> 1508</span><span class="comment">!</span></div>
<div class="line"><a id="l01509" name="l01509"></a><span class="lineno"> 1509</span>            abplnk2(wvl,i,k) = (f2(wvl)*exp(f3(wvl)/tlayr(i,k))) &amp;</div>
<div class="line"><a id="l01510" name="l01510"></a><span class="lineno"> 1510</span>                               /(tlayr(i,k)**5.0*(exp(f3(wvl)/tlayr(i,k))-1.0)**2.0)</div>
<div class="line"><a id="l01511" name="l01511"></a><span class="lineno"> 1511</span><span class="keywordflow">         end do</span></div>
<div class="line"><a id="l01512" name="l01512"></a><span class="lineno"> 1512</span><span class="keywordflow">      end do</span></div>
<div class="line"><a id="l01513" name="l01513"></a><span class="lineno"> 1513</span><span class="keywordflow">   end do</span></div>
<div class="line"><a id="l01514" name="l01514"></a><span class="lineno"> 1514</span><span class="comment">!</span></div>
<div class="line"><a id="l01515" name="l01515"></a><span class="lineno"> 1515</span>   <span class="keywordflow">return</span></div>
<div class="line"><a id="l01516" name="l01516"></a><span class="lineno"> 1516</span><span class="keyword">end subroutine </span><a class="code hl_function" href="namespacemodule__ra__cam__support.html#acb962f2259880f6eff6a0e78e1f4d744">trcplk</a></div>
<div class="line"><a id="l01517" name="l01517"></a><span class="lineno"> 1517</span> </div>
<div class="line"><a id="l01518" name="l01518"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#aebde22bf6abee96139e2a1f6f30a32fb"> 1518</a></span><span class="keyword">subroutine </span><a class="code hl_function" href="namespacemodule__ra__cam__support.html#aebde22bf6abee96139e2a1f6f30a32fb">trcpth</a>(lchnk   ,ncol    ,pcols, pver, pverp,         &amp;</div>
<div class="line"><a id="l01519" name="l01519"></a><span class="lineno"> 1519</span>                  tnm     ,pnm     ,cfc11   ,cfc12   ,n2o     , &amp;</div>
<div class="line"><a id="l01520" name="l01520"></a><span class="lineno"> 1520</span>                  ch4     ,qnm     ,ucfc11  ,ucfc12  ,un2o0   , &amp;</div>
<div class="line"><a id="l01521" name="l01521"></a><span class="lineno"> 1521</span>                  un2o1   ,uch4    ,uco211  ,uco212  ,uco213  , &amp;</div>
<div class="line"><a id="l01522" name="l01522"></a><span class="lineno"> 1522</span>                  uco221  ,uco222  ,uco223  ,bn2o0   ,bn2o1   , &amp;</div>
<div class="line"><a id="l01523" name="l01523"></a><span class="lineno"> 1523</span>                  bch4    ,uptype  )</div>
<div class="line"><a id="l01524" name="l01524"></a><span class="lineno"> 1524</span><span class="comment">!----------------------------------------------------------------------- </span></div>
<div class="line"><a id="l01525" name="l01525"></a><span class="lineno"> 1525</span><span class="comment">! </span></div>
<div class="line"><a id="l01526" name="l01526"></a><span class="lineno"> 1526</span><span class="comment">! Purpose: </span></div>
<div class="line"><a id="l01527" name="l01527"></a><span class="lineno"> 1527</span><span class="comment">! Calculate path lengths and pressure factors for CH4, N2O, CFC11</span></div>
<div class="line"><a id="l01528" name="l01528"></a><span class="lineno"> 1528</span><span class="comment">! and CFC12.</span></div>
<div class="line"><a id="l01529" name="l01529"></a><span class="lineno"> 1529</span><span class="comment">! </span></div>
<div class="line"><a id="l01530" name="l01530"></a><span class="lineno"> 1530</span><span class="comment">! Method: </span></div>
<div class="line"><a id="l01531" name="l01531"></a><span class="lineno"> 1531</span><span class="comment">! See CCM3 description for details</span></div>
<div class="line"><a id="l01532" name="l01532"></a><span class="lineno"> 1532</span><span class="comment">! </span></div>
<div class="line"><a id="l01533" name="l01533"></a><span class="lineno"> 1533</span><span class="comment">! Author: J. Kiehl</span></div>
<div class="line"><a id="l01534" name="l01534"></a><span class="lineno"> 1534</span><span class="comment">! </span></div>
<div class="line"><a id="l01535" name="l01535"></a><span class="lineno"> 1535</span><span class="comment">!-----------------------------------------------------------------------</span></div>
<div class="line"><a id="l01536" name="l01536"></a><span class="lineno"> 1536</span><span class="comment">!  use shr_kind_mod, only: r8 =&gt; shr_kind_r8</span></div>
<div class="line"><a id="l01537" name="l01537"></a><span class="lineno"> 1537</span><span class="comment">!  use ppgrid</span></div>
<div class="line"><a id="l01538" name="l01538"></a><span class="lineno"> 1538</span><span class="comment">!  use ghg_surfvals, only: co2mmr</span></div>
<div class="line"><a id="l01539" name="l01539"></a><span class="lineno"> 1539</span> </div>
<div class="line"><a id="l01540" name="l01540"></a><span class="lineno"> 1540</span>   <span class="keywordtype">implicit none</span></div>
<div class="line"><a id="l01541" name="l01541"></a><span class="lineno"> 1541</span> </div>
<div class="line"><a id="l01542" name="l01542"></a><span class="lineno"> 1542</span><span class="comment">!------------------------------Arguments--------------------------------</span></div>
<div class="line"><a id="l01543" name="l01543"></a><span class="lineno"> 1543</span><span class="comment">!</span></div>
<div class="line"><a id="l01544" name="l01544"></a><span class="lineno"> 1544</span><span class="comment">! Input arguments</span></div>
<div class="line"><a id="l01545" name="l01545"></a><span class="lineno"> 1545</span><span class="comment">!</span></div>
<div class="line"><a id="l01546" name="l01546"></a><span class="lineno"> 1546</span>   <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: lchnk                 <span class="comment">! chunk identifier</span></div>
<div class="line"><a id="l01547" name="l01547"></a><span class="lineno"> 1547</span>   <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: ncol                  <span class="comment">! number of atmospheric columns</span></div>
<div class="line"><a id="l01548" name="l01548"></a><span class="lineno"> 1548</span>   <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: pcols, pver, pverp</div>
<div class="line"><a id="l01549" name="l01549"></a><span class="lineno"> 1549</span> </div>
<div class="line"><a id="l01550" name="l01550"></a><span class="lineno"> 1550</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: tnm(pcols,pver)      <span class="comment">! Model level temperatures</span></div>
<div class="line"><a id="l01551" name="l01551"></a><span class="lineno"> 1551</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: pnm(pcols,pverp)     <span class="comment">! Pres. at model interfaces (dynes/cm2)</span></div>
<div class="line"><a id="l01552" name="l01552"></a><span class="lineno"> 1552</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: qnm(pcols,pver)      <span class="comment">! h2o specific humidity</span></div>
<div class="line"><a id="l01553" name="l01553"></a><span class="lineno"> 1553</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: cfc11(pcols,pver)    <span class="comment">! CFC11 mass mixing ratio</span></div>
<div class="line"><a id="l01554" name="l01554"></a><span class="lineno"> 1554</span><span class="comment">!</span></div>
<div class="line"><a id="l01555" name="l01555"></a><span class="lineno"> 1555</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: cfc12(pcols,pver)    <span class="comment">! CFC12 mass mixing ratio</span></div>
<div class="line"><a id="l01556" name="l01556"></a><span class="lineno"> 1556</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: n2o(pcols,pver)      <span class="comment">! N2O mass mixing ratio</span></div>
<div class="line"><a id="l01557" name="l01557"></a><span class="lineno"> 1557</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: ch4(pcols,pver)      <span class="comment">! CH4 mass mixing ratio</span></div>
<div class="line"><a id="l01558" name="l01558"></a><span class="lineno"> 1558</span> </div>
<div class="line"><a id="l01559" name="l01559"></a><span class="lineno"> 1559</span><span class="comment">!</span></div>
<div class="line"><a id="l01560" name="l01560"></a><span class="lineno"> 1560</span><span class="comment">! Output arguments</span></div>
<div class="line"><a id="l01561" name="l01561"></a><span class="lineno"> 1561</span><span class="comment">!</span></div>
<div class="line"><a id="l01562" name="l01562"></a><span class="lineno"> 1562</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(out)</span> :: ucfc11(pcols,pverp)  <span class="comment">! CFC11 path length</span></div>
<div class="line"><a id="l01563" name="l01563"></a><span class="lineno"> 1563</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(out)</span> :: ucfc12(pcols,pverp)  <span class="comment">! CFC12 path length</span></div>
<div class="line"><a id="l01564" name="l01564"></a><span class="lineno"> 1564</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(out)</span> :: un2o0(pcols,pverp)   <span class="comment">! N2O path length</span></div>
<div class="line"><a id="l01565" name="l01565"></a><span class="lineno"> 1565</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(out)</span> :: un2o1(pcols,pverp)   <span class="comment">! N2O path length (hot band)</span></div>
<div class="line"><a id="l01566" name="l01566"></a><span class="lineno"> 1566</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(out)</span> :: uch4(pcols,pverp)    <span class="comment">! CH4 path length</span></div>
<div class="line"><a id="l01567" name="l01567"></a><span class="lineno"> 1567</span><span class="comment">!</span></div>
<div class="line"><a id="l01568" name="l01568"></a><span class="lineno"> 1568</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(out)</span> :: uco211(pcols,pverp)  <span class="comment">! CO2 9.4 micron band path length</span></div>
<div class="line"><a id="l01569" name="l01569"></a><span class="lineno"> 1569</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(out)</span> :: uco212(pcols,pverp)  <span class="comment">! CO2 9.4 micron band path length</span></div>
<div class="line"><a id="l01570" name="l01570"></a><span class="lineno"> 1570</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(out)</span> :: uco213(pcols,pverp)  <span class="comment">! CO2 9.4 micron band path length</span></div>
<div class="line"><a id="l01571" name="l01571"></a><span class="lineno"> 1571</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(out)</span> :: uco221(pcols,pverp)  <span class="comment">! CO2 10.4 micron band path length</span></div>
<div class="line"><a id="l01572" name="l01572"></a><span class="lineno"> 1572</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(out)</span> :: uco222(pcols,pverp)  <span class="comment">! CO2 10.4 micron band path length</span></div>
<div class="line"><a id="l01573" name="l01573"></a><span class="lineno"> 1573</span><span class="comment">!</span></div>
<div class="line"><a id="l01574" name="l01574"></a><span class="lineno"> 1574</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(out)</span> :: uco223(pcols,pverp)  <span class="comment">! CO2 10.4 micron band path length</span></div>
<div class="line"><a id="l01575" name="l01575"></a><span class="lineno"> 1575</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(out)</span> :: bn2o0(pcols,pverp)   <span class="comment">! pressure factor for n2o</span></div>
<div class="line"><a id="l01576" name="l01576"></a><span class="lineno"> 1576</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(out)</span> :: bn2o1(pcols,pverp)   <span class="comment">! pressure factor for n2o</span></div>
<div class="line"><a id="l01577" name="l01577"></a><span class="lineno"> 1577</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(out)</span> :: bch4(pcols,pverp)    <span class="comment">! pressure factor for ch4</span></div>
<div class="line"><a id="l01578" name="l01578"></a><span class="lineno"> 1578</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(out)</span> :: uptype(pcols,pverp)  <span class="comment">! p-type continuum path length</span></div>
<div class="line"><a id="l01579" name="l01579"></a><span class="lineno"> 1579</span> </div>
<div class="line"><a id="l01580" name="l01580"></a><span class="lineno"> 1580</span><span class="comment">!</span></div>
<div class="line"><a id="l01581" name="l01581"></a><span class="lineno"> 1581</span><span class="comment">!---------------------------Local variables-----------------------------</span></div>
<div class="line"><a id="l01582" name="l01582"></a><span class="lineno"> 1582</span><span class="comment">!</span></div>
<div class="line"><a id="l01583" name="l01583"></a><span class="lineno"> 1583</span>   <span class="keywordtype">integer</span>   i               <span class="comment">! Longitude index</span></div>
<div class="line"><a id="l01584" name="l01584"></a><span class="lineno"> 1584</span>   <span class="keywordtype">integer</span>   k               <span class="comment">! Level index</span></div>
<div class="line"><a id="l01585" name="l01585"></a><span class="lineno"> 1585</span><span class="comment">!</span></div>
<div class="line"><a id="l01586" name="l01586"></a><span class="lineno"> 1586</span><span class="keywordtype">   real</span>(r8) co2fac(pcols,1)      <span class="comment">! co2 factor</span></div>
<div class="line"><a id="l01587" name="l01587"></a><span class="lineno"> 1587</span><span class="keywordtype">   real</span>(r8) alpha1(pcols)        <span class="comment">! stimulated emission term</span></div>
<div class="line"><a id="l01588" name="l01588"></a><span class="lineno"> 1588</span><span class="keywordtype">   real</span>(r8) alpha2(pcols)        <span class="comment">! stimulated emission term</span></div>
<div class="line"><a id="l01589" name="l01589"></a><span class="lineno"> 1589</span><span class="keywordtype">   real</span>(r8) rt(pcols)            <span class="comment">! reciprocal of local temperature</span></div>
<div class="line"><a id="l01590" name="l01590"></a><span class="lineno"> 1590</span><span class="keywordtype">   real</span>(r8) rsqrt(pcols)         <span class="comment">! reciprocal of sqrt of temp</span></div>
<div class="line"><a id="l01591" name="l01591"></a><span class="lineno"> 1591</span><span class="comment">!</span></div>
<div class="line"><a id="l01592" name="l01592"></a><span class="lineno"> 1592</span><span class="keywordtype">   real</span>(r8) pbar(pcols)          <span class="comment">! mean pressure</span></div>
<div class="line"><a id="l01593" name="l01593"></a><span class="lineno"> 1593</span><span class="keywordtype">   real</span>(r8) dpnm(pcols)          <span class="comment">! difference in pressure</span></div>
<div class="line"><a id="l01594" name="l01594"></a><span class="lineno"> 1594</span><span class="keywordtype">   real</span>(r8) diff                 <span class="comment">! diffusivity factor</span></div>
<div class="line"><a id="l01595" name="l01595"></a><span class="lineno"> 1595</span><span class="comment">!</span></div>
<div class="line"><a id="l01596" name="l01596"></a><span class="lineno"> 1596</span><span class="comment">!--------------------------Data Statements------------------------------</span></div>
<div class="line"><a id="l01597" name="l01597"></a><span class="lineno"> 1597</span><span class="comment">!</span></div>
<div class="line"><a id="l01598" name="l01598"></a><span class="lineno"> 1598</span>   <span class="keyword">data</span> diff /1.66/</div>
<div class="line"><a id="l01599" name="l01599"></a><span class="lineno"> 1599</span><span class="comment">!</span></div>
<div class="line"><a id="l01600" name="l01600"></a><span class="lineno"> 1600</span><span class="comment">!-----------------------------------------------------------------------</span></div>
<div class="line"><a id="l01601" name="l01601"></a><span class="lineno"> 1601</span><span class="comment">!</span></div>
<div class="line"><a id="l01602" name="l01602"></a><span class="lineno"> 1602</span><span class="comment">!  Calculate path lengths for the trace gases at model top</span></div>
<div class="line"><a id="l01603" name="l01603"></a><span class="lineno"> 1603</span><span class="comment">!</span></div>
<div class="line"><a id="l01604" name="l01604"></a><span class="lineno"> 1604</span>   <span class="keywordflow">do</span> i = 1,ncol</div>
<div class="line"><a id="l01605" name="l01605"></a><span class="lineno"> 1605</span>      ucfc11(i,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a1a12feb1033e5148328277eb0a083ab3">ntoplw</a>) = 1.8 * cfc11(i,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a1a12feb1033e5148328277eb0a083ab3">ntoplw</a>) * pnm(i,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a1a12feb1033e5148328277eb0a083ab3">ntoplw</a>) * <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a02a6fd3379ca9f88aedc856917d393ee">rga</a></div>
<div class="line"><a id="l01606" name="l01606"></a><span class="lineno"> 1606</span>      ucfc12(i,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a1a12feb1033e5148328277eb0a083ab3">ntoplw</a>) = 1.8 * cfc12(i,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a1a12feb1033e5148328277eb0a083ab3">ntoplw</a>) * pnm(i,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a1a12feb1033e5148328277eb0a083ab3">ntoplw</a>) * <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a02a6fd3379ca9f88aedc856917d393ee">rga</a></div>
<div class="line"><a id="l01607" name="l01607"></a><span class="lineno"> 1607</span>      un2o0(i,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a1a12feb1033e5148328277eb0a083ab3">ntoplw</a>) = diff * 1.02346e5 * n2o(i,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a1a12feb1033e5148328277eb0a083ab3">ntoplw</a>) * pnm(i,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a1a12feb1033e5148328277eb0a083ab3">ntoplw</a>) * <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a02a6fd3379ca9f88aedc856917d393ee">rga</a> / sqrt(tnm(i,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a1a12feb1033e5148328277eb0a083ab3">ntoplw</a>))</div>
<div class="line"><a id="l01608" name="l01608"></a><span class="lineno"> 1608</span>      un2o1(i,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a1a12feb1033e5148328277eb0a083ab3">ntoplw</a>) = diff * 2.01909 * un2o0(i,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a1a12feb1033e5148328277eb0a083ab3">ntoplw</a>) * exp(-847.36/tnm(i,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a1a12feb1033e5148328277eb0a083ab3">ntoplw</a>))</div>
<div class="line"><a id="l01609" name="l01609"></a><span class="lineno"> 1609</span>      uch4(i,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a1a12feb1033e5148328277eb0a083ab3">ntoplw</a>)  = diff * 8.60957e4 * ch4(i,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a1a12feb1033e5148328277eb0a083ab3">ntoplw</a>) * pnm(i,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a1a12feb1033e5148328277eb0a083ab3">ntoplw</a>) * <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a02a6fd3379ca9f88aedc856917d393ee">rga</a> / sqrt(tnm(i,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a1a12feb1033e5148328277eb0a083ab3">ntoplw</a>))</div>
<div class="line"><a id="l01610" name="l01610"></a><span class="lineno"> 1610</span>      co2fac(i,1)     = diff * <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a4888774864252c2e557495881ddbaa40">co2mmr</a> * pnm(i,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a1a12feb1033e5148328277eb0a083ab3">ntoplw</a>) * <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a02a6fd3379ca9f88aedc856917d393ee">rga</a></div>
<div class="line"><a id="l01611" name="l01611"></a><span class="lineno"> 1611</span>      alpha1(i) = (1.0 - exp(-1540.0/tnm(i,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a1a12feb1033e5148328277eb0a083ab3">ntoplw</a>)))**3.0/sqrt(tnm(i,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a1a12feb1033e5148328277eb0a083ab3">ntoplw</a>))</div>
<div class="line"><a id="l01612" name="l01612"></a><span class="lineno"> 1612</span>      alpha2(i) = (1.0 - exp(-1360.0/tnm(i,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a1a12feb1033e5148328277eb0a083ab3">ntoplw</a>)))**3.0/sqrt(tnm(i,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a1a12feb1033e5148328277eb0a083ab3">ntoplw</a>))</div>
<div class="line"><a id="l01613" name="l01613"></a><span class="lineno"> 1613</span>      uco211(i,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a1a12feb1033e5148328277eb0a083ab3">ntoplw</a>) = 3.42217e3 * co2fac(i,1) * alpha1(i) * exp(-1849.7/tnm(i,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a1a12feb1033e5148328277eb0a083ab3">ntoplw</a>))</div>
<div class="line"><a id="l01614" name="l01614"></a><span class="lineno"> 1614</span>      uco212(i,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a1a12feb1033e5148328277eb0a083ab3">ntoplw</a>) = 6.02454e3 * co2fac(i,1) * alpha1(i) * exp(-2782.1/tnm(i,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a1a12feb1033e5148328277eb0a083ab3">ntoplw</a>))</div>
<div class="line"><a id="l01615" name="l01615"></a><span class="lineno"> 1615</span>      uco213(i,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a1a12feb1033e5148328277eb0a083ab3">ntoplw</a>) = 5.53143e3 * co2fac(i,1) * alpha1(i) * exp(-3723.2/tnm(i,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a1a12feb1033e5148328277eb0a083ab3">ntoplw</a>))</div>
<div class="line"><a id="l01616" name="l01616"></a><span class="lineno"> 1616</span>      uco221(i,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a1a12feb1033e5148328277eb0a083ab3">ntoplw</a>) = 3.88984e3 * co2fac(i,1) * alpha2(i) * exp(-1997.6/tnm(i,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a1a12feb1033e5148328277eb0a083ab3">ntoplw</a>))</div>
<div class="line"><a id="l01617" name="l01617"></a><span class="lineno"> 1617</span>      uco222(i,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a1a12feb1033e5148328277eb0a083ab3">ntoplw</a>) = 3.67108e3 * co2fac(i,1) * alpha2(i) * exp(-3843.8/tnm(i,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a1a12feb1033e5148328277eb0a083ab3">ntoplw</a>))</div>
<div class="line"><a id="l01618" name="l01618"></a><span class="lineno"> 1618</span>      uco223(i,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a1a12feb1033e5148328277eb0a083ab3">ntoplw</a>) = 6.50642e3 * co2fac(i,1) * alpha2(i) * exp(-2989.7/tnm(i,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a1a12feb1033e5148328277eb0a083ab3">ntoplw</a>))</div>
<div class="line"><a id="l01619" name="l01619"></a><span class="lineno"> 1619</span>      bn2o0(i,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a1a12feb1033e5148328277eb0a083ab3">ntoplw</a>) = diff * 19.399 * pnm(i,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a1a12feb1033e5148328277eb0a083ab3">ntoplw</a>)**2.0 * n2o(i,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a1a12feb1033e5148328277eb0a083ab3">ntoplw</a>) * &amp;</div>
<div class="line"><a id="l01620" name="l01620"></a><span class="lineno"> 1620</span>                   1.02346e5 * <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a02a6fd3379ca9f88aedc856917d393ee">rga</a> / (<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#aedb55b03e1395012ec29e1914a2df7cc">sslp</a>*tnm(i,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a1a12feb1033e5148328277eb0a083ab3">ntoplw</a>))</div>
<div class="line"><a id="l01621" name="l01621"></a><span class="lineno"> 1621</span>      bn2o1(i,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a1a12feb1033e5148328277eb0a083ab3">ntoplw</a>) = bn2o0(i,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a1a12feb1033e5148328277eb0a083ab3">ntoplw</a>) * exp(-847.36/tnm(i,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a1a12feb1033e5148328277eb0a083ab3">ntoplw</a>)) * 2.06646e5</div>
<div class="line"><a id="l01622" name="l01622"></a><span class="lineno"> 1622</span>      bch4(i,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a1a12feb1033e5148328277eb0a083ab3">ntoplw</a>) = diff * 2.94449 * ch4(i,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a1a12feb1033e5148328277eb0a083ab3">ntoplw</a>) * pnm(i,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a1a12feb1033e5148328277eb0a083ab3">ntoplw</a>)**2.0 * <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a02a6fd3379ca9f88aedc856917d393ee">rga</a> * &amp;</div>
<div class="line"><a id="l01623" name="l01623"></a><span class="lineno"> 1623</span>                  8.60957e4 / (<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#aedb55b03e1395012ec29e1914a2df7cc">sslp</a>*tnm(i,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a1a12feb1033e5148328277eb0a083ab3">ntoplw</a>))</div>
<div class="line"><a id="l01624" name="l01624"></a><span class="lineno"> 1624</span>      uptype(i,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a1a12feb1033e5148328277eb0a083ab3">ntoplw</a>) = diff * qnm(i,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a1a12feb1033e5148328277eb0a083ab3">ntoplw</a>) * pnm(i,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a1a12feb1033e5148328277eb0a083ab3">ntoplw</a>)**2.0 *  &amp;</div>
<div class="line"><a id="l01625" name="l01625"></a><span class="lineno"> 1625</span>                    exp(1800.0*(1.0/tnm(i,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a1a12feb1033e5148328277eb0a083ab3">ntoplw</a>) - 1.0/296.0)) * <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a02a6fd3379ca9f88aedc856917d393ee">rga</a> / <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#aedb55b03e1395012ec29e1914a2df7cc">sslp</a></div>
<div class="line"><a id="l01626" name="l01626"></a><span class="lineno"> 1626</span><span class="keywordflow">   end do</span></div>
<div class="line"><a id="l01627" name="l01627"></a><span class="lineno"> 1627</span><span class="comment">!</span></div>
<div class="line"><a id="l01628" name="l01628"></a><span class="lineno"> 1628</span><span class="comment">! Calculate trace gas path lengths through model atmosphere</span></div>
<div class="line"><a id="l01629" name="l01629"></a><span class="lineno"> 1629</span><span class="comment">!</span></div>
<div class="line"><a id="l01630" name="l01630"></a><span class="lineno"> 1630</span>   <span class="keywordflow">do</span> k = <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a1a12feb1033e5148328277eb0a083ab3">ntoplw</a>,pver</div>
<div class="line"><a id="l01631" name="l01631"></a><span class="lineno"> 1631</span>      <span class="keywordflow">do</span> i = 1,ncol</div>
<div class="line"><a id="l01632" name="l01632"></a><span class="lineno"> 1632</span>         rt(i) = 1./tnm(i,k)</div>
<div class="line"><a id="l01633" name="l01633"></a><span class="lineno"> 1633</span>         rsqrt(i) = sqrt(rt(i))</div>
<div class="line"><a id="l01634" name="l01634"></a><span class="lineno"> 1634</span>         pbar(i) = 0.5 * (pnm(i,k+1) + pnm(i,k)) / <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#aedb55b03e1395012ec29e1914a2df7cc">sslp</a></div>
<div class="line"><a id="l01635" name="l01635"></a><span class="lineno"> 1635</span>         dpnm(i) = (pnm(i,k+1) - pnm(i,k)) * <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a02a6fd3379ca9f88aedc856917d393ee">rga</a></div>
<div class="line"><a id="l01636" name="l01636"></a><span class="lineno"> 1636</span>         alpha1(i) = diff * rsqrt(i) * (1.0 - exp(-1540.0/tnm(i,k)))**3.0</div>
<div class="line"><a id="l01637" name="l01637"></a><span class="lineno"> 1637</span>         alpha2(i) = diff * rsqrt(i) * (1.0 - exp(-1360.0/tnm(i,k)))**3.0</div>
<div class="line"><a id="l01638" name="l01638"></a><span class="lineno"> 1638</span>         ucfc11(i,k+1) = ucfc11(i,k) +  1.8 * cfc11(i,k) * dpnm(i)</div>
<div class="line"><a id="l01639" name="l01639"></a><span class="lineno"> 1639</span>         ucfc12(i,k+1) = ucfc12(i,k) +  1.8 * cfc12(i,k) * dpnm(i)</div>
<div class="line"><a id="l01640" name="l01640"></a><span class="lineno"> 1640</span>         un2o0(i,k+1) = un2o0(i,k) + diff * 1.02346e5 * n2o(i,k) * rsqrt(i) * dpnm(i)</div>
<div class="line"><a id="l01641" name="l01641"></a><span class="lineno"> 1641</span>         un2o1(i,k+1) = un2o1(i,k) + diff * 2.06646e5 * n2o(i,k) * &amp;</div>
<div class="line"><a id="l01642" name="l01642"></a><span class="lineno"> 1642</span>                        rsqrt(i) * exp(-847.36/tnm(i,k)) * dpnm(i)</div>
<div class="line"><a id="l01643" name="l01643"></a><span class="lineno"> 1643</span>         uch4(i,k+1) = uch4(i,k) + diff * 8.60957e4 * ch4(i,k) * rsqrt(i) * dpnm(i)</div>
<div class="line"><a id="l01644" name="l01644"></a><span class="lineno"> 1644</span>         uco211(i,k+1) = uco211(i,k) + 1.15*3.42217e3 * alpha1(i) * &amp;</div>
<div class="line"><a id="l01645" name="l01645"></a><span class="lineno"> 1645</span>                         <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a4888774864252c2e557495881ddbaa40">co2mmr</a> * exp(-1849.7/tnm(i,k)) * dpnm(i)</div>
<div class="line"><a id="l01646" name="l01646"></a><span class="lineno"> 1646</span>         uco212(i,k+1) = uco212(i,k) + 1.15*6.02454e3 * alpha1(i) * &amp;</div>
<div class="line"><a id="l01647" name="l01647"></a><span class="lineno"> 1647</span>                         <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a4888774864252c2e557495881ddbaa40">co2mmr</a> * exp(-2782.1/tnm(i,k)) * dpnm(i)</div>
<div class="line"><a id="l01648" name="l01648"></a><span class="lineno"> 1648</span>         uco213(i,k+1) = uco213(i,k) + 1.15*5.53143e3 * alpha1(i) * &amp;</div>
<div class="line"><a id="l01649" name="l01649"></a><span class="lineno"> 1649</span>                         <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a4888774864252c2e557495881ddbaa40">co2mmr</a> * exp(-3723.2/tnm(i,k)) * dpnm(i)</div>
<div class="line"><a id="l01650" name="l01650"></a><span class="lineno"> 1650</span>         uco221(i,k+1) = uco221(i,k) + 1.15*3.88984e3 * alpha2(i) * &amp;</div>
<div class="line"><a id="l01651" name="l01651"></a><span class="lineno"> 1651</span>                         <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a4888774864252c2e557495881ddbaa40">co2mmr</a> * exp(-1997.6/tnm(i,k)) * dpnm(i)</div>
<div class="line"><a id="l01652" name="l01652"></a><span class="lineno"> 1652</span>         uco222(i,k+1) = uco222(i,k) + 1.15*3.67108e3 * alpha2(i) * &amp;</div>
<div class="line"><a id="l01653" name="l01653"></a><span class="lineno"> 1653</span>                         <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a4888774864252c2e557495881ddbaa40">co2mmr</a> * exp(-3843.8/tnm(i,k)) * dpnm(i)</div>
<div class="line"><a id="l01654" name="l01654"></a><span class="lineno"> 1654</span>         uco223(i,k+1) = uco223(i,k) + 1.15*6.50642e3 * alpha2(i) * &amp;</div>
<div class="line"><a id="l01655" name="l01655"></a><span class="lineno"> 1655</span>                         <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a4888774864252c2e557495881ddbaa40">co2mmr</a> * exp(-2989.7/tnm(i,k)) * dpnm(i)</div>
<div class="line"><a id="l01656" name="l01656"></a><span class="lineno"> 1656</span>         bn2o0(i,k+1) = bn2o0(i,k) + diff * 19.399 * pbar(i) * rt(i) &amp;</div>
<div class="line"><a id="l01657" name="l01657"></a><span class="lineno"> 1657</span>                        * 1.02346e5 * n2o(i,k) * dpnm(i)</div>
<div class="line"><a id="l01658" name="l01658"></a><span class="lineno"> 1658</span>         bn2o1(i,k+1) = bn2o1(i,k) + diff * 19.399 * pbar(i) * rt(i) &amp;</div>
<div class="line"><a id="l01659" name="l01659"></a><span class="lineno"> 1659</span>                        * 2.06646e5 * exp(-847.36/tnm(i,k)) * n2o(i,k)*dpnm(i)</div>
<div class="line"><a id="l01660" name="l01660"></a><span class="lineno"> 1660</span>         bch4(i,k+1) = bch4(i,k) + diff * 2.94449 * rt(i) * pbar(i) &amp;</div>
<div class="line"><a id="l01661" name="l01661"></a><span class="lineno"> 1661</span>                       * 8.60957e4 * ch4(i,k) * dpnm(i)</div>
<div class="line"><a id="l01662" name="l01662"></a><span class="lineno"> 1662</span>         uptype(i,k+1) = uptype(i,k) + diff *qnm(i,k) * &amp;</div>
<div class="line"><a id="l01663" name="l01663"></a><span class="lineno"> 1663</span>                         exp(1800.0*(1.0/tnm(i,k) - 1.0/296.0)) * pbar(i) * dpnm(i)</div>
<div class="line"><a id="l01664" name="l01664"></a><span class="lineno"> 1664</span><span class="keywordflow">      end do</span></div>
<div class="line"><a id="l01665" name="l01665"></a><span class="lineno"> 1665</span><span class="keywordflow">   end do</span></div>
<div class="line"><a id="l01666" name="l01666"></a><span class="lineno"> 1666</span><span class="comment">!</span></div>
<div class="line"><a id="l01667" name="l01667"></a><span class="lineno"> 1667</span>   <span class="keywordflow">return</span></div>
<div class="line"><a id="l01668" name="l01668"></a><span class="lineno"> 1668</span><span class="keyword">end subroutine </span><a class="code hl_function" href="namespacemodule__ra__cam__support.html#aebde22bf6abee96139e2a1f6f30a32fb">trcpth</a></div>
<div class="line"><a id="l01669" name="l01669"></a><span class="lineno"> 1669</span> </div>
<div class="line"><a id="l01670" name="l01670"></a><span class="lineno"> 1670</span> </div>
<div class="line"><a id="l01671" name="l01671"></a><span class="lineno"> 1671</span> </div>
<div class="line"><a id="l01672" name="l01672"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#afdeaf3dafe110a840a0e153bb507d421"> 1672</a></span><span class="keyword">subroutine </span><a class="code hl_function" href="namespacemodule__ra__cam__support.html#afdeaf3dafe110a840a0e153bb507d421">aqsat</a>(t       ,p       ,es      ,qs        ,ii      , &amp;</div>
<div class="line"><a id="l01673" name="l01673"></a><span class="lineno"> 1673</span>                 ilen    ,kk      ,kstart  ,kend      )</div>
<div class="line"><a id="l01674" name="l01674"></a><span class="lineno"> 1674</span><span class="comment">!----------------------------------------------------------------------- </span></div>
<div class="line"><a id="l01675" name="l01675"></a><span class="lineno"> 1675</span><span class="comment">! </span></div>
<div class="line"><a id="l01676" name="l01676"></a><span class="lineno"> 1676</span><span class="comment">! Purpose: </span></div>
<div class="line"><a id="l01677" name="l01677"></a><span class="lineno"> 1677</span><span class="comment">! Utility procedure to look up and return saturation vapor pressure from</span></div>
<div class="line"><a id="l01678" name="l01678"></a><span class="lineno"> 1678</span><span class="comment">! precomputed table, calculate and return saturation specific humidity</span></div>
<div class="line"><a id="l01679" name="l01679"></a><span class="lineno"> 1679</span><span class="comment">! (g/g),for input arrays of temperature and pressure (dimensioned ii,kk)</span></div>
<div class="line"><a id="l01680" name="l01680"></a><span class="lineno"> 1680</span><span class="comment">! This routine is useful for evaluating only a selected region in the</span></div>
<div class="line"><a id="l01681" name="l01681"></a><span class="lineno"> 1681</span><span class="comment">! vertical.</span></div>
<div class="line"><a id="l01682" name="l01682"></a><span class="lineno"> 1682</span><span class="comment">! </span></div>
<div class="line"><a id="l01683" name="l01683"></a><span class="lineno"> 1683</span><span class="comment">! Method: </span></div>
<div class="line"><a id="l01684" name="l01684"></a><span class="lineno"> 1684</span><span class="comment">! &lt;Describe the algorithm(s) used in the routine.&gt; </span></div>
<div class="line"><a id="l01685" name="l01685"></a><span class="lineno"> 1685</span><span class="comment">! &lt;Also include any applicable external references.&gt; </span></div>
<div class="line"><a id="l01686" name="l01686"></a><span class="lineno"> 1686</span><span class="comment">! </span></div>
<div class="line"><a id="l01687" name="l01687"></a><span class="lineno"> 1687</span><span class="comment">! Author: J. Hack</span></div>
<div class="line"><a id="l01688" name="l01688"></a><span class="lineno"> 1688</span><span class="comment">! </span></div>
<div class="line"><a id="l01689" name="l01689"></a><span class="lineno"> 1689</span><span class="comment">!------------------------------Arguments--------------------------------</span></div>
<div class="line"><a id="l01690" name="l01690"></a><span class="lineno"> 1690</span><span class="comment">!</span></div>
<div class="line"><a id="l01691" name="l01691"></a><span class="lineno"> 1691</span><span class="comment">! Input arguments</span></div>
<div class="line"><a id="l01692" name="l01692"></a><span class="lineno"> 1692</span><span class="comment">!</span></div>
<div class="line"><a id="l01693" name="l01693"></a><span class="lineno"> 1693</span>   <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: ii             <span class="comment">! I dimension of arrays t, p, es, qs</span></div>
<div class="line"><a id="l01694" name="l01694"></a><span class="lineno"> 1694</span>   <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: kk             <span class="comment">! K dimension of arrays t, p, es, qs</span></div>
<div class="line"><a id="l01695" name="l01695"></a><span class="lineno"> 1695</span>   <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: ilen           <span class="comment">! Length of vectors in I direction which</span></div>
<div class="line"><a id="l01696" name="l01696"></a><span class="lineno"> 1696</span>   <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: kstart         <span class="comment">! Starting location in K direction</span></div>
<div class="line"><a id="l01697" name="l01697"></a><span class="lineno"> 1697</span>   <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: kend           <span class="comment">! Ending location in K direction</span></div>
<div class="line"><a id="l01698" name="l01698"></a><span class="lineno"> 1698</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: t(ii,kk)          <span class="comment">! Temperature</span></div>
<div class="line"><a id="l01699" name="l01699"></a><span class="lineno"> 1699</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: p(ii,kk)          <span class="comment">! Pressure</span></div>
<div class="line"><a id="l01700" name="l01700"></a><span class="lineno"> 1700</span><span class="comment">!</span></div>
<div class="line"><a id="l01701" name="l01701"></a><span class="lineno"> 1701</span><span class="comment">! Output arguments</span></div>
<div class="line"><a id="l01702" name="l01702"></a><span class="lineno"> 1702</span><span class="comment">!</span></div>
<div class="line"><a id="l01703" name="l01703"></a><span class="lineno"> 1703</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(out)</span> :: es(ii,kk)         <span class="comment">! Saturation vapor pressure</span></div>
<div class="line"><a id="l01704" name="l01704"></a><span class="lineno"> 1704</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(out)</span> :: qs(ii,kk)         <span class="comment">! Saturation specific humidity</span></div>
<div class="line"><a id="l01705" name="l01705"></a><span class="lineno"> 1705</span><span class="comment">!</span></div>
<div class="line"><a id="l01706" name="l01706"></a><span class="lineno"> 1706</span><span class="comment">!---------------------------Local workspace-----------------------------</span></div>
<div class="line"><a id="l01707" name="l01707"></a><span class="lineno"> 1707</span><span class="comment">!</span></div>
<div class="line"><a id="l01708" name="l01708"></a><span class="lineno"> 1708</span><span class="keywordtype">   real</span>(r8) omeps             <span class="comment">! 1 - 0.622</span></div>
<div class="line"><a id="l01709" name="l01709"></a><span class="lineno"> 1709</span>   <span class="keywordtype">integer</span> i, k           <span class="comment">! Indices</span></div>
<div class="line"><a id="l01710" name="l01710"></a><span class="lineno"> 1710</span><span class="comment">!</span></div>
<div class="line"><a id="l01711" name="l01711"></a><span class="lineno"> 1711</span><span class="comment">!-----------------------------------------------------------------------</span></div>
<div class="line"><a id="l01712" name="l01712"></a><span class="lineno"> 1712</span><span class="comment">!</span></div>
<div class="line"><a id="l01713" name="l01713"></a><span class="lineno"> 1713</span>   omeps = 1.0 - <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#af7e662e829862c7d94128b48616ae04b">epsqs</a></div>
<div class="line"><a id="l01714" name="l01714"></a><span class="lineno"> 1714</span>   <span class="keywordflow">do</span> k=kstart,kend</div>
<div class="line"><a id="l01715" name="l01715"></a><span class="lineno"> 1715</span>      <span class="keywordflow">do</span> i=1,ilen</div>
<div class="line"><a id="l01716" name="l01716"></a><span class="lineno"> 1716</span>         es(i,k) = <a class="code hl_function" href="namespacemodule__ra__cam__support.html#afa6ddf6a4f220dc56902e7da006468cd">estblf</a>(t(i,k))</div>
<div class="line"><a id="l01717" name="l01717"></a><span class="lineno"> 1717</span><span class="comment">!</span></div>
<div class="line"><a id="l01718" name="l01718"></a><span class="lineno"> 1718</span><span class="comment">! Saturation specific humidity</span></div>
<div class="line"><a id="l01719" name="l01719"></a><span class="lineno"> 1719</span><span class="comment">!</span></div>
<div class="line"><a id="l01720" name="l01720"></a><span class="lineno"> 1720</span>         qs(i,k) = <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#af7e662e829862c7d94128b48616ae04b">epsqs</a>*es(i,k)/(p(i,k) - omeps*es(i,k))</div>
<div class="line"><a id="l01721" name="l01721"></a><span class="lineno"> 1721</span><span class="comment">!</span></div>
<div class="line"><a id="l01722" name="l01722"></a><span class="lineno"> 1722</span><span class="comment">! The following check is to avoid the generation of negative values</span></div>
<div class="line"><a id="l01723" name="l01723"></a><span class="lineno"> 1723</span><span class="comment">! that can occur in the upper stratosphere and mesosphere</span></div>
<div class="line"><a id="l01724" name="l01724"></a><span class="lineno"> 1724</span><span class="comment">!</span></div>
<div class="line"><a id="l01725" name="l01725"></a><span class="lineno"> 1725</span>         qs(i,k) = min(1.0_r8,qs(i,k))</div>
<div class="line"><a id="l01726" name="l01726"></a><span class="lineno"> 1726</span><span class="comment">!</span></div>
<div class="line"><a id="l01727" name="l01727"></a><span class="lineno"> 1727</span>         <span class="keywordflow">if</span> (qs(i,k) &lt; 0.0) <span class="keywordflow">then</span></div>
<div class="line"><a id="l01728" name="l01728"></a><span class="lineno"> 1728</span>            qs(i,k) = 1.0</div>
<div class="line"><a id="l01729" name="l01729"></a><span class="lineno"> 1729</span>            es(i,k) = p(i,k)</div>
<div class="line"><a id="l01730" name="l01730"></a><span class="lineno"> 1730</span><span class="keywordflow">         end if</span></div>
<div class="line"><a id="l01731" name="l01731"></a><span class="lineno"> 1731</span><span class="keywordflow">      end do</span></div>
<div class="line"><a id="l01732" name="l01732"></a><span class="lineno"> 1732</span><span class="keywordflow">   end do</span></div>
<div class="line"><a id="l01733" name="l01733"></a><span class="lineno"> 1733</span><span class="comment">!</span></div>
<div class="line"><a id="l01734" name="l01734"></a><span class="lineno"> 1734</span>   <span class="keywordflow">return</span></div>
<div class="line"><a id="l01735" name="l01735"></a><span class="lineno"> 1735</span><span class="keyword">end subroutine </span><a class="code hl_function" href="namespacemodule__ra__cam__support.html#afdeaf3dafe110a840a0e153bb507d421">aqsat</a></div>
<div class="line"><a id="l01736" name="l01736"></a><span class="lineno"> 1736</span><span class="comment">!===============================================================================</span></div>
<div class="line"><a id="l01737" name="l01737"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#af892daaf6a02768d05d098d01bc3c101"> 1737</a></span>  <span class="keyword">subroutine </span><a class="code hl_function" href="namespacemodule__ra__cam__support.html#af892daaf6a02768d05d098d01bc3c101">cldefr</a>(lchnk   ,ncol    ,pcols, pver, pverp, &amp;</div>
<div class="line"><a id="l01738" name="l01738"></a><span class="lineno"> 1738</span>       landfrac,t       ,rel     ,rei     ,ps      ,pmid    , landm, icefrac, snowh)</div>
<div class="line"><a id="l01739" name="l01739"></a><span class="lineno"> 1739</span><span class="comment">!----------------------------------------------------------------------- </span></div>
<div class="line"><a id="l01740" name="l01740"></a><span class="lineno"> 1740</span><span class="comment">! </span></div>
<div class="line"><a id="l01741" name="l01741"></a><span class="lineno"> 1741</span><span class="comment">! Purpose: </span></div>
<div class="line"><a id="l01742" name="l01742"></a><span class="lineno"> 1742</span><span class="comment">! Compute cloud water and ice particle size </span></div>
<div class="line"><a id="l01743" name="l01743"></a><span class="lineno"> 1743</span><span class="comment">! </span></div>
<div class="line"><a id="l01744" name="l01744"></a><span class="lineno"> 1744</span><span class="comment">! Method: </span></div>
<div class="line"><a id="l01745" name="l01745"></a><span class="lineno"> 1745</span><span class="comment">! use empirical formulas to construct effective radii</span></div>
<div class="line"><a id="l01746" name="l01746"></a><span class="lineno"> 1746</span><span class="comment">! </span></div>
<div class="line"><a id="l01747" name="l01747"></a><span class="lineno"> 1747</span><span class="comment">! Author: J.T. Kiehl, B. A. Boville, P. Rasch</span></div>
<div class="line"><a id="l01748" name="l01748"></a><span class="lineno"> 1748</span><span class="comment">! </span></div>
<div class="line"><a id="l01749" name="l01749"></a><span class="lineno"> 1749</span><span class="comment">!-----------------------------------------------------------------------</span></div>
<div class="line"><a id="l01750" name="l01750"></a><span class="lineno"> 1750</span> </div>
<div class="line"><a id="l01751" name="l01751"></a><span class="lineno"> 1751</span>    <span class="keywordtype">implicit none</span></div>
<div class="line"><a id="l01752" name="l01752"></a><span class="lineno"> 1752</span><span class="comment">!------------------------------Arguments--------------------------------</span></div>
<div class="line"><a id="l01753" name="l01753"></a><span class="lineno"> 1753</span><span class="comment">!</span></div>
<div class="line"><a id="l01754" name="l01754"></a><span class="lineno"> 1754</span><span class="comment">! Input arguments</span></div>
<div class="line"><a id="l01755" name="l01755"></a><span class="lineno"> 1755</span><span class="comment">!</span></div>
<div class="line"><a id="l01756" name="l01756"></a><span class="lineno"> 1756</span>    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: lchnk                 <span class="comment">! chunk identifier</span></div>
<div class="line"><a id="l01757" name="l01757"></a><span class="lineno"> 1757</span>    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: ncol                  <span class="comment">! number of atmospheric columns</span></div>
<div class="line"><a id="l01758" name="l01758"></a><span class="lineno"> 1758</span>    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: pcols, pver, pverp</div>
<div class="line"><a id="l01759" name="l01759"></a><span class="lineno"> 1759</span> </div>
<div class="line"><a id="l01760" name="l01760"></a><span class="lineno"> 1760</span><span class="keywordtype">    real</span>(r8), <span class="keywordtype">intent(in)</span> :: landfrac(pcols)      <span class="comment">! Land fraction</span></div>
<div class="line"><a id="l01761" name="l01761"></a><span class="lineno"> 1761</span><span class="keywordtype">    real</span>(r8), <span class="keywordtype">intent(in)</span> :: icefrac(pcols)       <span class="comment">! Ice fraction</span></div>
<div class="line"><a id="l01762" name="l01762"></a><span class="lineno"> 1762</span><span class="keywordtype">    real</span>(r8), <span class="keywordtype">intent(in)</span> :: t(pcols,pver)        <span class="comment">! Temperature</span></div>
<div class="line"><a id="l01763" name="l01763"></a><span class="lineno"> 1763</span><span class="keywordtype">    real</span>(r8), <span class="keywordtype">intent(in)</span> :: ps(pcols)            <span class="comment">! Surface pressure</span></div>
<div class="line"><a id="l01764" name="l01764"></a><span class="lineno"> 1764</span><span class="keywordtype">    real</span>(r8), <span class="keywordtype">intent(in)</span> :: pmid(pcols,pver)     <span class="comment">! Midpoint pressures</span></div>
<div class="line"><a id="l01765" name="l01765"></a><span class="lineno"> 1765</span><span class="keywordtype">    real</span>(r8), <span class="keywordtype">intent(in)</span> :: landm(pcols)</div>
<div class="line"><a id="l01766" name="l01766"></a><span class="lineno"> 1766</span><span class="keywordtype">    real</span>(r8), <span class="keywordtype">intent(in)</span> :: snowh(pcols)         <span class="comment">! Snow depth over land, water equivalent (m)</span></div>
<div class="line"><a id="l01767" name="l01767"></a><span class="lineno"> 1767</span><span class="comment">!</span></div>
<div class="line"><a id="l01768" name="l01768"></a><span class="lineno"> 1768</span><span class="comment">! Output arguments</span></div>
<div class="line"><a id="l01769" name="l01769"></a><span class="lineno"> 1769</span><span class="comment">!</span></div>
<div class="line"><a id="l01770" name="l01770"></a><span class="lineno"> 1770</span><span class="keywordtype">    real</span>(r8), <span class="keywordtype">intent(out)</span> :: rel(pcols,pver)      <span class="comment">! Liquid effective drop size (microns)</span></div>
<div class="line"><a id="l01771" name="l01771"></a><span class="lineno"> 1771</span><span class="keywordtype">    real</span>(r8), <span class="keywordtype">intent(out)</span> :: rei(pcols,pver)      <span class="comment">! Ice effective drop size (microns)</span></div>
<div class="line"><a id="l01772" name="l01772"></a><span class="lineno"> 1772</span><span class="comment">!</span></div>
<div class="line"><a id="l01773" name="l01773"></a><span class="lineno"> 1773</span> </div>
<div class="line"><a id="l01774" name="l01774"></a><span class="lineno"> 1774</span><span class="comment">!++pjr</span></div>
<div class="line"><a id="l01775" name="l01775"></a><span class="lineno"> 1775</span><span class="comment">! following Kiehl</span></div>
<div class="line"><a id="l01776" name="l01776"></a><span class="lineno"> 1776</span>         <span class="keyword">call </span><a class="code hl_function" href="namespacemodule__ra__cam__support.html#ad0a6eb33d9ec3a8364ac2a73c046e21b">reltab</a>(ncol, pcols, pver, t, landfrac, landm, icefrac, rel, snowh)</div>
<div class="line"><a id="l01777" name="l01777"></a><span class="lineno"> 1777</span> </div>
<div class="line"><a id="l01778" name="l01778"></a><span class="lineno"> 1778</span><span class="comment">! following Kristjansson and Mitchell</span></div>
<div class="line"><a id="l01779" name="l01779"></a><span class="lineno"> 1779</span>         <span class="keyword">call </span><a class="code hl_function" href="namespacemodule__ra__cam__support.html#ad268fad53f00adfd496d699cc7b47184">reitab</a>(ncol, pcols, pver, t, rei)</div>
<div class="line"><a id="l01780" name="l01780"></a><span class="lineno"> 1780</span><span class="comment">!--pjr</span></div>
<div class="line"><a id="l01781" name="l01781"></a><span class="lineno"> 1781</span><span class="comment">!</span></div>
<div class="line"><a id="l01782" name="l01782"></a><span class="lineno"> 1782</span><span class="comment">!</span></div>
<div class="line"><a id="l01783" name="l01783"></a><span class="lineno"> 1783</span>    <span class="keywordflow">return</span></div>
<div class="line"><a id="l01784" name="l01784"></a><span class="lineno"> 1784</span>  <span class="keyword">end subroutine </span><a class="code hl_function" href="namespacemodule__ra__cam__support.html#af892daaf6a02768d05d098d01bc3c101">cldefr</a></div>
<div class="line"><a id="l01785" name="l01785"></a><span class="lineno"> 1785</span> </div>
<div class="line"><a id="l01786" name="l01786"></a><span class="lineno"> 1786</span> </div>
<div class="line"><a id="l01787" name="l01787"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a4efde24139c790af90e4d1221ee24787"> 1787</a></span><span class="keyword">subroutine </span><a class="code hl_function" href="namespacemodule__ra__cam__support.html#a4efde24139c790af90e4d1221ee24787">background</a>(lchnk, ncol, pint, pcols, pverr, pverrp, mmr)</div>
<div class="line"><a id="l01788" name="l01788"></a><span class="lineno"> 1788</span><span class="comment">!-----------------------------------------------------------------------</span></div>
<div class="line"><a id="l01789" name="l01789"></a><span class="lineno"> 1789</span><span class="comment">!</span></div>
<div class="line"><a id="l01790" name="l01790"></a><span class="lineno"> 1790</span><span class="comment">! Purpose:</span></div>
<div class="line"><a id="l01791" name="l01791"></a><span class="lineno"> 1791</span><span class="comment">! Set global mean tropospheric aerosol background (or tuning) field</span></div>
<div class="line"><a id="l01792" name="l01792"></a><span class="lineno"> 1792</span><span class="comment">!</span></div>
<div class="line"><a id="l01793" name="l01793"></a><span class="lineno"> 1793</span><span class="comment">! Method:</span></div>
<div class="line"><a id="l01794" name="l01794"></a><span class="lineno"> 1794</span><span class="comment">! Specify aerosol mixing ratio.</span></div>
<div class="line"><a id="l01795" name="l01795"></a><span class="lineno"> 1795</span><span class="comment">! Aerosol mass mixing ratio</span></div>
<div class="line"><a id="l01796" name="l01796"></a><span class="lineno"> 1796</span><span class="comment">! is specified so that the column visible aerosol optical depth is a</span></div>
<div class="line"><a id="l01797" name="l01797"></a><span class="lineno"> 1797</span><span class="comment">! specified global number (tauback). This means that the actual mixing</span></div>
<div class="line"><a id="l01798" name="l01798"></a><span class="lineno"> 1798</span><span class="comment">! ratio depends on pressure thickness of the lowest three atmospheric</span></div>
<div class="line"><a id="l01799" name="l01799"></a><span class="lineno"> 1799</span><span class="comment">! layers near the surface.</span></div>
<div class="line"><a id="l01800" name="l01800"></a><span class="lineno"> 1800</span><span class="comment">!</span></div>
<div class="line"><a id="l01801" name="l01801"></a><span class="lineno"> 1801</span><span class="preprocessor">#if defined(mpas)</span></div>
<div class="line"><a id="l01802" name="l01802"></a><span class="lineno"> 1802</span><span class="preprocessor"></span><span class="comment">! add-on to sourcecode:</span></div>
<div class="line"><a id="l01803" name="l01803"></a><span class="lineno"> 1803</span><span class="comment">! * check the value of mxaerl at the top of subroutine. If mxaerl is equal</span></div>
<div class="line"><a id="l01804" name="l01804"></a><span class="lineno"> 1804</span><span class="comment">!   to zero, then MPAS aborts to avoid dividing by zero in the calculation</span></div>
<div class="line"><a id="l01805" name="l01805"></a><span class="lineno"> 1805</span><span class="comment">!   of mass2mmr.</span></div>
<div class="line"><a id="l01806" name="l01806"></a><span class="lineno"> 1806</span><span class="comment">!   Laura D. Fowler (birch.ucar.edu) / 2013-07-01.</span></div>
<div class="line"><a id="l01807" name="l01807"></a><span class="lineno"> 1807</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l01808" name="l01808"></a><span class="lineno"> 1808</span><span class="preprocessor"></span><span class="comment">!-----------------------------------------------------------------------</span></div>
<div class="line"><a id="l01809" name="l01809"></a><span class="lineno"> 1809</span><span class="comment">!  use shr_kind_mod, only: r8 =&gt; shr_kind_r8</span></div>
<div class="line"><a id="l01810" name="l01810"></a><span class="lineno"> 1810</span><span class="comment">!  use aer_optics, only: kbg,idxVIS</span></div>
<div class="line"><a id="l01811" name="l01811"></a><span class="lineno"> 1811</span><span class="comment">!  use physconst, only: gravit</span></div>
<div class="line"><a id="l01812" name="l01812"></a><span class="lineno"> 1812</span><span class="comment">!-----------------------------------------------------------------------</span></div>
<div class="line"><a id="l01813" name="l01813"></a><span class="lineno"> 1813</span>   <span class="keywordtype">implicit none</span></div>
<div class="line"><a id="l01814" name="l01814"></a><span class="lineno"> 1814</span><span class="comment">!-----------------------------------------------------------------------</span></div>
<div class="line"><a id="l01815" name="l01815"></a><span class="lineno"> 1815</span><span class="comment">!#include &lt;ptrrgrid.h&gt;</span></div>
<div class="line"><a id="l01816" name="l01816"></a><span class="lineno"> 1816</span><span class="comment">!------------------------------Arguments--------------------------------</span></div>
<div class="line"><a id="l01817" name="l01817"></a><span class="lineno"> 1817</span><span class="comment">!</span></div>
<div class="line"><a id="l01818" name="l01818"></a><span class="lineno"> 1818</span><span class="comment">! Input arguments</span></div>
<div class="line"><a id="l01819" name="l01819"></a><span class="lineno"> 1819</span><span class="comment">!</span></div>
<div class="line"><a id="l01820" name="l01820"></a><span class="lineno"> 1820</span>   <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: lchnk                 <span class="comment">! chunk identifier</span></div>
<div class="line"><a id="l01821" name="l01821"></a><span class="lineno"> 1821</span>   <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: ncol                  <span class="comment">! number of atmospheric columns</span></div>
<div class="line"><a id="l01822" name="l01822"></a><span class="lineno"> 1822</span>   <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: pcols,pverr,pverrp</div>
<div class="line"><a id="l01823" name="l01823"></a><span class="lineno"> 1823</span> </div>
<div class="line"><a id="l01824" name="l01824"></a><span class="lineno"> 1824</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: pint(pcols,pverrp)   <span class="comment">! Interface pressure (mks)</span></div>
<div class="line"><a id="l01825" name="l01825"></a><span class="lineno"> 1825</span><span class="comment">!</span></div>
<div class="line"><a id="l01826" name="l01826"></a><span class="lineno"> 1826</span><span class="comment">! Output arguments</span></div>
<div class="line"><a id="l01827" name="l01827"></a><span class="lineno"> 1827</span><span class="comment">!</span></div>
<div class="line"><a id="l01828" name="l01828"></a><span class="lineno"> 1828</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(out)</span> :: mmr(pcols,pverr)    <span class="comment">! &quot;background&quot; aerosol mass mixing ratio</span></div>
<div class="line"><a id="l01829" name="l01829"></a><span class="lineno"> 1829</span><span class="comment">!</span></div>
<div class="line"><a id="l01830" name="l01830"></a><span class="lineno"> 1830</span><span class="comment">!---------------------------Local variables-----------------------------</span></div>
<div class="line"><a id="l01831" name="l01831"></a><span class="lineno"> 1831</span><span class="comment">!</span></div>
<div class="line"><a id="l01832" name="l01832"></a><span class="lineno"> 1832</span>   <span class="keywordtype">integer</span> i          <span class="comment">! Longitude index</span></div>
<div class="line"><a id="l01833" name="l01833"></a><span class="lineno"> 1833</span>   <span class="keywordtype">integer</span> k          <span class="comment">! Level index</span></div>
<div class="line"><a id="l01834" name="l01834"></a><span class="lineno"> 1834</span><span class="comment">!</span></div>
<div class="line"><a id="l01835" name="l01835"></a><span class="lineno"> 1835</span><span class="keywordtype">   real</span>(r8) mass2mmr  <span class="comment">! Factor to convert mass to mass mixing ratio</span></div>
<div class="line"><a id="l01836" name="l01836"></a><span class="lineno"> 1836</span><span class="keywordtype">   real</span>(r8) mass      <span class="comment">! Mass of &quot;background&quot; aerosol as specified by tauback</span></div>
<div class="line"><a id="l01837" name="l01837"></a><span class="lineno"> 1837</span><span class="comment">!</span></div>
<div class="line"><a id="l01838" name="l01838"></a><span class="lineno"> 1838</span><span class="comment">!-----------------------------------------------------------------------</span></div>
<div class="line"><a id="l01839" name="l01839"></a><span class="lineno"> 1839</span><span class="comment">!</span></div>
<div class="line"><a id="l01840" name="l01840"></a><span class="lineno"> 1840</span><span class="preprocessor">#if defined(mpas)</span></div>
<div class="line"><a id="l01841" name="l01841"></a><span class="lineno"> 1841</span><span class="preprocessor"></span>   <span class="keywordflow">if</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ab50efdf4518f1ed0df7adc0e8839b4bd">mxaerl</a> .eq. 0) &amp;</div>
<div class="line"><a id="l01842" name="l01842"></a><span class="lineno"> 1842</span>      <span class="keyword">call </span><a class="code hl_function" href="namespacempas__atmphys__utilities.html#aa49abb89b6ebc760010e08cbdade2706">physics_error_fatal</a>(<span class="stringliteral">&#39;CAMrad abort: mxaerl equals 0 in subroutine background&#39;</span>)</div>
<div class="line"><a id="l01843" name="l01843"></a><span class="lineno"> 1843</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l01844" name="l01844"></a><span class="lineno"> 1844</span><span class="preprocessor"></span> </div>
<div class="line"><a id="l01845" name="l01845"></a><span class="lineno"> 1845</span>   <span class="keywordflow">do</span> i=1,ncol</div>
<div class="line"><a id="l01846" name="l01846"></a><span class="lineno"> 1846</span>      mass2mmr =  <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a89418dd7797528310a5f90613aad0804">gravmks</a> / (pint(i,pverrp)-pint(i,pverrp-<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ab50efdf4518f1ed0df7adc0e8839b4bd">mxaerl</a>))</div>
<div class="line"><a id="l01847" name="l01847"></a><span class="lineno"> 1847</span>      <span class="keywordflow">do</span> k=1,pverr</div>
<div class="line"><a id="l01848" name="l01848"></a><span class="lineno"> 1848</span><span class="comment">!</span></div>
<div class="line"><a id="l01849" name="l01849"></a><span class="lineno"> 1849</span><span class="comment">! Compute aerosol mass mixing ratio for specified levels (1.e3 factor is</span></div>
<div class="line"><a id="l01850" name="l01850"></a><span class="lineno"> 1850</span><span class="comment">! for units conversion of the extinction coefficiant from m2/g to m2/kg)</span></div>
<div class="line"><a id="l01851" name="l01851"></a><span class="lineno"> 1851</span><span class="comment">!</span></div>
<div class="line"><a id="l01852" name="l01852"></a><span class="lineno"> 1852</span>        <span class="keywordflow">if</span> ( k &gt;= pverrp-<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ab50efdf4518f1ed0df7adc0e8839b4bd">mxaerl</a> ) <span class="keywordflow">then</span></div>
<div class="line"><a id="l01853" name="l01853"></a><span class="lineno"> 1853</span><span class="comment">! kaervs is not consistent with the values in aer_optics</span></div>
<div class="line"><a id="l01854" name="l01854"></a><span class="lineno"> 1854</span><span class="comment">! this ?should? be changed.</span></div>
<div class="line"><a id="l01855" name="l01855"></a><span class="lineno"> 1855</span><span class="comment">! rhfac is also implemented differently</span></div>
<div class="line"><a id="l01856" name="l01856"></a><span class="lineno"> 1856</span>            mass = <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a390a0bf0137854ad1b9f0e455aab7503">tauback</a> / (1.e3 * <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a7333bd6e64880f7c8a34daa55e2a9007">kbg</a>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ac44b8b41ab99cff1db5eedbdd196a269">idxvis</a>))</div>
<div class="line"><a id="l01857" name="l01857"></a><span class="lineno"> 1857</span>            mmr(i,k) = mass2mmr*mass</div>
<div class="line"><a id="l01858" name="l01858"></a><span class="lineno"> 1858</span>         <span class="keywordflow">else</span></div>
<div class="line"><a id="l01859" name="l01859"></a><span class="lineno"> 1859</span>            mmr(i,k) = 0._r8</div>
<div class="line"><a id="l01860" name="l01860"></a><span class="lineno"> 1860</span><span class="keywordflow">         endif</span></div>
<div class="line"><a id="l01861" name="l01861"></a><span class="lineno"> 1861</span><span class="comment">!</span></div>
<div class="line"><a id="l01862" name="l01862"></a><span class="lineno"> 1862</span><span class="keywordflow">      enddo</span></div>
<div class="line"><a id="l01863" name="l01863"></a><span class="lineno"> 1863</span><span class="keywordflow">   enddo</span></div>
<div class="line"><a id="l01864" name="l01864"></a><span class="lineno"> 1864</span><span class="comment">!</span></div>
<div class="line"><a id="l01865" name="l01865"></a><span class="lineno"> 1865</span>   <span class="keywordflow">return</span></div>
<div class="line"><a id="l01866" name="l01866"></a><span class="lineno"> 1866</span><span class="keyword">end subroutine </span><a class="code hl_function" href="namespacemodule__ra__cam__support.html#a4efde24139c790af90e4d1221ee24787">background</a></div>
<div class="line"><a id="l01867" name="l01867"></a><span class="lineno"> 1867</span> </div>
<div class="line"><a id="l01868" name="l01868"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#ae13281ef00b6e7a8aa0b3d1bfe08f3ee"> 1868</a></span><span class="keyword">subroutine </span><a class="code hl_function" href="namespacemodule__ra__cam__support.html#ae13281ef00b6e7a8aa0b3d1bfe08f3ee">scale_aerosols</a>(AEROSOLt, pcols, pver, ncol, lchnk, scale)</div>
<div class="line"><a id="l01869" name="l01869"></a><span class="lineno"> 1869</span><span class="comment">!-----------------------------------------------------------------</span></div>
<div class="line"><a id="l01870" name="l01870"></a><span class="lineno"> 1870</span><span class="comment">! scale each species as determined by scale factors</span></div>
<div class="line"><a id="l01871" name="l01871"></a><span class="lineno"> 1871</span><span class="comment">!-----------------------------------------------------------------</span></div>
<div class="line"><a id="l01872" name="l01872"></a><span class="lineno"> 1872</span>  <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: ncol, lchnk <span class="comment">! number of columns and chunk index</span></div>
<div class="line"><a id="l01873" name="l01873"></a><span class="lineno"> 1873</span>  <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: pcols, pver</div>
<div class="line"><a id="l01874" name="l01874"></a><span class="lineno"> 1874</span><span class="keywordtype">  real</span>(r8), <span class="keywordtype">intent(in)</span> :: scale(naer_all) <span class="comment">! scale each aerosol by this amount</span></div>
<div class="line"><a id="l01875" name="l01875"></a><span class="lineno"> 1875</span><span class="keywordtype">  real</span>(r8), <span class="keywordtype">intent(inout)</span> :: AEROSOLt(pcols, pver, naer_all) <span class="comment">! aerosols</span></div>
<div class="line"><a id="l01876" name="l01876"></a><span class="lineno"> 1876</span>  <span class="keywordtype">integer</span> m</div>
<div class="line"><a id="l01877" name="l01877"></a><span class="lineno"> 1877</span> </div>
<div class="line"><a id="l01878" name="l01878"></a><span class="lineno"> 1878</span>  <span class="keywordflow">do</span> m = 1, naer_all</div>
<div class="line"><a id="l01879" name="l01879"></a><span class="lineno"> 1879</span>     aerosolt(:ncol, :, m) = scale(m)*aerosolt(:ncol, :, m)</div>
<div class="line"><a id="l01880" name="l01880"></a><span class="lineno"> 1880</span><span class="keywordflow">  end do</span></div>
<div class="line"><a id="l01881" name="l01881"></a><span class="lineno"> 1881</span> </div>
<div class="line"><a id="l01882" name="l01882"></a><span class="lineno"> 1882</span>  <span class="keywordflow">return</span></div>
<div class="line"><a id="l01883" name="l01883"></a><span class="lineno"> 1883</span><span class="keyword">end subroutine </span><a class="code hl_function" href="namespacemodule__ra__cam__support.html#ae13281ef00b6e7a8aa0b3d1bfe08f3ee">scale_aerosols</a></div>
<div class="line"><a id="l01884" name="l01884"></a><span class="lineno"> 1884</span> </div>
<div class="line"><a id="l01885" name="l01885"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#ae1e13161e0ac9945a214464c0a5805c4"> 1885</a></span><span class="keyword">subroutine </span><a class="code hl_function" href="namespacemodule__ra__cam__support.html#ae1e13161e0ac9945a214464c0a5805c4">get_int_scales</a>(scales)</div>
<div class="line"><a id="l01886" name="l01886"></a><span class="lineno"> 1886</span><span class="keywordtype">  real</span>(r8), <span class="keywordtype">intent(out)</span>::scales(naer_all)  <span class="comment">! scale each aerosol by this amount</span></div>
<div class="line"><a id="l01887" name="l01887"></a><span class="lineno"> 1887</span>  <span class="keywordtype">integer</span> i                                  <span class="comment">! index through species</span></div>
<div class="line"><a id="l01888" name="l01888"></a><span class="lineno"> 1888</span> </div>
<div class="line"><a id="l01889" name="l01889"></a><span class="lineno"> 1889</span><span class="comment">!initialize</span></div>
<div class="line"><a id="l01890" name="l01890"></a><span class="lineno"> 1890</span>  scales = 1.</div>
<div class="line"><a id="l01891" name="l01891"></a><span class="lineno"> 1891</span> </div>
<div class="line"><a id="l01892" name="l01892"></a><span class="lineno"> 1892</span>  scales(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ab377fd834d670fed20ad3f59d359f8a7">idxbg</a>) = 1._r8</div>
<div class="line"><a id="l01893" name="l01893"></a><span class="lineno"> 1893</span>  scales(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a863b1d9602abdd9946b40135690a4db5">idxsul</a>) = <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#abd55a533deea6b6e4f418fbdb8ab7f6f">sulscl</a> </div>
<div class="line"><a id="l01894" name="l01894"></a><span class="lineno"> 1894</span>  scales(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a521884c838130d3a7fce69511e4708a0">idxsslt</a>) = <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a02a9ac601d0bc3f5408141218044d38e">ssltscl</a>  </div>
<div class="line"><a id="l01895" name="l01895"></a><span class="lineno"> 1895</span>  </div>
<div class="line"><a id="l01896" name="l01896"></a><span class="lineno"> 1896</span>  <span class="keywordflow">do</span> i = <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a35f5066746b13db0893d19b839574bc9">idxcarbonfirst</a>, <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a35f5066746b13db0893d19b839574bc9">idxcarbonfirst</a>+<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ae44324bed6778856144ccf65c0b8bf34">numcarbon</a>-1</div>
<div class="line"><a id="l01897" name="l01897"></a><span class="lineno"> 1897</span>    scales(i) = <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a0183c64b88e8ab41234d01725523454f">carscl</a></div>
<div class="line"><a id="l01898" name="l01898"></a><span class="lineno"> 1898</span><span class="keywordflow">  enddo</span></div>
<div class="line"><a id="l01899" name="l01899"></a><span class="lineno"> 1899</span>  </div>
<div class="line"><a id="l01900" name="l01900"></a><span class="lineno"> 1900</span>  <span class="keywordflow">do</span> i = <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a130c6997ed212e28b4c576707a7e82ad">idxdustfirst</a>, <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a130c6997ed212e28b4c576707a7e82ad">idxdustfirst</a>+<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#acf3acb40440157c2ff3dab3ebcde1546">numdust</a>-1</div>
<div class="line"><a id="l01901" name="l01901"></a><span class="lineno"> 1901</span>    scales(i) = <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a1b3671cb014fbdf0e5cf156dbd5bd316">dustscl</a></div>
<div class="line"><a id="l01902" name="l01902"></a><span class="lineno"> 1902</span><span class="keywordflow">  enddo</span></div>
<div class="line"><a id="l01903" name="l01903"></a><span class="lineno"> 1903</span> </div>
<div class="line"><a id="l01904" name="l01904"></a><span class="lineno"> 1904</span>  scales(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a027edc99883f6383db3e8108e2d28bce">idxvolc</a>) = <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a59a5f8093c36f54b739fac17bb9f2158">volcscl</a></div>
<div class="line"><a id="l01905" name="l01905"></a><span class="lineno"> 1905</span> </div>
<div class="line"><a id="l01906" name="l01906"></a><span class="lineno"> 1906</span>  <span class="keywordflow">return</span></div>
<div class="line"><a id="l01907" name="l01907"></a><span class="lineno"> 1907</span><span class="keyword">end subroutine </span><a class="code hl_function" href="namespacemodule__ra__cam__support.html#ae1e13161e0ac9945a214464c0a5805c4">get_int_scales</a></div>
<div class="line"><a id="l01908" name="l01908"></a><span class="lineno"> 1908</span> </div>
<div class="line"><a id="l01909" name="l01909"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a49bd824d487a1d945b332a79c956d68e"> 1909</a></span><span class="keyword">subroutine </span><a class="code hl_function" href="namespacemodule__ra__cam__support.html#a49bd824d487a1d945b332a79c956d68e">vert_interpolate</a> (Match_ps, aerosolc, m_hybi, paerlev, naer_c, pint, n, AEROSOL_mmr, pcols, pver, pverp, ncol, c)</div>
<div class="line"><a id="l01910" name="l01910"></a><span class="lineno"> 1910</span><span class="comment">!--------------------------------------------------------------------</span></div>
<div class="line"><a id="l01911" name="l01911"></a><span class="lineno"> 1911</span><span class="comment">! Input: match surface pressure, cam interface pressure,</span></div>
<div class="line"><a id="l01912" name="l01912"></a><span class="lineno"> 1912</span><span class="comment">!        month index, number of columns, chunk index</span></div>
<div class="line"><a id="l01913" name="l01913"></a><span class="lineno"> 1913</span><span class="comment">!</span></div>
<div class="line"><a id="l01914" name="l01914"></a><span class="lineno"> 1914</span><span class="comment">! Output: Aerosol mass mixing ratio (AEROSOL_mmr)</span></div>
<div class="line"><a id="l01915" name="l01915"></a><span class="lineno"> 1915</span><span class="comment">!</span></div>
<div class="line"><a id="l01916" name="l01916"></a><span class="lineno"> 1916</span><span class="comment">! Method:</span></div>
<div class="line"><a id="l01917" name="l01917"></a><span class="lineno"> 1917</span><span class="comment">!         interpolate column mass (cumulative) from match onto</span></div>
<div class="line"><a id="l01918" name="l01918"></a><span class="lineno"> 1918</span><span class="comment">!           cam&#39;s vertical grid (pressure coordinate)</span></div>
<div class="line"><a id="l01919" name="l01919"></a><span class="lineno"> 1919</span><span class="comment">!         convert back to mass mixing ratio</span></div>
<div class="line"><a id="l01920" name="l01920"></a><span class="lineno"> 1920</span><span class="comment">!</span></div>
<div class="line"><a id="l01921" name="l01921"></a><span class="lineno"> 1921</span><span class="comment">!--------------------------------------------------------------------</span></div>
<div class="line"><a id="l01922" name="l01922"></a><span class="lineno"> 1922</span> </div>
<div class="line"><a id="l01923" name="l01923"></a><span class="lineno"> 1923</span><span class="comment">!  use physconst,     only: gravit</span></div>
<div class="line"><a id="l01924" name="l01924"></a><span class="lineno"> 1924</span> </div>
<div class="line"><a id="l01925" name="l01925"></a><span class="lineno"> 1925</span>   <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span>  :: paerlev,naer_c,pcols,pver,pverp</div>
<div class="line"><a id="l01926" name="l01926"></a><span class="lineno"> 1926</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(out)</span> :: AEROSOL_mmr(pcols,pver,naer)  <span class="comment">! aerosol mmr from MATCH</span></div>
<div class="line"><a id="l01927" name="l01927"></a><span class="lineno"> 1927</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: Match_ps(pcols)                <span class="comment">! surface pressure at a particular month</span></div>
<div class="line"><a id="l01928" name="l01928"></a><span class="lineno"> 1928</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: pint(pcols,pverp)              <span class="comment">! interface pressure from CAM</span></div>
<div class="line"><a id="l01929" name="l01929"></a><span class="lineno"> 1929</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: aerosolc(pcols,paerlev,naer_c)</div>
<div class="line"><a id="l01930" name="l01930"></a><span class="lineno"> 1930</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: m_hybi(paerlev)</div>
<div class="line"><a id="l01931" name="l01931"></a><span class="lineno"> 1931</span> </div>
<div class="line"><a id="l01932" name="l01932"></a><span class="lineno"> 1932</span>   <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: ncol,c                          <span class="comment">! chunk index and number of columns</span></div>
<div class="line"><a id="l01933" name="l01933"></a><span class="lineno"> 1933</span>   <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: n                               <span class="comment">! prv or nxt month index</span></div>
<div class="line"><a id="l01934" name="l01934"></a><span class="lineno"> 1934</span><span class="comment">!</span></div>
<div class="line"><a id="l01935" name="l01935"></a><span class="lineno"> 1935</span><span class="comment">! Local workspace</span></div>
<div class="line"><a id="l01936" name="l01936"></a><span class="lineno"> 1936</span><span class="comment">!</span></div>
<div class="line"><a id="l01937" name="l01937"></a><span class="lineno"> 1937</span>   <span class="keywordtype">integer</span> m                           <span class="comment">! index to aerosol species</span></div>
<div class="line"><a id="l01938" name="l01938"></a><span class="lineno"> 1938</span>   <span class="keywordtype">integer</span> kupper(pcols)               <span class="comment">! last upper bound for interpolation</span></div>
<div class="line"><a id="l01939" name="l01939"></a><span class="lineno"> 1939</span>   <span class="keywordtype">integer</span> i, k, kk, kkstart, kount    <span class="comment">! loop vars for interpolation</span></div>
<div class="line"><a id="l01940" name="l01940"></a><span class="lineno"> 1940</span>   <span class="keywordtype">integer</span> isv, ksv, msv               <span class="comment">! loop indices to save</span></div>
<div class="line"><a id="l01941" name="l01941"></a><span class="lineno"> 1941</span> </div>
<div class="line"><a id="l01942" name="l01942"></a><span class="lineno"> 1942</span>   <span class="keywordtype">logical</span> bad                         <span class="comment">! indicates a bad point found</span></div>
<div class="line"><a id="l01943" name="l01943"></a><span class="lineno"> 1943</span>   <span class="keywordtype">logical</span> lev_interp_comp             <span class="comment">! interpolation completed for a level</span></div>
<div class="line"><a id="l01944" name="l01944"></a><span class="lineno"> 1944</span> </div>
<div class="line"><a id="l01945" name="l01945"></a><span class="lineno"> 1945</span><span class="keywordtype">   real</span>(r8) AEROSOL(pcols,pverp,naer)  <span class="comment">! cumulative mass of aerosol in column beneath upper</span></div>
<div class="line"><a id="l01946" name="l01946"></a><span class="lineno"> 1946</span>                                       <span class="comment">! interface of level in column at particular month</span></div>
<div class="line"><a id="l01947" name="l01947"></a><span class="lineno"> 1947</span><span class="keywordtype">   real</span>(r8) dpl, dpu                   <span class="comment">! lower and upper intepolation factors</span></div>
<div class="line"><a id="l01948" name="l01948"></a><span class="lineno"> 1948</span><span class="keywordtype">   real</span>(r8) v_coord                    <span class="comment">! vertical coordinate</span></div>
<div class="line"><a id="l01949" name="l01949"></a><span class="lineno"> 1949</span><span class="keywordtype">   real</span>(r8) m_to_mmr                   <span class="comment">! mass to mass mixing ratio conversion factor</span></div>
<div class="line"><a id="l01950" name="l01950"></a><span class="lineno"> 1950</span><span class="keywordtype">   real</span>(r8) AER_diff                   <span class="comment">! temp var for difference between aerosol masses</span></div>
<div class="line"><a id="l01951" name="l01951"></a><span class="lineno"> 1951</span> </div>
<div class="line"><a id="l01952" name="l01952"></a><span class="lineno"> 1952</span><span class="comment">!  call t_startf (&#39;vert_interpolate&#39;)</span></div>
<div class="line"><a id="l01953" name="l01953"></a><span class="lineno"> 1953</span><span class="comment">!</span></div>
<div class="line"><a id="l01954" name="l01954"></a><span class="lineno"> 1954</span><span class="comment">! Initialize index array</span></div>
<div class="line"><a id="l01955" name="l01955"></a><span class="lineno"> 1955</span><span class="comment">!</span></div>
<div class="line"><a id="l01956" name="l01956"></a><span class="lineno"> 1956</span>   <span class="keywordflow">do</span> i=1,ncol</div>
<div class="line"><a id="l01957" name="l01957"></a><span class="lineno"> 1957</span>      kupper(i) = 1</div>
<div class="line"><a id="l01958" name="l01958"></a><span class="lineno"> 1958</span><span class="keywordflow">   end do</span></div>
<div class="line"><a id="l01959" name="l01959"></a><span class="lineno"> 1959</span><span class="comment">!</span></div>
<div class="line"><a id="l01960" name="l01960"></a><span class="lineno"> 1960</span><span class="comment">! assign total mass to topmost level</span></div>
<div class="line"><a id="l01961" name="l01961"></a><span class="lineno"> 1961</span><span class="comment">!</span></div>
<div class="line"><a id="l01962" name="l01962"></a><span class="lineno"> 1962</span>   </div>
<div class="line"><a id="l01963" name="l01963"></a><span class="lineno"> 1963</span>   <span class="keywordflow">do</span> i=1,ncol</div>
<div class="line"><a id="l01964" name="l01964"></a><span class="lineno"> 1964</span>   <span class="keywordflow">do</span> m=1,naer</div>
<div class="line"><a id="l01965" name="l01965"></a><span class="lineno"> 1965</span>   aerosol(i,1,m) = aerosolc(i,1,m)</div>
<div class="line"><a id="l01966" name="l01966"></a><span class="lineno"> 1966</span><span class="keywordflow">   enddo</span></div>
<div class="line"><a id="l01967" name="l01967"></a><span class="lineno"> 1967</span><span class="keywordflow">   enddo</span></div>
<div class="line"><a id="l01968" name="l01968"></a><span class="lineno"> 1968</span><span class="comment">!</span></div>
<div class="line"><a id="l01969" name="l01969"></a><span class="lineno"> 1969</span><span class="comment">! At every pressure level, interpolate onto that pressure level</span></div>
<div class="line"><a id="l01970" name="l01970"></a><span class="lineno"> 1970</span><span class="comment">!</span></div>
<div class="line"><a id="l01971" name="l01971"></a><span class="lineno"> 1971</span>   <span class="keywordflow">do</span> k=2,pver</div>
<div class="line"><a id="l01972" name="l01972"></a><span class="lineno"> 1972</span><span class="comment">!</span></div>
<div class="line"><a id="l01973" name="l01973"></a><span class="lineno"> 1973</span><span class="comment">! Top level we need to start looking is the top level for the previous k</span></div>
<div class="line"><a id="l01974" name="l01974"></a><span class="lineno"> 1974</span><span class="comment">! for all longitude points</span></div>
<div class="line"><a id="l01975" name="l01975"></a><span class="lineno"> 1975</span><span class="comment">!</span></div>
<div class="line"><a id="l01976" name="l01976"></a><span class="lineno"> 1976</span>      kkstart = paerlev</div>
<div class="line"><a id="l01977" name="l01977"></a><span class="lineno"> 1977</span>      <span class="keywordflow">do</span> i=1,ncol</div>
<div class="line"><a id="l01978" name="l01978"></a><span class="lineno"> 1978</span>         kkstart = min0(kkstart,kupper(i))</div>
<div class="line"><a id="l01979" name="l01979"></a><span class="lineno"> 1979</span><span class="keywordflow">      end do</span></div>
<div class="line"><a id="l01980" name="l01980"></a><span class="lineno"> 1980</span>      kount = 0</div>
<div class="line"><a id="l01981" name="l01981"></a><span class="lineno"> 1981</span><span class="comment">!</span></div>
<div class="line"><a id="l01982" name="l01982"></a><span class="lineno"> 1982</span><span class="comment">! Store level indices for interpolation</span></div>
<div class="line"><a id="l01983" name="l01983"></a><span class="lineno"> 1983</span><span class="comment">!</span></div>
<div class="line"><a id="l01984" name="l01984"></a><span class="lineno"> 1984</span><span class="comment">! for the pressure interpolation should be comparing</span></div>
<div class="line"><a id="l01985" name="l01985"></a><span class="lineno"> 1985</span><span class="comment">! pint(column,lev) with M_hybi(lev)*M_ps_cam_col(month,column,chunk)</span></div>
<div class="line"><a id="l01986" name="l01986"></a><span class="lineno"> 1986</span><span class="comment">!</span></div>
<div class="line"><a id="l01987" name="l01987"></a><span class="lineno"> 1987</span>      lev_interp_comp = .false.</div>
<div class="line"><a id="l01988" name="l01988"></a><span class="lineno"> 1988</span>      <span class="keywordflow">do</span> kk=kkstart,paerlev-1</div>
<div class="line"><a id="l01989" name="l01989"></a><span class="lineno"> 1989</span>         <span class="keywordflow">if</span>(.not.lev_interp_comp) <span class="keywordflow">then</span></div>
<div class="line"><a id="l01990" name="l01990"></a><span class="lineno"> 1990</span>         <span class="keywordflow">do</span> i=1,ncol</div>
<div class="line"><a id="l01991" name="l01991"></a><span class="lineno"> 1991</span>            v_coord = pint(i,k)</div>
<div class="line"><a id="l01992" name="l01992"></a><span class="lineno"> 1992</span>            <span class="keywordflow">if</span> (m_hybi(kk)*match_ps(i) .lt. v_coord .and. v_coord .le. m_hybi(kk+1)*match_ps(i)) <span class="keywordflow">then</span></div>
<div class="line"><a id="l01993" name="l01993"></a><span class="lineno"> 1993</span>               kupper(i) = kk</div>
<div class="line"><a id="l01994" name="l01994"></a><span class="lineno"> 1994</span>               kount = kount + 1</div>
<div class="line"><a id="l01995" name="l01995"></a><span class="lineno"> 1995</span><span class="keywordflow">            end if</span></div>
<div class="line"><a id="l01996" name="l01996"></a><span class="lineno"> 1996</span><span class="keywordflow">         end do</span></div>
<div class="line"><a id="l01997" name="l01997"></a><span class="lineno"> 1997</span><span class="comment">!</span></div>
<div class="line"><a id="l01998" name="l01998"></a><span class="lineno"> 1998</span><span class="comment">! If all indices for this level have been found, do the interpolation and</span></div>
<div class="line"><a id="l01999" name="l01999"></a><span class="lineno"> 1999</span><span class="comment">! go to the next level</span></div>
<div class="line"><a id="l02000" name="l02000"></a><span class="lineno"> 2000</span><span class="comment">!</span></div>
<div class="line"><a id="l02001" name="l02001"></a><span class="lineno"> 2001</span><span class="comment">! Interpolate in pressure.</span></div>
<div class="line"><a id="l02002" name="l02002"></a><span class="lineno"> 2002</span><span class="comment">!</span></div>
<div class="line"><a id="l02003" name="l02003"></a><span class="lineno"> 2003</span>         <span class="keywordflow">if</span> (kount.eq.ncol) <span class="keywordflow">then</span></div>
<div class="line"><a id="l02004" name="l02004"></a><span class="lineno"> 2004</span>            <span class="keywordflow">do</span> i=1,ncol</div>
<div class="line"><a id="l02005" name="l02005"></a><span class="lineno"> 2005</span>             <span class="keywordflow">do</span> m=1,naer</div>
<div class="line"><a id="l02006" name="l02006"></a><span class="lineno"> 2006</span>               dpu = pint(i,k) - m_hybi(kupper(i))*match_ps(i)</div>
<div class="line"><a id="l02007" name="l02007"></a><span class="lineno"> 2007</span>               dpl = m_hybi(kupper(i)+1)*match_ps(i) - pint(i,k)</div>
<div class="line"><a id="l02008" name="l02008"></a><span class="lineno"> 2008</span>               aerosol(i,k,m) = &amp;</div>
<div class="line"><a id="l02009" name="l02009"></a><span class="lineno"> 2009</span>                    (aerosolc(i,kupper(i)  ,m)*dpl + &amp;</div>
<div class="line"><a id="l02010" name="l02010"></a><span class="lineno"> 2010</span>                     aerosolc(i,kupper(i)+1,m)*dpu)/(dpl + dpu)</div>
<div class="line"><a id="l02011" name="l02011"></a><span class="lineno"> 2011</span><span class="keywordflow">             enddo</span></div>
<div class="line"><a id="l02012" name="l02012"></a><span class="lineno"> 2012</span><span class="keywordflow">            enddo</span> <span class="comment">!i</span></div>
<div class="line"><a id="l02013" name="l02013"></a><span class="lineno"> 2013</span>            lev_interp_comp = .true.</div>
<div class="line"><a id="l02014" name="l02014"></a><span class="lineno"> 2014</span><span class="keywordflow">         end if</span></div>
<div class="line"><a id="l02015" name="l02015"></a><span class="lineno"> 2015</span><span class="keywordflow">         end if</span></div>
<div class="line"><a id="l02016" name="l02016"></a><span class="lineno"> 2016</span><span class="keywordflow">      end do</span></div>
<div class="line"><a id="l02017" name="l02017"></a><span class="lineno"> 2017</span><span class="comment">!</span></div>
<div class="line"><a id="l02018" name="l02018"></a><span class="lineno"> 2018</span><span class="comment">! If we&#39;ve fallen through the kk=1,levsiz-1 loop, we cannot interpolate and</span></div>
<div class="line"><a id="l02019" name="l02019"></a><span class="lineno"> 2019</span> </div>
<div class="line"><a id="l02020" name="l02020"></a><span class="lineno"> 2020</span><span class="comment">! must extrapolate from the bottom or top pressure level for at least some</span></div>
<div class="line"><a id="l02021" name="l02021"></a><span class="lineno"> 2021</span><span class="comment">! of the longitude points.</span></div>
<div class="line"><a id="l02022" name="l02022"></a><span class="lineno"> 2022</span><span class="comment">!</span></div>
<div class="line"><a id="l02023" name="l02023"></a><span class="lineno"> 2023</span> </div>
<div class="line"><a id="l02024" name="l02024"></a><span class="lineno"> 2024</span>      <span class="keywordflow">if</span>(.not.lev_interp_comp) <span class="keywordflow">then</span></div>
<div class="line"><a id="l02025" name="l02025"></a><span class="lineno"> 2025</span>         <span class="keywordflow">do</span> i=1,ncol</div>
<div class="line"><a id="l02026" name="l02026"></a><span class="lineno"> 2026</span>          <span class="keywordflow">do</span> m=1,naer </div>
<div class="line"><a id="l02027" name="l02027"></a><span class="lineno"> 2027</span>            <span class="keywordflow">if</span> (pint(i,k) .lt. m_hybi(1)*match_ps(i)) <span class="keywordflow">then</span></div>
<div class="line"><a id="l02028" name="l02028"></a><span class="lineno"> 2028</span>               aerosol(i,k,m) =  aerosolc(i,1,m)</div>
<div class="line"><a id="l02029" name="l02029"></a><span class="lineno"> 2029</span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pint(i,k) .gt. m_hybi(paerlev)*match_ps(i)) <span class="keywordflow">then</span></div>
<div class="line"><a id="l02030" name="l02030"></a><span class="lineno"> 2030</span>               aerosol(i,k,m) = 0.0</div>
<div class="line"><a id="l02031" name="l02031"></a><span class="lineno"> 2031</span>            <span class="keywordflow">else</span></div>
<div class="line"><a id="l02032" name="l02032"></a><span class="lineno"> 2032</span>               dpu = pint(i,k) - m_hybi(kupper(i))*match_ps(i)</div>
<div class="line"><a id="l02033" name="l02033"></a><span class="lineno"> 2033</span>               dpl = m_hybi(kupper(i)+1)*match_ps(i) - pint(i,k)</div>
<div class="line"><a id="l02034" name="l02034"></a><span class="lineno"> 2034</span>               aerosol(i,k,m) = &amp;</div>
<div class="line"><a id="l02035" name="l02035"></a><span class="lineno"> 2035</span>                    (aerosolc(i,kupper(i)  ,m)*dpl + &amp;</div>
<div class="line"><a id="l02036" name="l02036"></a><span class="lineno"> 2036</span>                     aerosolc(i,kupper(i)+1,m)*dpu)/(dpl + dpu)</div>
<div class="line"><a id="l02037" name="l02037"></a><span class="lineno"> 2037</span><span class="keywordflow">            end if</span></div>
<div class="line"><a id="l02038" name="l02038"></a><span class="lineno"> 2038</span><span class="keywordflow">          enddo</span></div>
<div class="line"><a id="l02039" name="l02039"></a><span class="lineno"> 2039</span><span class="keywordflow">         end do</span></div>
<div class="line"><a id="l02040" name="l02040"></a><span class="lineno"> 2040</span> </div>
<div class="line"><a id="l02041" name="l02041"></a><span class="lineno"> 2041</span>         <span class="keywordflow">if</span> (kount.gt.ncol) <span class="keywordflow">then</span></div>
<div class="line"><a id="l02042" name="l02042"></a><span class="lineno"> 2042</span><span class="comment">!           call endrun (&#39;VERT_INTERPOLATE: Bad data: non-monotonicity suspected in dependent variable&#39;)</span></div>
<div class="line"><a id="l02043" name="l02043"></a><span class="lineno"> 2043</span><span class="keywordflow">         end if</span></div>
<div class="line"><a id="l02044" name="l02044"></a><span class="lineno"> 2044</span><span class="keywordflow">      end if</span></div>
<div class="line"><a id="l02045" name="l02045"></a><span class="lineno"> 2045</span><span class="keywordflow">   end do</span></div>
<div class="line"><a id="l02046" name="l02046"></a><span class="lineno"> 2046</span> </div>
<div class="line"><a id="l02047" name="l02047"></a><span class="lineno"> 2047</span><span class="comment">!  call t_startf (&#39;vi_checks&#39;)</span></div>
<div class="line"><a id="l02048" name="l02048"></a><span class="lineno"> 2048</span><span class="comment">!</span></div>
<div class="line"><a id="l02049" name="l02049"></a><span class="lineno"> 2049</span><span class="comment">! aerosol mass beneath lowest interface (pverp) must be 0</span></div>
<div class="line"><a id="l02050" name="l02050"></a><span class="lineno"> 2050</span><span class="comment">!</span></div>
<div class="line"><a id="l02051" name="l02051"></a><span class="lineno"> 2051</span>   aerosol(1:ncol,pverp,:) = 0.</div>
<div class="line"><a id="l02052" name="l02052"></a><span class="lineno"> 2052</span><span class="comment">!</span></div>
<div class="line"><a id="l02053" name="l02053"></a><span class="lineno"> 2053</span><span class="comment">! Set mass in layer to zero whenever it is less than</span></div>
<div class="line"><a id="l02054" name="l02054"></a><span class="lineno"> 2054</span><span class="comment">!   1.e-40 kg/m^2 in the layer</span></div>
<div class="line"><a id="l02055" name="l02055"></a><span class="lineno"> 2055</span><span class="comment">!</span></div>
<div class="line"><a id="l02056" name="l02056"></a><span class="lineno"> 2056</span>   <span class="keywordflow">do</span> m = 1, naer</div>
<div class="line"><a id="l02057" name="l02057"></a><span class="lineno"> 2057</span>      <span class="keywordflow">do</span> k = 1, pver</div>
<div class="line"><a id="l02058" name="l02058"></a><span class="lineno"> 2058</span>         <span class="keywordflow">do</span> i = 1, ncol</div>
<div class="line"><a id="l02059" name="l02059"></a><span class="lineno"> 2059</span>            <span class="keywordflow">if</span> (aerosol(i,k,m) &lt; 1.e-40_r8) aerosol(i,k,m) = 0.</div>
<div class="line"><a id="l02060" name="l02060"></a><span class="lineno"> 2060</span><span class="keywordflow">         end do</span></div>
<div class="line"><a id="l02061" name="l02061"></a><span class="lineno"> 2061</span><span class="keywordflow">      end do</span></div>
<div class="line"><a id="l02062" name="l02062"></a><span class="lineno"> 2062</span><span class="keywordflow">   end do</span></div>
<div class="line"><a id="l02063" name="l02063"></a><span class="lineno"> 2063</span><span class="comment">!</span></div>
<div class="line"><a id="l02064" name="l02064"></a><span class="lineno"> 2064</span><span class="comment">! Set mass in layer to zero whenever it is less than</span></div>
<div class="line"><a id="l02065" name="l02065"></a><span class="lineno"> 2065</span><span class="comment">!   10^-15 relative to column total mass</span></div>
<div class="line"><a id="l02066" name="l02066"></a><span class="lineno"> 2066</span><span class="comment">! convert back to mass mixing ratios.</span></div>
<div class="line"><a id="l02067" name="l02067"></a><span class="lineno"> 2067</span><span class="comment">! exit if mmr is negative</span></div>
<div class="line"><a id="l02068" name="l02068"></a><span class="lineno"> 2068</span><span class="comment">!</span></div>
<div class="line"><a id="l02069" name="l02069"></a><span class="lineno"> 2069</span>   <span class="keywordflow">do</span> m = 1, naer</div>
<div class="line"><a id="l02070" name="l02070"></a><span class="lineno"> 2070</span>      <span class="keywordflow">do</span> k = 1, pver</div>
<div class="line"><a id="l02071" name="l02071"></a><span class="lineno"> 2071</span>         <span class="keywordflow">do</span> i = 1, ncol</div>
<div class="line"><a id="l02072" name="l02072"></a><span class="lineno"> 2072</span>            aer_diff = aerosol(i,k,m) - aerosol(i,k+1,m)</div>
<div class="line"><a id="l02073" name="l02073"></a><span class="lineno"> 2073</span>            <span class="keywordflow">if</span>( abs(aer_diff) &lt; 1e-15*aerosol(i,1,m)) <span class="keywordflow">then</span></div>
<div class="line"><a id="l02074" name="l02074"></a><span class="lineno"> 2074</span>               aer_diff = 0.</div>
<div class="line"><a id="l02075" name="l02075"></a><span class="lineno"> 2075</span><span class="keywordflow">            end if</span></div>
<div class="line"><a id="l02076" name="l02076"></a><span class="lineno"> 2076</span>            m_to_mmr = <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a89418dd7797528310a5f90613aad0804">gravmks</a> / (pint(i,k+1)-pint(i,k))</div>
<div class="line"><a id="l02077" name="l02077"></a><span class="lineno"> 2077</span>            aerosol_mmr(i,k,m)= aer_diff * m_to_mmr</div>
<div class="line"><a id="l02078" name="l02078"></a><span class="lineno"> 2078</span>            <span class="keywordflow">if</span> (aerosol_mmr(i,k,m) &lt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a id="l02079" name="l02079"></a><span class="lineno"> 2079</span>               <span class="keyword">write</span>(6,*)<span class="stringliteral">&#39;vert_interpolate: mmr &lt; 0, m, col, lev, mmr&#39;</span>,m, i, k, aerosol_mmr(i,k,m)</div>
<div class="line"><a id="l02080" name="l02080"></a><span class="lineno"> 2080</span>               <span class="keyword">write</span>(6,*)<span class="stringliteral">&#39;vert_interpolate: aerosol(k),(k+1)&#39;</span>,aerosol(i,k,m),aerosol(i,k+1,m)</div>
<div class="line"><a id="l02081" name="l02081"></a><span class="lineno"> 2081</span>               <span class="keyword">write</span>(6,*)<span class="stringliteral">&#39;vert_interpolate: pint(k+1),(k)&#39;</span>,pint(i,k+1),pint(i,k)</div>
<div class="line"><a id="l02082" name="l02082"></a><span class="lineno"> 2082</span>               <span class="keyword">write</span>(6,*)<span class="stringliteral">&#39;n,c&#39;</span>,n,c</div>
<div class="line"><a id="l02083" name="l02083"></a><span class="lineno"> 2083</span><span class="comment">!              call endrun()</span></div>
<div class="line"><a id="l02084" name="l02084"></a><span class="lineno"> 2084</span><span class="keywordflow">            end if</span></div>
<div class="line"><a id="l02085" name="l02085"></a><span class="lineno"> 2085</span><span class="keywordflow">         end do</span></div>
<div class="line"><a id="l02086" name="l02086"></a><span class="lineno"> 2086</span><span class="keywordflow">      end do</span></div>
<div class="line"><a id="l02087" name="l02087"></a><span class="lineno"> 2087</span><span class="keywordflow">   end do</span></div>
<div class="line"><a id="l02088" name="l02088"></a><span class="lineno"> 2088</span> </div>
<div class="line"><a id="l02089" name="l02089"></a><span class="lineno"> 2089</span><span class="comment">!  call t_stopf (&#39;vi_checks&#39;)</span></div>
<div class="line"><a id="l02090" name="l02090"></a><span class="lineno"> 2090</span><span class="comment">!  call t_stopf (&#39;vert_interpolate&#39;)</span></div>
<div class="line"><a id="l02091" name="l02091"></a><span class="lineno"> 2091</span> </div>
<div class="line"><a id="l02092" name="l02092"></a><span class="lineno"> 2092</span>   <span class="keywordflow">return</span></div>
<div class="line"><a id="l02093" name="l02093"></a><span class="lineno"> 2093</span><span class="keyword">end subroutine </span><a class="code hl_function" href="namespacemodule__ra__cam__support.html#a49bd824d487a1d945b332a79c956d68e">vert_interpolate</a></div>
<div class="line"><a id="l02094" name="l02094"></a><span class="lineno"> 2094</span> </div>
<div class="line"><a id="l02095" name="l02095"></a><span class="lineno"> 2095</span> </div>
<div class="line"><a id="l02096" name="l02096"></a><span class="lineno"> 2096</span><span class="comment">!===============================================================================</span></div>
<div class="line"><a id="l02097" name="l02097"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#ac0aaa7b85ecec3480c170d01c6ef81e3"> 2097</a></span>  <span class="keyword">subroutine </span><a class="code hl_function" href="namespacemodule__ra__cam__support.html#ac0aaa7b85ecec3480c170d01c6ef81e3">cldems</a>(lchnk   ,ncol    ,pcols, pver, pverp, clwp    ,fice    ,rei     ,emis    )</div>
<div class="line"><a id="l02098" name="l02098"></a><span class="lineno"> 2098</span><span class="comment">!----------------------------------------------------------------------- </span></div>
<div class="line"><a id="l02099" name="l02099"></a><span class="lineno"> 2099</span><span class="comment">! </span></div>
<div class="line"><a id="l02100" name="l02100"></a><span class="lineno"> 2100</span><span class="comment">! Purpose: </span></div>
<div class="line"><a id="l02101" name="l02101"></a><span class="lineno"> 2101</span><span class="comment">! Compute cloud emissivity using cloud liquid water path (g/m**2)</span></div>
<div class="line"><a id="l02102" name="l02102"></a><span class="lineno"> 2102</span><span class="comment">! </span></div>
<div class="line"><a id="l02103" name="l02103"></a><span class="lineno"> 2103</span><span class="comment">! Method: </span></div>
<div class="line"><a id="l02104" name="l02104"></a><span class="lineno"> 2104</span><span class="comment">! &lt;Describe the algorithm(s) used in the routine.&gt; </span></div>
<div class="line"><a id="l02105" name="l02105"></a><span class="lineno"> 2105</span><span class="comment">! &lt;Also include any applicable external references.&gt; </span></div>
<div class="line"><a id="l02106" name="l02106"></a><span class="lineno"> 2106</span><span class="comment">! </span></div>
<div class="line"><a id="l02107" name="l02107"></a><span class="lineno"> 2107</span><span class="comment">! Author: J.T. Kiehl</span></div>
<div class="line"><a id="l02108" name="l02108"></a><span class="lineno"> 2108</span><span class="comment">! </span></div>
<div class="line"><a id="l02109" name="l02109"></a><span class="lineno"> 2109</span><span class="comment">!-----------------------------------------------------------------------</span></div>
<div class="line"><a id="l02110" name="l02110"></a><span class="lineno"> 2110</span> </div>
<div class="line"><a id="l02111" name="l02111"></a><span class="lineno"> 2111</span>    <span class="keywordtype">implicit none</span></div>
<div class="line"><a id="l02112" name="l02112"></a><span class="lineno"> 2112</span><span class="comment">!------------------------------Parameters-------------------------------</span></div>
<div class="line"><a id="l02113" name="l02113"></a><span class="lineno"> 2113</span><span class="comment">!</span></div>
<div class="line"><a id="l02114" name="l02114"></a><span class="lineno"> 2114</span><span class="keywordtype">    real</span>(r8) kabsl                  <span class="comment">! longwave liquid absorption coeff (m**2/g)</span></div>
<div class="line"><a id="l02115" name="l02115"></a><span class="lineno"> 2115</span>    parameter(kabsl = 0.090361)</div>
<div class="line"><a id="l02116" name="l02116"></a><span class="lineno"> 2116</span><span class="comment">!</span></div>
<div class="line"><a id="l02117" name="l02117"></a><span class="lineno"> 2117</span><span class="comment">!------------------------------Arguments--------------------------------</span></div>
<div class="line"><a id="l02118" name="l02118"></a><span class="lineno"> 2118</span><span class="comment">!</span></div>
<div class="line"><a id="l02119" name="l02119"></a><span class="lineno"> 2119</span><span class="comment">! Input arguments</span></div>
<div class="line"><a id="l02120" name="l02120"></a><span class="lineno"> 2120</span><span class="comment">!</span></div>
<div class="line"><a id="l02121" name="l02121"></a><span class="lineno"> 2121</span>    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: lchnk                   <span class="comment">! chunk identifier</span></div>
<div class="line"><a id="l02122" name="l02122"></a><span class="lineno"> 2122</span>    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: ncol                    <span class="comment">! number of atmospheric columns</span></div>
<div class="line"><a id="l02123" name="l02123"></a><span class="lineno"> 2123</span>    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: pcols, pver, pverp</div>
<div class="line"><a id="l02124" name="l02124"></a><span class="lineno"> 2124</span> </div>
<div class="line"><a id="l02125" name="l02125"></a><span class="lineno"> 2125</span><span class="keywordtype">    real</span>(r8), <span class="keywordtype">intent(in)</span> :: clwp(pcols,pver)       <span class="comment">! cloud liquid water path (g/m**2)</span></div>
<div class="line"><a id="l02126" name="l02126"></a><span class="lineno"> 2126</span><span class="keywordtype">    real</span>(r8), <span class="keywordtype">intent(in)</span> :: rei(pcols,pver)        <span class="comment">! ice effective drop size (microns)</span></div>
<div class="line"><a id="l02127" name="l02127"></a><span class="lineno"> 2127</span><span class="keywordtype">    real</span>(r8), <span class="keywordtype">intent(in)</span> :: fice(pcols,pver)       <span class="comment">! fractional ice content within cloud</span></div>
<div class="line"><a id="l02128" name="l02128"></a><span class="lineno"> 2128</span><span class="comment">!</span></div>
<div class="line"><a id="l02129" name="l02129"></a><span class="lineno"> 2129</span><span class="comment">! Output arguments</span></div>
<div class="line"><a id="l02130" name="l02130"></a><span class="lineno"> 2130</span><span class="comment">!</span></div>
<div class="line"><a id="l02131" name="l02131"></a><span class="lineno"> 2131</span><span class="keywordtype">    real</span>(r8), <span class="keywordtype">intent(out)</span> :: emis(pcols,pver)       <span class="comment">! cloud emissivity (fraction)</span></div>
<div class="line"><a id="l02132" name="l02132"></a><span class="lineno"> 2132</span><span class="comment">!</span></div>
<div class="line"><a id="l02133" name="l02133"></a><span class="lineno"> 2133</span><span class="comment">!---------------------------Local workspace-----------------------------</span></div>
<div class="line"><a id="l02134" name="l02134"></a><span class="lineno"> 2134</span><span class="comment">!</span></div>
<div class="line"><a id="l02135" name="l02135"></a><span class="lineno"> 2135</span>    <span class="keywordtype">integer</span> i,k                 <span class="comment">! longitude, level indices</span></div>
<div class="line"><a id="l02136" name="l02136"></a><span class="lineno"> 2136</span><span class="keywordtype">    real</span>(r8) kabs                   <span class="comment">! longwave absorption coeff (m**2/g)</span></div>
<div class="line"><a id="l02137" name="l02137"></a><span class="lineno"> 2137</span><span class="keywordtype">    real</span>(r8) kabsi                  <span class="comment">! ice absorption coefficient</span></div>
<div class="line"><a id="l02138" name="l02138"></a><span class="lineno"> 2138</span><span class="comment">!</span></div>
<div class="line"><a id="l02139" name="l02139"></a><span class="lineno"> 2139</span><span class="comment">!-----------------------------------------------------------------------</span></div>
<div class="line"><a id="l02140" name="l02140"></a><span class="lineno"> 2140</span><span class="comment">!</span></div>
<div class="line"><a id="l02141" name="l02141"></a><span class="lineno"> 2141</span>    <span class="keywordflow">do</span> k=1,pver</div>
<div class="line"><a id="l02142" name="l02142"></a><span class="lineno"> 2142</span>       <span class="keywordflow">do</span> i=1,ncol</div>
<div class="line"><a id="l02143" name="l02143"></a><span class="lineno"> 2143</span>          kabsi = 0.005 + 1./rei(i,k)</div>
<div class="line"><a id="l02144" name="l02144"></a><span class="lineno"> 2144</span>          kabs = kabsl*(1.-fice(i,k)) + kabsi*fice(i,k)</div>
<div class="line"><a id="l02145" name="l02145"></a><span class="lineno"> 2145</span>          emis(i,k) = 1. - exp(-1.66*kabs*clwp(i,k))</div>
<div class="line"><a id="l02146" name="l02146"></a><span class="lineno"> 2146</span><span class="keywordflow">       end do</span></div>
<div class="line"><a id="l02147" name="l02147"></a><span class="lineno"> 2147</span><span class="keywordflow">    end do</span></div>
<div class="line"><a id="l02148" name="l02148"></a><span class="lineno"> 2148</span><span class="comment">!</span></div>
<div class="line"><a id="l02149" name="l02149"></a><span class="lineno"> 2149</span>    <span class="keywordflow">return</span></div>
<div class="line"><a id="l02150" name="l02150"></a><span class="lineno"> 2150</span>  <span class="keyword">end subroutine </span><a class="code hl_function" href="namespacemodule__ra__cam__support.html#ac0aaa7b85ecec3480c170d01c6ef81e3">cldems</a></div>
<div class="line"><a id="l02151" name="l02151"></a><span class="lineno"> 2151</span> </div>
<div class="line"><a id="l02152" name="l02152"></a><span class="lineno"> 2152</span><span class="comment">!===============================================================================</span></div>
<div class="line"><a id="l02153" name="l02153"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a4ba37464e5da87a20bbbbd42eb6ff761"> 2153</a></span>  <span class="keyword">subroutine </span><a class="code hl_function" href="namespacemodule__ra__cam__support.html#a4ba37464e5da87a20bbbbd42eb6ff761">cldovrlap</a>(lchnk   ,ncol    ,pcols, pver, pverp, pint    ,cld     ,nmxrgn  ,pmxrgn  )</div>
<div class="line"><a id="l02154" name="l02154"></a><span class="lineno"> 2154</span><span class="comment">!----------------------------------------------------------------------- </span></div>
<div class="line"><a id="l02155" name="l02155"></a><span class="lineno"> 2155</span><span class="comment">! </span></div>
<div class="line"><a id="l02156" name="l02156"></a><span class="lineno"> 2156</span><span class="comment">! Purpose: </span></div>
<div class="line"><a id="l02157" name="l02157"></a><span class="lineno"> 2157</span><span class="comment">! Partitions each column into regions with clouds in neighboring layers.</span></div>
<div class="line"><a id="l02158" name="l02158"></a><span class="lineno"> 2158</span><span class="comment">! This information is used to implement maximum overlap in these regions</span></div>
<div class="line"><a id="l02159" name="l02159"></a><span class="lineno"> 2159</span><span class="comment">! with random overlap between them.</span></div>
<div class="line"><a id="l02160" name="l02160"></a><span class="lineno"> 2160</span><span class="comment">! On output,</span></div>
<div class="line"><a id="l02161" name="l02161"></a><span class="lineno"> 2161</span><span class="comment">!    nmxrgn contains the number of regions in each column</span></div>
<div class="line"><a id="l02162" name="l02162"></a><span class="lineno"> 2162</span><span class="comment">!    pmxrgn contains the interface pressures for the lower boundaries of</span></div>
<div class="line"><a id="l02163" name="l02163"></a><span class="lineno"> 2163</span><span class="comment">!           each region! </span></div>
<div class="line"><a id="l02164" name="l02164"></a><span class="lineno"> 2164</span><span class="comment">! Method: </span></div>
<div class="line"><a id="l02165" name="l02165"></a><span class="lineno"> 2165</span> </div>
<div class="line"><a id="l02166" name="l02166"></a><span class="lineno"> 2166</span><span class="comment">! </span></div>
<div class="line"><a id="l02167" name="l02167"></a><span class="lineno"> 2167</span><span class="comment">! Author: W. Collins</span></div>
<div class="line"><a id="l02168" name="l02168"></a><span class="lineno"> 2168</span><span class="comment">! </span></div>
<div class="line"><a id="l02169" name="l02169"></a><span class="lineno"> 2169</span><span class="comment">!-----------------------------------------------------------------------</span></div>
<div class="line"><a id="l02170" name="l02170"></a><span class="lineno"> 2170</span> </div>
<div class="line"><a id="l02171" name="l02171"></a><span class="lineno"> 2171</span>    <span class="keywordtype">implicit none</span></div>
<div class="line"><a id="l02172" name="l02172"></a><span class="lineno"> 2172</span><span class="comment">!</span></div>
<div class="line"><a id="l02173" name="l02173"></a><span class="lineno"> 2173</span><span class="comment">! Input arguments</span></div>
<div class="line"><a id="l02174" name="l02174"></a><span class="lineno"> 2174</span><span class="comment">!</span></div>
<div class="line"><a id="l02175" name="l02175"></a><span class="lineno"> 2175</span>    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: lchnk                <span class="comment">! chunk identifier</span></div>
<div class="line"><a id="l02176" name="l02176"></a><span class="lineno"> 2176</span>    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: ncol                 <span class="comment">! number of atmospheric columns</span></div>
<div class="line"><a id="l02177" name="l02177"></a><span class="lineno"> 2177</span>    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: pcols, pver, pverp</div>
<div class="line"><a id="l02178" name="l02178"></a><span class="lineno"> 2178</span> </div>
<div class="line"><a id="l02179" name="l02179"></a><span class="lineno"> 2179</span><span class="keywordtype">    real</span>(r8), <span class="keywordtype">intent(in)</span> :: pint(pcols,pverp)   <span class="comment">! Interface pressure</span></div>
<div class="line"><a id="l02180" name="l02180"></a><span class="lineno"> 2180</span><span class="keywordtype">    real</span>(r8), <span class="keywordtype">intent(in)</span> :: cld(pcols,pver)     <span class="comment">! Fractional cloud cover</span></div>
<div class="line"><a id="l02181" name="l02181"></a><span class="lineno"> 2181</span><span class="comment">!</span></div>
<div class="line"><a id="l02182" name="l02182"></a><span class="lineno"> 2182</span><span class="comment">! Output arguments</span></div>
<div class="line"><a id="l02183" name="l02183"></a><span class="lineno"> 2183</span><span class="comment">!</span></div>
<div class="line"><a id="l02184" name="l02184"></a><span class="lineno"> 2184</span><span class="keywordtype">    real</span>(r8), <span class="keywordtype">intent(out)</span> :: pmxrgn(pcols,pverp)<span class="comment">! Maximum values of pressure for each</span></div>
<div class="line"><a id="l02185" name="l02185"></a><span class="lineno"> 2185</span><span class="comment">!    maximally overlapped region.</span></div>
<div class="line"><a id="l02186" name="l02186"></a><span class="lineno"> 2186</span><span class="comment">!    0-&gt;pmxrgn(i,1) is range of pressure for</span></div>
<div class="line"><a id="l02187" name="l02187"></a><span class="lineno"> 2187</span><span class="comment">!    1st region,pmxrgn(i,1)-&gt;pmxrgn(i,2) for</span></div>
<div class="line"><a id="l02188" name="l02188"></a><span class="lineno"> 2188</span><span class="comment">!    2nd region, etc</span></div>
<div class="line"><a id="l02189" name="l02189"></a><span class="lineno"> 2189</span>    <span class="keywordtype">integer</span> nmxrgn(pcols)                    <span class="comment">! Number of maximally overlapped regions</span></div>
<div class="line"><a id="l02190" name="l02190"></a><span class="lineno"> 2190</span><span class="comment">!</span></div>
<div class="line"><a id="l02191" name="l02191"></a><span class="lineno"> 2191</span><span class="comment">!---------------------------Local variables-----------------------------</span></div>
<div class="line"><a id="l02192" name="l02192"></a><span class="lineno"> 2192</span><span class="comment">!</span></div>
<div class="line"><a id="l02193" name="l02193"></a><span class="lineno"> 2193</span>    <span class="keywordtype">integer</span> i                    <span class="comment">! Longitude index</span></div>
<div class="line"><a id="l02194" name="l02194"></a><span class="lineno"> 2194</span>    <span class="keywordtype">integer</span> k                    <span class="comment">! Level index</span></div>
<div class="line"><a id="l02195" name="l02195"></a><span class="lineno"> 2195</span>    <span class="keywordtype">integer</span> n                    <span class="comment">! Max-overlap region counter</span></div>
<div class="line"><a id="l02196" name="l02196"></a><span class="lineno"> 2196</span> </div>
<div class="line"><a id="l02197" name="l02197"></a><span class="lineno"> 2197</span><span class="keywordtype">    real</span>(r8) pnm(pcols,pverp)    <span class="comment">! Interface pressure</span></div>
<div class="line"><a id="l02198" name="l02198"></a><span class="lineno"> 2198</span> </div>
<div class="line"><a id="l02199" name="l02199"></a><span class="lineno"> 2199</span>    <span class="keywordtype">logical</span> cld_found            <span class="comment">! Flag for detection of cloud</span></div>
<div class="line"><a id="l02200" name="l02200"></a><span class="lineno"> 2200</span>    <span class="keywordtype">logical</span> cld_layer(pver)      <span class="comment">! Flag for cloud in layer</span></div>
<div class="line"><a id="l02201" name="l02201"></a><span class="lineno"> 2201</span><span class="comment">!</span></div>
<div class="line"><a id="l02202" name="l02202"></a><span class="lineno"> 2202</span><span class="comment">!------------------------------------------------------------------------</span></div>
<div class="line"><a id="l02203" name="l02203"></a><span class="lineno"> 2203</span><span class="comment">!</span></div>
<div class="line"><a id="l02204" name="l02204"></a><span class="lineno"> 2204</span> </div>
<div class="line"><a id="l02205" name="l02205"></a><span class="lineno"> 2205</span>    <span class="keywordflow">do</span> i = 1, ncol</div>
<div class="line"><a id="l02206" name="l02206"></a><span class="lineno"> 2206</span>       cld_found = .false.</div>
<div class="line"><a id="l02207" name="l02207"></a><span class="lineno"> 2207</span>       cld_layer(:) = cld(i,:) &gt; 0.0_r8</div>
<div class="line"><a id="l02208" name="l02208"></a><span class="lineno"> 2208</span>       pmxrgn(i,:) = 0.0</div>
<div class="line"><a id="l02209" name="l02209"></a><span class="lineno"> 2209</span>       pnm(i,:)=pint(i,:)*10.</div>
<div class="line"><a id="l02210" name="l02210"></a><span class="lineno"> 2210</span>       n = 1</div>
<div class="line"><a id="l02211" name="l02211"></a><span class="lineno"> 2211</span>       <span class="keywordflow">do</span> k = 1, pver</div>
<div class="line"><a id="l02212" name="l02212"></a><span class="lineno"> 2212</span>          <span class="keywordflow">if</span> (cld_layer(k) .and.  .not. cld_found) <span class="keywordflow">then</span></div>
<div class="line"><a id="l02213" name="l02213"></a><span class="lineno"> 2213</span>             cld_found = .true.</div>
<div class="line"><a id="l02214" name="l02214"></a><span class="lineno"> 2214</span>          <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( .not. cld_layer(k) .and. cld_found) <span class="keywordflow">then</span></div>
<div class="line"><a id="l02215" name="l02215"></a><span class="lineno"> 2215</span>             cld_found = .false.</div>
<div class="line"><a id="l02216" name="l02216"></a><span class="lineno"> 2216</span>             <span class="keywordflow">if</span> (count(cld_layer(k:pver)) == 0) <span class="keywordflow">then</span></div>
<div class="line"><a id="l02217" name="l02217"></a><span class="lineno"> 2217</span>                <span class="keywordflow">exit</span></div>
<div class="line"><a id="l02218" name="l02218"></a><span class="lineno"> 2218</span><span class="keywordflow">             endif</span></div>
<div class="line"><a id="l02219" name="l02219"></a><span class="lineno"> 2219</span>             pmxrgn(i,n) = pnm(i,k)</div>
<div class="line"><a id="l02220" name="l02220"></a><span class="lineno"> 2220</span>             n = n + 1</div>
<div class="line"><a id="l02221" name="l02221"></a><span class="lineno"> 2221</span><span class="keywordflow">          endif</span></div>
<div class="line"><a id="l02222" name="l02222"></a><span class="lineno"> 2222</span><span class="keywordflow">       end do</span></div>
<div class="line"><a id="l02223" name="l02223"></a><span class="lineno"> 2223</span>       pmxrgn(i,n) = pnm(i,pverp)</div>
<div class="line"><a id="l02224" name="l02224"></a><span class="lineno"> 2224</span>       nmxrgn(i) = n</div>
<div class="line"><a id="l02225" name="l02225"></a><span class="lineno"> 2225</span><span class="keywordflow">    end do</span></div>
<div class="line"><a id="l02226" name="l02226"></a><span class="lineno"> 2226</span> </div>
<div class="line"><a id="l02227" name="l02227"></a><span class="lineno"> 2227</span>    <span class="keywordflow">return</span></div>
<div class="line"><a id="l02228" name="l02228"></a><span class="lineno"> 2228</span>  <span class="keyword">end subroutine </span><a class="code hl_function" href="namespacemodule__ra__cam__support.html#a4ba37464e5da87a20bbbbd42eb6ff761">cldovrlap</a></div>
<div class="line"><a id="l02229" name="l02229"></a><span class="lineno"> 2229</span> </div>
<div class="line"><a id="l02230" name="l02230"></a><span class="lineno"> 2230</span><span class="comment">!===============================================================================</span></div>
<div class="line"><a id="l02231" name="l02231"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a2007fbc8d58c13c4e5ba46f0f7f8bc31"> 2231</a></span>  <span class="keyword">subroutine </span><a class="code hl_function" href="namespacemodule__ra__cam__support.html#a2007fbc8d58c13c4e5ba46f0f7f8bc31">cldclw</a>(lchnk   ,ncol    ,pcols, pver, pverp, zi      ,clwp    ,tpw     ,hl      )</div>
<div class="line"><a id="l02232" name="l02232"></a><span class="lineno"> 2232</span><span class="comment">!----------------------------------------------------------------------- </span></div>
<div class="line"><a id="l02233" name="l02233"></a><span class="lineno"> 2233</span><span class="comment">! </span></div>
<div class="line"><a id="l02234" name="l02234"></a><span class="lineno"> 2234</span><span class="comment">! Purpose: </span></div>
<div class="line"><a id="l02235" name="l02235"></a><span class="lineno"> 2235</span><span class="comment">! Evaluate cloud liquid water path clwp (g/m**2)</span></div>
<div class="line"><a id="l02236" name="l02236"></a><span class="lineno"> 2236</span><span class="comment">! </span></div>
<div class="line"><a id="l02237" name="l02237"></a><span class="lineno"> 2237</span><span class="comment">! Method: </span></div>
<div class="line"><a id="l02238" name="l02238"></a><span class="lineno"> 2238</span><span class="comment">! &lt;Describe the algorithm(s) used in the routine.&gt; </span></div>
<div class="line"><a id="l02239" name="l02239"></a><span class="lineno"> 2239</span><span class="comment">! &lt;Also include any applicable external references.&gt; </span></div>
<div class="line"><a id="l02240" name="l02240"></a><span class="lineno"> 2240</span><span class="comment">! </span></div>
<div class="line"><a id="l02241" name="l02241"></a><span class="lineno"> 2241</span><span class="comment">! Author: J.T. Kiehl</span></div>
<div class="line"><a id="l02242" name="l02242"></a><span class="lineno"> 2242</span><span class="comment">! </span></div>
<div class="line"><a id="l02243" name="l02243"></a><span class="lineno"> 2243</span><span class="comment">!-----------------------------------------------------------------------</span></div>
<div class="line"><a id="l02244" name="l02244"></a><span class="lineno"> 2244</span> </div>
<div class="line"><a id="l02245" name="l02245"></a><span class="lineno"> 2245</span>    <span class="keywordtype">implicit none</span></div>
<div class="line"><a id="l02246" name="l02246"></a><span class="lineno"> 2246</span> </div>
<div class="line"><a id="l02247" name="l02247"></a><span class="lineno"> 2247</span><span class="comment">!</span></div>
<div class="line"><a id="l02248" name="l02248"></a><span class="lineno"> 2248</span><span class="comment">! Input arguments</span></div>
<div class="line"><a id="l02249" name="l02249"></a><span class="lineno"> 2249</span><span class="comment">!</span></div>
<div class="line"><a id="l02250" name="l02250"></a><span class="lineno"> 2250</span>    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: lchnk                 <span class="comment">! chunk identifier</span></div>
<div class="line"><a id="l02251" name="l02251"></a><span class="lineno"> 2251</span>    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: ncol                  <span class="comment">! number of atmospheric columns</span></div>
<div class="line"><a id="l02252" name="l02252"></a><span class="lineno"> 2252</span>    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: pcols, pver, pverp</div>
<div class="line"><a id="l02253" name="l02253"></a><span class="lineno"> 2253</span> </div>
<div class="line"><a id="l02254" name="l02254"></a><span class="lineno"> 2254</span><span class="keywordtype">    real</span>(r8), <span class="keywordtype">intent(in)</span> :: zi(pcols,pverp)      <span class="comment">! height at layer interfaces(m)</span></div>
<div class="line"><a id="l02255" name="l02255"></a><span class="lineno"> 2255</span><span class="keywordtype">    real</span>(r8), <span class="keywordtype">intent(in)</span> :: tpw(pcols)           <span class="comment">! total precipitable water (mm)</span></div>
<div class="line"><a id="l02256" name="l02256"></a><span class="lineno"> 2256</span><span class="comment">!</span></div>
<div class="line"><a id="l02257" name="l02257"></a><span class="lineno"> 2257</span><span class="comment">! Output arguments</span></div>
<div class="line"><a id="l02258" name="l02258"></a><span class="lineno"> 2258</span><span class="comment">!</span></div>
<div class="line"><a id="l02259" name="l02259"></a><span class="lineno"> 2259</span><span class="keywordtype">    real</span>(r8) clwp(pcols,pver)     <span class="comment">! cloud liquid water path (g/m**2)</span></div>
<div class="line"><a id="l02260" name="l02260"></a><span class="lineno"> 2260</span><span class="keywordtype">    real</span>(r8) hl(pcols)            <span class="comment">! liquid water scale height</span></div>
<div class="line"><a id="l02261" name="l02261"></a><span class="lineno"> 2261</span><span class="keywordtype">    real</span>(r8) rhl(pcols)           <span class="comment">! 1/hl</span></div>
<div class="line"><a id="l02262" name="l02262"></a><span class="lineno"> 2262</span> </div>
<div class="line"><a id="l02263" name="l02263"></a><span class="lineno"> 2263</span><span class="comment">!</span></div>
<div class="line"><a id="l02264" name="l02264"></a><span class="lineno"> 2264</span><span class="comment">!---------------------------Local workspace-----------------------------</span></div>
<div class="line"><a id="l02265" name="l02265"></a><span class="lineno"> 2265</span><span class="comment">!</span></div>
<div class="line"><a id="l02266" name="l02266"></a><span class="lineno"> 2266</span>    <span class="keywordtype">integer</span> i,k               <span class="comment">! longitude, level indices</span></div>
<div class="line"><a id="l02267" name="l02267"></a><span class="lineno"> 2267</span><span class="keywordtype">    real</span>(r8) clwc0                <span class="comment">! reference liquid water concentration (g/m**3)</span></div>
<div class="line"><a id="l02268" name="l02268"></a><span class="lineno"> 2268</span><span class="keywordtype">    real</span>(r8) emziohl(pcols,pverp) <span class="comment">! exp(-zi/hl)</span></div>
<div class="line"><a id="l02269" name="l02269"></a><span class="lineno"> 2269</span><span class="comment">!</span></div>
<div class="line"><a id="l02270" name="l02270"></a><span class="lineno"> 2270</span><span class="comment">!-----------------------------------------------------------------------</span></div>
<div class="line"><a id="l02271" name="l02271"></a><span class="lineno"> 2271</span><span class="comment">!</span></div>
<div class="line"><a id="l02272" name="l02272"></a><span class="lineno"> 2272</span><span class="comment">! Set reference liquid water concentration</span></div>
<div class="line"><a id="l02273" name="l02273"></a><span class="lineno"> 2273</span><span class="comment">!</span></div>
<div class="line"><a id="l02274" name="l02274"></a><span class="lineno"> 2274</span>    clwc0 = 0.21</div>
<div class="line"><a id="l02275" name="l02275"></a><span class="lineno"> 2275</span><span class="comment">!</span></div>
<div class="line"><a id="l02276" name="l02276"></a><span class="lineno"> 2276</span><span class="comment">! Diagnose liquid water scale height from precipitable water</span></div>
<div class="line"><a id="l02277" name="l02277"></a><span class="lineno"> 2277</span><span class="comment">!</span></div>
<div class="line"><a id="l02278" name="l02278"></a><span class="lineno"> 2278</span>    <span class="keywordflow">do</span> i=1,ncol</div>
<div class="line"><a id="l02279" name="l02279"></a><span class="lineno"> 2279</span>       hl(i)  = 700.0*log(max(tpw(i)+1.0_r8,1.0_r8))</div>
<div class="line"><a id="l02280" name="l02280"></a><span class="lineno"> 2280</span>       rhl(i) = 1.0/hl(i)</div>
<div class="line"><a id="l02281" name="l02281"></a><span class="lineno"> 2281</span><span class="keywordflow">    end do</span></div>
<div class="line"><a id="l02282" name="l02282"></a><span class="lineno"> 2282</span><span class="comment">!</span></div>
<div class="line"><a id="l02283" name="l02283"></a><span class="lineno"> 2283</span><span class="comment">! Evaluate cloud liquid water path (vertical integral of exponential fn)</span></div>
<div class="line"><a id="l02284" name="l02284"></a><span class="lineno"> 2284</span><span class="comment">!</span></div>
<div class="line"><a id="l02285" name="l02285"></a><span class="lineno"> 2285</span>    <span class="keywordflow">do</span> k=1,pverp</div>
<div class="line"><a id="l02286" name="l02286"></a><span class="lineno"> 2286</span>       <span class="keywordflow">do</span> i=1,ncol</div>
<div class="line"><a id="l02287" name="l02287"></a><span class="lineno"> 2287</span>          emziohl(i,k) = exp(-zi(i,k)*rhl(i))</div>
<div class="line"><a id="l02288" name="l02288"></a><span class="lineno"> 2288</span><span class="keywordflow">       end do</span></div>
<div class="line"><a id="l02289" name="l02289"></a><span class="lineno"> 2289</span><span class="keywordflow">    end do</span></div>
<div class="line"><a id="l02290" name="l02290"></a><span class="lineno"> 2290</span>    <span class="keywordflow">do</span> k=1,pver</div>
<div class="line"><a id="l02291" name="l02291"></a><span class="lineno"> 2291</span>       <span class="keywordflow">do</span> i=1,ncol</div>
<div class="line"><a id="l02292" name="l02292"></a><span class="lineno"> 2292</span>          clwp(i,k) = clwc0*hl(i)*(emziohl(i,k+1) - emziohl(i,k))</div>
<div class="line"><a id="l02293" name="l02293"></a><span class="lineno"> 2293</span><span class="keywordflow">       end do</span></div>
<div class="line"><a id="l02294" name="l02294"></a><span class="lineno"> 2294</span><span class="keywordflow">    end do</span></div>
<div class="line"><a id="l02295" name="l02295"></a><span class="lineno"> 2295</span><span class="comment">!</span></div>
<div class="line"><a id="l02296" name="l02296"></a><span class="lineno"> 2296</span>    <span class="keywordflow">return</span></div>
<div class="line"><a id="l02297" name="l02297"></a><span class="lineno"> 2297</span>  <span class="keyword">end subroutine </span><a class="code hl_function" href="namespacemodule__ra__cam__support.html#a2007fbc8d58c13c4e5ba46f0f7f8bc31">cldclw</a></div>
<div class="line"><a id="l02298" name="l02298"></a><span class="lineno"> 2298</span> </div>
<div class="line"><a id="l02299" name="l02299"></a><span class="lineno"> 2299</span> </div>
<div class="line"><a id="l02300" name="l02300"></a><span class="lineno"> 2300</span><span class="comment">!===============================================================================</span></div>
<div class="line"><a id="l02301" name="l02301"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#ad0a6eb33d9ec3a8364ac2a73c046e21b"> 2301</a></span>  <span class="keyword">subroutine </span><a class="code hl_function" href="namespacemodule__ra__cam__support.html#ad0a6eb33d9ec3a8364ac2a73c046e21b">reltab</a>(ncol, pcols, pver, t, landfrac, landm, icefrac, rel, snowh)</div>
<div class="line"><a id="l02302" name="l02302"></a><span class="lineno"> 2302</span><span class="comment">!----------------------------------------------------------------------- </span></div>
<div class="line"><a id="l02303" name="l02303"></a><span class="lineno"> 2303</span><span class="comment">! </span></div>
<div class="line"><a id="l02304" name="l02304"></a><span class="lineno"> 2304</span><span class="comment">! Purpose: </span></div>
<div class="line"><a id="l02305" name="l02305"></a><span class="lineno"> 2305</span><span class="comment">! Compute cloud water size</span></div>
<div class="line"><a id="l02306" name="l02306"></a><span class="lineno"> 2306</span><span class="comment">! </span></div>
<div class="line"><a id="l02307" name="l02307"></a><span class="lineno"> 2307</span><span class="comment">! Method: </span></div>
<div class="line"><a id="l02308" name="l02308"></a><span class="lineno"> 2308</span><span class="comment">! analytic formula following the formulation originally developed by J. T. Kiehl</span></div>
<div class="line"><a id="l02309" name="l02309"></a><span class="lineno"> 2309</span><span class="comment">! </span></div>
<div class="line"><a id="l02310" name="l02310"></a><span class="lineno"> 2310</span><span class="comment">! Author: Phil Rasch</span></div>
<div class="line"><a id="l02311" name="l02311"></a><span class="lineno"> 2311</span><span class="comment">! </span></div>
<div class="line"><a id="l02312" name="l02312"></a><span class="lineno"> 2312</span><span class="comment">!-----------------------------------------------------------------------</span></div>
<div class="line"><a id="l02313" name="l02313"></a><span class="lineno"> 2313</span><span class="comment">!   use physconst,          only: tmelt</span></div>
<div class="line"><a id="l02314" name="l02314"></a><span class="lineno"> 2314</span>    <span class="keywordtype">implicit none</span></div>
<div class="line"><a id="l02315" name="l02315"></a><span class="lineno"> 2315</span><span class="comment">!------------------------------Arguments--------------------------------</span></div>
<div class="line"><a id="l02316" name="l02316"></a><span class="lineno"> 2316</span><span class="comment">!</span></div>
<div class="line"><a id="l02317" name="l02317"></a><span class="lineno"> 2317</span><span class="comment">! Input arguments</span></div>
<div class="line"><a id="l02318" name="l02318"></a><span class="lineno"> 2318</span><span class="comment">!</span></div>
<div class="line"><a id="l02319" name="l02319"></a><span class="lineno"> 2319</span>    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: ncol</div>
<div class="line"><a id="l02320" name="l02320"></a><span class="lineno"> 2320</span>    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: pcols, pver</div>
<div class="line"><a id="l02321" name="l02321"></a><span class="lineno"> 2321</span><span class="keywordtype">    real</span>(r8), <span class="keywordtype">intent(in)</span> :: landfrac(pcols)      <span class="comment">! Land fraction</span></div>
<div class="line"><a id="l02322" name="l02322"></a><span class="lineno"> 2322</span><span class="keywordtype">    real</span>(r8), <span class="keywordtype">intent(in)</span> :: icefrac(pcols)       <span class="comment">! Ice fraction</span></div>
<div class="line"><a id="l02323" name="l02323"></a><span class="lineno"> 2323</span><span class="keywordtype">    real</span>(r8), <span class="keywordtype">intent(in)</span> :: snowh(pcols)         <span class="comment">! Snow depth over land, water equivalent (m)</span></div>
<div class="line"><a id="l02324" name="l02324"></a><span class="lineno"> 2324</span><span class="keywordtype">    real</span>(r8), <span class="keywordtype">intent(in)</span> :: landm(pcols)         <span class="comment">! Land fraction ramping to zero over ocean</span></div>
<div class="line"><a id="l02325" name="l02325"></a><span class="lineno"> 2325</span><span class="keywordtype">    real</span>(r8), <span class="keywordtype">intent(in)</span> :: t(pcols,pver)        <span class="comment">! Temperature</span></div>
<div class="line"><a id="l02326" name="l02326"></a><span class="lineno"> 2326</span> </div>
<div class="line"><a id="l02327" name="l02327"></a><span class="lineno"> 2327</span><span class="comment">!</span></div>
<div class="line"><a id="l02328" name="l02328"></a><span class="lineno"> 2328</span><span class="comment">! Output arguments</span></div>
<div class="line"><a id="l02329" name="l02329"></a><span class="lineno"> 2329</span><span class="comment">!</span></div>
<div class="line"><a id="l02330" name="l02330"></a><span class="lineno"> 2330</span><span class="keywordtype">    real</span>(r8), <span class="keywordtype">intent(out)</span> :: rel(pcols,pver)      <span class="comment">! Liquid effective drop size (microns)</span></div>
<div class="line"><a id="l02331" name="l02331"></a><span class="lineno"> 2331</span><span class="comment">!</span></div>
<div class="line"><a id="l02332" name="l02332"></a><span class="lineno"> 2332</span><span class="comment">!---------------------------Local workspace-----------------------------</span></div>
<div class="line"><a id="l02333" name="l02333"></a><span class="lineno"> 2333</span><span class="comment">!</span></div>
<div class="line"><a id="l02334" name="l02334"></a><span class="lineno"> 2334</span>    <span class="keywordtype">integer</span> i,k               <span class="comment">! Lon, lev indices</span></div>
<div class="line"><a id="l02335" name="l02335"></a><span class="lineno"> 2335</span><span class="keywordtype">    real</span>(r8) rliqland         <span class="comment">! liquid drop size if over land</span></div>
<div class="line"><a id="l02336" name="l02336"></a><span class="lineno"> 2336</span><span class="keywordtype">    real</span>(r8) rliqocean        <span class="comment">! liquid drop size if over ocean</span></div>
<div class="line"><a id="l02337" name="l02337"></a><span class="lineno"> 2337</span><span class="keywordtype">    real</span>(r8) rliqice          <span class="comment">! liquid drop size if over sea ice</span></div>
<div class="line"><a id="l02338" name="l02338"></a><span class="lineno"> 2338</span><span class="comment">!</span></div>
<div class="line"><a id="l02339" name="l02339"></a><span class="lineno"> 2339</span><span class="comment">!-----------------------------------------------------------------------</span></div>
<div class="line"><a id="l02340" name="l02340"></a><span class="lineno"> 2340</span><span class="comment">!</span></div>
<div class="line"><a id="l02341" name="l02341"></a><span class="lineno"> 2341</span>    rliqocean = 14.0_r8</div>
<div class="line"><a id="l02342" name="l02342"></a><span class="lineno"> 2342</span>    rliqice   = 14.0_r8</div>
<div class="line"><a id="l02343" name="l02343"></a><span class="lineno"> 2343</span>    rliqland  = 8.0_r8</div>
<div class="line"><a id="l02344" name="l02344"></a><span class="lineno"> 2344</span>    <span class="keywordflow">do</span> k=1,pver</div>
<div class="line"><a id="l02345" name="l02345"></a><span class="lineno"> 2345</span>       <span class="keywordflow">do</span> i=1,ncol</div>
<div class="line"><a id="l02346" name="l02346"></a><span class="lineno"> 2346</span><span class="comment">! jrm Reworked effective radius algorithm</span></div>
<div class="line"><a id="l02347" name="l02347"></a><span class="lineno"> 2347</span>          <span class="comment">! Start with temperature-dependent value appropriate for continental air</span></div>
<div class="line"><a id="l02348" name="l02348"></a><span class="lineno"> 2348</span>          <span class="comment">! Note: findmcnew has a pressure dependence here</span></div>
<div class="line"><a id="l02349" name="l02349"></a><span class="lineno"> 2349</span>          rel(i,k) = rliqland + (rliqocean-rliqland) * min(1.0_r8,max(0.0_r8,(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a4e848e3e0511ebba4d1541494c416613">tmelt</a>-t(i,k))*0.05))</div>
<div class="line"><a id="l02350" name="l02350"></a><span class="lineno"> 2350</span>          <span class="comment">! Modify for snow depth over land</span></div>
<div class="line"><a id="l02351" name="l02351"></a><span class="lineno"> 2351</span>          rel(i,k) = rel(i,k) + (rliqocean-rel(i,k)) * min(1.0_r8,max(0.0_r8,snowh(i)*10.))</div>
<div class="line"><a id="l02352" name="l02352"></a><span class="lineno"> 2352</span>          <span class="comment">! Ramp between polluted value over land to clean value over ocean.</span></div>
<div class="line"><a id="l02353" name="l02353"></a><span class="lineno"> 2353</span>          rel(i,k) = rel(i,k) + (rliqocean-rel(i,k)) * min(1.0_r8,max(0.0_r8,1.0-landm(i)))</div>
<div class="line"><a id="l02354" name="l02354"></a><span class="lineno"> 2354</span>          <span class="comment">! Ramp between the resultant value and a sea ice value in the presence of ice.</span></div>
<div class="line"><a id="l02355" name="l02355"></a><span class="lineno"> 2355</span>          rel(i,k) = rel(i,k) + (rliqice-rel(i,k)) * min(1.0_r8,max(0.0_r8,icefrac(i)))</div>
<div class="line"><a id="l02356" name="l02356"></a><span class="lineno"> 2356</span><span class="comment">! end jrm</span></div>
<div class="line"><a id="l02357" name="l02357"></a><span class="lineno"> 2357</span><span class="keywordflow">       end do</span></div>
<div class="line"><a id="l02358" name="l02358"></a><span class="lineno"> 2358</span><span class="keywordflow">    end do</span></div>
<div class="line"><a id="l02359" name="l02359"></a><span class="lineno"> 2359</span>  <span class="keyword">end subroutine </span><a class="code hl_function" href="namespacemodule__ra__cam__support.html#ad0a6eb33d9ec3a8364ac2a73c046e21b">reltab</a></div>
<div class="line"><a id="l02360" name="l02360"></a><span class="lineno"> 2360</span><span class="comment">!===============================================================================</span></div>
<div class="line"><a id="l02361" name="l02361"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#ad268fad53f00adfd496d699cc7b47184"> 2361</a></span>  <span class="keyword">subroutine </span><a class="code hl_function" href="namespacemodule__ra__cam__support.html#ad268fad53f00adfd496d699cc7b47184">reitab</a>(ncol, pcols, pver, t, re)</div>
<div class="line"><a id="l02362" name="l02362"></a><span class="lineno"> 2362</span>    <span class="comment">!</span></div>
<div class="line"><a id="l02363" name="l02363"></a><span class="lineno"> 2363</span> </div>
<div class="line"><a id="l02364" name="l02364"></a><span class="lineno"> 2364</span>    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: ncol, pcols, pver</div>
<div class="line"><a id="l02365" name="l02365"></a><span class="lineno"> 2365</span><span class="keywordtype">    real</span>(r8), <span class="keywordtype">intent(out)</span> :: re(pcols,pver)</div>
<div class="line"><a id="l02366" name="l02366"></a><span class="lineno"> 2366</span><span class="keywordtype">    real</span>(r8), <span class="keywordtype">intent(in)</span> :: t(pcols,pver)</div>
<div class="line"><a id="l02367" name="l02367"></a><span class="lineno"> 2367</span><span class="keywordtype">    real</span>(r8) corr</div>
<div class="line"><a id="l02368" name="l02368"></a><span class="lineno"> 2368</span>    <span class="keywordtype">integer</span> i</div>
<div class="line"><a id="l02369" name="l02369"></a><span class="lineno"> 2369</span>    <span class="keywordtype">integer</span> k</div>
<div class="line"><a id="l02370" name="l02370"></a><span class="lineno"> 2370</span>    <span class="keywordtype">integer</span> index</div>
<div class="line"><a id="l02371" name="l02371"></a><span class="lineno"> 2371</span>    <span class="comment">!</span></div>
<div class="line"><a id="l02372" name="l02372"></a><span class="lineno"> 2372</span>    <span class="keywordflow">do</span> k=1,pver</div>
<div class="line"><a id="l02373" name="l02373"></a><span class="lineno"> 2373</span>       <span class="keywordflow">do</span> i=1,ncol</div>
<div class="line"><a id="l02374" name="l02374"></a><span class="lineno"> 2374</span>          index = int(t(i,k)-179.)</div>
<div class="line"><a id="l02375" name="l02375"></a><span class="lineno"> 2375</span>          index = min(max(index,1),94)</div>
<div class="line"><a id="l02376" name="l02376"></a><span class="lineno"> 2376</span>          corr = t(i,k) - int(t(i,k))</div>
<div class="line"><a id="l02377" name="l02377"></a><span class="lineno"> 2377</span>          re(i,k) = <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a55540415fe1cc156dd9204bb7129de14">retab</a>(index)*(1.-corr)      &amp;</div>
<div class="line"><a id="l02378" name="l02378"></a><span class="lineno"> 2378</span>               +<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a55540415fe1cc156dd9204bb7129de14">retab</a>(index+1)*corr</div>
<div class="line"><a id="l02379" name="l02379"></a><span class="lineno"> 2379</span>          <span class="comment">!           re(i,k) = amax1(amin1(re(i,k),30.),10.)</span></div>
<div class="line"><a id="l02380" name="l02380"></a><span class="lineno"> 2380</span><span class="keywordflow">       end do</span></div>
<div class="line"><a id="l02381" name="l02381"></a><span class="lineno"> 2381</span><span class="keywordflow">    end do</span></div>
<div class="line"><a id="l02382" name="l02382"></a><span class="lineno"> 2382</span>    <span class="comment">!</span></div>
<div class="line"><a id="l02383" name="l02383"></a><span class="lineno"> 2383</span>    <span class="keywordflow">return</span></div>
<div class="line"><a id="l02384" name="l02384"></a><span class="lineno"> 2384</span>  <span class="keyword">end subroutine </span><a class="code hl_function" href="namespacemodule__ra__cam__support.html#ad268fad53f00adfd496d699cc7b47184">reitab</a></div>
<div class="line"><a id="l02385" name="l02385"></a><span class="lineno"> 2385</span>  </div>
<div class="line"><a id="l02386" name="l02386"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a46342ec26656238d58f64d5d8be63d97"> 2386</a></span>  <span class="keyword">function </span><a class="code hl_function" href="namespacemodule__ra__cam__support.html#a46342ec26656238d58f64d5d8be63d97">exp_interpol</a>(x, f, y) <span class="keyword">result</span>(g)</div>
<div class="line"><a id="l02387" name="l02387"></a><span class="lineno"> 2387</span> </div>
<div class="line"><a id="l02388" name="l02388"></a><span class="lineno"> 2388</span>    <span class="comment">! Purpose:</span></div>
<div class="line"><a id="l02389" name="l02389"></a><span class="lineno"> 2389</span>    <span class="comment">!   interpolates f(x) to point y</span></div>
<div class="line"><a id="l02390" name="l02390"></a><span class="lineno"> 2390</span>    <span class="comment">!   assuming f(x) = f(x0) exp a(x - x0)</span></div>
<div class="line"><a id="l02391" name="l02391"></a><span class="lineno"> 2391</span>    <span class="comment">!   where a = ( ln f(x1) - ln f(x0) ) / (x1 - x0)</span></div>
<div class="line"><a id="l02392" name="l02392"></a><span class="lineno"> 2392</span>    <span class="comment">!   x0 &lt;= x &lt;= x1</span></div>
<div class="line"><a id="l02393" name="l02393"></a><span class="lineno"> 2393</span>    <span class="comment">!   assumes x is monotonically increasing</span></div>
<div class="line"><a id="l02394" name="l02394"></a><span class="lineno"> 2394</span> </div>
<div class="line"><a id="l02395" name="l02395"></a><span class="lineno"> 2395</span>    <span class="comment">! Author: D. Fillmore</span></div>
<div class="line"><a id="l02396" name="l02396"></a><span class="lineno"> 2396</span> </div>
<div class="line"><a id="l02397" name="l02397"></a><span class="lineno"> 2397</span><span class="comment">!   use shr_kind_mod, only: r8 =&gt; shr_kind_r8</span></div>
<div class="line"><a id="l02398" name="l02398"></a><span class="lineno"> 2398</span> </div>
<div class="line"><a id="l02399" name="l02399"></a><span class="lineno"> 2399</span>    <span class="keywordtype">implicit none</span></div>
<div class="line"><a id="l02400" name="l02400"></a><span class="lineno"> 2400</span> </div>
<div class="line"><a id="l02401" name="l02401"></a><span class="lineno"> 2401</span><span class="keywordtype">    real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>), <span class="keywordtype">intent(in)</span>, <span class="keywordtype">dimension(:)</span> :: x  <span class="comment">! grid points</span></div>
<div class="line"><a id="l02402" name="l02402"></a><span class="lineno"> 2402</span><span class="keywordtype">    real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>), <span class="keywordtype">intent(in)</span>, <span class="keywordtype">dimension(:)</span> :: f  <span class="comment">! grid function values</span></div>
<div class="line"><a id="l02403" name="l02403"></a><span class="lineno"> 2403</span><span class="keywordtype">    real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>), <span class="keywordtype">intent(in)</span> :: y                <span class="comment">! interpolation point</span></div>
<div class="line"><a id="l02404" name="l02404"></a><span class="lineno"> 2404</span><span class="keywordtype">    real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>) :: <a class="code hl_function" href="params_8m.html#a86bdec0d61a48a8ca4da1674058837cc">g</a>                            <span class="comment">! interpolated function value</span></div>
<div class="line"><a id="l02405" name="l02405"></a><span class="lineno"> 2405</span> </div>
<div class="line"><a id="l02406" name="l02406"></a><span class="lineno"> 2406</span>    <span class="keywordtype">integer</span> :: k  <span class="comment">! interpolation point index</span></div>
<div class="line"><a id="l02407" name="l02407"></a><span class="lineno"> 2407</span>    <span class="keywordtype">integer</span> :: n  <span class="comment">! length of x</span></div>
<div class="line"><a id="l02408" name="l02408"></a><span class="lineno"> 2408</span><span class="keywordtype">    real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>) :: a</div>
<div class="line"><a id="l02409" name="l02409"></a><span class="lineno"> 2409</span> </div>
<div class="line"><a id="l02410" name="l02410"></a><span class="lineno"> 2410</span>    n = <span class="keyword">size</span>(x)</div>
<div class="line"><a id="l02411" name="l02411"></a><span class="lineno"> 2411</span> </div>
<div class="line"><a id="l02412" name="l02412"></a><span class="lineno"> 2412</span>    <span class="comment">! find k such that x(k) &lt; y =&lt; x(k+1)</span></div>
<div class="line"><a id="l02413" name="l02413"></a><span class="lineno"> 2413</span>    <span class="comment">! set k = 1 if y &lt;= x(1)  and  k = n-1 if y &gt; x(n)</span></div>
<div class="line"><a id="l02414" name="l02414"></a><span class="lineno"> 2414</span> </div>
<div class="line"><a id="l02415" name="l02415"></a><span class="lineno"> 2415</span>    <span class="keywordflow">if</span> (y &lt;= x(1)) <span class="keywordflow">then</span></div>
<div class="line"><a id="l02416" name="l02416"></a><span class="lineno"> 2416</span>      k = 1</div>
<div class="line"><a id="l02417" name="l02417"></a><span class="lineno"> 2417</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (y &gt;= x(n)) <span class="keywordflow">then</span></div>
<div class="line"><a id="l02418" name="l02418"></a><span class="lineno"> 2418</span>      k = n - 1</div>
<div class="line"><a id="l02419" name="l02419"></a><span class="lineno"> 2419</span>    <span class="keywordflow">else</span></div>
<div class="line"><a id="l02420" name="l02420"></a><span class="lineno"> 2420</span>      k = 1</div>
<div class="line"><a id="l02421" name="l02421"></a><span class="lineno"> 2421</span>      <span class="keywordflow">do</span> <span class="keywordflow">while</span> (y &gt; x(k+1) .and. k &lt; n)</div>
<div class="line"><a id="l02422" name="l02422"></a><span class="lineno"> 2422</span>        k = k + 1</div>
<div class="line"><a id="l02423" name="l02423"></a><span class="lineno"> 2423</span><span class="keywordflow">      end do</span></div>
<div class="line"><a id="l02424" name="l02424"></a><span class="lineno"> 2424</span><span class="keywordflow">    end if</span></div>
<div class="line"><a id="l02425" name="l02425"></a><span class="lineno"> 2425</span> </div>
<div class="line"><a id="l02426" name="l02426"></a><span class="lineno"> 2426</span>    <span class="comment">! interpolate</span></div>
<div class="line"><a id="l02427" name="l02427"></a><span class="lineno"> 2427</span>    a = (  log( f(k+1) / f(k) )  ) / ( x(k+1) - x(k) )</div>
<div class="line"><a id="l02428" name="l02428"></a><span class="lineno"> 2428</span>    <a class="code hl_function" href="params_8m.html#a86bdec0d61a48a8ca4da1674058837cc">g</a> = f(k) * exp( a * (y - x(k)) )</div>
<div class="line"><a id="l02429" name="l02429"></a><span class="lineno"> 2429</span> </div>
<div class="line"><a id="l02430" name="l02430"></a><span class="lineno"> 2430</span>  <span class="keyword">end function </span><a class="code hl_function" href="namespacemodule__ra__cam__support.html#a46342ec26656238d58f64d5d8be63d97">exp_interpol</a></div>
<div class="line"><a id="l02431" name="l02431"></a><span class="lineno"> 2431</span> </div>
<div class="line"><a id="l02432" name="l02432"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a68912f8cfcb40aec718139f5eca9014c"> 2432</a></span>  <span class="keyword">function </span><a class="code hl_function" href="namespacemodule__ra__cam__support.html#a68912f8cfcb40aec718139f5eca9014c">lin_interpol</a>(x, f, y) <span class="keyword">result</span>(g)</div>
<div class="line"><a id="l02433" name="l02433"></a><span class="lineno"> 2433</span>    </div>
<div class="line"><a id="l02434" name="l02434"></a><span class="lineno"> 2434</span>    <span class="comment">! Purpose:</span></div>
<div class="line"><a id="l02435" name="l02435"></a><span class="lineno"> 2435</span>    <span class="comment">!   interpolates f(x) to point y</span></div>
<div class="line"><a id="l02436" name="l02436"></a><span class="lineno"> 2436</span>    <span class="comment">!   assuming f(x) = f(x0) + a * (x - x0)</span></div>
<div class="line"><a id="l02437" name="l02437"></a><span class="lineno"> 2437</span>    <span class="comment">!   where a = ( f(x1) - f(x0) ) / (x1 - x0)</span></div>
<div class="line"><a id="l02438" name="l02438"></a><span class="lineno"> 2438</span>    <span class="comment">!   x0 &lt;= x &lt;= x1</span></div>
<div class="line"><a id="l02439" name="l02439"></a><span class="lineno"> 2439</span>    <span class="comment">!   assumes x is monotonically increasing</span></div>
<div class="line"><a id="l02440" name="l02440"></a><span class="lineno"> 2440</span> </div>
<div class="line"><a id="l02441" name="l02441"></a><span class="lineno"> 2441</span>    <span class="comment">! Author: D. Fillmore</span></div>
<div class="line"><a id="l02442" name="l02442"></a><span class="lineno"> 2442</span> </div>
<div class="line"><a id="l02443" name="l02443"></a><span class="lineno"> 2443</span><span class="comment">!   use shr_kind_mod, only: r8 =&gt; shr_kind_r8</span></div>
<div class="line"><a id="l02444" name="l02444"></a><span class="lineno"> 2444</span> </div>
<div class="line"><a id="l02445" name="l02445"></a><span class="lineno"> 2445</span>    <span class="keywordtype">implicit none</span></div>
<div class="line"><a id="l02446" name="l02446"></a><span class="lineno"> 2446</span>    </div>
<div class="line"><a id="l02447" name="l02447"></a><span class="lineno"> 2447</span><span class="keywordtype">    real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>), <span class="keywordtype">intent(in)</span>, <span class="keywordtype">dimension(:)</span> :: x  <span class="comment">! grid points</span></div>
<div class="line"><a id="l02448" name="l02448"></a><span class="lineno"> 2448</span><span class="keywordtype">    real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>), <span class="keywordtype">intent(in)</span>, <span class="keywordtype">dimension(:)</span> :: f  <span class="comment">! grid function values</span></div>
<div class="line"><a id="l02449" name="l02449"></a><span class="lineno"> 2449</span><span class="keywordtype">    real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>), <span class="keywordtype">intent(in)</span> :: y                <span class="comment">! interpolation point</span></div>
<div class="line"><a id="l02450" name="l02450"></a><span class="lineno"> 2450</span><span class="keywordtype">    real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>) :: <a class="code hl_function" href="params_8m.html#a86bdec0d61a48a8ca4da1674058837cc">g</a>                            <span class="comment">! interpolated function value</span></div>
<div class="line"><a id="l02451" name="l02451"></a><span class="lineno"> 2451</span>    </div>
<div class="line"><a id="l02452" name="l02452"></a><span class="lineno"> 2452</span>    <span class="keywordtype">integer</span> :: k  <span class="comment">! interpolation point index</span></div>
<div class="line"><a id="l02453" name="l02453"></a><span class="lineno"> 2453</span>    <span class="keywordtype">integer</span> :: n  <span class="comment">! length of x</span></div>
<div class="line"><a id="l02454" name="l02454"></a><span class="lineno"> 2454</span><span class="keywordtype">    real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>) :: a</div>
<div class="line"><a id="l02455" name="l02455"></a><span class="lineno"> 2455</span> </div>
<div class="line"><a id="l02456" name="l02456"></a><span class="lineno"> 2456</span>    n = <span class="keyword">size</span>(x)</div>
<div class="line"><a id="l02457" name="l02457"></a><span class="lineno"> 2457</span> </div>
<div class="line"><a id="l02458" name="l02458"></a><span class="lineno"> 2458</span>    <span class="comment">! find k such that x(k) &lt; y =&lt; x(k+1)</span></div>
<div class="line"><a id="l02459" name="l02459"></a><span class="lineno"> 2459</span>    <span class="comment">! set k = 1 if y &lt;= x(1)  and  k = n-1 if y &gt; x(n)</span></div>
<div class="line"><a id="l02460" name="l02460"></a><span class="lineno"> 2460</span> </div>
<div class="line"><a id="l02461" name="l02461"></a><span class="lineno"> 2461</span>    <span class="keywordflow">if</span> (y &lt;= x(1)) <span class="keywordflow">then</span> </div>
<div class="line"><a id="l02462" name="l02462"></a><span class="lineno"> 2462</span>      k = 1 </div>
<div class="line"><a id="l02463" name="l02463"></a><span class="lineno"> 2463</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (y &gt;= x(n)) <span class="keywordflow">then</span></div>
<div class="line"><a id="l02464" name="l02464"></a><span class="lineno"> 2464</span>      k = n - 1</div>
<div class="line"><a id="l02465" name="l02465"></a><span class="lineno"> 2465</span>    <span class="keywordflow">else</span> </div>
<div class="line"><a id="l02466" name="l02466"></a><span class="lineno"> 2466</span>      k = 1 </div>
<div class="line"><a id="l02467" name="l02467"></a><span class="lineno"> 2467</span>      <span class="keywordflow">do</span> <span class="keywordflow">while</span> (y &gt; x(k+1) .and. k &lt; n)</div>
<div class="line"><a id="l02468" name="l02468"></a><span class="lineno"> 2468</span>        k = k + 1</div>
<div class="line"><a id="l02469" name="l02469"></a><span class="lineno"> 2469</span><span class="keywordflow">      end do</span></div>
<div class="line"><a id="l02470" name="l02470"></a><span class="lineno"> 2470</span><span class="keywordflow">    end if</span></div>
<div class="line"><a id="l02471" name="l02471"></a><span class="lineno"> 2471</span> </div>
<div class="line"><a id="l02472" name="l02472"></a><span class="lineno"> 2472</span>    <span class="comment">! interpolate</span></div>
<div class="line"><a id="l02473" name="l02473"></a><span class="lineno"> 2473</span>    a = (  f(k+1) - f(k) ) / ( x(k+1) - x(k) )</div>
<div class="line"><a id="l02474" name="l02474"></a><span class="lineno"> 2474</span>    <a class="code hl_function" href="params_8m.html#a86bdec0d61a48a8ca4da1674058837cc">g</a> = f(k) + a * (y - x(k))</div>
<div class="line"><a id="l02475" name="l02475"></a><span class="lineno"> 2475</span> </div>
<div class="line"><a id="l02476" name="l02476"></a><span class="lineno"> 2476</span>  <span class="keyword">end function </span><a class="code hl_function" href="namespacemodule__ra__cam__support.html#a68912f8cfcb40aec718139f5eca9014c">lin_interpol</a></div>
<div class="line"><a id="l02477" name="l02477"></a><span class="lineno"> 2477</span> </div>
<div class="line"><a id="l02478" name="l02478"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a0a9ae8d88dbd86e1bed5948a3bc5224e"> 2478</a></span>  <span class="keyword">function </span><a class="code hl_function" href="namespacemodule__ra__cam__support.html#a0a9ae8d88dbd86e1bed5948a3bc5224e">lin_interpol2</a>(x, f, y) <span class="keyword">result</span>(g)</div>
<div class="line"><a id="l02479" name="l02479"></a><span class="lineno"> 2479</span> </div>
<div class="line"><a id="l02480" name="l02480"></a><span class="lineno"> 2480</span>    <span class="comment">! Purpose:</span></div>
<div class="line"><a id="l02481" name="l02481"></a><span class="lineno"> 2481</span>    <span class="comment">!   interpolates f(x) to point y</span></div>
<div class="line"><a id="l02482" name="l02482"></a><span class="lineno"> 2482</span>    <span class="comment">!   assuming f(x) = f(x0) + a * (x - x0)</span></div>
<div class="line"><a id="l02483" name="l02483"></a><span class="lineno"> 2483</span>    <span class="comment">!   where a = ( f(x1) - f(x0) ) / (x1 - x0)</span></div>
<div class="line"><a id="l02484" name="l02484"></a><span class="lineno"> 2484</span>    <span class="comment">!   x0 &lt;= x &lt;= x1</span></div>
<div class="line"><a id="l02485" name="l02485"></a><span class="lineno"> 2485</span>    <span class="comment">!   assumes x is monotonically increasing</span></div>
<div class="line"><a id="l02486" name="l02486"></a><span class="lineno"> 2486</span> </div>
<div class="line"><a id="l02487" name="l02487"></a><span class="lineno"> 2487</span>    <span class="comment">! Author: D. Fillmore ::  J. Done changed from r8 to r4</span></div>
<div class="line"><a id="l02488" name="l02488"></a><span class="lineno"> 2488</span> </div>
<div class="line"><a id="l02489" name="l02489"></a><span class="lineno"> 2489</span>    <span class="keywordtype">implicit none</span></div>
<div class="line"><a id="l02490" name="l02490"></a><span class="lineno"> 2490</span> </div>
<div class="line"><a id="l02491" name="l02491"></a><span class="lineno"> 2491</span><span class="keywordtype">    real</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">dimension(:)</span> :: x  <span class="comment">! grid points</span></div>
<div class="line"><a id="l02492" name="l02492"></a><span class="lineno"> 2492</span><span class="keywordtype">    real</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">dimension(:)</span> :: f  <span class="comment">! grid function values</span></div>
<div class="line"><a id="l02493" name="l02493"></a><span class="lineno"> 2493</span><span class="keywordtype">    real</span>, <span class="keywordtype">intent(in)</span> :: y                <span class="comment">! interpolation point</span></div>
<div class="line"><a id="l02494" name="l02494"></a><span class="lineno"> 2494</span><span class="keywordtype">    real</span> :: <a class="code hl_function" href="params_8m.html#a86bdec0d61a48a8ca4da1674058837cc">g</a>                            <span class="comment">! interpolated function value</span></div>
<div class="line"><a id="l02495" name="l02495"></a><span class="lineno"> 2495</span> </div>
<div class="line"><a id="l02496" name="l02496"></a><span class="lineno"> 2496</span>    <span class="keywordtype">integer</span> :: k  <span class="comment">! interpolation point index</span></div>
<div class="line"><a id="l02497" name="l02497"></a><span class="lineno"> 2497</span>    <span class="keywordtype">integer</span> :: n  <span class="comment">! length of x</span></div>
<div class="line"><a id="l02498" name="l02498"></a><span class="lineno"> 2498</span><span class="keywordtype">    real</span>    :: a</div>
<div class="line"><a id="l02499" name="l02499"></a><span class="lineno"> 2499</span> </div>
<div class="line"><a id="l02500" name="l02500"></a><span class="lineno"> 2500</span>    n = <span class="keyword">size</span>(x)</div>
<div class="line"><a id="l02501" name="l02501"></a><span class="lineno"> 2501</span> </div>
<div class="line"><a id="l02502" name="l02502"></a><span class="lineno"> 2502</span>    <span class="comment">! find k such that x(k) &lt; y =&lt; x(k+1)</span></div>
<div class="line"><a id="l02503" name="l02503"></a><span class="lineno"> 2503</span>    <span class="comment">! set k = 1 if y &lt;= x(1)  and  k = n-1 if y &gt; x(n)</span></div>
<div class="line"><a id="l02504" name="l02504"></a><span class="lineno"> 2504</span> </div>
<div class="line"><a id="l02505" name="l02505"></a><span class="lineno"> 2505</span>    <span class="keywordflow">if</span> (y &lt;= x(1)) <span class="keywordflow">then</span></div>
<div class="line"><a id="l02506" name="l02506"></a><span class="lineno"> 2506</span>      k = 1</div>
<div class="line"><a id="l02507" name="l02507"></a><span class="lineno"> 2507</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (y &gt;= x(n)) <span class="keywordflow">then</span></div>
<div class="line"><a id="l02508" name="l02508"></a><span class="lineno"> 2508</span>      k = n - 1</div>
<div class="line"><a id="l02509" name="l02509"></a><span class="lineno"> 2509</span>    <span class="keywordflow">else</span></div>
<div class="line"><a id="l02510" name="l02510"></a><span class="lineno"> 2510</span>      k = 1</div>
<div class="line"><a id="l02511" name="l02511"></a><span class="lineno"> 2511</span>      <span class="keywordflow">do</span> <span class="keywordflow">while</span> (y &gt; x(k+1) .and. k &lt; n)</div>
<div class="line"><a id="l02512" name="l02512"></a><span class="lineno"> 2512</span>        k = k + 1</div>
<div class="line"><a id="l02513" name="l02513"></a><span class="lineno"> 2513</span><span class="keywordflow">      end do</span></div>
<div class="line"><a id="l02514" name="l02514"></a><span class="lineno"> 2514</span><span class="keywordflow">    end if</span></div>
<div class="line"><a id="l02515" name="l02515"></a><span class="lineno"> 2515</span> </div>
<div class="line"><a id="l02516" name="l02516"></a><span class="lineno"> 2516</span>    <span class="comment">! interpolate</span></div>
<div class="line"><a id="l02517" name="l02517"></a><span class="lineno"> 2517</span>    a = (  f(k+1) - f(k) ) / ( x(k+1) - x(k) )</div>
<div class="line"><a id="l02518" name="l02518"></a><span class="lineno"> 2518</span>    <a class="code hl_function" href="params_8m.html#a86bdec0d61a48a8ca4da1674058837cc">g</a> = f(k) + a * (y - x(k))</div>
<div class="line"><a id="l02519" name="l02519"></a><span class="lineno"> 2519</span> </div>
<div class="line"><a id="l02520" name="l02520"></a><span class="lineno"> 2520</span>  <span class="keyword">end function </span><a class="code hl_function" href="namespacemodule__ra__cam__support.html#a0a9ae8d88dbd86e1bed5948a3bc5224e">lin_interpol2</a>    </div>
<div class="line"><a id="l02521" name="l02521"></a><span class="lineno"> 2521</span> </div>
<div class="line"><a id="l02522" name="l02522"></a><span class="lineno"> 2522</span> </div>
<div class="line"><a id="l02523" name="l02523"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#acf33ff369ebd5a597e81572072f0dc3f"> 2523</a></span><span class="keyword">subroutine </span><a class="code hl_function" href="namespacemodule__ra__cam__support.html#acf33ff369ebd5a597e81572072f0dc3f">getfactors</a> (cycflag, np1, cdayminus, cdayplus, cday, &amp;</div>
<div class="line"><a id="l02524" name="l02524"></a><span class="lineno"> 2524</span>                       fact1, fact2)</div>
<div class="line"><a id="l02525" name="l02525"></a><span class="lineno"> 2525</span><span class="comment">!---------------------------------------------------------------------------</span></div>
<div class="line"><a id="l02526" name="l02526"></a><span class="lineno"> 2526</span><span class="comment">!</span></div>
<div class="line"><a id="l02527" name="l02527"></a><span class="lineno"> 2527</span><span class="comment">! Purpose: Determine time interpolation factors (normally for a boundary dataset)</span></div>
<div class="line"><a id="l02528" name="l02528"></a><span class="lineno"> 2528</span><span class="comment">!          for linear interpolation.</span></div>
<div class="line"><a id="l02529" name="l02529"></a><span class="lineno"> 2529</span><span class="comment">!</span></div>
<div class="line"><a id="l02530" name="l02530"></a><span class="lineno"> 2530</span><span class="comment">! Method:  Assume 365 days per year.  Output variable fact1 will be the weight to</span></div>
<div class="line"><a id="l02531" name="l02531"></a><span class="lineno"> 2531</span><span class="comment">!          apply to data at calendar time &quot;cdayminus&quot;, and fact2 the weight to apply</span></div>
<div class="line"><a id="l02532" name="l02532"></a><span class="lineno"> 2532</span><span class="comment">!          to data at time &quot;cdayplus&quot;.  Combining these values will produce a result</span></div>
<div class="line"><a id="l02533" name="l02533"></a><span class="lineno"> 2533</span><span class="comment">!          valid at time &quot;cday&quot;.  Output arguments fact1 and fact2 will be between</span></div>
<div class="line"><a id="l02534" name="l02534"></a><span class="lineno"> 2534</span><span class="comment">!          0 and 1, and fact1 + fact2 = 1 to roundoff.</span></div>
<div class="line"><a id="l02535" name="l02535"></a><span class="lineno"> 2535</span><span class="comment">!</span></div>
<div class="line"><a id="l02536" name="l02536"></a><span class="lineno"> 2536</span><span class="comment">! Author:  Jim Rosinski</span></div>
<div class="line"><a id="l02537" name="l02537"></a><span class="lineno"> 2537</span><span class="comment">!</span></div>
<div class="line"><a id="l02538" name="l02538"></a><span class="lineno"> 2538</span><span class="comment">!---------------------------------------------------------------------------</span></div>
<div class="line"><a id="l02539" name="l02539"></a><span class="lineno"> 2539</span>   <span class="keywordtype">implicit none</span></div>
<div class="line"><a id="l02540" name="l02540"></a><span class="lineno"> 2540</span><span class="comment">!</span></div>
<div class="line"><a id="l02541" name="l02541"></a><span class="lineno"> 2541</span><span class="comment">! Arguments</span></div>
<div class="line"><a id="l02542" name="l02542"></a><span class="lineno"> 2542</span><span class="comment">!</span></div>
<div class="line"><a id="l02543" name="l02543"></a><span class="lineno"> 2543</span>   <span class="keywordtype">logical</span>, <span class="keywordtype">intent(in)</span> :: cycflag             <span class="comment">! flag indicates whether dataset is being cycled yearly</span></div>
<div class="line"><a id="l02544" name="l02544"></a><span class="lineno"> 2544</span> </div>
<div class="line"><a id="l02545" name="l02545"></a><span class="lineno"> 2545</span>   <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: np1                 <span class="comment">! index points to forward time slice matching cdayplus</span></div>
<div class="line"><a id="l02546" name="l02546"></a><span class="lineno"> 2546</span> </div>
<div class="line"><a id="l02547" name="l02547"></a><span class="lineno"> 2547</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: cdayminus          <span class="comment">! calendar day of rearward time slice</span></div>
<div class="line"><a id="l02548" name="l02548"></a><span class="lineno"> 2548</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: cdayplus           <span class="comment">! calendar day of forward time slice</span></div>
<div class="line"><a id="l02549" name="l02549"></a><span class="lineno"> 2549</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: cday               <span class="comment">! calenar day to be interpolated to</span></div>
<div class="line"><a id="l02550" name="l02550"></a><span class="lineno"> 2550</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(out)</span> :: fact1             <span class="comment">! time interpolation factor to apply to rearward time slice</span></div>
<div class="line"><a id="l02551" name="l02551"></a><span class="lineno"> 2551</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(out)</span> :: fact2             <span class="comment">! time interpolation factor to apply to forward time slice</span></div>
<div class="line"><a id="l02552" name="l02552"></a><span class="lineno"> 2552</span> </div>
<div class="line"><a id="l02553" name="l02553"></a><span class="lineno"> 2553</span><span class="comment">!  character(len=*), intent(in) :: str        ! string to be added to print in case of error (normally the callers name)</span></div>
<div class="line"><a id="l02554" name="l02554"></a><span class="lineno"> 2554</span><span class="comment">!</span></div>
<div class="line"><a id="l02555" name="l02555"></a><span class="lineno"> 2555</span><span class="comment">! Local workspace</span></div>
<div class="line"><a id="l02556" name="l02556"></a><span class="lineno"> 2556</span><span class="comment">!</span></div>
<div class="line"><a id="l02557" name="l02557"></a><span class="lineno"> 2557</span><span class="keywordtype">   real</span>(r8) :: deltat                         <span class="comment">! time difference (days) between cdayminus and cdayplus</span></div>
<div class="line"><a id="l02558" name="l02558"></a><span class="lineno"> 2558</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">parameter</span> :: daysperyear = 365.  <span class="comment">! number of days in a year</span></div>
<div class="line"><a id="l02559" name="l02559"></a><span class="lineno"> 2559</span><span class="comment">!</span></div>
<div class="line"><a id="l02560" name="l02560"></a><span class="lineno"> 2560</span><span class="comment">! Initial sanity checks</span></div>
<div class="line"><a id="l02561" name="l02561"></a><span class="lineno"> 2561</span><span class="comment">!</span></div>
<div class="line"><a id="l02562" name="l02562"></a><span class="lineno"> 2562</span><span class="comment">!  if (np1 == 1 .and. .not. cycflag) then</span></div>
<div class="line"><a id="l02563" name="l02563"></a><span class="lineno"> 2563</span><span class="comment">!     call endrun (&#39;GETFACTORS:&#39;//str//&#39; cycflag false and forward month index = Jan. not allowed&#39;)</span></div>
<div class="line"><a id="l02564" name="l02564"></a><span class="lineno"> 2564</span><span class="comment">!  end if</span></div>
<div class="line"><a id="l02565" name="l02565"></a><span class="lineno"> 2565</span> </div>
<div class="line"><a id="l02566" name="l02566"></a><span class="lineno"> 2566</span><span class="comment">!  if (np1 &lt; 1) then</span></div>
<div class="line"><a id="l02567" name="l02567"></a><span class="lineno"> 2567</span><span class="comment">!     call endrun (&#39;GETFACTORS:&#39;//str//&#39; input arg np1 must be &gt; 0&#39;)</span></div>
<div class="line"><a id="l02568" name="l02568"></a><span class="lineno"> 2568</span><span class="comment">!  end if</span></div>
<div class="line"><a id="l02569" name="l02569"></a><span class="lineno"> 2569</span> </div>
<div class="line"><a id="l02570" name="l02570"></a><span class="lineno"> 2570</span>   <span class="keywordflow">if</span> (cycflag) <span class="keywordflow">then</span></div>
<div class="line"><a id="l02571" name="l02571"></a><span class="lineno"> 2571</span>      <span class="keywordflow">if</span> ((cday &lt; 1.) .or. (cday &gt; (daysperyear+1.))) <span class="keywordflow">then</span></div>
<div class="line"><a id="l02572" name="l02572"></a><span class="lineno"> 2572</span>         <span class="keyword">write</span>(6,*) <span class="stringliteral">&#39;GETFACTORS:&#39;</span>, <span class="stringliteral">&#39; bad cday=&#39;</span>,cday</div>
<div class="line"><a id="l02573" name="l02573"></a><span class="lineno"> 2573</span><span class="comment">!        call endrun ()</span></div>
<div class="line"><a id="l02574" name="l02574"></a><span class="lineno"> 2574</span><span class="keywordflow">      end if</span></div>
<div class="line"><a id="l02575" name="l02575"></a><span class="lineno"> 2575</span>   <span class="keywordflow">else</span></div>
<div class="line"><a id="l02576" name="l02576"></a><span class="lineno"> 2576</span>      <span class="keywordflow">if</span> (cday &lt; 1.) <span class="keywordflow">then</span></div>
<div class="line"><a id="l02577" name="l02577"></a><span class="lineno"> 2577</span>         <span class="keyword">write</span>(6,*) <span class="stringliteral">&#39;GETFACTORS:&#39;</span>,  <span class="stringliteral">&#39; bad cday=&#39;</span>,cday</div>
<div class="line"><a id="l02578" name="l02578"></a><span class="lineno"> 2578</span><span class="comment">!        call endrun ()</span></div>
<div class="line"><a id="l02579" name="l02579"></a><span class="lineno"> 2579</span><span class="keywordflow">      end if</span></div>
<div class="line"><a id="l02580" name="l02580"></a><span class="lineno"> 2580</span><span class="keywordflow">   end if</span></div>
<div class="line"><a id="l02581" name="l02581"></a><span class="lineno"> 2581</span><span class="comment">!</span></div>
<div class="line"><a id="l02582" name="l02582"></a><span class="lineno"> 2582</span><span class="comment">! Determine time interpolation factors.  Account for December-January</span></div>
<div class="line"><a id="l02583" name="l02583"></a><span class="lineno"> 2583</span><span class="comment">! interpolation if dataset is being cycled yearly.</span></div>
<div class="line"><a id="l02584" name="l02584"></a><span class="lineno"> 2584</span><span class="comment">!</span></div>
<div class="line"><a id="l02585" name="l02585"></a><span class="lineno"> 2585</span>   <span class="keywordflow">if</span> (cycflag .and. np1 == 1) <span class="keywordflow">then</span>                     <span class="comment">! Dec-Jan interpolation</span></div>
<div class="line"><a id="l02586" name="l02586"></a><span class="lineno"> 2586</span>      deltat = cdayplus + daysperyear - cdayminus</div>
<div class="line"><a id="l02587" name="l02587"></a><span class="lineno"> 2587</span>      <span class="keywordflow">if</span> (cday &gt; cdayplus) <span class="keywordflow">then</span>                         <span class="comment">! We are in December</span></div>
<div class="line"><a id="l02588" name="l02588"></a><span class="lineno"> 2588</span>         fact1 = (cdayplus + daysperyear - cday)/deltat</div>
<div class="line"><a id="l02589" name="l02589"></a><span class="lineno"> 2589</span>         fact2 = (cday - cdayminus)/deltat</div>
<div class="line"><a id="l02590" name="l02590"></a><span class="lineno"> 2590</span>      <span class="keywordflow">else</span>                                              <span class="comment">! We are in January</span></div>
<div class="line"><a id="l02591" name="l02591"></a><span class="lineno"> 2591</span>         fact1 = (cdayplus - cday)/deltat</div>
<div class="line"><a id="l02592" name="l02592"></a><span class="lineno"> 2592</span>         fact2 = (cday + daysperyear - cdayminus)/deltat</div>
<div class="line"><a id="l02593" name="l02593"></a><span class="lineno"> 2593</span><span class="keywordflow">      end if</span></div>
<div class="line"><a id="l02594" name="l02594"></a><span class="lineno"> 2594</span>   <span class="keywordflow">else</span></div>
<div class="line"><a id="l02595" name="l02595"></a><span class="lineno"> 2595</span>      deltat = cdayplus - cdayminus</div>
<div class="line"><a id="l02596" name="l02596"></a><span class="lineno"> 2596</span>      fact1 = (cdayplus - cday)/deltat</div>
<div class="line"><a id="l02597" name="l02597"></a><span class="lineno"> 2597</span>      fact2 = (cday - cdayminus)/deltat</div>
<div class="line"><a id="l02598" name="l02598"></a><span class="lineno"> 2598</span><span class="keywordflow">   end if</span></div>
<div class="line"><a id="l02599" name="l02599"></a><span class="lineno"> 2599</span> </div>
<div class="line"><a id="l02600" name="l02600"></a><span class="lineno"> 2600</span>   <span class="keywordflow">if</span> (.not. <a class="code hl_function" href="namespacemodule__ra__cam__support.html#a5c7dc0d73653270f1ac4ad36d5c2d6ea">validfactors</a>(fact1, fact2)) <span class="keywordflow">then</span></div>
<div class="line"><a id="l02601" name="l02601"></a><span class="lineno"> 2601</span>      <span class="keyword">write</span>(6,*) <span class="stringliteral">&#39;GETFACTORS: &#39;</span>, <span class="stringliteral">&#39; bad fact1 and/or fact2=&#39;</span>, fact1, fact2</div>
<div class="line"><a id="l02602" name="l02602"></a><span class="lineno"> 2602</span><span class="comment">!     call endrun ()</span></div>
<div class="line"><a id="l02603" name="l02603"></a><span class="lineno"> 2603</span><span class="keywordflow">   end if</span></div>
<div class="line"><a id="l02604" name="l02604"></a><span class="lineno"> 2604</span> </div>
<div class="line"><a id="l02605" name="l02605"></a><span class="lineno"> 2605</span>   <span class="keywordflow">return</span></div>
<div class="line"><a id="l02606" name="l02606"></a><span class="lineno"> 2606</span><span class="keyword">end subroutine </span><a class="code hl_function" href="namespacemodule__ra__cam__support.html#acf33ff369ebd5a597e81572072f0dc3f">getfactors</a></div>
<div class="line"><a id="l02607" name="l02607"></a><span class="lineno"> 2607</span> </div>
<div class="line"><a id="l02608" name="l02608"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a5c7dc0d73653270f1ac4ad36d5c2d6ea"> 2608</a></span><span class="keyword">logical </span><span class="keyword">function </span><a class="code hl_function" href="namespacemodule__ra__cam__support.html#a5c7dc0d73653270f1ac4ad36d5c2d6ea">validfactors</a> (fact1, fact2)</div>
<div class="line"><a id="l02609" name="l02609"></a><span class="lineno"> 2609</span><span class="comment">!---------------------------------------------------------------------------</span></div>
<div class="line"><a id="l02610" name="l02610"></a><span class="lineno"> 2610</span><span class="comment">!</span></div>
<div class="line"><a id="l02611" name="l02611"></a><span class="lineno"> 2611</span><span class="comment">! Purpose: check sanity of time interpolation factors to within 32-bit roundoff</span></div>
<div class="line"><a id="l02612" name="l02612"></a><span class="lineno"> 2612</span><span class="comment">!</span></div>
<div class="line"><a id="l02613" name="l02613"></a><span class="lineno"> 2613</span><span class="comment">!---------------------------------------------------------------------------</span></div>
<div class="line"><a id="l02614" name="l02614"></a><span class="lineno"> 2614</span>   <span class="keywordtype">implicit none</span></div>
<div class="line"><a id="l02615" name="l02615"></a><span class="lineno"> 2615</span> </div>
<div class="line"><a id="l02616" name="l02616"></a><span class="lineno"> 2616</span><span class="keywordtype">   real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>), <span class="keywordtype">intent(in)</span> :: fact1, fact2           <span class="comment">! time interpolation factors</span></div>
<div class="line"><a id="l02617" name="l02617"></a><span class="lineno"> 2617</span> </div>
<div class="line"><a id="l02618" name="l02618"></a><span class="lineno"> 2618</span>   <a class="code hl_function" href="namespacemodule__ra__cam__support.html#a5c7dc0d73653270f1ac4ad36d5c2d6ea">validfactors</a> = .true.</div>
<div class="line"><a id="l02619" name="l02619"></a><span class="lineno"> 2619</span>   <span class="keywordflow">if</span> (abs(fact1+fact2-1.) &gt; 1.e-6 .or. &amp;</div>
<div class="line"><a id="l02620" name="l02620"></a><span class="lineno"> 2620</span>       fact1 &gt; 1.000001 .or. fact1 &lt; -1.e-6 .or. &amp;</div>
<div class="line"><a id="l02621" name="l02621"></a><span class="lineno"> 2621</span>       fact2 &gt; 1.000001 .or. fact2 &lt; -1.e-6) <span class="keywordflow">then</span></div>
<div class="line"><a id="l02622" name="l02622"></a><span class="lineno"> 2622</span> </div>
<div class="line"><a id="l02623" name="l02623"></a><span class="lineno"> 2623</span>      <a class="code hl_function" href="namespacemodule__ra__cam__support.html#a5c7dc0d73653270f1ac4ad36d5c2d6ea">validfactors</a> = .false.</div>
<div class="line"><a id="l02624" name="l02624"></a><span class="lineno"> 2624</span><span class="keywordflow">   end if</span></div>
<div class="line"><a id="l02625" name="l02625"></a><span class="lineno"> 2625</span> </div>
<div class="line"><a id="l02626" name="l02626"></a><span class="lineno"> 2626</span>   <span class="keywordflow">return</span></div>
<div class="line"><a id="l02627" name="l02627"></a><span class="lineno"> 2627</span><span class="keyword">end function </span><a class="code hl_function" href="namespacemodule__ra__cam__support.html#a5c7dc0d73653270f1ac4ad36d5c2d6ea">validfactors</a></div>
<div class="line"><a id="l02628" name="l02628"></a><span class="lineno"> 2628</span> </div>
<div class="line"><a id="l02629" name="l02629"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#ad5b0cc3996fc6091152b094d8b4e6fe4"> 2629</a></span><span class="keyword">subroutine </span><a class="code hl_function" href="namespacemodule__ra__cam__support.html#ad5b0cc3996fc6091152b094d8b4e6fe4">get_rf_scales</a>(scales)</div>
<div class="line"><a id="l02630" name="l02630"></a><span class="lineno"> 2630</span> </div>
<div class="line"><a id="l02631" name="l02631"></a><span class="lineno"> 2631</span><span class="keywordtype">  real</span>(r8), <span class="keywordtype">intent(out)</span>::scales(naer_all)  <span class="comment">! scale aerosols by this amount</span></div>
<div class="line"><a id="l02632" name="l02632"></a><span class="lineno"> 2632</span> </div>
<div class="line"><a id="l02633" name="l02633"></a><span class="lineno"> 2633</span>  <span class="keywordtype">integer</span> i                                  <span class="comment">! loop index</span></div>
<div class="line"><a id="l02634" name="l02634"></a><span class="lineno"> 2634</span> </div>
<div class="line"><a id="l02635" name="l02635"></a><span class="lineno"> 2635</span>  <span class="keyword">write</span>(0,*)</div>
<div class="line"><a id="l02636" name="l02636"></a><span class="lineno"> 2636</span>  <span class="keyword">write</span>(0,*) <span class="stringliteral">&#39;--- enter subroutine get_rf_scales:&#39;</span></div>
<div class="line"><a id="l02637" name="l02637"></a><span class="lineno"> 2637</span>  <span class="keyword">write</span>(0,*) <span class="stringliteral">&#39;--- naer_all = &#39;</span>, naer_all</div>
<div class="line"><a id="l02638" name="l02638"></a><span class="lineno"> 2638</span>  <span class="keyword">write</span>(0,*) <span class="stringliteral">&#39;--- idxBG    = &#39;</span>, <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ab377fd834d670fed20ad3f59d359f8a7">idxbg</a></div>
<div class="line"><a id="l02639" name="l02639"></a><span class="lineno"> 2639</span>  <span class="keyword">write</span>(0,*) <span class="stringliteral">&#39;--- idxSUL   = &#39;</span>, <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a863b1d9602abdd9946b40135690a4db5">idxsul</a></div>
<div class="line"><a id="l02640" name="l02640"></a><span class="lineno"> 2640</span>  <span class="keyword">write</span>(0,*) <span class="stringliteral">&#39;--- idxSSLT  = &#39;</span>, <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a521884c838130d3a7fce69511e4708a0">idxsslt</a></div>
<div class="line"><a id="l02641" name="l02641"></a><span class="lineno"> 2641</span>  <span class="keyword">write</span>(0,*) <span class="stringliteral">&#39;--- idxCARBONfirst = &#39;</span>, <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a35f5066746b13db0893d19b839574bc9">idxcarbonfirst</a></div>
<div class="line"><a id="l02642" name="l02642"></a><span class="lineno"> 2642</span>  <span class="keyword">write</span>(0,*) <span class="stringliteral">&#39;--- numCARBON = &#39;</span>, <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ae44324bed6778856144ccf65c0b8bf34">numcarbon</a></div>
<div class="line"><a id="l02643" name="l02643"></a><span class="lineno"> 2643</span>  <span class="keyword">write</span>(0,*) <span class="stringliteral">&#39;--- idxDUSTfirst = &#39;</span>, <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a130c6997ed212e28b4c576707a7e82ad">idxdustfirst</a></div>
<div class="line"><a id="l02644" name="l02644"></a><span class="lineno"> 2644</span>  <span class="keyword">write</span>(0,*) <span class="stringliteral">&#39;--- numDUST   = &#39;</span>, <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#acf3acb40440157c2ff3dab3ebcde1546">numdust</a></div>
<div class="line"><a id="l02645" name="l02645"></a><span class="lineno"> 2645</span>  <span class="keyword">write</span>(0,*) <span class="stringliteral">&#39;--- idxVOLC = &#39;</span>, <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a027edc99883f6383db3e8108e2d28bce">idxvolc</a></div>
<div class="line"><a id="l02646" name="l02646"></a><span class="lineno"> 2646</span>  stop</div>
<div class="line"><a id="l02647" name="l02647"></a><span class="lineno"> 2647</span> </div>
<div class="line"><a id="l02648" name="l02648"></a><span class="lineno"> 2648</span>  scales(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ab377fd834d670fed20ad3f59d359f8a7">idxbg</a>) = <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ac271b0b48df7c1f38bb4ae5a507cfeb5">bgscl_rf</a></div>
<div class="line"><a id="l02649" name="l02649"></a><span class="lineno"> 2649</span>  scales(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a863b1d9602abdd9946b40135690a4db5">idxsul</a>) = <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a4098d4672dba23f66f732f3e0195dfd1">sulscl_rf</a></div>
<div class="line"><a id="l02650" name="l02650"></a><span class="lineno"> 2650</span>  scales(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a521884c838130d3a7fce69511e4708a0">idxsslt</a>) = <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a5971b22b001ecc165f9c3eb2222b9225">ssltscl_rf</a></div>
<div class="line"><a id="l02651" name="l02651"></a><span class="lineno"> 2651</span> </div>
<div class="line"><a id="l02652" name="l02652"></a><span class="lineno"> 2652</span>  <span class="keywordflow">do</span> i = <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a35f5066746b13db0893d19b839574bc9">idxcarbonfirst</a>, <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a35f5066746b13db0893d19b839574bc9">idxcarbonfirst</a>+<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ae44324bed6778856144ccf65c0b8bf34">numcarbon</a>-1</div>
<div class="line"><a id="l02653" name="l02653"></a><span class="lineno"> 2653</span>    scales(i) = <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a9084c0a881dd139972347d6c86b4a7ed">carscl_rf</a></div>
<div class="line"><a id="l02654" name="l02654"></a><span class="lineno"> 2654</span><span class="keywordflow">  enddo</span></div>
<div class="line"><a id="l02655" name="l02655"></a><span class="lineno"> 2655</span> </div>
<div class="line"><a id="l02656" name="l02656"></a><span class="lineno"> 2656</span>  <span class="keywordflow">do</span> i = <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a130c6997ed212e28b4c576707a7e82ad">idxdustfirst</a>, <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a130c6997ed212e28b4c576707a7e82ad">idxdustfirst</a>+<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#acf3acb40440157c2ff3dab3ebcde1546">numdust</a>-1</div>
<div class="line"><a id="l02657" name="l02657"></a><span class="lineno"> 2657</span>    scales(i) = <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a45931081332eeb6af5a457003dfc59bc">dustscl_rf</a></div>
<div class="line"><a id="l02658" name="l02658"></a><span class="lineno"> 2658</span><span class="keywordflow">  enddo</span></div>
<div class="line"><a id="l02659" name="l02659"></a><span class="lineno"> 2659</span> </div>
<div class="line"><a id="l02660" name="l02660"></a><span class="lineno"> 2660</span>  scales(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a027edc99883f6383db3e8108e2d28bce">idxvolc</a>) = <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ac14abc1728ad2feb7b32e3634c901fec">volcscl_rf</a></div>
<div class="line"><a id="l02661" name="l02661"></a><span class="lineno"> 2661</span> </div>
<div class="line"><a id="l02662" name="l02662"></a><span class="lineno"> 2662</span><span class="keyword">end subroutine </span><a class="code hl_function" href="namespacemodule__ra__cam__support.html#ad5b0cc3996fc6091152b094d8b4e6fe4">get_rf_scales</a></div>
<div class="line"><a id="l02663" name="l02663"></a><span class="lineno"> 2663</span> </div>
<div class="line"><a id="l02664" name="l02664"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a4446dd561840717c0510f977776013a7"> 2664</a></span><span class="keyword">function </span><a class="code hl_function" href="namespacemodule__ra__cam__support.html#a4446dd561840717c0510f977776013a7">psi</a>(tpx,iband)</div>
<div class="line"><a id="l02665" name="l02665"></a><span class="lineno"> 2665</span><span class="comment">!    </span></div>
<div class="line"><a id="l02666" name="l02666"></a><span class="lineno"> 2666</span><span class="comment">! History: First version for Hitran 1996 (C/H/E)</span></div>
<div class="line"><a id="l02667" name="l02667"></a><span class="lineno"> 2667</span><span class="comment">!          Current version for Hitran 2000 (C/LT/E)</span></div>
<div class="line"><a id="l02668" name="l02668"></a><span class="lineno"> 2668</span><span class="comment">! Short function for Hulst-Curtis-Godson temperature factors for</span></div>
<div class="line"><a id="l02669" name="l02669"></a><span class="lineno"> 2669</span><span class="comment">!   computing effective H2O path</span></div>
<div class="line"><a id="l02670" name="l02670"></a><span class="lineno"> 2670</span><span class="comment">! Line data for H2O: Hitran 2000, plus H2O patches v11.0 for 1341 missing</span></div>
<div class="line"><a id="l02671" name="l02671"></a><span class="lineno"> 2671</span><span class="comment">!                    lines between 500 and 2820 cm^-1.</span></div>
<div class="line"><a id="l02672" name="l02672"></a><span class="lineno"> 2672</span><span class="comment">!                    See cfa-www.harvard.edu/HITRAN</span></div>
<div class="line"><a id="l02673" name="l02673"></a><span class="lineno"> 2673</span><span class="comment">! Isotopes of H2O: all</span></div>
<div class="line"><a id="l02674" name="l02674"></a><span class="lineno"> 2674</span><span class="comment">! Line widths: air-broadened only (self set to 0)</span></div>
<div class="line"><a id="l02675" name="l02675"></a><span class="lineno"> 2675</span><span class="comment">! Code for line strengths and widths: GENLN3</span></div>
<div class="line"><a id="l02676" name="l02676"></a><span class="lineno"> 2676</span><span class="comment">! Reference: Edwards, D.P., 1992: GENLN2, A General Line-by-Line Atmospheric</span></div>
<div class="line"><a id="l02677" name="l02677"></a><span class="lineno"> 2677</span><span class="comment">!                     Transmittance and Radiance Model, Version 3.0 Description</span></div>
<div class="line"><a id="l02678" name="l02678"></a><span class="lineno"> 2678</span><span class="comment">!                     and Users Guide, NCAR/TN-367+STR, 147 pp.</span></div>
<div class="line"><a id="l02679" name="l02679"></a><span class="lineno"> 2679</span><span class="comment">!     </span></div>
<div class="line"><a id="l02680" name="l02680"></a><span class="lineno"> 2680</span><span class="comment">! Note: functions have been normalized by dividing by their values at</span></div>
<div class="line"><a id="l02681" name="l02681"></a><span class="lineno"> 2681</span><span class="comment">!       a path temperature of 160K</span></div>
<div class="line"><a id="l02682" name="l02682"></a><span class="lineno"> 2682</span><span class="comment">!</span></div>
<div class="line"><a id="l02683" name="l02683"></a><span class="lineno"> 2683</span><span class="comment">! spectral intervals:     </span></div>
<div class="line"><a id="l02684" name="l02684"></a><span class="lineno"> 2684</span><span class="comment">!   1 = 0-800 cm^-1 and 1200-2200 cm^-1</span></div>
<div class="line"><a id="l02685" name="l02685"></a><span class="lineno"> 2685</span><span class="comment">!   2 = 800-1200 cm^-1      </span></div>
<div class="line"><a id="l02686" name="l02686"></a><span class="lineno"> 2686</span><span class="comment">!</span></div>
<div class="line"><a id="l02687" name="l02687"></a><span class="lineno"> 2687</span><span class="comment">! Formulae: Goody and Yung, Atmospheric Radiation: Theoretical Basis,</span></div>
<div class="line"><a id="l02688" name="l02688"></a><span class="lineno"> 2688</span><span class="comment">!           2nd edition, Oxford University Press, 1989.</span></div>
<div class="line"><a id="l02689" name="l02689"></a><span class="lineno"> 2689</span><span class="comment">! Psi: function for pressure along path</span></div>
<div class="line"><a id="l02690" name="l02690"></a><span class="lineno"> 2690</span><span class="comment">!      eq. 6.30, p. 228</span></div>
<div class="line"><a id="l02691" name="l02691"></a><span class="lineno"> 2691</span><span class="comment">!</span></div>
<div class="line"><a id="l02692" name="l02692"></a><span class="lineno"> 2692</span><span class="keywordtype">   real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>),<span class="keywordtype">intent(in)</span>:: tpx      <span class="comment">! path temperature</span></div>
<div class="line"><a id="l02693" name="l02693"></a><span class="lineno"> 2693</span>   <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span>:: iband    <span class="comment">! band to process</span></div>
<div class="line"><a id="l02694" name="l02694"></a><span class="lineno"> 2694</span><span class="keywordtype">   real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>) <a class="code hl_function" href="namespacemodule__ra__cam__support.html#a4446dd561840717c0510f977776013a7">psi</a>                   <span class="comment">! psi for given band</span></div>
<div class="line"><a id="l02695" name="l02695"></a><span class="lineno"> 2695</span><span class="keywordtype">   real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>),<span class="keywordtype">parameter</span> ::  psi_r0(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#aeb5ccbe33dbb2a183e6407b4b8644d7b">nbands</a>) = (/ 5.65308452e-01, -7.30087891e+01/)</div>
<div class="line"><a id="l02696" name="l02696"></a><span class="lineno"> 2696</span><span class="keywordtype">   real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>),<span class="keywordtype">parameter</span> ::  psi_r1(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#aeb5ccbe33dbb2a183e6407b4b8644d7b">nbands</a>) = (/ 4.07519005e-03,  1.22199547e+00/)</div>
<div class="line"><a id="l02697" name="l02697"></a><span class="lineno"> 2697</span><span class="keywordtype">   real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>),<span class="keywordtype">parameter</span> ::  psi_r2(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#aeb5ccbe33dbb2a183e6407b4b8644d7b">nbands</a>) = (/-1.04347237e-05, -7.12256227e-03/)</div>
<div class="line"><a id="l02698" name="l02698"></a><span class="lineno"> 2698</span><span class="keywordtype">   real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>),<span class="keywordtype">parameter</span> ::  psi_r3(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#aeb5ccbe33dbb2a183e6407b4b8644d7b">nbands</a>) = (/ 1.23765354e-08,  1.47852825e-05/)</div>
<div class="line"><a id="l02699" name="l02699"></a><span class="lineno"> 2699</span> </div>
<div class="line"><a id="l02700" name="l02700"></a><span class="lineno"> 2700</span>   <a class="code hl_function" href="namespacemodule__ra__cam__support.html#a4446dd561840717c0510f977776013a7">psi</a> = (((psi_r3(iband) * tpx) + psi_r2(iband)) * tpx + psi_r1(iband)) * tpx + psi_r0(iband)</div>
<div class="line"><a id="l02701" name="l02701"></a><span class="lineno"> 2701</span><span class="keyword">end function </span><a class="code hl_function" href="namespacemodule__ra__cam__support.html#a4446dd561840717c0510f977776013a7">psi</a></div>
<div class="line"><a id="l02702" name="l02702"></a><span class="lineno"> 2702</span> </div>
<div class="line"><a id="l02703" name="l02703"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#afe03c6fa755507b2c3c9d478065ddda8"> 2703</a></span><span class="keyword">function </span><a class="code hl_function" href="namespacemodule__ra__cam__support.html#afe03c6fa755507b2c3c9d478065ddda8">phi</a>(tpx,iband)</div>
<div class="line"><a id="l02704" name="l02704"></a><span class="lineno"> 2704</span><span class="comment">!</span></div>
<div class="line"><a id="l02705" name="l02705"></a><span class="lineno"> 2705</span><span class="comment">! History: First version for Hitran 1996 (C/H/E)</span></div>
<div class="line"><a id="l02706" name="l02706"></a><span class="lineno"> 2706</span><span class="comment">!          Current version for Hitran 2000 (C/LT/E)</span></div>
<div class="line"><a id="l02707" name="l02707"></a><span class="lineno"> 2707</span><span class="comment">! Short function for Hulst-Curtis-Godson temperature factors for</span></div>
<div class="line"><a id="l02708" name="l02708"></a><span class="lineno"> 2708</span><span class="comment">!   computing effective H2O path</span></div>
<div class="line"><a id="l02709" name="l02709"></a><span class="lineno"> 2709</span><span class="comment">! Line data for H2O: Hitran 2000, plus H2O patches v11.0 for 1341 missing</span></div>
<div class="line"><a id="l02710" name="l02710"></a><span class="lineno"> 2710</span><span class="comment">!                    lines between 500 and 2820 cm^-1.</span></div>
<div class="line"><a id="l02711" name="l02711"></a><span class="lineno"> 2711</span><span class="comment">!                    See cfa-www.harvard.edu/HITRAN</span></div>
<div class="line"><a id="l02712" name="l02712"></a><span class="lineno"> 2712</span><span class="comment">! Isotopes of H2O: all</span></div>
<div class="line"><a id="l02713" name="l02713"></a><span class="lineno"> 2713</span><span class="comment">! Line widths: air-broadened only (self set to 0)</span></div>
<div class="line"><a id="l02714" name="l02714"></a><span class="lineno"> 2714</span><span class="comment">! Code for line strengths and widths: GENLN3</span></div>
<div class="line"><a id="l02715" name="l02715"></a><span class="lineno"> 2715</span><span class="comment">! Reference: Edwards, D.P., 1992: GENLN2, A General Line-by-Line Atmospheric</span></div>
<div class="line"><a id="l02716" name="l02716"></a><span class="lineno"> 2716</span><span class="comment">!                     Transmittance and Radiance Model, Version 3.0 Description</span></div>
<div class="line"><a id="l02717" name="l02717"></a><span class="lineno"> 2717</span><span class="comment">!                     and Users Guide, NCAR/TN-367+STR, 147 pp.</span></div>
<div class="line"><a id="l02718" name="l02718"></a><span class="lineno"> 2718</span><span class="comment">!</span></div>
<div class="line"><a id="l02719" name="l02719"></a><span class="lineno"> 2719</span><span class="comment">! Note: functions have been normalized by dividing by their values at</span></div>
<div class="line"><a id="l02720" name="l02720"></a><span class="lineno"> 2720</span><span class="comment">!       a path temperature of 160K</span></div>
<div class="line"><a id="l02721" name="l02721"></a><span class="lineno"> 2721</span><span class="comment">!</span></div>
<div class="line"><a id="l02722" name="l02722"></a><span class="lineno"> 2722</span><span class="comment">! spectral intervals:</span></div>
<div class="line"><a id="l02723" name="l02723"></a><span class="lineno"> 2723</span><span class="comment">!   1 = 0-800 cm^-1 and 1200-2200 cm^-1</span></div>
<div class="line"><a id="l02724" name="l02724"></a><span class="lineno"> 2724</span><span class="comment">!   2 = 800-1200 cm^-1</span></div>
<div class="line"><a id="l02725" name="l02725"></a><span class="lineno"> 2725</span><span class="comment">!</span></div>
<div class="line"><a id="l02726" name="l02726"></a><span class="lineno"> 2726</span><span class="comment">! Formulae: Goody and Yung, Atmospheric Radiation: Theoretical Basis,</span></div>
<div class="line"><a id="l02727" name="l02727"></a><span class="lineno"> 2727</span><span class="comment">!           2nd edition, Oxford University Press, 1989.</span></div>
<div class="line"><a id="l02728" name="l02728"></a><span class="lineno"> 2728</span><span class="comment">! Phi: function for H2O path</span></div>
<div class="line"><a id="l02729" name="l02729"></a><span class="lineno"> 2729</span><span class="comment">!      eq. 6.25, p. 228</span></div>
<div class="line"><a id="l02730" name="l02730"></a><span class="lineno"> 2730</span><span class="comment">!</span></div>
<div class="line"><a id="l02731" name="l02731"></a><span class="lineno"> 2731</span><span class="keywordtype">   real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>),<span class="keywordtype">intent(in)</span>:: tpx      <span class="comment">! path temperature</span></div>
<div class="line"><a id="l02732" name="l02732"></a><span class="lineno"> 2732</span>   <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span>:: iband    <span class="comment">! band to process</span></div>
<div class="line"><a id="l02733" name="l02733"></a><span class="lineno"> 2733</span><span class="keywordtype">   real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>) <a class="code hl_function" href="namespacemodule__ra__cam__support.html#afe03c6fa755507b2c3c9d478065ddda8">phi</a>                   <span class="comment">! phi for given band</span></div>
<div class="line"><a id="l02734" name="l02734"></a><span class="lineno"> 2734</span><span class="keywordtype">   real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>),<span class="keywordtype">parameter</span> ::  phi_r0(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#aeb5ccbe33dbb2a183e6407b4b8644d7b">nbands</a>) = (/ 9.60917711e-01, -2.21031342e+01/)</div>
<div class="line"><a id="l02735" name="l02735"></a><span class="lineno"> 2735</span><span class="keywordtype">   real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>),<span class="keywordtype">parameter</span> ::  phi_r1(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#aeb5ccbe33dbb2a183e6407b4b8644d7b">nbands</a>) = (/ 4.86076751e-04,  4.24062610e-01/)</div>
<div class="line"><a id="l02736" name="l02736"></a><span class="lineno"> 2736</span><span class="keywordtype">   real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>),<span class="keywordtype">parameter</span> ::  phi_r2(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#aeb5ccbe33dbb2a183e6407b4b8644d7b">nbands</a>) = (/-1.84806265e-06, -2.95543415e-03/)</div>
<div class="line"><a id="l02737" name="l02737"></a><span class="lineno"> 2737</span><span class="keywordtype">   real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>),<span class="keywordtype">parameter</span> ::  phi_r3(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#aeb5ccbe33dbb2a183e6407b4b8644d7b">nbands</a>) = (/ 2.11239959e-09,  7.52470896e-06/)</div>
<div class="line"><a id="l02738" name="l02738"></a><span class="lineno"> 2738</span> </div>
<div class="line"><a id="l02739" name="l02739"></a><span class="lineno"> 2739</span>   <a class="code hl_function" href="namespacemodule__ra__cam__support.html#afe03c6fa755507b2c3c9d478065ddda8">phi</a> = (((phi_r3(iband) * tpx) + phi_r2(iband)) * tpx + phi_r1(iband)) &amp;</div>
<div class="line"><a id="l02740" name="l02740"></a><span class="lineno"> 2740</span>          * tpx + phi_r0(iband)</div>
<div class="line"><a id="l02741" name="l02741"></a><span class="lineno"> 2741</span><span class="keyword">end function </span><a class="code hl_function" href="namespacemodule__ra__cam__support.html#afe03c6fa755507b2c3c9d478065ddda8">phi</a></div>
<div class="line"><a id="l02742" name="l02742"></a><span class="lineno"> 2742</span> </div>
<div class="line"><a id="l02743" name="l02743"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a3c649ff81a5df618b4dda31c33db3bae"> 2743</a></span><span class="keyword">function </span><a class="code hl_function" href="namespacemodule__ra__cam__support.html#a3c649ff81a5df618b4dda31c33db3bae">fh2oself</a>( temp )</div>
<div class="line"><a id="l02744" name="l02744"></a><span class="lineno"> 2744</span><span class="comment">!</span></div>
<div class="line"><a id="l02745" name="l02745"></a><span class="lineno"> 2745</span><span class="comment">! Short function for H2O self-continuum temperature factor in</span></div>
<div class="line"><a id="l02746" name="l02746"></a><span class="lineno"> 2746</span><span class="comment">!   calculation of effective H2O self-continuum path length</span></div>
<div class="line"><a id="l02747" name="l02747"></a><span class="lineno"> 2747</span><span class="comment">!</span></div>
<div class="line"><a id="l02748" name="l02748"></a><span class="lineno"> 2748</span><span class="comment">! H2O Continuum: CKD 2.4</span></div>
<div class="line"><a id="l02749" name="l02749"></a><span class="lineno"> 2749</span><span class="comment">! Code for continuum: GENLN3</span></div>
<div class="line"><a id="l02750" name="l02750"></a><span class="lineno"> 2750</span><span class="comment">! Reference: Edwards, D.P., 1992: GENLN2, A General Line-by-Line Atmospheric</span></div>
<div class="line"><a id="l02751" name="l02751"></a><span class="lineno"> 2751</span><span class="comment">!                     Transmittance and Radiance Model, Version 3.0 Description</span></div>
<div class="line"><a id="l02752" name="l02752"></a><span class="lineno"> 2752</span><span class="comment">!                     and Users Guide, NCAR/TN-367+STR, 147 pp.</span></div>
<div class="line"><a id="l02753" name="l02753"></a><span class="lineno"> 2753</span><span class="comment">!</span></div>
<div class="line"><a id="l02754" name="l02754"></a><span class="lineno"> 2754</span><span class="comment">! In GENLN, the temperature scaling of the self-continuum is handled</span></div>
<div class="line"><a id="l02755" name="l02755"></a><span class="lineno"> 2755</span><span class="comment">!    by exponential interpolation/extrapolation from observations at</span></div>
<div class="line"><a id="l02756" name="l02756"></a><span class="lineno"> 2756</span><span class="comment">!    260K and 296K by:</span></div>
<div class="line"><a id="l02757" name="l02757"></a><span class="lineno"> 2757</span><span class="comment">!</span></div>
<div class="line"><a id="l02758" name="l02758"></a><span class="lineno"> 2758</span><span class="comment">!         TFAC =  (T(IPATH) - 296.0)/(260.0 - 296.0)</span></div>
<div class="line"><a id="l02759" name="l02759"></a><span class="lineno"> 2759</span><span class="comment">!         CSFFT = CSFF296*(CSFF260/CSFF296)**TFAC</span></div>
<div class="line"><a id="l02760" name="l02760"></a><span class="lineno"> 2760</span><span class="comment">!</span></div>
<div class="line"><a id="l02761" name="l02761"></a><span class="lineno"> 2761</span><span class="comment">! For 800-1200 cm^-1, (CSFF260/CSFF296) ranges from ~2.1 to ~1.9</span></div>
<div class="line"><a id="l02762" name="l02762"></a><span class="lineno"> 2762</span><span class="comment">!     with increasing wavenumber.  The ratio &lt;CSFF260&gt;/&lt;CSFF296&gt;,</span></div>
<div class="line"><a id="l02763" name="l02763"></a><span class="lineno"> 2763</span><span class="comment">!     where &lt;&gt; indicates average over wavenumber, is ~2.07</span></div>
<div class="line"><a id="l02764" name="l02764"></a><span class="lineno"> 2764</span><span class="comment">!</span></div>
<div class="line"><a id="l02765" name="l02765"></a><span class="lineno"> 2765</span><span class="comment">! fh2oself is (&lt;CSFF260&gt;/&lt;CSFF296&gt;)**TFAC</span></div>
<div class="line"><a id="l02766" name="l02766"></a><span class="lineno"> 2766</span><span class="comment">!</span></div>
<div class="line"><a id="l02767" name="l02767"></a><span class="lineno"> 2767</span><span class="keywordtype">   real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>),<span class="keywordtype">intent(in)</span> :: temp     <span class="comment">! path temperature</span></div>
<div class="line"><a id="l02768" name="l02768"></a><span class="lineno"> 2768</span><span class="keywordtype">   real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>) <a class="code hl_function" href="namespacemodule__ra__cam__support.html#a3c649ff81a5df618b4dda31c33db3bae">fh2oself</a>               <span class="comment">! mean ratio of self-continuum at temp and 296K</span></div>
<div class="line"><a id="l02769" name="l02769"></a><span class="lineno"> 2769</span> </div>
<div class="line"><a id="l02770" name="l02770"></a><span class="lineno"> 2770</span>   <a class="code hl_function" href="namespacemodule__ra__cam__support.html#a3c649ff81a5df618b4dda31c33db3bae">fh2oself</a> = 2.0727484**((296.0 - temp) / 36.0)</div>
<div class="line"><a id="l02771" name="l02771"></a><span class="lineno"> 2771</span><span class="keyword">end function </span><a class="code hl_function" href="namespacemodule__ra__cam__support.html#a3c649ff81a5df618b4dda31c33db3bae">fh2oself</a></div>
<div class="line"><a id="l02772" name="l02772"></a><span class="lineno"> 2772</span> </div>
<div class="line"><a id="l02773" name="l02773"></a><span class="lineno"> 2773</span><span class="comment">! from wv_saturation.F90</span></div>
<div class="line"><a id="l02774" name="l02774"></a><span class="lineno"> 2774</span> </div>
<div class="line"><a id="l02775" name="l02775"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a0a79238bc77c689eec9388903e00babb"> 2775</a></span><span class="keyword">subroutine </span><a class="code hl_function" href="namespacemodule__ra__cam__support.html#a0a79238bc77c689eec9388903e00babb">esinti</a>(epslon  ,latvap  ,latice  ,rh2o    ,cpair   ,tmelt   )</div>
<div class="line"><a id="l02776" name="l02776"></a><span class="lineno"> 2776</span><span class="comment">!----------------------------------------------------------------------- </span></div>
<div class="line"><a id="l02777" name="l02777"></a><span class="lineno"> 2777</span><span class="comment">! </span></div>
<div class="line"><a id="l02778" name="l02778"></a><span class="lineno"> 2778</span><span class="comment">! Purpose: </span></div>
<div class="line"><a id="l02779" name="l02779"></a><span class="lineno"> 2779</span><span class="comment">! Initialize es lookup tables</span></div>
<div class="line"><a id="l02780" name="l02780"></a><span class="lineno"> 2780</span><span class="comment">! </span></div>
<div class="line"><a id="l02781" name="l02781"></a><span class="lineno"> 2781</span><span class="comment">! Method: </span></div>
<div class="line"><a id="l02782" name="l02782"></a><span class="lineno"> 2782</span><span class="comment">! &lt;Describe the algorithm(s) used in the routine.&gt; </span></div>
<div class="line"><a id="l02783" name="l02783"></a><span class="lineno"> 2783</span><span class="comment">! &lt;Also include any applicable external references.&gt; </span></div>
<div class="line"><a id="l02784" name="l02784"></a><span class="lineno"> 2784</span><span class="comment">! </span></div>
<div class="line"><a id="l02785" name="l02785"></a><span class="lineno"> 2785</span><span class="comment">! Author: J. Hack</span></div>
<div class="line"><a id="l02786" name="l02786"></a><span class="lineno"> 2786</span><span class="comment">! </span></div>
<div class="line"><a id="l02787" name="l02787"></a><span class="lineno"> 2787</span><span class="comment">!-----------------------------------------------------------------------</span></div>
<div class="line"><a id="l02788" name="l02788"></a><span class="lineno"> 2788</span><span class="comment">!  use shr_kind_mod, only: r8 =&gt; shr_kind_r8</span></div>
<div class="line"><a id="l02789" name="l02789"></a><span class="lineno"> 2789</span><span class="comment">!  use wv_saturation, only: gestbl</span></div>
<div class="line"><a id="l02790" name="l02790"></a><span class="lineno"> 2790</span>   <span class="keywordtype">implicit none</span></div>
<div class="line"><a id="l02791" name="l02791"></a><span class="lineno"> 2791</span><span class="comment">!------------------------------Arguments--------------------------------</span></div>
<div class="line"><a id="l02792" name="l02792"></a><span class="lineno"> 2792</span><span class="comment">!</span></div>
<div class="line"><a id="l02793" name="l02793"></a><span class="lineno"> 2793</span><span class="comment">! Input arguments</span></div>
<div class="line"><a id="l02794" name="l02794"></a><span class="lineno"> 2794</span><span class="comment">!</span></div>
<div class="line"><a id="l02795" name="l02795"></a><span class="lineno"> 2795</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: epslon          <span class="comment">! Ratio of h2o to dry air molecular weights</span></div>
<div class="line"><a id="l02796" name="l02796"></a><span class="lineno"> 2796</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: latvap          <span class="comment">! Latent heat of vaporization</span></div>
<div class="line"><a id="l02797" name="l02797"></a><span class="lineno"> 2797</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: latice          <span class="comment">! Latent heat of fusion</span></div>
<div class="line"><a id="l02798" name="l02798"></a><span class="lineno"> 2798</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: rh2o            <span class="comment">! Gas constant for water vapor</span></div>
<div class="line"><a id="l02799" name="l02799"></a><span class="lineno"> 2799</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: cpair           <span class="comment">! Specific heat of dry air</span></div>
<div class="line"><a id="l02800" name="l02800"></a><span class="lineno"> 2800</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: tmelt           <span class="comment">! Melting point of water (K)</span></div>
<div class="line"><a id="l02801" name="l02801"></a><span class="lineno"> 2801</span><span class="comment">!</span></div>
<div class="line"><a id="l02802" name="l02802"></a><span class="lineno"> 2802</span><span class="comment">!---------------------------Local workspace-----------------------------</span></div>
<div class="line"><a id="l02803" name="l02803"></a><span class="lineno"> 2803</span><span class="comment">!</span></div>
<div class="line"><a id="l02804" name="l02804"></a><span class="lineno"> 2804</span><span class="keywordtype">   real</span>(r8) tmn             <span class="comment">! Minimum temperature entry in table</span></div>
<div class="line"><a id="l02805" name="l02805"></a><span class="lineno"> 2805</span><span class="keywordtype">   real</span>(r8) tmx             <span class="comment">! Maximum temperature entry in table</span></div>
<div class="line"><a id="l02806" name="l02806"></a><span class="lineno"> 2806</span><span class="keywordtype">   real</span>(r8) trice           <span class="comment">! Trans range from es over h2o to es over ice</span></div>
<div class="line"><a id="l02807" name="l02807"></a><span class="lineno"> 2807</span>   <span class="keywordtype">logical</span> ip           <span class="comment">! Ice phase (true or false)</span></div>
<div class="line"><a id="l02808" name="l02808"></a><span class="lineno"> 2808</span><span class="comment">!</span></div>
<div class="line"><a id="l02809" name="l02809"></a><span class="lineno"> 2809</span><span class="comment">!-----------------------------------------------------------------------</span></div>
<div class="line"><a id="l02810" name="l02810"></a><span class="lineno"> 2810</span><span class="comment">!</span></div>
<div class="line"><a id="l02811" name="l02811"></a><span class="lineno"> 2811</span><span class="comment">! Specify control parameters first</span></div>
<div class="line"><a id="l02812" name="l02812"></a><span class="lineno"> 2812</span><span class="comment">!</span></div>
<div class="line"><a id="l02813" name="l02813"></a><span class="lineno"> 2813</span>   tmn   = 173.16</div>
<div class="line"><a id="l02814" name="l02814"></a><span class="lineno"> 2814</span>   tmx   = 375.16</div>
<div class="line"><a id="l02815" name="l02815"></a><span class="lineno"> 2815</span>   trice =  20.00</div>
<div class="line"><a id="l02816" name="l02816"></a><span class="lineno"> 2816</span>   ip    = .true.</div>
<div class="line"><a id="l02817" name="l02817"></a><span class="lineno"> 2817</span><span class="comment">!</span></div>
<div class="line"><a id="l02818" name="l02818"></a><span class="lineno"> 2818</span><span class="comment">! Call gestbl to build saturation vapor pressure table.</span></div>
<div class="line"><a id="l02819" name="l02819"></a><span class="lineno"> 2819</span><span class="comment">!</span></div>
<div class="line"><a id="l02820" name="l02820"></a><span class="lineno"> 2820</span>   <span class="keyword">call </span><a class="code hl_function" href="namespacemodule__ra__cam__support.html#a7a5b6927fda0934eee09b020cc183820">gestbl</a>(tmn     ,tmx     ,trice   ,ip      ,epslon  , &amp;</div>
<div class="line"><a id="l02821" name="l02821"></a><span class="lineno"> 2821</span>               latvap  ,latice  ,rh2o    ,cpair   ,tmelt )</div>
<div class="line"><a id="l02822" name="l02822"></a><span class="lineno"> 2822</span><span class="comment">!</span></div>
<div class="line"><a id="l02823" name="l02823"></a><span class="lineno"> 2823</span>   <span class="keywordflow">return</span></div>
<div class="line"><a id="l02824" name="l02824"></a><span class="lineno"> 2824</span><span class="keyword">end subroutine </span><a class="code hl_function" href="namespacemodule__ra__cam__support.html#a0a79238bc77c689eec9388903e00babb">esinti</a></div>
<div class="line"><a id="l02825" name="l02825"></a><span class="lineno"> 2825</span> </div>
<div class="line"><a id="l02826" name="l02826"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a7a5b6927fda0934eee09b020cc183820"> 2826</a></span><span class="keyword">subroutine </span><a class="code hl_function" href="namespacemodule__ra__cam__support.html#a7a5b6927fda0934eee09b020cc183820">gestbl</a>(tmn     ,tmx     ,trice   ,ip      ,epsil   , &amp;</div>
<div class="line"><a id="l02827" name="l02827"></a><span class="lineno"> 2827</span>                  latvap  ,latice  ,rh2o    ,cpair   ,tmeltx   )</div>
<div class="line"><a id="l02828" name="l02828"></a><span class="lineno"> 2828</span><span class="comment">!-----------------------------------------------------------------------</span></div>
<div class="line"><a id="l02829" name="l02829"></a><span class="lineno"> 2829</span><span class="comment">!</span></div>
<div class="line"><a id="l02830" name="l02830"></a><span class="lineno"> 2830</span><span class="comment">! Purpose:</span></div>
<div class="line"><a id="l02831" name="l02831"></a><span class="lineno"> 2831</span><span class="comment">! Builds saturation vapor pressure table for later lookup procedure.</span></div>
<div class="line"><a id="l02832" name="l02832"></a><span class="lineno"> 2832</span><span class="comment">!</span></div>
<div class="line"><a id="l02833" name="l02833"></a><span class="lineno"> 2833</span><span class="comment">! Method:</span></div>
<div class="line"><a id="l02834" name="l02834"></a><span class="lineno"> 2834</span><span class="comment">! Uses Goff &amp; Gratch (1946) relationships to generate the table</span></div>
<div class="line"><a id="l02835" name="l02835"></a><span class="lineno"> 2835</span><span class="comment">! according to a set of free parameters defined below.  Auxiliary</span></div>
<div class="line"><a id="l02836" name="l02836"></a><span class="lineno"> 2836</span><span class="comment">! routines are also included for making rapid estimates (well with 1%)</span></div>
<div class="line"><a id="l02837" name="l02837"></a><span class="lineno"> 2837</span><span class="comment">! of both es and d(es)/dt for the particular table configuration.</span></div>
<div class="line"><a id="l02838" name="l02838"></a><span class="lineno"> 2838</span><span class="comment">!</span></div>
<div class="line"><a id="l02839" name="l02839"></a><span class="lineno"> 2839</span><span class="comment">! Author: J. Hack</span></div>
<div class="line"><a id="l02840" name="l02840"></a><span class="lineno"> 2840</span><span class="comment">!</span></div>
<div class="line"><a id="l02841" name="l02841"></a><span class="lineno"> 2841</span><span class="comment">!-----------------------------------------------------------------------</span></div>
<div class="line"><a id="l02842" name="l02842"></a><span class="lineno"> 2842</span><span class="comment">!  use pmgrid, only: masterproc</span></div>
<div class="line"><a id="l02843" name="l02843"></a><span class="lineno"> 2843</span>   <span class="keywordtype">implicit none</span></div>
<div class="line"><a id="l02844" name="l02844"></a><span class="lineno"> 2844</span><span class="comment">!------------------------------Arguments--------------------------------</span></div>
<div class="line"><a id="l02845" name="l02845"></a><span class="lineno"> 2845</span><span class="comment">!</span></div>
<div class="line"><a id="l02846" name="l02846"></a><span class="lineno"> 2846</span><span class="comment">! Input arguments</span></div>
<div class="line"><a id="l02847" name="l02847"></a><span class="lineno"> 2847</span><span class="comment">!</span></div>
<div class="line"><a id="l02848" name="l02848"></a><span class="lineno"> 2848</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: tmn           <span class="comment">! Minimum temperature entry in es lookup table</span></div>
<div class="line"><a id="l02849" name="l02849"></a><span class="lineno"> 2849</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: tmx           <span class="comment">! Maximum temperature entry in es lookup table</span></div>
<div class="line"><a id="l02850" name="l02850"></a><span class="lineno"> 2850</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: epsil         <span class="comment">! Ratio of h2o to dry air molecular weights</span></div>
<div class="line"><a id="l02851" name="l02851"></a><span class="lineno"> 2851</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: trice         <span class="comment">! Transition range from es over range to es over ice</span></div>
<div class="line"><a id="l02852" name="l02852"></a><span class="lineno"> 2852</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: latvap        <span class="comment">! Latent heat of vaporization</span></div>
<div class="line"><a id="l02853" name="l02853"></a><span class="lineno"> 2853</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: latice        <span class="comment">! Latent heat of fusion</span></div>
<div class="line"><a id="l02854" name="l02854"></a><span class="lineno"> 2854</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: rh2o          <span class="comment">! Gas constant for water vapor</span></div>
<div class="line"><a id="l02855" name="l02855"></a><span class="lineno"> 2855</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: cpair         <span class="comment">! Specific heat of dry air</span></div>
<div class="line"><a id="l02856" name="l02856"></a><span class="lineno"> 2856</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: tmeltx        <span class="comment">! Melting point of water (K)</span></div>
<div class="line"><a id="l02857" name="l02857"></a><span class="lineno"> 2857</span><span class="comment">!</span></div>
<div class="line"><a id="l02858" name="l02858"></a><span class="lineno"> 2858</span><span class="comment">!---------------------------Local variables-----------------------------</span></div>
<div class="line"><a id="l02859" name="l02859"></a><span class="lineno"> 2859</span><span class="comment">!</span></div>
<div class="line"><a id="l02860" name="l02860"></a><span class="lineno"> 2860</span><span class="keywordtype">   real</span>(r8) t             <span class="comment">! Temperature</span></div>
<div class="line"><a id="l02861" name="l02861"></a><span class="lineno"> 2861</span><span class="keywordtype">   real</span>(r8) rgasv </div>
<div class="line"><a id="l02862" name="l02862"></a><span class="lineno"> 2862</span><span class="keywordtype">   real</span>(r8) cp</div>
<div class="line"><a id="l02863" name="l02863"></a><span class="lineno"> 2863</span><span class="keywordtype">   real</span>(r8) hlatf</div>
<div class="line"><a id="l02864" name="l02864"></a><span class="lineno"> 2864</span><span class="keywordtype">   real</span>(r8) ttrice</div>
<div class="line"><a id="l02865" name="l02865"></a><span class="lineno"> 2865</span><span class="keywordtype">   real</span>(r8) hlatv</div>
<div class="line"><a id="l02866" name="l02866"></a><span class="lineno"> 2866</span>   <span class="keywordtype">integer</span> n          <span class="comment">! Increment counter</span></div>
<div class="line"><a id="l02867" name="l02867"></a><span class="lineno"> 2867</span>   <span class="keywordtype">integer</span> lentbl     <span class="comment">! Calculated length of lookup table</span></div>
<div class="line"><a id="l02868" name="l02868"></a><span class="lineno"> 2868</span>   <span class="keywordtype">integer</span> itype      <span class="comment">! Ice phase: 0 -&gt; no ice phase</span></div>
<div class="line"><a id="l02869" name="l02869"></a><span class="lineno"> 2869</span><span class="comment">!            1 -&gt; ice phase, no transition</span></div>
<div class="line"><a id="l02870" name="l02870"></a><span class="lineno"> 2870</span><span class="comment">!           -x -&gt; ice phase, x degree transition</span></div>
<div class="line"><a id="l02871" name="l02871"></a><span class="lineno"> 2871</span>   <span class="keywordtype">logical</span> ip         <span class="comment">! Ice phase logical flag</span></div>
<div class="line"><a id="l02872" name="l02872"></a><span class="lineno"> 2872</span>   <span class="keywordtype">logical</span> icephs</div>
<div class="line"><a id="l02873" name="l02873"></a><span class="lineno"> 2873</span><span class="comment">!</span></div>
<div class="line"><a id="l02874" name="l02874"></a><span class="lineno"> 2874</span><span class="comment">!-----------------------------------------------------------------------</span></div>
<div class="line"><a id="l02875" name="l02875"></a><span class="lineno"> 2875</span><span class="comment">!</span></div>
<div class="line"><a id="l02876" name="l02876"></a><span class="lineno"> 2876</span><span class="comment">! Set es table parameters</span></div>
<div class="line"><a id="l02877" name="l02877"></a><span class="lineno"> 2877</span><span class="comment">!</span></div>
<div class="line"><a id="l02878" name="l02878"></a><span class="lineno"> 2878</span>   <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ab7607052d159e3c4918a4be06574a590">tmin</a>   = tmn       <span class="comment">! Minimum temperature entry in table</span></div>
<div class="line"><a id="l02879" name="l02879"></a><span class="lineno"> 2879</span>   <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ac550f97473b686550bc1aae97e282cff">tmax</a>   = tmx       <span class="comment">! Maximum temperature entry in table</span></div>
<div class="line"><a id="l02880" name="l02880"></a><span class="lineno"> 2880</span>   ttrice = trice     <span class="comment">! Trans. range from es over h2o to es over ice</span></div>
<div class="line"><a id="l02881" name="l02881"></a><span class="lineno"> 2881</span>   icephs = ip        <span class="comment">! Ice phase (true or false)</span></div>
<div class="line"><a id="l02882" name="l02882"></a><span class="lineno"> 2882</span><span class="comment">!</span></div>
<div class="line"><a id="l02883" name="l02883"></a><span class="lineno"> 2883</span><span class="comment">! Set physical constants required for es calculation</span></div>
<div class="line"><a id="l02884" name="l02884"></a><span class="lineno"> 2884</span><span class="comment">!</span></div>
<div class="line"><a id="l02885" name="l02885"></a><span class="lineno"> 2885</span>   <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#af7e662e829862c7d94128b48616ae04b">epsqs</a>  = epsil</div>
<div class="line"><a id="l02886" name="l02886"></a><span class="lineno"> 2886</span>   hlatv  = latvap</div>
<div class="line"><a id="l02887" name="l02887"></a><span class="lineno"> 2887</span>   hlatf  = latice</div>
<div class="line"><a id="l02888" name="l02888"></a><span class="lineno"> 2888</span>   rgasv  = rh2o</div>
<div class="line"><a id="l02889" name="l02889"></a><span class="lineno"> 2889</span>   cp     = cpair</div>
<div class="line"><a id="l02890" name="l02890"></a><span class="lineno"> 2890</span>   <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a4e848e3e0511ebba4d1541494c416613">tmelt</a>  = tmeltx</div>
<div class="line"><a id="l02891" name="l02891"></a><span class="lineno"> 2891</span><span class="comment">!</span></div>
<div class="line"><a id="l02892" name="l02892"></a><span class="lineno"> 2892</span>   lentbl = int(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ac550f97473b686550bc1aae97e282cff">tmax</a>-<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ab7607052d159e3c4918a4be06574a590">tmin</a>+2.000001)</div>
<div class="line"><a id="l02893" name="l02893"></a><span class="lineno"> 2893</span>   <span class="keywordflow">if</span> (lentbl .gt. <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ade898261c4d5956cba8ee44692928f2b">plenest</a>) <span class="keywordflow">then</span></div>
<div class="line"><a id="l02894" name="l02894"></a><span class="lineno"> 2894</span>      <span class="keyword">write</span>(6,9000) <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ac550f97473b686550bc1aae97e282cff">tmax</a>, <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ab7607052d159e3c4918a4be06574a590">tmin</a>, <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ade898261c4d5956cba8ee44692928f2b">plenest</a></div>
<div class="line"><a id="l02895" name="l02895"></a><span class="lineno"> 2895</span><span class="comment">!     call endrun (&#39;GESTBL&#39;)    ! Abnormal termination</span></div>
<div class="line"><a id="l02896" name="l02896"></a><span class="lineno"> 2896</span><span class="keywordflow">   end if</span></div>
<div class="line"><a id="l02897" name="l02897"></a><span class="lineno"> 2897</span><span class="comment">!</span></div>
<div class="line"><a id="l02898" name="l02898"></a><span class="lineno"> 2898</span><span class="comment">! Begin building es table.</span></div>
<div class="line"><a id="l02899" name="l02899"></a><span class="lineno"> 2899</span><span class="comment">! Check whether ice phase requested.</span></div>
<div class="line"><a id="l02900" name="l02900"></a><span class="lineno"> 2900</span><span class="comment">! If so, set appropriate transition range for temperature</span></div>
<div class="line"><a id="l02901" name="l02901"></a><span class="lineno"> 2901</span><span class="comment">!</span></div>
<div class="line"><a id="l02902" name="l02902"></a><span class="lineno"> 2902</span>   <span class="keywordflow">if</span> (icephs) <span class="keywordflow">then</span></div>
<div class="line"><a id="l02903" name="l02903"></a><span class="lineno"> 2903</span>      <span class="keywordflow">if</span> (ttrice /= 0.0) <span class="keywordflow">then</span></div>
<div class="line"><a id="l02904" name="l02904"></a><span class="lineno"> 2904</span>         itype = -ttrice</div>
<div class="line"><a id="l02905" name="l02905"></a><span class="lineno"> 2905</span>      <span class="keywordflow">else</span></div>
<div class="line"><a id="l02906" name="l02906"></a><span class="lineno"> 2906</span>         itype = 1</div>
<div class="line"><a id="l02907" name="l02907"></a><span class="lineno"> 2907</span><span class="keywordflow">      end if</span></div>
<div class="line"><a id="l02908" name="l02908"></a><span class="lineno"> 2908</span>   <span class="keywordflow">else</span></div>
<div class="line"><a id="l02909" name="l02909"></a><span class="lineno"> 2909</span>      itype = 0</div>
<div class="line"><a id="l02910" name="l02910"></a><span class="lineno"> 2910</span><span class="keywordflow">   end if</span></div>
<div class="line"><a id="l02911" name="l02911"></a><span class="lineno"> 2911</span><span class="comment">!</span></div>
<div class="line"><a id="l02912" name="l02912"></a><span class="lineno"> 2912</span>   t = <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ab7607052d159e3c4918a4be06574a590">tmin</a> - 1.0</div>
<div class="line"><a id="l02913" name="l02913"></a><span class="lineno"> 2913</span>   <span class="keywordflow">do</span> n=1,lentbl</div>
<div class="line"><a id="l02914" name="l02914"></a><span class="lineno"> 2914</span>      t = t + 1.0</div>
<div class="line"><a id="l02915" name="l02915"></a><span class="lineno"> 2915</span>      <span class="keyword">call </span><a class="code hl_function" href="namespacemodule__ra__cam__support.html#acbc7ddcbc2ec8b0b8f4b5dba23f0df96">gffgch</a>(t,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a753905688ac0510d00957932c5b24c69">estbl</a>(n),itype)</div>
<div class="line"><a id="l02916" name="l02916"></a><span class="lineno"> 2916</span><span class="keywordflow">   end do</span></div>
<div class="line"><a id="l02917" name="l02917"></a><span class="lineno"> 2917</span><span class="comment">!</span></div>
<div class="line"><a id="l02918" name="l02918"></a><span class="lineno"> 2918</span>   <span class="keywordflow">do</span> n=lentbl+1,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ade898261c4d5956cba8ee44692928f2b">plenest</a></div>
<div class="line"><a id="l02919" name="l02919"></a><span class="lineno"> 2919</span>      <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a753905688ac0510d00957932c5b24c69">estbl</a>(n) = -99999.0</div>
<div class="line"><a id="l02920" name="l02920"></a><span class="lineno"> 2920</span><span class="keywordflow">   end do</span></div>
<div class="line"><a id="l02921" name="l02921"></a><span class="lineno"> 2921</span><span class="comment">!</span></div>
<div class="line"><a id="l02922" name="l02922"></a><span class="lineno"> 2922</span><span class="comment">! Table complete -- Set coefficients for polynomial approximation of</span></div>
<div class="line"><a id="l02923" name="l02923"></a><span class="lineno"> 2923</span><span class="comment">! difference between saturation vapor press over water and saturation</span></div>
<div class="line"><a id="l02924" name="l02924"></a><span class="lineno"> 2924</span><span class="comment">! pressure over ice for -ttrice &lt; t &lt; 0 (degrees C). NOTE: polynomial</span></div>
<div class="line"><a id="l02925" name="l02925"></a><span class="lineno"> 2925</span><span class="comment">! is valid in the range -40 &lt; t &lt; 0 (degrees C).</span></div>
<div class="line"><a id="l02926" name="l02926"></a><span class="lineno"> 2926</span><span class="comment">!</span></div>
<div class="line"><a id="l02927" name="l02927"></a><span class="lineno"> 2927</span><span class="comment">!                  --- Degree 5 approximation ---</span></div>
<div class="line"><a id="l02928" name="l02928"></a><span class="lineno"> 2928</span><span class="comment">!</span></div>
<div class="line"><a id="l02929" name="l02929"></a><span class="lineno"> 2929</span>   <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a9959643d725aaab6c2bc49ef8233f17d">pcf</a>(1) =  5.04469588506e-01</div>
<div class="line"><a id="l02930" name="l02930"></a><span class="lineno"> 2930</span>   <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a9959643d725aaab6c2bc49ef8233f17d">pcf</a>(2) = -5.47288442819e+00</div>
<div class="line"><a id="l02931" name="l02931"></a><span class="lineno"> 2931</span>   <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a9959643d725aaab6c2bc49ef8233f17d">pcf</a>(3) = -3.67471858735e-01</div>
<div class="line"><a id="l02932" name="l02932"></a><span class="lineno"> 2932</span>   <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a9959643d725aaab6c2bc49ef8233f17d">pcf</a>(4) = -8.95963532403e-03</div>
<div class="line"><a id="l02933" name="l02933"></a><span class="lineno"> 2933</span>   <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a9959643d725aaab6c2bc49ef8233f17d">pcf</a>(5) = -7.78053686625e-05</div>
<div class="line"><a id="l02934" name="l02934"></a><span class="lineno"> 2934</span><span class="comment">!</span></div>
<div class="line"><a id="l02935" name="l02935"></a><span class="lineno"> 2935</span><span class="comment">!                  --- Degree 6 approximation ---</span></div>
<div class="line"><a id="l02936" name="l02936"></a><span class="lineno"> 2936</span><span class="comment">!</span></div>
<div class="line"><a id="l02937" name="l02937"></a><span class="lineno"> 2937</span><span class="comment">!-----pcf(1) =  7.63285250063e-02</span></div>
<div class="line"><a id="l02938" name="l02938"></a><span class="lineno"> 2938</span><span class="comment">!-----pcf(2) = -5.86048427932e+00</span></div>
<div class="line"><a id="l02939" name="l02939"></a><span class="lineno"> 2939</span><span class="comment">!-----pcf(3) = -4.38660831780e-01</span></div>
<div class="line"><a id="l02940" name="l02940"></a><span class="lineno"> 2940</span><span class="comment">!-----pcf(4) = -1.37898276415e-02</span></div>
<div class="line"><a id="l02941" name="l02941"></a><span class="lineno"> 2941</span><span class="comment">!-----pcf(5) = -2.14444472424e-04</span></div>
<div class="line"><a id="l02942" name="l02942"></a><span class="lineno"> 2942</span><span class="comment">!-----pcf(6) = -1.36639103771e-06</span></div>
<div class="line"><a id="l02943" name="l02943"></a><span class="lineno"> 2943</span><span class="comment">!</span></div>
<div class="line"><a id="l02944" name="l02944"></a><span class="lineno"> 2944</span><span class="preprocessor">#if !defined(mpas)</span></div>
<div class="line"><a id="l02945" name="l02945"></a><span class="lineno"> 2945</span><span class="preprocessor"></span>   <span class="keywordflow">if</span> (<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a23c78317414125c627ac5c180f91a508">masterproc</a>) <span class="keywordflow">then</span></div>
<div class="line"><a id="l02946" name="l02946"></a><span class="lineno"> 2946</span>      <span class="keyword">write</span>(6,*)<span class="stringliteral">&#39; *** SATURATION VAPOR PRESSURE TABLE COMPLETED ***&#39;</span></div>
<div class="line"><a id="l02947" name="l02947"></a><span class="lineno"> 2947</span><span class="keywordflow">   end if</span></div>
<div class="line"><a id="l02948" name="l02948"></a><span class="lineno"> 2948</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l02949" name="l02949"></a><span class="lineno"> 2949</span><span class="preprocessor"></span> </div>
<div class="line"><a id="l02950" name="l02950"></a><span class="lineno"> 2950</span>   <span class="keywordflow">return</span></div>
<div class="line"><a id="l02951" name="l02951"></a><span class="lineno"> 2951</span><span class="comment">!</span></div>
<div class="line"><a id="l02952" name="l02952"></a><span class="lineno"> 2952</span>9000 <span class="keyword">format</span>(<span class="stringliteral">&#39;GESTBL: FATAL ERROR *********************************&#39;</span>,/, &amp;</div>
<div class="line"><a id="l02953" name="l02953"></a><span class="lineno"> 2953</span>            <span class="stringliteral">&#39; TMAX AND TMIN REQUIRE A LARGER DIMENSION ON THE LENGTH&#39;</span>, &amp;</div>
<div class="line"><a id="l02954" name="l02954"></a><span class="lineno"> 2954</span>            <span class="stringliteral">&#39; OF THE SATURATION VAPOR PRESSURE TABLE ESTBL(PLENEST)&#39;</span>,/, &amp;</div>
<div class="line"><a id="l02955" name="l02955"></a><span class="lineno"> 2955</span>            <span class="stringliteral">&#39; TMAX, TMIN, AND PLENEST =&gt; &#39;</span>, 2f7.2, i3)</div>
<div class="line"><a id="l02956" name="l02956"></a><span class="lineno"> 2956</span><span class="comment">!</span></div>
<div class="line"><a id="l02957" name="l02957"></a><span class="lineno"> 2957</span><span class="keyword">end subroutine </span><a class="code hl_function" href="namespacemodule__ra__cam__support.html#a7a5b6927fda0934eee09b020cc183820">gestbl</a></div>
<div class="line"><a id="l02958" name="l02958"></a><span class="lineno"> 2958</span> </div>
<div class="line"><a id="l02959" name="l02959"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#acbc7ddcbc2ec8b0b8f4b5dba23f0df96"> 2959</a></span><span class="keyword">subroutine </span><a class="code hl_function" href="namespacemodule__ra__cam__support.html#acbc7ddcbc2ec8b0b8f4b5dba23f0df96">gffgch</a>(t       ,es      ,itype   )</div>
<div class="line"><a id="l02960" name="l02960"></a><span class="lineno"> 2960</span><span class="comment">!----------------------------------------------------------------------- </span></div>
<div class="line"><a id="l02961" name="l02961"></a><span class="lineno"> 2961</span><span class="comment">! </span></div>
<div class="line"><a id="l02962" name="l02962"></a><span class="lineno"> 2962</span><span class="comment">! Purpose: </span></div>
<div class="line"><a id="l02963" name="l02963"></a><span class="lineno"> 2963</span><span class="comment">! Computes saturation vapor pressure over water and/or over ice using</span></div>
<div class="line"><a id="l02964" name="l02964"></a><span class="lineno"> 2964</span><span class="comment">! Goff &amp; Gratch (1946) relationships. </span></div>
<div class="line"><a id="l02965" name="l02965"></a><span class="lineno"> 2965</span><span class="comment">! &lt;Say what the routine does&gt; </span></div>
<div class="line"><a id="l02966" name="l02966"></a><span class="lineno"> 2966</span><span class="comment">! </span></div>
<div class="line"><a id="l02967" name="l02967"></a><span class="lineno"> 2967</span><span class="comment">! Method: </span></div>
<div class="line"><a id="l02968" name="l02968"></a><span class="lineno"> 2968</span><span class="comment">! T (temperature), and itype are input parameters, while es (saturation</span></div>
<div class="line"><a id="l02969" name="l02969"></a><span class="lineno"> 2969</span><span class="comment">! vapor pressure) is an output parameter.  The input parameter itype</span></div>
<div class="line"><a id="l02970" name="l02970"></a><span class="lineno"> 2970</span><span class="comment">! serves two purposes: a value of zero indicates that saturation vapor</span></div>
<div class="line"><a id="l02971" name="l02971"></a><span class="lineno"> 2971</span><span class="comment">! pressures over water are to be returned (regardless of temperature),</span></div>
<div class="line"><a id="l02972" name="l02972"></a><span class="lineno"> 2972</span><span class="comment">! while a value of one indicates that saturation vapor pressures over</span></div>
<div class="line"><a id="l02973" name="l02973"></a><span class="lineno"> 2973</span><span class="comment">! ice should be returned when t is less than freezing degrees.  If itype</span></div>
<div class="line"><a id="l02974" name="l02974"></a><span class="lineno"> 2974</span><span class="comment">! is negative, its absolute value is interpreted to define a temperature</span></div>
<div class="line"><a id="l02975" name="l02975"></a><span class="lineno"> 2975</span><span class="comment">! transition region below freezing in which the returned</span></div>
<div class="line"><a id="l02976" name="l02976"></a><span class="lineno"> 2976</span><span class="comment">! saturation vapor pressure is a weighted average of the respective ice</span></div>
<div class="line"><a id="l02977" name="l02977"></a><span class="lineno"> 2977</span><span class="comment">! and water value.  That is, in the temperature range 0 =&gt; -itype</span></div>
<div class="line"><a id="l02978" name="l02978"></a><span class="lineno"> 2978</span><span class="comment">! degrees c, the saturation vapor pressures are assumed to be a weighted</span></div>
<div class="line"><a id="l02979" name="l02979"></a><span class="lineno"> 2979</span><span class="comment">! average of the vapor pressure over supercooled water and ice (all</span></div>
<div class="line"><a id="l02980" name="l02980"></a><span class="lineno"> 2980</span><span class="comment">! water at 0 c; all ice at -itype c).  Maximum transition range =&gt; 40 c</span></div>
<div class="line"><a id="l02981" name="l02981"></a><span class="lineno"> 2981</span><span class="comment">! </span></div>
<div class="line"><a id="l02982" name="l02982"></a><span class="lineno"> 2982</span><span class="comment">! Author: J. Hack</span></div>
<div class="line"><a id="l02983" name="l02983"></a><span class="lineno"> 2983</span><span class="comment">! </span></div>
<div class="line"><a id="l02984" name="l02984"></a><span class="lineno"> 2984</span><span class="comment">!-----------------------------------------------------------------------</span></div>
<div class="line"><a id="l02985" name="l02985"></a><span class="lineno"> 2985</span><span class="comment">!  use shr_kind_mod, only: r8 =&gt; shr_kind_r8</span></div>
<div class="line"><a id="l02986" name="l02986"></a><span class="lineno"> 2986</span><span class="comment">!  use physconst, only: tmelt</span></div>
<div class="line"><a id="l02987" name="l02987"></a><span class="lineno"> 2987</span><span class="comment">!  use abortutils, only: endrun</span></div>
<div class="line"><a id="l02988" name="l02988"></a><span class="lineno"> 2988</span>    </div>
<div class="line"><a id="l02989" name="l02989"></a><span class="lineno"> 2989</span>   <span class="keywordtype">implicit none</span></div>
<div class="line"><a id="l02990" name="l02990"></a><span class="lineno"> 2990</span><span class="comment">!------------------------------Arguments--------------------------------</span></div>
<div class="line"><a id="l02991" name="l02991"></a><span class="lineno"> 2991</span><span class="comment">!</span></div>
<div class="line"><a id="l02992" name="l02992"></a><span class="lineno"> 2992</span><span class="comment">! Input arguments</span></div>
<div class="line"><a id="l02993" name="l02993"></a><span class="lineno"> 2993</span><span class="comment">!</span></div>
<div class="line"><a id="l02994" name="l02994"></a><span class="lineno"> 2994</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: t          <span class="comment">! Temperature</span></div>
<div class="line"><a id="l02995" name="l02995"></a><span class="lineno"> 2995</span><span class="comment">!</span></div>
<div class="line"><a id="l02996" name="l02996"></a><span class="lineno"> 2996</span><span class="comment">! Output arguments</span></div>
<div class="line"><a id="l02997" name="l02997"></a><span class="lineno"> 2997</span><span class="comment">!</span></div>
<div class="line"><a id="l02998" name="l02998"></a><span class="lineno"> 2998</span>   <span class="keywordtype">integer</span>, <span class="keywordtype">intent(inout)</span> :: itype   <span class="comment">! Flag for ice phase and associated transition</span></div>
<div class="line"><a id="l02999" name="l02999"></a><span class="lineno"> 2999</span> </div>
<div class="line"><a id="l03000" name="l03000"></a><span class="lineno"> 3000</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(out)</span> :: es         <span class="comment">! Saturation vapor pressure</span></div>
<div class="line"><a id="l03001" name="l03001"></a><span class="lineno"> 3001</span><span class="comment">!</span></div>
<div class="line"><a id="l03002" name="l03002"></a><span class="lineno"> 3002</span><span class="comment">!---------------------------Local variables-----------------------------</span></div>
<div class="line"><a id="l03003" name="l03003"></a><span class="lineno"> 3003</span><span class="comment">!</span></div>
<div class="line"><a id="l03004" name="l03004"></a><span class="lineno"> 3004</span><span class="keywordtype">   real</span>(r8) e1         <span class="comment">! Intermediate scratch variable for es over water</span></div>
<div class="line"><a id="l03005" name="l03005"></a><span class="lineno"> 3005</span><span class="keywordtype">   real</span>(r8) e2         <span class="comment">! Intermediate scratch variable for es over water</span></div>
<div class="line"><a id="l03006" name="l03006"></a><span class="lineno"> 3006</span><span class="keywordtype">   real</span>(r8) eswtr      <span class="comment">! Saturation vapor pressure over water</span></div>
<div class="line"><a id="l03007" name="l03007"></a><span class="lineno"> 3007</span><span class="keywordtype">   real</span>(r8) f          <span class="comment">! Intermediate scratch variable for es over water</span></div>
<div class="line"><a id="l03008" name="l03008"></a><span class="lineno"> 3008</span><span class="keywordtype">   real</span>(r8) f1         <span class="comment">! Intermediate scratch variable for es over water</span></div>
<div class="line"><a id="l03009" name="l03009"></a><span class="lineno"> 3009</span><span class="keywordtype">   real</span>(r8) f2         <span class="comment">! Intermediate scratch variable for es over water</span></div>
<div class="line"><a id="l03010" name="l03010"></a><span class="lineno"> 3010</span><span class="keywordtype">   real</span>(r8) f3         <span class="comment">! Intermediate scratch variable for es over water</span></div>
<div class="line"><a id="l03011" name="l03011"></a><span class="lineno"> 3011</span><span class="keywordtype">   real</span>(r8) f4         <span class="comment">! Intermediate scratch variable for es over water</span></div>
<div class="line"><a id="l03012" name="l03012"></a><span class="lineno"> 3012</span><span class="keywordtype">   real</span>(r8) f5         <span class="comment">! Intermediate scratch variable for es over water</span></div>
<div class="line"><a id="l03013" name="l03013"></a><span class="lineno"> 3013</span><span class="keywordtype">   real</span>(r8) ps         <span class="comment">! Reference pressure (mb)</span></div>
<div class="line"><a id="l03014" name="l03014"></a><span class="lineno"> 3014</span><span class="keywordtype">   real</span>(r8) t0         <span class="comment">! Reference temperature (freezing point of water)</span></div>
<div class="line"><a id="l03015" name="l03015"></a><span class="lineno"> 3015</span><span class="keywordtype">   real</span>(r8) term1      <span class="comment">! Intermediate scratch variable for es over ice</span></div>
<div class="line"><a id="l03016" name="l03016"></a><span class="lineno"> 3016</span><span class="keywordtype">   real</span>(r8) term2      <span class="comment">! Intermediate scratch variable for es over ice</span></div>
<div class="line"><a id="l03017" name="l03017"></a><span class="lineno"> 3017</span><span class="keywordtype">   real</span>(r8) term3      <span class="comment">! Intermediate scratch variable for es over ice</span></div>
<div class="line"><a id="l03018" name="l03018"></a><span class="lineno"> 3018</span><span class="keywordtype">   real</span>(r8) tr         <span class="comment">! Transition range for es over water to es over ice</span></div>
<div class="line"><a id="l03019" name="l03019"></a><span class="lineno"> 3019</span><span class="keywordtype">   real</span>(r8) ts         <span class="comment">! Reference temperature (boiling point of water)</span></div>
<div class="line"><a id="l03020" name="l03020"></a><span class="lineno"> 3020</span><span class="keywordtype">   real</span>(r8) weight     <span class="comment">! Intermediate scratch variable for es transition</span></div>
<div class="line"><a id="l03021" name="l03021"></a><span class="lineno"> 3021</span>   <span class="keywordtype">integer</span> itypo   <span class="comment">! Intermediate scratch variable for holding itype</span></div>
<div class="line"><a id="l03022" name="l03022"></a><span class="lineno"> 3022</span><span class="comment">!</span></div>
<div class="line"><a id="l03023" name="l03023"></a><span class="lineno"> 3023</span><span class="comment">!-----------------------------------------------------------------------</span></div>
<div class="line"><a id="l03024" name="l03024"></a><span class="lineno"> 3024</span><span class="comment">!</span></div>
<div class="line"><a id="l03025" name="l03025"></a><span class="lineno"> 3025</span><span class="comment">! Check on whether there is to be a transition region for es</span></div>
<div class="line"><a id="l03026" name="l03026"></a><span class="lineno"> 3026</span><span class="comment">!</span></div>
<div class="line"><a id="l03027" name="l03027"></a><span class="lineno"> 3027</span>   <span class="keywordflow">if</span> (itype &lt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a id="l03028" name="l03028"></a><span class="lineno"> 3028</span>      tr    = abs(float(itype))</div>
<div class="line"><a id="l03029" name="l03029"></a><span class="lineno"> 3029</span>      itypo = itype</div>
<div class="line"><a id="l03030" name="l03030"></a><span class="lineno"> 3030</span>      itype = 1</div>
<div class="line"><a id="l03031" name="l03031"></a><span class="lineno"> 3031</span>   <span class="keywordflow">else</span></div>
<div class="line"><a id="l03032" name="l03032"></a><span class="lineno"> 3032</span>      tr    = 0.0</div>
<div class="line"><a id="l03033" name="l03033"></a><span class="lineno"> 3033</span>      itypo = itype</div>
<div class="line"><a id="l03034" name="l03034"></a><span class="lineno"> 3034</span><span class="keywordflow">   end if</span></div>
<div class="line"><a id="l03035" name="l03035"></a><span class="lineno"> 3035</span>   <span class="keywordflow">if</span> (tr &gt; 40.0) <span class="keywordflow">then</span></div>
<div class="line"><a id="l03036" name="l03036"></a><span class="lineno"> 3036</span>      <span class="keyword">write</span>(6,900) tr</div>
<div class="line"><a id="l03037" name="l03037"></a><span class="lineno"> 3037</span><span class="comment">!     call endrun (&#39;GFFGCH&#39;)                ! Abnormal termination</span></div>
<div class="line"><a id="l03038" name="l03038"></a><span class="lineno"> 3038</span><span class="keywordflow">   end if</span></div>
<div class="line"><a id="l03039" name="l03039"></a><span class="lineno"> 3039</span><span class="comment">!</span></div>
<div class="line"><a id="l03040" name="l03040"></a><span class="lineno"> 3040</span>   <span class="keywordflow">if</span>(t &lt; (<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a4e848e3e0511ebba4d1541494c416613">tmelt</a> - tr) .and. itype == 1) <span class="keywordflow">go to</span> 10</div>
<div class="line"><a id="l03041" name="l03041"></a><span class="lineno"> 3041</span><span class="comment">!</span></div>
<div class="line"><a id="l03042" name="l03042"></a><span class="lineno"> 3042</span><span class="comment">! Water</span></div>
<div class="line"><a id="l03043" name="l03043"></a><span class="lineno"> 3043</span><span class="comment">!</span></div>
<div class="line"><a id="l03044" name="l03044"></a><span class="lineno"> 3044</span>   ps = 1013.246</div>
<div class="line"><a id="l03045" name="l03045"></a><span class="lineno"> 3045</span>   ts = 373.16</div>
<div class="line"><a id="l03046" name="l03046"></a><span class="lineno"> 3046</span>   e1 = 11.344*(1.0 - t/ts)</div>
<div class="line"><a id="l03047" name="l03047"></a><span class="lineno"> 3047</span>   e2 = -3.49149*(ts/t - 1.0)</div>
<div class="line"><a id="l03048" name="l03048"></a><span class="lineno"> 3048</span>   f1 = -7.90298*(ts/t - 1.0)</div>
<div class="line"><a id="l03049" name="l03049"></a><span class="lineno"> 3049</span>   f2 = 5.02808*log10(ts/t)</div>
<div class="line"><a id="l03050" name="l03050"></a><span class="lineno"> 3050</span>   f3 = -1.3816*(10.0**e1 - 1.0)/10000000.0</div>
<div class="line"><a id="l03051" name="l03051"></a><span class="lineno"> 3051</span>   f4 = 8.1328*(10.0**e2 - 1.0)/1000.0</div>
<div class="line"><a id="l03052" name="l03052"></a><span class="lineno"> 3052</span>   f5 = log10(ps)</div>
<div class="line"><a id="l03053" name="l03053"></a><span class="lineno"> 3053</span>   f  = f1 + f2 + f3 + f4 + f5</div>
<div class="line"><a id="l03054" name="l03054"></a><span class="lineno"> 3054</span>   es = (10.0**f)*100.0</div>
<div class="line"><a id="l03055" name="l03055"></a><span class="lineno"> 3055</span>   eswtr = es</div>
<div class="line"><a id="l03056" name="l03056"></a><span class="lineno"> 3056</span><span class="comment">!</span></div>
<div class="line"><a id="l03057" name="l03057"></a><span class="lineno"> 3057</span>   <span class="keywordflow">if</span>(t &gt;= <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a4e848e3e0511ebba4d1541494c416613">tmelt</a> .or. itype == 0) <span class="keywordflow">go to</span> 20</div>
<div class="line"><a id="l03058" name="l03058"></a><span class="lineno"> 3058</span><span class="comment">!</span></div>
<div class="line"><a id="l03059" name="l03059"></a><span class="lineno"> 3059</span><span class="comment">! Ice</span></div>
<div class="line"><a id="l03060" name="l03060"></a><span class="lineno"> 3060</span><span class="comment">!</span></div>
<div class="line"><a id="l03061" name="l03061"></a><span class="lineno"> 3061</span>10 <span class="keywordflow">continue</span></div>
<div class="line"><a id="l03062" name="l03062"></a><span class="lineno"> 3062</span>   t0    = <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a4e848e3e0511ebba4d1541494c416613">tmelt</a></div>
<div class="line"><a id="l03063" name="l03063"></a><span class="lineno"> 3063</span>   term1 = 2.01889049/(t0/t)</div>
<div class="line"><a id="l03064" name="l03064"></a><span class="lineno"> 3064</span>   term2 = 3.56654*log(t0/t)</div>
<div class="line"><a id="l03065" name="l03065"></a><span class="lineno"> 3065</span>   term3 = 20.947031*(t0/t)</div>
<div class="line"><a id="l03066" name="l03066"></a><span class="lineno"> 3066</span>   es    = 575.185606e10*exp(-(term1 + term2 + term3))</div>
<div class="line"><a id="l03067" name="l03067"></a><span class="lineno"> 3067</span><span class="comment">!</span></div>
<div class="line"><a id="l03068" name="l03068"></a><span class="lineno"> 3068</span>   <span class="keywordflow">if</span> (t &lt; (<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a4e848e3e0511ebba4d1541494c416613">tmelt</a> - tr)) <span class="keywordflow">go to</span> 20</div>
<div class="line"><a id="l03069" name="l03069"></a><span class="lineno"> 3069</span><span class="comment">!</span></div>
<div class="line"><a id="l03070" name="l03070"></a><span class="lineno"> 3070</span><span class="comment">! Weighted transition between water and ice</span></div>
<div class="line"><a id="l03071" name="l03071"></a><span class="lineno"> 3071</span><span class="comment">!</span></div>
<div class="line"><a id="l03072" name="l03072"></a><span class="lineno"> 3072</span>   weight = min((<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a4e848e3e0511ebba4d1541494c416613">tmelt</a> - t)/tr,1.0_r8)</div>
<div class="line"><a id="l03073" name="l03073"></a><span class="lineno"> 3073</span>   es = weight*es + (1.0 - weight)*eswtr</div>
<div class="line"><a id="l03074" name="l03074"></a><span class="lineno"> 3074</span><span class="comment">!</span></div>
<div class="line"><a id="l03075" name="l03075"></a><span class="lineno"> 3075</span>20 <span class="keywordflow">continue</span></div>
<div class="line"><a id="l03076" name="l03076"></a><span class="lineno"> 3076</span>   itype = itypo</div>
<div class="line"><a id="l03077" name="l03077"></a><span class="lineno"> 3077</span>   <span class="keywordflow">return</span></div>
<div class="line"><a id="l03078" name="l03078"></a><span class="lineno"> 3078</span><span class="comment">!</span></div>
<div class="line"><a id="l03079" name="l03079"></a><span class="lineno"> 3079</span>900 <span class="keyword">format</span>(<span class="stringliteral">&#39;GFFGCH: FATAL ERROR ******************************&#39;</span>,/, &amp;</div>
<div class="line"><a id="l03080" name="l03080"></a><span class="lineno"> 3080</span>           <span class="stringliteral">&#39;TRANSITION RANGE FOR WATER TO ICE SATURATION VAPOR&#39;</span>, &amp;</div>
<div class="line"><a id="l03081" name="l03081"></a><span class="lineno"> 3081</span>           <span class="stringliteral">&#39; PRESSURE, TR, EXCEEDS MAXIMUM ALLOWABLE VALUE OF&#39;</span>, &amp;</div>
<div class="line"><a id="l03082" name="l03082"></a><span class="lineno"> 3082</span>           <span class="stringliteral">&#39; 40.0 DEGREES C&#39;</span>,/, <span class="stringliteral">&#39; TR = &#39;</span>,f7.2)</div>
<div class="line"><a id="l03083" name="l03083"></a><span class="lineno"> 3083</span><span class="comment">!</span></div>
<div class="line"><a id="l03084" name="l03084"></a><span class="lineno"> 3084</span><span class="keyword">end subroutine </span><a class="code hl_function" href="namespacemodule__ra__cam__support.html#acbc7ddcbc2ec8b0b8f4b5dba23f0df96">gffgch</a></div>
<div class="line"><a id="l03085" name="l03085"></a><span class="lineno"> 3085</span> </div>
<div class="line"><a id="l03086" name="l03086"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#afa6ddf6a4f220dc56902e7da006468cd"> 3086</a></span><span class="keywordtype">   real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>) function <a class="code hl_function" href="namespacemodule__ra__cam__support.html#afa6ddf6a4f220dc56902e7da006468cd">estblf</a>( td )</div>
<div class="line"><a id="l03087" name="l03087"></a><span class="lineno"> 3087</span><span class="comment">!</span></div>
<div class="line"><a id="l03088" name="l03088"></a><span class="lineno"> 3088</span><span class="comment">! Saturation vapor pressure table lookup</span></div>
<div class="line"><a id="l03089" name="l03089"></a><span class="lineno"> 3089</span><span class="comment">!</span></div>
<div class="line"><a id="l03090" name="l03090"></a><span class="lineno"> 3090</span><span class="keywordtype">   real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>), <span class="keywordtype">intent(in)</span> :: td         <span class="comment">! Temperature for saturation lookup</span></div>
<div class="line"><a id="l03091" name="l03091"></a><span class="lineno"> 3091</span><span class="comment">!</span></div>
<div class="line"><a id="l03092" name="l03092"></a><span class="lineno"> 3092</span><span class="keywordtype">   real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>) :: e       <span class="comment">! intermediate variable for es look-up</span></div>
<div class="line"><a id="l03093" name="l03093"></a><span class="lineno"> 3093</span><span class="keywordtype">   real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>) :: ai</div>
<div class="line"><a id="l03094" name="l03094"></a><span class="lineno"> 3094</span>   <span class="keywordtype">integer</span>  :: i</div>
<div class="line"><a id="l03095" name="l03095"></a><span class="lineno"> 3095</span><span class="comment">!</span></div>
<div class="line"><a id="l03096" name="l03096"></a><span class="lineno"> 3096</span>   e = max(min(td,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ac550f97473b686550bc1aae97e282cff">tmax</a>),<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ab7607052d159e3c4918a4be06574a590">tmin</a>)   <span class="comment">! partial pressure</span></div>
<div class="line"><a id="l03097" name="l03097"></a><span class="lineno"> 3097</span>   i = int(e-<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ab7607052d159e3c4918a4be06574a590">tmin</a>)+1</div>
<div class="line"><a id="l03098" name="l03098"></a><span class="lineno"> 3098</span>   ai = aint(e-<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ab7607052d159e3c4918a4be06574a590">tmin</a>)</div>
<div class="line"><a id="l03099" name="l03099"></a><span class="lineno"> 3099</span>   <a class="code hl_function" href="namespacemodule__ra__cam__support.html#afa6ddf6a4f220dc56902e7da006468cd">estblf</a> = (<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ab7607052d159e3c4918a4be06574a590">tmin</a>+ai-e+1.)* &amp;</div>
<div class="line"><a id="l03100" name="l03100"></a><span class="lineno"> 3100</span>            <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a753905688ac0510d00957932c5b24c69">estbl</a>(i)-(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ab7607052d159e3c4918a4be06574a590">tmin</a>+ai-e)* &amp;</div>
<div class="line"><a id="l03101" name="l03101"></a><span class="lineno"> 3101</span>            <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a753905688ac0510d00957932c5b24c69">estbl</a>(i+1)</div>
<div class="line"><a id="l03102" name="l03102"></a><span class="lineno"> 3102</span>   <span class="keyword">end function </span><a class="code hl_function" href="namespacemodule__ra__cam__support.html#afa6ddf6a4f220dc56902e7da006468cd">estblf</a></div>
<div class="line"><a id="l03103" name="l03103"></a><span class="lineno"> 3103</span> </div>
<div class="line"><a id="l03104" name="l03104"></a><span class="lineno"> 3104</span> </div>
<div class="line"><a id="l03105" name="l03105"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a0bedf61bf2aa689f1fe7d40c1fb2421c"> 3105</a></span><span class="keyword">function </span><a class="code hl_function" href="namespacemodule__ra__cam__support.html#a0bedf61bf2aa689f1fe7d40c1fb2421c">findvalue</a>(ix,n,ain,indxa)</div>
<div class="line"><a id="l03106" name="l03106"></a><span class="lineno"> 3106</span><span class="comment">!----------------------------------------------------------------------- </span></div>
<div class="line"><a id="l03107" name="l03107"></a><span class="lineno"> 3107</span><span class="comment">! </span></div>
<div class="line"><a id="l03108" name="l03108"></a><span class="lineno"> 3108</span><span class="comment">! Purpose: </span></div>
<div class="line"><a id="l03109" name="l03109"></a><span class="lineno"> 3109</span><span class="comment">! Subroutine for finding ix-th smallest value in the array</span></div>
<div class="line"><a id="l03110" name="l03110"></a><span class="lineno"> 3110</span><span class="comment">! The elements are rearranged so that the ix-th smallest</span></div>
<div class="line"><a id="l03111" name="l03111"></a><span class="lineno"> 3111</span><span class="comment">! element is in the ix place and all smaller elements are</span></div>
<div class="line"><a id="l03112" name="l03112"></a><span class="lineno"> 3112</span><span class="comment">! moved to the elements up to ix (with random order).</span></div>
<div class="line"><a id="l03113" name="l03113"></a><span class="lineno"> 3113</span><span class="comment">!</span></div>
<div class="line"><a id="l03114" name="l03114"></a><span class="lineno"> 3114</span><span class="comment">! Algorithm: Based on the quicksort algorithm.</span></div>
<div class="line"><a id="l03115" name="l03115"></a><span class="lineno"> 3115</span><span class="comment">!</span></div>
<div class="line"><a id="l03116" name="l03116"></a><span class="lineno"> 3116</span><span class="comment">! Author:       T. Craig</span></div>
<div class="line"><a id="l03117" name="l03117"></a><span class="lineno"> 3117</span><span class="comment">! </span></div>
<div class="line"><a id="l03118" name="l03118"></a><span class="lineno"> 3118</span><span class="comment">!-----------------------------------------------------------------------</span></div>
<div class="line"><a id="l03119" name="l03119"></a><span class="lineno"> 3119</span><span class="comment">!  use shr_kind_mod, only: r8 =&gt; shr_kind_r8</span></div>
<div class="line"><a id="l03120" name="l03120"></a><span class="lineno"> 3120</span>   <span class="keywordtype">implicit none</span></div>
<div class="line"><a id="l03121" name="l03121"></a><span class="lineno"> 3121</span><span class="comment">!</span></div>
<div class="line"><a id="l03122" name="l03122"></a><span class="lineno"> 3122</span><span class="comment">! arguments</span></div>
<div class="line"><a id="l03123" name="l03123"></a><span class="lineno"> 3123</span><span class="comment">!</span></div>
<div class="line"><a id="l03124" name="l03124"></a><span class="lineno"> 3124</span>   <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: ix                <span class="comment">! element to search for</span></div>
<div class="line"><a id="l03125" name="l03125"></a><span class="lineno"> 3125</span>   <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: n                 <span class="comment">! total number of elements</span></div>
<div class="line"><a id="l03126" name="l03126"></a><span class="lineno"> 3126</span>   <span class="keywordtype">integer</span>, <span class="keywordtype">intent(inout)</span>:: indxa(n)        <span class="comment">! array of integers</span></div>
<div class="line"><a id="l03127" name="l03127"></a><span class="lineno"> 3127</span><span class="keywordtype">   real</span>(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">r8</a>), <span class="keywordtype">intent(in)</span> :: ain(n)           <span class="comment">! array to search</span></div>
<div class="line"><a id="l03128" name="l03128"></a><span class="lineno"> 3128</span><span class="comment">!</span></div>
<div class="line"><a id="l03129" name="l03129"></a><span class="lineno"> 3129</span>   <span class="keywordtype">integer</span> <a class="code hl_function" href="namespacemodule__ra__cam__support.html#a0bedf61bf2aa689f1fe7d40c1fb2421c">findvalue</a>                        <span class="comment">! return value</span></div>
<div class="line"><a id="l03130" name="l03130"></a><span class="lineno"> 3130</span><span class="comment">!</span></div>
<div class="line"><a id="l03131" name="l03131"></a><span class="lineno"> 3131</span><span class="comment">! local variables</span></div>
<div class="line"><a id="l03132" name="l03132"></a><span class="lineno"> 3132</span><span class="comment">!</span></div>
<div class="line"><a id="l03133" name="l03133"></a><span class="lineno"> 3133</span>   <span class="keywordtype">integer</span> i,j</div>
<div class="line"><a id="l03134" name="l03134"></a><span class="lineno"> 3134</span>   <span class="keywordtype">integer</span> il,im,ir</div>
<div class="line"><a id="l03135" name="l03135"></a><span class="lineno"> 3135</span> </div>
<div class="line"><a id="l03136" name="l03136"></a><span class="lineno"> 3136</span>   <span class="keywordtype">integer</span> ia</div>
<div class="line"><a id="l03137" name="l03137"></a><span class="lineno"> 3137</span>   <span class="keywordtype">integer</span> itmp</div>
<div class="line"><a id="l03138" name="l03138"></a><span class="lineno"> 3138</span><span class="comment">!</span></div>
<div class="line"><a id="l03139" name="l03139"></a><span class="lineno"> 3139</span><span class="comment">!---------------------------Routine-----------------------------</span></div>
<div class="line"><a id="l03140" name="l03140"></a><span class="lineno"> 3140</span><span class="comment">!</span></div>
<div class="line"><a id="l03141" name="l03141"></a><span class="lineno"> 3141</span>   il=1</div>
<div class="line"><a id="l03142" name="l03142"></a><span class="lineno"> 3142</span>   ir=n</div>
<div class="line"><a id="l03143" name="l03143"></a><span class="lineno"> 3143</span>   <span class="keywordflow">do</span></div>
<div class="line"><a id="l03144" name="l03144"></a><span class="lineno"> 3144</span>      <span class="keywordflow">if</span> (ir-il &lt;= 1) <span class="keywordflow">then</span></div>
<div class="line"><a id="l03145" name="l03145"></a><span class="lineno"> 3145</span>         <span class="keywordflow">if</span> (ir-il == 1) <span class="keywordflow">then</span></div>
<div class="line"><a id="l03146" name="l03146"></a><span class="lineno"> 3146</span>            <span class="keywordflow">if</span> (ain(indxa(ir)) &lt; ain(indxa(il))) <span class="keywordflow">then</span></div>
<div class="line"><a id="l03147" name="l03147"></a><span class="lineno"> 3147</span>               itmp=indxa(il)</div>
<div class="line"><a id="l03148" name="l03148"></a><span class="lineno"> 3148</span>               indxa(il)=indxa(ir)</div>
<div class="line"><a id="l03149" name="l03149"></a><span class="lineno"> 3149</span>               indxa(ir)=itmp</div>
<div class="line"><a id="l03150" name="l03150"></a><span class="lineno"> 3150</span><span class="keywordflow">            endif</span></div>
<div class="line"><a id="l03151" name="l03151"></a><span class="lineno"> 3151</span><span class="keywordflow">         endif</span></div>
<div class="line"><a id="l03152" name="l03152"></a><span class="lineno"> 3152</span>         <a class="code hl_function" href="namespacemodule__ra__cam__support.html#a0bedf61bf2aa689f1fe7d40c1fb2421c">findvalue</a>=indxa(ix)</div>
<div class="line"><a id="l03153" name="l03153"></a><span class="lineno"> 3153</span>         <span class="keywordflow">return</span></div>
<div class="line"><a id="l03154" name="l03154"></a><span class="lineno"> 3154</span>      <span class="keywordflow">else</span></div>
<div class="line"><a id="l03155" name="l03155"></a><span class="lineno"> 3155</span>         im=(il+ir)/2</div>
<div class="line"><a id="l03156" name="l03156"></a><span class="lineno"> 3156</span>         itmp=indxa(im)</div>
<div class="line"><a id="l03157" name="l03157"></a><span class="lineno"> 3157</span>         indxa(im)=indxa(il+1)</div>
<div class="line"><a id="l03158" name="l03158"></a><span class="lineno"> 3158</span>         indxa(il+1)=itmp</div>
<div class="line"><a id="l03159" name="l03159"></a><span class="lineno"> 3159</span>         <span class="keywordflow">if</span> (ain(indxa(il+1)) &gt; ain(indxa(ir))) <span class="keywordflow">then</span></div>
<div class="line"><a id="l03160" name="l03160"></a><span class="lineno"> 3160</span>            itmp=indxa(il+1)</div>
<div class="line"><a id="l03161" name="l03161"></a><span class="lineno"> 3161</span>            indxa(il+1)=indxa(ir)</div>
<div class="line"><a id="l03162" name="l03162"></a><span class="lineno"> 3162</span>            indxa(ir)=itmp</div>
<div class="line"><a id="l03163" name="l03163"></a><span class="lineno"> 3163</span><span class="keywordflow">         endif</span></div>
<div class="line"><a id="l03164" name="l03164"></a><span class="lineno"> 3164</span>         <span class="keywordflow">if</span> (ain(indxa(il)) &gt; ain(indxa(ir))) <span class="keywordflow">then</span></div>
<div class="line"><a id="l03165" name="l03165"></a><span class="lineno"> 3165</span>            itmp=indxa(il)</div>
<div class="line"><a id="l03166" name="l03166"></a><span class="lineno"> 3166</span>            indxa(il)=indxa(ir)</div>
<div class="line"><a id="l03167" name="l03167"></a><span class="lineno"> 3167</span>            indxa(ir)=itmp</div>
<div class="line"><a id="l03168" name="l03168"></a><span class="lineno"> 3168</span><span class="keywordflow">         endif</span></div>
<div class="line"><a id="l03169" name="l03169"></a><span class="lineno"> 3169</span>         <span class="keywordflow">if</span> (ain(indxa(il+1)) &gt; ain(indxa(il))) <span class="keywordflow">then</span></div>
<div class="line"><a id="l03170" name="l03170"></a><span class="lineno"> 3170</span>            itmp=indxa(il+1)</div>
<div class="line"><a id="l03171" name="l03171"></a><span class="lineno"> 3171</span>            indxa(il+1)=indxa(il)</div>
<div class="line"><a id="l03172" name="l03172"></a><span class="lineno"> 3172</span>            indxa(il)=itmp</div>
<div class="line"><a id="l03173" name="l03173"></a><span class="lineno"> 3173</span><span class="keywordflow">         endif</span></div>
<div class="line"><a id="l03174" name="l03174"></a><span class="lineno"> 3174</span>         i=il+1</div>
<div class="line"><a id="l03175" name="l03175"></a><span class="lineno"> 3175</span>         j=ir</div>
<div class="line"><a id="l03176" name="l03176"></a><span class="lineno"> 3176</span>         ia=indxa(il)</div>
<div class="line"><a id="l03177" name="l03177"></a><span class="lineno"> 3177</span>         <span class="keywordflow">do</span></div>
<div class="line"><a id="l03178" name="l03178"></a><span class="lineno"> 3178</span>            <span class="keywordflow">do</span></div>
<div class="line"><a id="l03179" name="l03179"></a><span class="lineno"> 3179</span>               i=i+1</div>
<div class="line"><a id="l03180" name="l03180"></a><span class="lineno"> 3180</span>               <span class="keywordflow">if</span> (ain(indxa(i)) &gt;= ain(ia)) <span class="keywordflow">exit</span></div>
<div class="line"><a id="l03181" name="l03181"></a><span class="lineno"> 3181</span><span class="keywordflow">            end do</span></div>
<div class="line"><a id="l03182" name="l03182"></a><span class="lineno"> 3182</span>            <span class="keywordflow">do</span></div>
<div class="line"><a id="l03183" name="l03183"></a><span class="lineno"> 3183</span>               j=j-1</div>
<div class="line"><a id="l03184" name="l03184"></a><span class="lineno"> 3184</span>               <span class="keywordflow">if</span> (ain(indxa(j)) &lt;= ain(ia)) <span class="keywordflow">exit</span></div>
<div class="line"><a id="l03185" name="l03185"></a><span class="lineno"> 3185</span><span class="keywordflow">            end do</span></div>
<div class="line"><a id="l03186" name="l03186"></a><span class="lineno"> 3186</span>            <span class="keywordflow">if</span> (j &lt; i) <span class="keywordflow">exit</span></div>
<div class="line"><a id="l03187" name="l03187"></a><span class="lineno"> 3187</span>            itmp=indxa(i)</div>
<div class="line"><a id="l03188" name="l03188"></a><span class="lineno"> 3188</span>            indxa(i)=indxa(j)</div>
<div class="line"><a id="l03189" name="l03189"></a><span class="lineno"> 3189</span>            indxa(j)=itmp</div>
<div class="line"><a id="l03190" name="l03190"></a><span class="lineno"> 3190</span><span class="keywordflow">         end do</span></div>
<div class="line"><a id="l03191" name="l03191"></a><span class="lineno"> 3191</span>         indxa(il)=indxa(j)</div>
<div class="line"><a id="l03192" name="l03192"></a><span class="lineno"> 3192</span>         indxa(j)=ia</div>
<div class="line"><a id="l03193" name="l03193"></a><span class="lineno"> 3193</span>         <span class="keywordflow">if</span> (j &gt;= ix)ir=j-1</div>
<div class="line"><a id="l03194" name="l03194"></a><span class="lineno"> 3194</span>         <span class="keywordflow">if</span> (j &lt;= ix)il=i</div>
<div class="line"><a id="l03195" name="l03195"></a><span class="lineno"> 3195</span><span class="keywordflow">      endif</span></div>
<div class="line"><a id="l03196" name="l03196"></a><span class="lineno"> 3196</span><span class="keywordflow">   end do</span></div>
<div class="line"><a id="l03197" name="l03197"></a><span class="lineno"> 3197</span><span class="keyword">end function </span><a class="code hl_function" href="namespacemodule__ra__cam__support.html#a0bedf61bf2aa689f1fe7d40c1fb2421c">findvalue</a></div>
<div class="line"><a id="l03198" name="l03198"></a><span class="lineno"> 3198</span> </div>
<div class="line"><a id="l03199" name="l03199"></a><span class="lineno"> 3199</span> </div>
<div class="line"><a id="l03200" name="l03200"></a><span class="lineno"> 3200</span><span class="comment">!LDF (05-21-2011): This section of the module is moved to module_physics_ra_cam_init.F in</span></div>
<div class="line"><a id="l03201" name="l03201"></a><span class="lineno"> 3201</span><span class="comment">!./../core_physics to accomodate differences in the mpi calls between WRF and MPAS.I thought</span></div>
<div class="line"><a id="l03202" name="l03202"></a><span class="lineno"> 3202</span><span class="comment">!that it would be cleaner to do this instead of adding a lot of #ifdef statements throughout</span></div>
<div class="line"><a id="l03203" name="l03203"></a><span class="lineno"> 3203</span><span class="comment">!the initialization of the longwave radiation code. Initialization is handled the same way</span></div>
<div class="line"><a id="l03204" name="l03204"></a><span class="lineno"> 3204</span><span class="comment">!for the shortwave radiation code.</span></div>
<div class="line"><a id="l03205" name="l03205"></a><span class="lineno"> 3205</span> </div>
<div class="line"><a id="l03206" name="l03206"></a><span class="lineno"> 3206</span><span class="preprocessor">#if !defined(mpas)</span></div>
<div class="line"><a id="l03207" name="l03207"></a><span class="lineno"> 3207</span><span class="preprocessor"></span> </div>
<div class="line"><a id="l03208" name="l03208"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a1a0681340dae6917a86859303ce696bc"> 3208</a></span><span class="keyword">subroutine </span>radini(gravx   ,cpairx  ,epsilox ,stebolx, pstdx )</div>
<div class="line"><a id="l03209" name="l03209"></a><span class="lineno"> 3209</span><span class="comment">!----------------------------------------------------------------------- </span></div>
<div class="line"><a id="l03210" name="l03210"></a><span class="lineno"> 3210</span><span class="comment">! </span></div>
<div class="line"><a id="l03211" name="l03211"></a><span class="lineno"> 3211</span><span class="comment">! Purpose: </span></div>
<div class="line"><a id="l03212" name="l03212"></a><span class="lineno"> 3212</span><span class="comment">! Initialize various constants for radiation scheme; note that</span></div>
<div class="line"><a id="l03213" name="l03213"></a><span class="lineno"> 3213</span><span class="comment">! the radiation scheme uses cgs units.</span></div>
<div class="line"><a id="l03214" name="l03214"></a><span class="lineno"> 3214</span><span class="comment">! </span></div>
<div class="line"><a id="l03215" name="l03215"></a><span class="lineno"> 3215</span><span class="comment">! Method: </span></div>
<div class="line"><a id="l03216" name="l03216"></a><span class="lineno"> 3216</span><span class="comment">! &lt;Describe the algorithm(s) used in the routine.&gt; </span></div>
<div class="line"><a id="l03217" name="l03217"></a><span class="lineno"> 3217</span><span class="comment">! &lt;Also include any applicable external references.&gt; </span></div>
<div class="line"><a id="l03218" name="l03218"></a><span class="lineno"> 3218</span><span class="comment">! </span></div>
<div class="line"><a id="l03219" name="l03219"></a><span class="lineno"> 3219</span><span class="comment">! Author: W. Collins (H2O parameterization) and J. Kiehl</span></div>
<div class="line"><a id="l03220" name="l03220"></a><span class="lineno"> 3220</span><span class="comment">! </span></div>
<div class="line"><a id="l03221" name="l03221"></a><span class="lineno"> 3221</span><span class="comment">!-----------------------------------------------------------------------</span></div>
<div class="line"><a id="l03222" name="l03222"></a><span class="lineno"> 3222</span><span class="comment">!  use shr_kind_mod, only: r8 =&gt; shr_kind_r8</span></div>
<div class="line"><a id="l03223" name="l03223"></a><span class="lineno"> 3223</span><span class="comment">!  use ppgrid,       only: pver, pverp</span></div>
<div class="line"><a id="l03224" name="l03224"></a><span class="lineno"> 3224</span><span class="comment">!  use comozp,       only: cplos, cplol</span></div>
<div class="line"><a id="l03225" name="l03225"></a><span class="lineno"> 3225</span><span class="comment">!  use pmgrid,       only: masterproc, plev, plevp</span></div>
<div class="line"><a id="l03226" name="l03226"></a><span class="lineno"> 3226</span><span class="comment">!  use radae,        only: radaeini</span></div>
<div class="line"><a id="l03227" name="l03227"></a><span class="lineno"> 3227</span><span class="comment">!  use physconst,    only: mwdry, mwco2</span></div>
<div class="line"><a id="l03228" name="l03228"></a><span class="lineno"> 3228</span><span class="preprocessor">#if ( defined SPMD )</span></div>
<div class="line"><a id="l03229" name="l03229"></a><span class="lineno"> 3229</span><span class="preprocessor"></span><span class="comment">!   use mpishorthand</span></div>
<div class="line"><a id="l03230" name="l03230"></a><span class="lineno"> 3230</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l03231" name="l03231"></a><span class="lineno"> 3231</span><span class="preprocessor"></span>   <span class="keywordtype">implicit none</span></div>
<div class="line"><a id="l03232" name="l03232"></a><span class="lineno"> 3232</span> </div>
<div class="line"><a id="l03233" name="l03233"></a><span class="lineno"> 3233</span><span class="comment">!------------------------------Arguments--------------------------------</span></div>
<div class="line"><a id="l03234" name="l03234"></a><span class="lineno"> 3234</span><span class="comment">!</span></div>
<div class="line"><a id="l03235" name="l03235"></a><span class="lineno"> 3235</span><span class="comment">! Input arguments</span></div>
<div class="line"><a id="l03236" name="l03236"></a><span class="lineno"> 3236</span><span class="comment">!</span></div>
<div class="line"><a id="l03237" name="l03237"></a><span class="lineno"> 3237</span><span class="keywordtype">   real</span>, <span class="keywordtype">intent(in)</span> :: gravx      <span class="comment">! Acceleration of gravity (MKS)</span></div>
<div class="line"><a id="l03238" name="l03238"></a><span class="lineno"> 3238</span><span class="keywordtype">   real</span>, <span class="keywordtype">intent(in)</span> :: cpairx     <span class="comment">! Specific heat of dry air (MKS)</span></div>
<div class="line"><a id="l03239" name="l03239"></a><span class="lineno"> 3239</span><span class="keywordtype">   real</span>, <span class="keywordtype">intent(in)</span> :: epsilox    <span class="comment">! Ratio of mol. wght of H2O to dry air</span></div>
<div class="line"><a id="l03240" name="l03240"></a><span class="lineno"> 3240</span><span class="keywordtype">   real</span>, <span class="keywordtype">intent(in)</span> :: stebolx    <span class="comment">! Stefan-Boltzmann&#39;s constant (MKS)</span></div>
<div class="line"><a id="l03241" name="l03241"></a><span class="lineno"> 3241</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: pstdx      <span class="comment">! Standard pressure (Pascals)</span></div>
<div class="line"><a id="l03242" name="l03242"></a><span class="lineno"> 3242</span><span class="comment">!</span></div>
<div class="line"><a id="l03243" name="l03243"></a><span class="lineno"> 3243</span><span class="comment">!---------------------------Local variables-----------------------------</span></div>
<div class="line"><a id="l03244" name="l03244"></a><span class="lineno"> 3244</span><span class="comment">!</span></div>
<div class="line"><a id="l03245" name="l03245"></a><span class="lineno"> 3245</span>   <span class="keywordtype">integer</span> k       <span class="comment">! Loop variable</span></div>
<div class="line"><a id="l03246" name="l03246"></a><span class="lineno"> 3246</span> </div>
<div class="line"><a id="l03247" name="l03247"></a><span class="lineno"> 3247</span><span class="keywordtype">   real</span>(r8) v0         <span class="comment">! Volume of a gas at stp (m**3/kmol)</span></div>
<div class="line"><a id="l03248" name="l03248"></a><span class="lineno"> 3248</span><span class="keywordtype">   real</span>(r8) p0         <span class="comment">! Standard pressure (pascals)</span></div>
<div class="line"><a id="l03249" name="l03249"></a><span class="lineno"> 3249</span><span class="keywordtype">   real</span>(r8) amd        <span class="comment">! Effective molecular weight of dry air (kg/kmol)</span></div>
<div class="line"><a id="l03250" name="l03250"></a><span class="lineno"> 3250</span><span class="keywordtype">   real</span>(r8) goz        <span class="comment">! Acceleration of gravity (m/s**2)</span></div>
<div class="line"><a id="l03251" name="l03251"></a><span class="lineno"> 3251</span><span class="comment">!</span></div>
<div class="line"><a id="l03252" name="l03252"></a><span class="lineno"> 3252</span><span class="comment">!-----------------------------------------------------------------------</span></div>
<div class="line"><a id="l03253" name="l03253"></a><span class="lineno"> 3253</span><span class="comment">!</span></div>
<div class="line"><a id="l03254" name="l03254"></a><span class="lineno"> 3254</span><span class="comment">! Set general radiation consts; convert to cgs units where appropriate:</span></div>
<div class="line"><a id="l03255" name="l03255"></a><span class="lineno"> 3255</span><span class="comment">!</span></div>
<div class="line"><a id="l03256" name="l03256"></a><span class="lineno"> 3256</span>   <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ad3f1a3043da7349342bf4f8b0f4178af">gravit</a>  =  100.*gravx</div>
<div class="line"><a id="l03257" name="l03257"></a><span class="lineno"> 3257</span>   <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a02a6fd3379ca9f88aedc856917d393ee">rga</a>     =  1./<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ad3f1a3043da7349342bf4f8b0f4178af">gravit</a></div>
<div class="line"><a id="l03258" name="l03258"></a><span class="lineno"> 3258</span>   <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a89418dd7797528310a5f90613aad0804">gravmks</a> =  gravx</div>
<div class="line"><a id="l03259" name="l03259"></a><span class="lineno"> 3259</span>   <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a601da5d1916ef5ff2acfdbd3e6631643">cpair</a>   =  1.e4*cpairx</div>
<div class="line"><a id="l03260" name="l03260"></a><span class="lineno"> 3260</span>   <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ad1a3c3e4002c37ba64642c27d7b963ba">epsilo</a>  =  epsilox</div>
<div class="line"><a id="l03261" name="l03261"></a><span class="lineno"> 3261</span>   <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#aedb55b03e1395012ec29e1914a2df7cc">sslp</a>    =  1.013250e6</div>
<div class="line"><a id="l03262" name="l03262"></a><span class="lineno"> 3262</span>   <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a1d3aedbb07ddd76fbe919f80ad7d8f40">stebol</a>  =  1.e3*stebolx</div>
<div class="line"><a id="l03263" name="l03263"></a><span class="lineno"> 3263</span>   <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#abc4231d9935087dc214c8a629167ff8c">rgsslp</a>  =  0.5/(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ad3f1a3043da7349342bf4f8b0f4178af">gravit</a>*<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#aedb55b03e1395012ec29e1914a2df7cc">sslp</a>)</div>
<div class="line"><a id="l03264" name="l03264"></a><span class="lineno"> 3264</span>   <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a3302213173442f385c5ddb46d252c41f">dpfo3</a>   =  2.5e-3</div>
<div class="line"><a id="l03265" name="l03265"></a><span class="lineno"> 3265</span>   <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a5e62f9ce314a5b32db8ca6283d47dda9">dpfco2</a>  =  5.0e-3</div>
<div class="line"><a id="l03266" name="l03266"></a><span class="lineno"> 3266</span>   <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a0f42e6165f18772a89612e762798b41e">dayspy</a>  =  365.</div>
<div class="line"><a id="l03267" name="l03267"></a><span class="lineno"> 3267</span>   <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#af11c957c451e4f7284f282c6424be96b">pie</a>     =  4.*atan(1.)</div>
<div class="line"><a id="l03268" name="l03268"></a><span class="lineno"> 3268</span><span class="comment">!</span></div>
<div class="line"><a id="l03269" name="l03269"></a><span class="lineno"> 3269</span><span class="comment">! Initialize ozone data.</span></div>
<div class="line"><a id="l03270" name="l03270"></a><span class="lineno"> 3270</span><span class="comment">!</span></div>
<div class="line"><a id="l03271" name="l03271"></a><span class="lineno"> 3271</span>   v0  = 22.4136         <span class="comment">! Volume of a gas at stp (m**3/kmol)</span></div>
<div class="line"><a id="l03272" name="l03272"></a><span class="lineno"> 3272</span>   p0  = 0.1*<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#aedb55b03e1395012ec29e1914a2df7cc">sslp</a>        <span class="comment">! Standard pressure (pascals)</span></div>
<div class="line"><a id="l03273" name="l03273"></a><span class="lineno"> 3273</span>   amd = 28.9644         <span class="comment">! Molecular weight of dry air (kg/kmol)</span></div>
<div class="line"><a id="l03274" name="l03274"></a><span class="lineno"> 3274</span>   goz = gravx           <span class="comment">! Acceleration of gravity (m/s**2)</span></div>
<div class="line"><a id="l03275" name="l03275"></a><span class="lineno"> 3275</span><span class="comment">!</span></div>
<div class="line"><a id="l03276" name="l03276"></a><span class="lineno"> 3276</span><span class="comment">! Constants for ozone path integrals (multiplication by 100 for unit</span></div>
<div class="line"><a id="l03277" name="l03277"></a><span class="lineno"> 3277</span><span class="comment">! conversion to cgs from mks):</span></div>
<div class="line"><a id="l03278" name="l03278"></a><span class="lineno"> 3278</span><span class="comment">!</span></div>
<div class="line"><a id="l03279" name="l03279"></a><span class="lineno"> 3279</span>   <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ab8a0687da829019bc834c68800c09a88">cplos</a> = v0/(amd*goz)       *100.0</div>
<div class="line"><a id="l03280" name="l03280"></a><span class="lineno"> 3280</span>   <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a9adf2e225e8f61abf989b024fd390325">cplol</a> = v0/(amd*goz*p0)*0.5*100.0</div>
<div class="line"><a id="l03281" name="l03281"></a><span class="lineno"> 3281</span><span class="comment">!</span></div>
<div class="line"><a id="l03282" name="l03282"></a><span class="lineno"> 3282</span><span class="comment">! Derived constants</span></div>
<div class="line"><a id="l03283" name="l03283"></a><span class="lineno"> 3283</span><span class="comment">! If the top model level is above ~90 km (0.1 Pa), set the top level to compute</span></div>
<div class="line"><a id="l03284" name="l03284"></a><span class="lineno"> 3284</span><span class="comment">! longwave cooling to about 80 km (1 Pa)</span></div>
<div class="line"><a id="l03285" name="l03285"></a><span class="lineno"> 3285</span><span class="comment">! WRF: assume top level &gt; 0.1 mb</span></div>
<div class="line"><a id="l03286" name="l03286"></a><span class="lineno"> 3286</span><span class="comment">!  if (hypm(1) .lt. 0.1) then</span></div>
<div class="line"><a id="l03287" name="l03287"></a><span class="lineno"> 3287</span><span class="comment">!     do k = 1, pver</span></div>
<div class="line"><a id="l03288" name="l03288"></a><span class="lineno"> 3288</span><span class="comment">!        if (hypm(k) .lt. 1.) ntoplw  = k</span></div>
<div class="line"><a id="l03289" name="l03289"></a><span class="lineno"> 3289</span><span class="comment">!     end do</span></div>
<div class="line"><a id="l03290" name="l03290"></a><span class="lineno"> 3290</span><span class="comment">!  else</span></div>
<div class="line"><a id="l03291" name="l03291"></a><span class="lineno"> 3291</span>      <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a1a12feb1033e5148328277eb0a083ab3">ntoplw</a> = 1</div>
<div class="line"><a id="l03292" name="l03292"></a><span class="lineno"> 3292</span><span class="comment">!  end if</span></div>
<div class="line"><a id="l03293" name="l03293"></a><span class="lineno"> 3293</span><span class="comment">!   if (masterproc) then</span></div>
<div class="line"><a id="l03294" name="l03294"></a><span class="lineno"> 3294</span><span class="comment">!     write (6,*) &#39;RADINI: ntoplw =&#39;,ntoplw, &#39; pressure:&#39;,hypm(ntoplw)</span></div>
<div class="line"><a id="l03295" name="l03295"></a><span class="lineno"> 3295</span><span class="comment">!   endif</span></div>
<div class="line"><a id="l03296" name="l03296"></a><span class="lineno"> 3296</span> </div>
<div class="line"><a id="l03297" name="l03297"></a><span class="lineno"> 3297</span>   <span class="keyword">call </span>radaeini( pstdx, <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a455077c905b075fb0c227ed4d0e73e09">mwdry</a>, <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a54962ae853da73335f745d7f188d8aa2">mwco2</a> )</div>
<div class="line"><a id="l03298" name="l03298"></a><span class="lineno"> 3298</span>   <span class="keywordflow">return</span></div>
<div class="line"><a id="l03299" name="l03299"></a><span class="lineno"> 3299</span><span class="keyword">end subroutine </span>radini</div>
<div class="line"><a id="l03300" name="l03300"></a><span class="lineno"> 3300</span> </div>
<div class="line"><a id="l03301" name="l03301"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#aa14a6045d01815132e40db9967b18602"> 3301</a></span><span class="keyword">subroutine </span>oznini(ozmixm,pin,levsiz,num_months,XLAT,                &amp;</div>
<div class="line"><a id="l03302" name="l03302"></a><span class="lineno"> 3302</span>                     ids, ide, jds, jde, kds, kde,                  &amp;</div>
<div class="line"><a id="l03303" name="l03303"></a><span class="lineno"> 3303</span>                     ims, ime, jms, jme, kms, kme,                  &amp;</div>
<div class="line"><a id="l03304" name="l03304"></a><span class="lineno"> 3304</span>                     its, ite, jts, jte, kts, kte)</div>
<div class="line"><a id="l03305" name="l03305"></a><span class="lineno"> 3305</span><span class="comment">!</span></div>
<div class="line"><a id="l03306" name="l03306"></a><span class="lineno"> 3306</span><span class="comment">! This subroutine assumes uniform distribution of ozone concentration.</span></div>
<div class="line"><a id="l03307" name="l03307"></a><span class="lineno"> 3307</span><span class="comment">! It should be replaced by monthly climatology that varies latitudinally and vertically</span></div>
<div class="line"><a id="l03308" name="l03308"></a><span class="lineno"> 3308</span><span class="comment">!</span></div>
<div class="line"><a id="l03309" name="l03309"></a><span class="lineno"> 3309</span> </div>
<div class="line"><a id="l03310" name="l03310"></a><span class="lineno"> 3310</span>      <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"><a id="l03311" name="l03311"></a><span class="lineno"> 3311</span> </div>
<div class="line"><a id="l03312" name="l03312"></a><span class="lineno"> 3312</span>   <span class="keywordtype">INTEGER</span>,      <span class="keywordtype">INTENT(IN   )</span>    ::   ids,ide, jds,jde, kds,kde, &amp;</div>
<div class="line"><a id="l03313" name="l03313"></a><span class="lineno"> 3313</span>                                       ims,ime, jms,jme, kms,kme, &amp;</div>
<div class="line"><a id="l03314" name="l03314"></a><span class="lineno"> 3314</span>                                       its,ite, jts,jte, kts,kte   </div>
<div class="line"><a id="l03315" name="l03315"></a><span class="lineno"> 3315</span> </div>
<div class="line"><a id="l03316" name="l03316"></a><span class="lineno"> 3316</span>   <span class="keywordtype">INTEGER</span>,      <span class="keywordtype">INTENT(IN   )</span>    ::   levsiz, num_months</div>
<div class="line"><a id="l03317" name="l03317"></a><span class="lineno"> 3317</span> </div>
<div class="line"><a id="l03318" name="l03318"></a><span class="lineno"> 3318</span><span class="keywordtype">   REAL</span>,  <span class="keywordtype">DIMENSION( ims:ime, jms:jme )</span>, <span class="keywordtype">INTENT(IN   )</span>  ::     XLAT</div>
<div class="line"><a id="l03319" name="l03319"></a><span class="lineno"> 3319</span> </div>
<div class="line"><a id="l03320" name="l03320"></a><span class="lineno"> 3320</span><span class="keywordtype">   REAL</span>,  <span class="keywordtype">DIMENSION( ims:ime, levsiz, jms:jme, num_months )</span>,      &amp;</div>
<div class="line"><a id="l03321" name="l03321"></a><span class="lineno"> 3321</span>          <span class="keywordtype">INTENT(OUT   )</span> ::                                  OZMIXM</div>
<div class="line"><a id="l03322" name="l03322"></a><span class="lineno"> 3322</span> </div>
<div class="line"><a id="l03323" name="l03323"></a><span class="lineno"> 3323</span><span class="keywordtype">   REAL</span>,  <span class="keywordtype">DIMENSION(levsiz)</span>, <span class="keywordtype">INTENT(OUT )</span>  ::                   PIN</div>
<div class="line"><a id="l03324" name="l03324"></a><span class="lineno"> 3324</span> </div>
<div class="line"><a id="l03325" name="l03325"></a><span class="lineno"> 3325</span><span class="comment">! Local</span></div>
<div class="line"><a id="l03326" name="l03326"></a><span class="lineno"> 3326</span>   <span class="keywordtype">INTEGER</span>, <span class="keywordtype">PARAMETER</span> :: latsiz = 64</div>
<div class="line"><a id="l03327" name="l03327"></a><span class="lineno"> 3327</span>   <span class="keywordtype">INTEGER</span>, <span class="keywordtype">PARAMETER</span> :: lonsiz = 1</div>
<div class="line"><a id="l03328" name="l03328"></a><span class="lineno"> 3328</span>   <span class="keywordtype">INTEGER</span> :: i, j, k, itf, jtf, ktf, m, pin_unit, lat_unit, oz_unit</div>
<div class="line"><a id="l03329" name="l03329"></a><span class="lineno"> 3329</span><span class="keywordtype">   REAL</span>    :: interp_pt</div>
<div class="line"><a id="l03330" name="l03330"></a><span class="lineno"> 3330</span>   <span class="keywordtype">CHARACTER*256</span> :: message</div>
<div class="line"><a id="l03331" name="l03331"></a><span class="lineno"> 3331</span> </div>
<div class="line"><a id="l03332" name="l03332"></a><span class="lineno"> 3332</span><span class="keywordtype">   REAL</span>,  <span class="keywordtype">DIMENSION( lonsiz, levsiz, latsiz, num_months )</span>    ::   &amp;</div>
<div class="line"><a id="l03333" name="l03333"></a><span class="lineno"> 3333</span>                                                            OZMIXIN</div>
<div class="line"><a id="l03334" name="l03334"></a><span class="lineno"> 3334</span> </div>
<div class="line"><a id="l03335" name="l03335"></a><span class="lineno"> 3335</span><span class="keywordtype">   REAL</span>,  <span class="keywordtype">DIMENSION(latsiz)</span>                ::             lat_ozone</div>
<div class="line"><a id="l03336" name="l03336"></a><span class="lineno"> 3336</span> </div>
<div class="line"><a id="l03337" name="l03337"></a><span class="lineno"> 3337</span>   jtf=min0(jte,jde-1)</div>
<div class="line"><a id="l03338" name="l03338"></a><span class="lineno"> 3338</span>   ktf=min0(kte,kde-1)</div>
<div class="line"><a id="l03339" name="l03339"></a><span class="lineno"> 3339</span>   itf=min0(ite,ide-1)</div>
<div class="line"><a id="l03340" name="l03340"></a><span class="lineno"> 3340</span> </div>
<div class="line"><a id="l03341" name="l03341"></a><span class="lineno"> 3341</span> </div>
<div class="line"><a id="l03342" name="l03342"></a><span class="lineno"> 3342</span><span class="comment">!-- read in ozone pressure data</span></div>
<div class="line"><a id="l03343" name="l03343"></a><span class="lineno"> 3343</span> </div>
<div class="line"><a id="l03344" name="l03344"></a><span class="lineno"> 3344</span>     <span class="keyword">WRITE</span>(message,*)<span class="stringliteral">&#39;num_months = &#39;</span>,num_months</div>
<div class="line"><a id="l03345" name="l03345"></a><span class="lineno"> 3345</span>     <span class="keyword">CALL </span>wrf_debug(50,message)</div>
<div class="line"><a id="l03346" name="l03346"></a><span class="lineno"> 3346</span> </div>
<div class="line"><a id="l03347" name="l03347"></a><span class="lineno"> 3347</span>      pin_unit = 27</div>
<div class="line"><a id="l03348" name="l03348"></a><span class="lineno"> 3348</span>        <span class="keyword">OPEN</span>(pin_unit, file=<span class="stringliteral">&#39;ozone_plev.formatted&#39;</span>,form=<span class="stringliteral">&#39;FORMATTED&#39;</span>,status=<span class="stringliteral">&#39;OLD&#39;</span>)</div>
<div class="line"><a id="l03349" name="l03349"></a><span class="lineno"> 3349</span>        <span class="keywordflow">do</span> k = 1,levsiz</div>
<div class="line"><a id="l03350" name="l03350"></a><span class="lineno"> 3350</span>        <span class="keyword">READ</span> (pin_unit,*)pin(k)</div>
<div class="line"><a id="l03351" name="l03351"></a><span class="lineno"> 3351</span><span class="keywordflow">        end do</span></div>
<div class="line"><a id="l03352" name="l03352"></a><span class="lineno"> 3352</span>      <span class="keyword">close</span>(27)</div>
<div class="line"><a id="l03353" name="l03353"></a><span class="lineno"> 3353</span> </div>
<div class="line"><a id="l03354" name="l03354"></a><span class="lineno"> 3354</span>      <span class="keywordflow">do</span> k=1,levsiz</div>
<div class="line"><a id="l03355" name="l03355"></a><span class="lineno"> 3355</span>        pin(k) = pin(k)*100.</div>
<div class="line"><a id="l03356" name="l03356"></a><span class="lineno"> 3356</span><span class="keywordflow">      end do</span></div>
<div class="line"><a id="l03357" name="l03357"></a><span class="lineno"> 3357</span> </div>
<div class="line"><a id="l03358" name="l03358"></a><span class="lineno"> 3358</span><span class="comment">!-- read in ozone lat data</span></div>
<div class="line"><a id="l03359" name="l03359"></a><span class="lineno"> 3359</span> </div>
<div class="line"><a id="l03360" name="l03360"></a><span class="lineno"> 3360</span>      lat_unit = 28</div>
<div class="line"><a id="l03361" name="l03361"></a><span class="lineno"> 3361</span>        <span class="keyword">OPEN</span>(lat_unit, file=<span class="stringliteral">&#39;ozone_lat.formatted&#39;</span>,form=<span class="stringliteral">&#39;FORMATTED&#39;</span>,status=<span class="stringliteral">&#39;OLD&#39;</span>)</div>
<div class="line"><a id="l03362" name="l03362"></a><span class="lineno"> 3362</span>        <span class="keywordflow">do</span> j = 1,latsiz</div>
<div class="line"><a id="l03363" name="l03363"></a><span class="lineno"> 3363</span>        <span class="keyword">READ</span> (lat_unit,*)lat_ozone(j)</div>
<div class="line"><a id="l03364" name="l03364"></a><span class="lineno"> 3364</span><span class="keywordflow">        end do</span></div>
<div class="line"><a id="l03365" name="l03365"></a><span class="lineno"> 3365</span>      <span class="keyword">close</span>(28)</div>
<div class="line"><a id="l03366" name="l03366"></a><span class="lineno"> 3366</span> </div>
<div class="line"><a id="l03367" name="l03367"></a><span class="lineno"> 3367</span> </div>
<div class="line"><a id="l03368" name="l03368"></a><span class="lineno"> 3368</span><span class="comment">!-- read in ozone data</span></div>
<div class="line"><a id="l03369" name="l03369"></a><span class="lineno"> 3369</span> </div>
<div class="line"><a id="l03370" name="l03370"></a><span class="lineno"> 3370</span>      oz_unit = 29</div>
<div class="line"><a id="l03371" name="l03371"></a><span class="lineno"> 3371</span>      <span class="keyword">OPEN</span>(oz_unit, file=<span class="stringliteral">&#39;ozone.formatted&#39;</span>,form=<span class="stringliteral">&#39;FORMATTED&#39;</span>,status=<span class="stringliteral">&#39;OLD&#39;</span>)</div>
<div class="line"><a id="l03372" name="l03372"></a><span class="lineno"> 3372</span> </div>
<div class="line"><a id="l03373" name="l03373"></a><span class="lineno"> 3373</span>      <span class="keywordflow">do</span> m=2,num_months</div>
<div class="line"><a id="l03374" name="l03374"></a><span class="lineno"> 3374</span>      <span class="keywordflow">do</span> j=1,latsiz <span class="comment">! latsiz=64</span></div>
<div class="line"><a id="l03375" name="l03375"></a><span class="lineno"> 3375</span>      <span class="keywordflow">do</span> k=1,levsiz <span class="comment">! levsiz=59</span></div>
<div class="line"><a id="l03376" name="l03376"></a><span class="lineno"> 3376</span>      <span class="keywordflow">do</span> i=1,lonsiz <span class="comment">! lonsiz=1</span></div>
<div class="line"><a id="l03377" name="l03377"></a><span class="lineno"> 3377</span>        <span class="keyword">READ</span> (oz_unit,*)ozmixin(i,k,j,m)</div>
<div class="line"><a id="l03378" name="l03378"></a><span class="lineno"> 3378</span><span class="keywordflow">      enddo</span></div>
<div class="line"><a id="l03379" name="l03379"></a><span class="lineno"> 3379</span><span class="keywordflow">      enddo</span></div>
<div class="line"><a id="l03380" name="l03380"></a><span class="lineno"> 3380</span><span class="keywordflow">      enddo</span></div>
<div class="line"><a id="l03381" name="l03381"></a><span class="lineno"> 3381</span><span class="keywordflow">      enddo</span></div>
<div class="line"><a id="l03382" name="l03382"></a><span class="lineno"> 3382</span>      <span class="keyword">close</span>(29)</div>
<div class="line"><a id="l03383" name="l03383"></a><span class="lineno"> 3383</span> </div>
<div class="line"><a id="l03384" name="l03384"></a><span class="lineno"> 3384</span> </div>
<div class="line"><a id="l03385" name="l03385"></a><span class="lineno"> 3385</span><span class="comment">!-- latitudinally interpolate ozone data (and extend longitudinally)</span></div>
<div class="line"><a id="l03386" name="l03386"></a><span class="lineno"> 3386</span><span class="comment">!-- using function lin_interpol2(x, f, y) result(g)</span></div>
<div class="line"><a id="l03387" name="l03387"></a><span class="lineno"> 3387</span><span class="comment">! Purpose:</span></div>
<div class="line"><a id="l03388" name="l03388"></a><span class="lineno"> 3388</span><span class="comment">!   interpolates f(x) to point y</span></div>
<div class="line"><a id="l03389" name="l03389"></a><span class="lineno"> 3389</span><span class="comment">!   assuming f(x) = f(x0) + a * (x - x0)</span></div>
<div class="line"><a id="l03390" name="l03390"></a><span class="lineno"> 3390</span><span class="comment">!   where a = ( f(x1) - f(x0) ) / (x1 - x0)</span></div>
<div class="line"><a id="l03391" name="l03391"></a><span class="lineno"> 3391</span><span class="comment">!   x0 &lt;= x &lt;= x1</span></div>
<div class="line"><a id="l03392" name="l03392"></a><span class="lineno"> 3392</span><span class="comment">!   assumes x is monotonically increasing</span></div>
<div class="line"><a id="l03393" name="l03393"></a><span class="lineno"> 3393</span><span class="comment">!    real, intent(in), dimension(:) :: x  ! grid points</span></div>
<div class="line"><a id="l03394" name="l03394"></a><span class="lineno"> 3394</span><span class="comment">!    real, intent(in), dimension(:) :: f  ! grid function values</span></div>
<div class="line"><a id="l03395" name="l03395"></a><span class="lineno"> 3395</span><span class="comment">!    real, intent(in) :: y                ! interpolation point</span></div>
<div class="line"><a id="l03396" name="l03396"></a><span class="lineno"> 3396</span><span class="comment">!    real :: g                            ! interpolated function value</span></div>
<div class="line"><a id="l03397" name="l03397"></a><span class="lineno"> 3397</span><span class="comment">!---------------------------------------------------------------------------</span></div>
<div class="line"><a id="l03398" name="l03398"></a><span class="lineno"> 3398</span> </div>
<div class="line"><a id="l03399" name="l03399"></a><span class="lineno"> 3399</span>      <span class="keywordflow">do</span> m=2,num_months</div>
<div class="line"><a id="l03400" name="l03400"></a><span class="lineno"> 3400</span>      <span class="keywordflow">do</span> j=jts,jtf</div>
<div class="line"><a id="l03401" name="l03401"></a><span class="lineno"> 3401</span>      <span class="keywordflow">do</span> k=1,levsiz</div>
<div class="line"><a id="l03402" name="l03402"></a><span class="lineno"> 3402</span>      <span class="keywordflow">do</span> i=its,itf</div>
<div class="line"><a id="l03403" name="l03403"></a><span class="lineno"> 3403</span>         interp_pt=xlat(i,j)</div>
<div class="line"><a id="l03404" name="l03404"></a><span class="lineno"> 3404</span>         ozmixm(i,k,j,m)=<a class="code hl_function" href="namespacemodule__ra__cam__support.html#a0a9ae8d88dbd86e1bed5948a3bc5224e">lin_interpol2</a>(lat_ozone(:),ozmixin(1,k,:,m),interp_pt)</div>
<div class="line"><a id="l03405" name="l03405"></a><span class="lineno"> 3405</span><span class="keywordflow">      enddo</span></div>
<div class="line"><a id="l03406" name="l03406"></a><span class="lineno"> 3406</span><span class="keywordflow">      enddo</span></div>
<div class="line"><a id="l03407" name="l03407"></a><span class="lineno"> 3407</span><span class="keywordflow">      enddo</span></div>
<div class="line"><a id="l03408" name="l03408"></a><span class="lineno"> 3408</span><span class="keywordflow">      enddo</span></div>
<div class="line"><a id="l03409" name="l03409"></a><span class="lineno"> 3409</span> </div>
<div class="line"><a id="l03410" name="l03410"></a><span class="lineno"> 3410</span><span class="comment">! Old code for fixed ozone</span></div>
<div class="line"><a id="l03411" name="l03411"></a><span class="lineno"> 3411</span> </div>
<div class="line"><a id="l03412" name="l03412"></a><span class="lineno"> 3412</span><span class="comment">!     pin(1)=70.</span></div>
<div class="line"><a id="l03413" name="l03413"></a><span class="lineno"> 3413</span><span class="comment">!     DO k=2,levsiz</span></div>
<div class="line"><a id="l03414" name="l03414"></a><span class="lineno"> 3414</span><span class="comment">!     pin(k)=pin(k-1)+16.</span></div>
<div class="line"><a id="l03415" name="l03415"></a><span class="lineno"> 3415</span><span class="comment">!     ENDDO</span></div>
<div class="line"><a id="l03416" name="l03416"></a><span class="lineno"> 3416</span> </div>
<div class="line"><a id="l03417" name="l03417"></a><span class="lineno"> 3417</span><span class="comment">!     DO k=1,levsiz</span></div>
<div class="line"><a id="l03418" name="l03418"></a><span class="lineno"> 3418</span><span class="comment">!         pin(k) = pin(k)*100.</span></div>
<div class="line"><a id="l03419" name="l03419"></a><span class="lineno"> 3419</span><span class="comment">!     end do</span></div>
<div class="line"><a id="l03420" name="l03420"></a><span class="lineno"> 3420</span> </div>
<div class="line"><a id="l03421" name="l03421"></a><span class="lineno"> 3421</span><span class="comment">!     DO m=1,num_months</span></div>
<div class="line"><a id="l03422" name="l03422"></a><span class="lineno"> 3422</span><span class="comment">!     DO j=jts,jtf</span></div>
<div class="line"><a id="l03423" name="l03423"></a><span class="lineno"> 3423</span><span class="comment">!     DO i=its,itf</span></div>
<div class="line"><a id="l03424" name="l03424"></a><span class="lineno"> 3424</span><span class="comment">!     DO k=1,2</span></div>
<div class="line"><a id="l03425" name="l03425"></a><span class="lineno"> 3425</span><span class="comment">!      ozmixm(i,k,j,m)=1.e-6</span></div>
<div class="line"><a id="l03426" name="l03426"></a><span class="lineno"> 3426</span><span class="comment">!     ENDDO</span></div>
<div class="line"><a id="l03427" name="l03427"></a><span class="lineno"> 3427</span><span class="comment">!     DO k=3,levsiz</span></div>
<div class="line"><a id="l03428" name="l03428"></a><span class="lineno"> 3428</span><span class="comment">!      ozmixm(i,k,j,m)=1.e-7</span></div>
<div class="line"><a id="l03429" name="l03429"></a><span class="lineno"> 3429</span><span class="comment">!     ENDDO</span></div>
<div class="line"><a id="l03430" name="l03430"></a><span class="lineno"> 3430</span><span class="comment">!     ENDDO</span></div>
<div class="line"><a id="l03431" name="l03431"></a><span class="lineno"> 3431</span><span class="comment">!     ENDDO</span></div>
<div class="line"><a id="l03432" name="l03432"></a><span class="lineno"> 3432</span><span class="comment">!     ENDDO</span></div>
<div class="line"><a id="l03433" name="l03433"></a><span class="lineno"> 3433</span> </div>
<div class="line"><a id="l03434" name="l03434"></a><span class="lineno"> 3434</span><span class="keyword">END SUBROUTINE </span>oznini</div>
<div class="line"><a id="l03435" name="l03435"></a><span class="lineno"> 3435</span> </div>
<div class="line"><a id="l03436" name="l03436"></a><span class="lineno"> 3436</span> </div>
<div class="line"><a id="l03437" name="l03437"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a594e59b89f09fc37dd2f002f72e2c03c"> 3437</a></span><span class="keyword">subroutine </span>aerosol_init(m_psp,m_psn,m_hybi,aerosolcp,aerosolcn,paerlev,naer_c,shalf,pptop,    &amp;</div>
<div class="line"><a id="l03438" name="l03438"></a><span class="lineno"> 3438</span>                     ids, ide, jds, jde, kds, kde,                  &amp;</div>
<div class="line"><a id="l03439" name="l03439"></a><span class="lineno"> 3439</span>                     ims, ime, jms, jme, kms, kme,                  &amp;</div>
<div class="line"><a id="l03440" name="l03440"></a><span class="lineno"> 3440</span>                     its, ite, jts, jte, kts, kte)</div>
<div class="line"><a id="l03441" name="l03441"></a><span class="lineno"> 3441</span><span class="comment">!</span></div>
<div class="line"><a id="l03442" name="l03442"></a><span class="lineno"> 3442</span><span class="comment">!  This subroutine assumes a uniform aerosol distribution in both time and space.</span></div>
<div class="line"><a id="l03443" name="l03443"></a><span class="lineno"> 3443</span><span class="comment">!  It should be modified if aerosol data are available from WRF-CHEM or other sources</span></div>
<div class="line"><a id="l03444" name="l03444"></a><span class="lineno"> 3444</span><span class="comment">!</span></div>
<div class="line"><a id="l03445" name="l03445"></a><span class="lineno"> 3445</span>      <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"><a id="l03446" name="l03446"></a><span class="lineno"> 3446</span> </div>
<div class="line"><a id="l03447" name="l03447"></a><span class="lineno"> 3447</span>   <span class="keywordtype">INTEGER</span>,      <span class="keywordtype">INTENT(IN   )</span>    ::   ids,ide, jds,jde, kds,kde, &amp;</div>
<div class="line"><a id="l03448" name="l03448"></a><span class="lineno"> 3448</span>                                       ims,ime, jms,jme, kms,kme, &amp;</div>
<div class="line"><a id="l03449" name="l03449"></a><span class="lineno"> 3449</span>                                       its,ite, jts,jte, kts,kte</div>
<div class="line"><a id="l03450" name="l03450"></a><span class="lineno"> 3450</span> </div>
<div class="line"><a id="l03451" name="l03451"></a><span class="lineno"> 3451</span>   <span class="keywordtype">INTEGER</span>,      <span class="keywordtype">INTENT(IN   )</span>    ::   paerlev,naer_c </div>
<div class="line"><a id="l03452" name="l03452"></a><span class="lineno"> 3452</span> </div>
<div class="line"><a id="l03453" name="l03453"></a><span class="lineno"> 3453</span><span class="keywordtype">   REAL</span>,     <span class="keywordtype">intent(in)</span>                        :: pptop</div>
<div class="line"><a id="l03454" name="l03454"></a><span class="lineno"> 3454</span><span class="keywordtype">   REAL</span>,     <span class="keywordtype">DIMENSION( kms:kme )</span>, <span class="keywordtype">intent(in)</span>  :: shalf</div>
<div class="line"><a id="l03455" name="l03455"></a><span class="lineno"> 3455</span> </div>
<div class="line"><a id="l03456" name="l03456"></a><span class="lineno"> 3456</span><span class="keywordtype">   REAL</span>,  <span class="keywordtype">DIMENSION( ims:ime, paerlev, jms:jme, naer_c )</span>,      &amp;</div>
<div class="line"><a id="l03457" name="l03457"></a><span class="lineno"> 3457</span>          <span class="keywordtype">INTENT(INOUT   )</span> ::                                  aerosolcn , aerosolcp</div>
<div class="line"><a id="l03458" name="l03458"></a><span class="lineno"> 3458</span> </div>
<div class="line"><a id="l03459" name="l03459"></a><span class="lineno"> 3459</span><span class="keywordtype">   REAL</span>,  <span class="keywordtype">DIMENSION(paerlev)</span>, <span class="keywordtype">INTENT(OUT )</span>  ::                m_hybi</div>
<div class="line"><a id="l03460" name="l03460"></a><span class="lineno"> 3460</span><span class="keywordtype">   REAL</span>,  <span class="keywordtype">DIMENSION( ims:ime, jms:jme)</span>,  <span class="keywordtype">INTENT(OUT )</span>  ::       m_psp,m_psn </div>
<div class="line"><a id="l03461" name="l03461"></a><span class="lineno"> 3461</span> </div>
<div class="line"><a id="l03462" name="l03462"></a><span class="lineno"> 3462</span><span class="keywordtype">   REAL</span> ::                                                      psurf</div>
<div class="line"><a id="l03463" name="l03463"></a><span class="lineno"> 3463</span><span class="keywordtype">   real</span>, <span class="keywordtype">dimension(29)</span> :: hybi  </div>
<div class="line"><a id="l03464" name="l03464"></a><span class="lineno"> 3464</span>   <span class="keywordtype">integer</span> k <span class="comment">! index through vertical levels</span></div>
<div class="line"><a id="l03465" name="l03465"></a><span class="lineno"> 3465</span> </div>
<div class="line"><a id="l03466" name="l03466"></a><span class="lineno"> 3466</span>   <span class="keywordtype">INTEGER</span> :: i, j, itf, jtf, ktf,m</div>
<div class="line"><a id="l03467" name="l03467"></a><span class="lineno"> 3467</span> </div>
<div class="line"><a id="l03468" name="l03468"></a><span class="lineno"> 3468</span>   <span class="keyword">data</span> hybi/0, 0.0065700002014637, 0.0138600002974272, 0.023089999333024, &amp;</div>
<div class="line"><a id="l03469" name="l03469"></a><span class="lineno"> 3469</span>    0.0346900001168251, 0.0491999983787537, 0.0672300010919571,      &amp;</div>
<div class="line"><a id="l03470" name="l03470"></a><span class="lineno"> 3470</span>     0.0894500017166138, 0.116539999842644, 0.149159997701645,       &amp;</div>
<div class="line"><a id="l03471" name="l03471"></a><span class="lineno"> 3471</span>    0.187830001115799, 0.232859998941422, 0.284209996461868,         &amp;</div>
<div class="line"><a id="l03472" name="l03472"></a><span class="lineno"> 3472</span>    0.341369986534119, 0.403340011835098, 0.468600004911423,         &amp;</div>
<div class="line"><a id="l03473" name="l03473"></a><span class="lineno"> 3473</span>    0.535290002822876, 0.601350009441376, 0.66482001543045,          &amp;</div>
<div class="line"><a id="l03474" name="l03474"></a><span class="lineno"> 3474</span>    0.724009990692139, 0.777729988098145, 0.825269997119904,         &amp; </div>
<div class="line"><a id="l03475" name="l03475"></a><span class="lineno"> 3475</span>    0.866419970989227, 0.901350021362305, 0.930540025234222,         &amp; </div>
<div class="line"><a id="l03476" name="l03476"></a><span class="lineno"> 3476</span>    0.954590022563934, 0.974179983139038, 0.990000009536743, 1/</div>
<div class="line"><a id="l03477" name="l03477"></a><span class="lineno"> 3477</span> </div>
<div class="line"><a id="l03478" name="l03478"></a><span class="lineno"> 3478</span>   jtf=min0(jte,jde-1)</div>
<div class="line"><a id="l03479" name="l03479"></a><span class="lineno"> 3479</span>   ktf=min0(kte,kde-1)</div>
<div class="line"><a id="l03480" name="l03480"></a><span class="lineno"> 3480</span>   itf=min0(ite,ide-1)</div>
<div class="line"><a id="l03481" name="l03481"></a><span class="lineno"> 3481</span> </div>
<div class="line"><a id="l03482" name="l03482"></a><span class="lineno"> 3482</span>    <span class="keywordflow">do</span> k=1,paerlev</div>
<div class="line"><a id="l03483" name="l03483"></a><span class="lineno"> 3483</span>      m_hybi(k)=hybi(k)</div>
<div class="line"><a id="l03484" name="l03484"></a><span class="lineno"> 3484</span><span class="keywordflow">    enddo</span></div>
<div class="line"><a id="l03485" name="l03485"></a><span class="lineno"> 3485</span> </div>
<div class="line"><a id="l03486" name="l03486"></a><span class="lineno"> 3486</span><span class="comment">!</span></div>
<div class="line"><a id="l03487" name="l03487"></a><span class="lineno"> 3487</span><span class="comment">! mxaerl = max number of levels (from bottom) for background aerosol</span></div>
<div class="line"><a id="l03488" name="l03488"></a><span class="lineno"> 3488</span><span class="comment">! Limit background aerosol height to regions below 900 mb</span></div>
<div class="line"><a id="l03489" name="l03489"></a><span class="lineno"> 3489</span><span class="comment">!</span></div>
<div class="line"><a id="l03490" name="l03490"></a><span class="lineno"> 3490</span> </div>
<div class="line"><a id="l03491" name="l03491"></a><span class="lineno"> 3491</span>   psurf = 1.e05</div>
<div class="line"><a id="l03492" name="l03492"></a><span class="lineno"> 3492</span>   <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ab50efdf4518f1ed0df7adc0e8839b4bd">mxaerl</a> = 0</div>
<div class="line"><a id="l03493" name="l03493"></a><span class="lineno"> 3493</span><span class="comment">!  do k=pver,1,-1</span></div>
<div class="line"><a id="l03494" name="l03494"></a><span class="lineno"> 3494</span>   <span class="keywordflow">do</span> k=kms,kme-1</div>
<div class="line"><a id="l03495" name="l03495"></a><span class="lineno"> 3495</span><span class="comment">!     if (hypm(k) &gt;= 9.e4) mxaerl = mxaerl + 1</span></div>
<div class="line"><a id="l03496" name="l03496"></a><span class="lineno"> 3496</span>      <span class="keywordflow">if</span> (shalf(k)*psurf+pptop  &gt;= 9.e4) <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ab50efdf4518f1ed0df7adc0e8839b4bd">mxaerl</a> = <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ab50efdf4518f1ed0df7adc0e8839b4bd">mxaerl</a> + 1</div>
<div class="line"><a id="l03497" name="l03497"></a><span class="lineno"> 3497</span><span class="keywordflow">   end do</span></div>
<div class="line"><a id="l03498" name="l03498"></a><span class="lineno"> 3498</span>   <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ab50efdf4518f1ed0df7adc0e8839b4bd">mxaerl</a> = max(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ab50efdf4518f1ed0df7adc0e8839b4bd">mxaerl</a>,1)</div>
<div class="line"><a id="l03499" name="l03499"></a><span class="lineno"> 3499</span><span class="comment">!  if (masterproc) then</span></div>
<div class="line"><a id="l03500" name="l03500"></a><span class="lineno"> 3500</span>      <span class="keyword">write</span>(6,*)<span class="stringliteral">&#39;AEROSOLS:  Background aerosol will be limited to &#39;</span>, &amp;</div>
<div class="line"><a id="l03501" name="l03501"></a><span class="lineno"> 3501</span>                <span class="stringliteral">&#39;bottom &#39;</span>,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ab50efdf4518f1ed0df7adc0e8839b4bd">mxaerl</a>,<span class="stringliteral">&#39; model interfaces.&#39;</span></div>
<div class="line"><a id="l03502" name="l03502"></a><span class="lineno"> 3502</span><span class="comment">!               &#39;bottom &#39;,mxaerl,&#39; model interfaces. Top interface is &#39;, &amp;</span></div>
<div class="line"><a id="l03503" name="l03503"></a><span class="lineno"> 3503</span><span class="comment">!               hypi(pverp-mxaerl),&#39; pascals&#39;</span></div>
<div class="line"><a id="l03504" name="l03504"></a><span class="lineno"> 3504</span><span class="comment">!  end if</span></div>
<div class="line"><a id="l03505" name="l03505"></a><span class="lineno"> 3505</span> </div>
<div class="line"><a id="l03506" name="l03506"></a><span class="lineno"> 3506</span>     <span class="keywordflow">DO</span> j=jts,jtf</div>
<div class="line"><a id="l03507" name="l03507"></a><span class="lineno"> 3507</span>     <span class="keywordflow">DO</span> i=its,itf</div>
<div class="line"><a id="l03508" name="l03508"></a><span class="lineno"> 3508</span>      m_psp(i,j)=psurf</div>
<div class="line"><a id="l03509" name="l03509"></a><span class="lineno"> 3509</span>      m_psn(i,j)=psurf</div>
<div class="line"><a id="l03510" name="l03510"></a><span class="lineno"> 3510</span><span class="keywordflow">     ENDDO</span></div>
<div class="line"><a id="l03511" name="l03511"></a><span class="lineno"> 3511</span><span class="keywordflow">     ENDDO</span></div>
<div class="line"><a id="l03512" name="l03512"></a><span class="lineno"> 3512</span> </div>
<div class="line"><a id="l03513" name="l03513"></a><span class="lineno"> 3513</span>     <span class="keywordflow">DO</span> j=jts,jtf</div>
<div class="line"><a id="l03514" name="l03514"></a><span class="lineno"> 3514</span>     <span class="keywordflow">DO</span> i=its,itf</div>
<div class="line"><a id="l03515" name="l03515"></a><span class="lineno"> 3515</span>     <span class="keywordflow">DO</span> k=1,paerlev</div>
<div class="line"><a id="l03516" name="l03516"></a><span class="lineno"> 3516</span><span class="comment">! aerosolc arrays are upward cumulative (kg/m2) at each level</span></div>
<div class="line"><a id="l03517" name="l03517"></a><span class="lineno"> 3517</span><span class="comment">! Here we assume uniform vertical distribution (aerosolc linear with hybi)</span></div>
<div class="line"><a id="l03518" name="l03518"></a><span class="lineno"> 3518</span>      aerosolcp(i,k,j,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a863b1d9602abdd9946b40135690a4db5">idxsul</a>)=1.e-7*(1.-hybi(k))</div>
<div class="line"><a id="l03519" name="l03519"></a><span class="lineno"> 3519</span>      aerosolcn(i,k,j,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a863b1d9602abdd9946b40135690a4db5">idxsul</a>)=1.e-7*(1.-hybi(k))</div>
<div class="line"><a id="l03520" name="l03520"></a><span class="lineno"> 3520</span>      aerosolcp(i,k,j,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a521884c838130d3a7fce69511e4708a0">idxsslt</a>)=1.e-22*(1.-hybi(k))</div>
<div class="line"><a id="l03521" name="l03521"></a><span class="lineno"> 3521</span>      aerosolcn(i,k,j,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a521884c838130d3a7fce69511e4708a0">idxsslt</a>)=1.e-22*(1.-hybi(k))</div>
<div class="line"><a id="l03522" name="l03522"></a><span class="lineno"> 3522</span>      aerosolcp(i,k,j,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a130c6997ed212e28b4c576707a7e82ad">idxdustfirst</a>)=1.e-7*(1.-hybi(k))</div>
<div class="line"><a id="l03523" name="l03523"></a><span class="lineno"> 3523</span>      aerosolcn(i,k,j,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a130c6997ed212e28b4c576707a7e82ad">idxdustfirst</a>)=1.e-7*(1.-hybi(k))</div>
<div class="line"><a id="l03524" name="l03524"></a><span class="lineno"> 3524</span>      aerosolcp(i,k,j,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a130c6997ed212e28b4c576707a7e82ad">idxdustfirst</a>+1)=1.e-7*(1.-hybi(k))</div>
<div class="line"><a id="l03525" name="l03525"></a><span class="lineno"> 3525</span>      aerosolcn(i,k,j,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a130c6997ed212e28b4c576707a7e82ad">idxdustfirst</a>+1)=1.e-7*(1.-hybi(k))</div>
<div class="line"><a id="l03526" name="l03526"></a><span class="lineno"> 3526</span>      aerosolcp(i,k,j,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a130c6997ed212e28b4c576707a7e82ad">idxdustfirst</a>+2)=1.e-7*(1.-hybi(k))</div>
<div class="line"><a id="l03527" name="l03527"></a><span class="lineno"> 3527</span>      aerosolcn(i,k,j,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a130c6997ed212e28b4c576707a7e82ad">idxdustfirst</a>+2)=1.e-7*(1.-hybi(k))</div>
<div class="line"><a id="l03528" name="l03528"></a><span class="lineno"> 3528</span>      aerosolcp(i,k,j,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a130c6997ed212e28b4c576707a7e82ad">idxdustfirst</a>+3)=1.e-7*(1.-hybi(k))</div>
<div class="line"><a id="l03529" name="l03529"></a><span class="lineno"> 3529</span>      aerosolcn(i,k,j,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a130c6997ed212e28b4c576707a7e82ad">idxdustfirst</a>+3)=1.e-7*(1.-hybi(k))</div>
<div class="line"><a id="l03530" name="l03530"></a><span class="lineno"> 3530</span>      aerosolcp(i,k,j,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a6169752cdbc54265aba357093feb3e77">idxocpho</a>)=1.e-7*(1.-hybi(k))</div>
<div class="line"><a id="l03531" name="l03531"></a><span class="lineno"> 3531</span>      aerosolcn(i,k,j,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a6169752cdbc54265aba357093feb3e77">idxocpho</a>)=1.e-7*(1.-hybi(k))</div>
<div class="line"><a id="l03532" name="l03532"></a><span class="lineno"> 3532</span>      aerosolcp(i,k,j,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a24d476dd94afaa7f4e36e5856f37194c">idxbcpho</a>)=1.e-9*(1.-hybi(k))</div>
<div class="line"><a id="l03533" name="l03533"></a><span class="lineno"> 3533</span>      aerosolcn(i,k,j,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a24d476dd94afaa7f4e36e5856f37194c">idxbcpho</a>)=1.e-9*(1.-hybi(k))</div>
<div class="line"><a id="l03534" name="l03534"></a><span class="lineno"> 3534</span>      aerosolcp(i,k,j,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ad82655074f7b9f4590d239dd3df48bf8">idxocphi</a>)=1.e-7*(1.-hybi(k))</div>
<div class="line"><a id="l03535" name="l03535"></a><span class="lineno"> 3535</span>      aerosolcn(i,k,j,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ad82655074f7b9f4590d239dd3df48bf8">idxocphi</a>)=1.e-7*(1.-hybi(k))</div>
<div class="line"><a id="l03536" name="l03536"></a><span class="lineno"> 3536</span>      aerosolcp(i,k,j,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a9c057f8d1d1eca09482693db2df3b5e6">idxbcphi</a>)=1.e-8*(1.-hybi(k))</div>
<div class="line"><a id="l03537" name="l03537"></a><span class="lineno"> 3537</span>      aerosolcn(i,k,j,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a9c057f8d1d1eca09482693db2df3b5e6">idxbcphi</a>)=1.e-8*(1.-hybi(k))</div>
<div class="line"><a id="l03538" name="l03538"></a><span class="lineno"> 3538</span><span class="keywordflow">     ENDDO</span></div>
<div class="line"><a id="l03539" name="l03539"></a><span class="lineno"> 3539</span><span class="keywordflow">     ENDDO</span></div>
<div class="line"><a id="l03540" name="l03540"></a><span class="lineno"> 3540</span><span class="keywordflow">     ENDDO</span></div>
<div class="line"><a id="l03541" name="l03541"></a><span class="lineno"> 3541</span> </div>
<div class="line"><a id="l03542" name="l03542"></a><span class="lineno"> 3542</span>     <span class="keyword">call </span>aer_optics_initialize</div>
<div class="line"><a id="l03543" name="l03543"></a><span class="lineno"> 3543</span> </div>
<div class="line"><a id="l03544" name="l03544"></a><span class="lineno"> 3544</span> </div>
<div class="line"><a id="l03545" name="l03545"></a><span class="lineno"> 3545</span><span class="keyword">END subroutine </span>aerosol_init</div>
<div class="line"><a id="l03546" name="l03546"></a><span class="lineno"> 3546</span> </div>
<div class="line"><a id="l03547" name="l03547"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a06a46ac2808da819e718479153a13258"> 3547</a></span>  <span class="keyword">subroutine </span>aer_optics_initialize</div>
<div class="line"><a id="l03548" name="l03548"></a><span class="lineno"> 3548</span> </div>
<div class="line"><a id="l03549" name="l03549"></a><span class="lineno"> 3549</span><span class="keywordtype">USE </span>module_wrf_error</div>
<div class="line"><a id="l03550" name="l03550"></a><span class="lineno"> 3550</span> </div>
<div class="line"><a id="l03551" name="l03551"></a><span class="lineno"> 3551</span><span class="comment">!   use shr_kind_mod, only: r8 =&gt; shr_kind_r8</span></div>
<div class="line"><a id="l03552" name="l03552"></a><span class="lineno"> 3552</span><span class="comment">!   use pmgrid  ! masterproc is here</span></div>
<div class="line"><a id="l03553" name="l03553"></a><span class="lineno"> 3553</span><span class="comment">!   use ioFileMod, only: getfil</span></div>
<div class="line"><a id="l03554" name="l03554"></a><span class="lineno"> 3554</span> </div>
<div class="line"><a id="l03555" name="l03555"></a><span class="lineno"> 3555</span><span class="comment">!#if ( defined SPMD )</span></div>
<div class="line"><a id="l03556" name="l03556"></a><span class="lineno"> 3556</span><span class="comment">!    use mpishorthand</span></div>
<div class="line"><a id="l03557" name="l03557"></a><span class="lineno"> 3557</span><span class="comment">!#endif</span></div>
<div class="line"><a id="l03558" name="l03558"></a><span class="lineno"> 3558</span>    <span class="keywordtype">implicit none</span></div>
<div class="line"><a id="l03559" name="l03559"></a><span class="lineno"> 3559</span> </div>
<div class="line"><a id="l03560" name="l03560"></a><span class="lineno"> 3560</span><span class="comment">!   include &#39;netcdf.inc&#39;</span></div>
<div class="line"><a id="l03561" name="l03561"></a><span class="lineno"> 3561</span> </div>
<div class="line"><a id="l03562" name="l03562"></a><span class="lineno"> 3562</span> </div>
<div class="line"><a id="l03563" name="l03563"></a><span class="lineno"> 3563</span>    <span class="keywordtype">integer</span> :: nrh_opac  <span class="comment">! number of relative humidity values for OPAC data</span></div>
<div class="line"><a id="l03564" name="l03564"></a><span class="lineno"> 3564</span>    <span class="keywordtype">integer</span> :: nbnd      <span class="comment">! number of spectral bands, should be identical to nspint</span></div>
<div class="line"><a id="l03565" name="l03565"></a><span class="lineno"> 3565</span><span class="keywordtype">    real</span>(r8), <span class="keywordtype">parameter</span> :: wgt_sscm = 6.0 / 7.0</div>
<div class="line"><a id="l03566" name="l03566"></a><span class="lineno"> 3566</span>    <span class="keywordtype">integer</span> :: krh_opac  <span class="comment">! rh index for OPAC rh grid</span></div>
<div class="line"><a id="l03567" name="l03567"></a><span class="lineno"> 3567</span>    <span class="keywordtype">integer</span> :: krh       <span class="comment">! another rh index</span></div>
<div class="line"><a id="l03568" name="l03568"></a><span class="lineno"> 3568</span>    <span class="keywordtype">integer</span> :: ksz       <span class="comment">! dust size bin index</span></div>
<div class="line"><a id="l03569" name="l03569"></a><span class="lineno"> 3569</span>    <span class="keywordtype">integer</span> :: kbnd      <span class="comment">! band index</span></div>
<div class="line"><a id="l03570" name="l03570"></a><span class="lineno"> 3570</span> </div>
<div class="line"><a id="l03571" name="l03571"></a><span class="lineno"> 3571</span><span class="keywordtype">    real</span>(r8) :: rh   <span class="comment">! local relative humidity variable</span></div>
<div class="line"><a id="l03572" name="l03572"></a><span class="lineno"> 3572</span> </div>
<div class="line"><a id="l03573" name="l03573"></a><span class="lineno"> 3573</span>    <span class="keywordtype">integer</span>, <span class="keywordtype">parameter</span> :: irh=8</div>
<div class="line"><a id="l03574" name="l03574"></a><span class="lineno"> 3574</span><span class="keywordtype">    real</span>(r8) :: rh_opac(irh)        <span class="comment">! OPAC relative humidity grid</span></div>
<div class="line"><a id="l03575" name="l03575"></a><span class="lineno"> 3575</span><span class="keywordtype">    real</span>(r8) :: ksul_opac(irh,nspint)    <span class="comment">! sulfate  extinction</span></div>
<div class="line"><a id="l03576" name="l03576"></a><span class="lineno"> 3576</span><span class="keywordtype">    real</span>(r8) :: wsul_opac(irh,nspint)    <span class="comment">!          single scattering albedo</span></div>
<div class="line"><a id="l03577" name="l03577"></a><span class="lineno"> 3577</span><span class="keywordtype">    real</span>(r8) :: gsul_opac(irh,nspint)    <span class="comment">!          asymmetry parameter</span></div>
<div class="line"><a id="l03578" name="l03578"></a><span class="lineno"> 3578</span><span class="keywordtype">    real</span>(r8) :: ksslt_opac(irh,nspint)   <span class="comment">! sea-salt</span></div>
<div class="line"><a id="l03579" name="l03579"></a><span class="lineno"> 3579</span><span class="keywordtype">    real</span>(r8) :: wsslt_opac(irh,nspint)</div>
<div class="line"><a id="l03580" name="l03580"></a><span class="lineno"> 3580</span><span class="keywordtype">    real</span>(r8) :: gsslt_opac(irh,nspint)</div>
<div class="line"><a id="l03581" name="l03581"></a><span class="lineno"> 3581</span><span class="keywordtype">    real</span>(r8) :: kssam_opac(irh,nspint)   <span class="comment">! sea-salt accumulation mode</span></div>
<div class="line"><a id="l03582" name="l03582"></a><span class="lineno"> 3582</span><span class="keywordtype">    real</span>(r8) :: wssam_opac(irh,nspint)</div>
<div class="line"><a id="l03583" name="l03583"></a><span class="lineno"> 3583</span><span class="keywordtype">    real</span>(r8) :: gssam_opac(irh,nspint)</div>
<div class="line"><a id="l03584" name="l03584"></a><span class="lineno"> 3584</span><span class="keywordtype">    real</span>(r8) :: ksscm_opac(irh,nspint)   <span class="comment">! sea-salt coarse mode</span></div>
<div class="line"><a id="l03585" name="l03585"></a><span class="lineno"> 3585</span><span class="keywordtype">    real</span>(r8) :: wsscm_opac(irh,nspint)</div>
<div class="line"><a id="l03586" name="l03586"></a><span class="lineno"> 3586</span><span class="keywordtype">    real</span>(r8) :: gsscm_opac(irh,nspint)</div>
<div class="line"><a id="l03587" name="l03587"></a><span class="lineno"> 3587</span><span class="keywordtype">    real</span>(r8) :: kcphil_opac(irh,nspint)  <span class="comment">! hydrophilic organic carbon</span></div>
<div class="line"><a id="l03588" name="l03588"></a><span class="lineno"> 3588</span><span class="keywordtype">    real</span>(r8) :: wcphil_opac(irh,nspint)</div>
<div class="line"><a id="l03589" name="l03589"></a><span class="lineno"> 3589</span><span class="keywordtype">    real</span>(r8) :: gcphil_opac(irh,nspint)</div>
<div class="line"><a id="l03590" name="l03590"></a><span class="lineno"> 3590</span><span class="keywordtype">    real</span>(r8) :: dummy(nspint)</div>
<div class="line"><a id="l03591" name="l03591"></a><span class="lineno"> 3591</span> </div>
<div class="line"><a id="l03592" name="l03592"></a><span class="lineno"> 3592</span>      <span class="keywordtype">LOGICAL</span>                 :: opened</div>
<div class="line"><a id="l03593" name="l03593"></a><span class="lineno"> 3593</span>      <span class="keywordtype">LOGICAL</span> , <span class="keywordtype">EXTERNAL</span>      :: wrf_dm_on_monitor</div>
<div class="line"><a id="l03594" name="l03594"></a><span class="lineno"> 3594</span> </div>
<div class="line"><a id="l03595" name="l03595"></a><span class="lineno"> 3595</span>      <span class="keywordtype">CHARACTER*80</span> errmess</div>
<div class="line"><a id="l03596" name="l03596"></a><span class="lineno"> 3596</span>      <span class="keywordtype">INTEGER</span> cam_aer_unit</div>
<div class="line"><a id="l03597" name="l03597"></a><span class="lineno"> 3597</span>      <span class="keywordtype">integer</span> :: i</div>
<div class="line"><a id="l03598" name="l03598"></a><span class="lineno"> 3598</span> </div>
<div class="line"><a id="l03599" name="l03599"></a><span class="lineno"> 3599</span><span class="comment">!   read aerosol optics data</span></div>
<div class="line"><a id="l03600" name="l03600"></a><span class="lineno"> 3600</span> </div>
<div class="line"><a id="l03601" name="l03601"></a><span class="lineno"> 3601</span>      <span class="keywordflow">IF</span> ( wrf_dm_on_monitor() ) <span class="keywordflow">THEN</span></div>
<div class="line"><a id="l03602" name="l03602"></a><span class="lineno"> 3602</span>        <span class="keywordflow">DO</span> i = 10,99</div>
<div class="line"><a id="l03603" name="l03603"></a><span class="lineno"> 3603</span>          <span class="keyword">INQUIRE</span> ( i , opened = opened )</div>
<div class="line"><a id="l03604" name="l03604"></a><span class="lineno"> 3604</span>          <span class="keywordflow">IF</span> ( .NOT. opened ) <span class="keywordflow">THEN</span></div>
<div class="line"><a id="l03605" name="l03605"></a><span class="lineno"> 3605</span>            cam_aer_unit = i</div>
<div class="line"><a id="l03606" name="l03606"></a><span class="lineno"> 3606</span>            <span class="keywordflow">GOTO</span> 2010</div>
<div class="line"><a id="l03607" name="l03607"></a><span class="lineno"> 3607</span><span class="keywordflow">          ENDIF</span></div>
<div class="line"><a id="l03608" name="l03608"></a><span class="lineno"> 3608</span><span class="keywordflow">        ENDDO</span></div>
<div class="line"><a id="l03609" name="l03609"></a><span class="lineno"> 3609</span>        cam_aer_unit = -1</div>
<div class="line"><a id="l03610" name="l03610"></a><span class="lineno"> 3610</span> 2010   <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a id="l03611" name="l03611"></a><span class="lineno"> 3611</span><span class="keywordflow">      ENDIF</span></div>
<div class="line"><a id="l03612" name="l03612"></a><span class="lineno"> 3612</span>      <span class="keyword">CALL </span>wrf_dm_bcast_bytes ( cam_aer_unit , iwordsize )</div>
<div class="line"><a id="l03613" name="l03613"></a><span class="lineno"> 3613</span>      <span class="keywordflow">IF</span> ( cam_aer_unit &lt; 0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a id="l03614" name="l03614"></a><span class="lineno"> 3614</span>        <span class="keyword">CALL </span>wrf_error_fatal ( <span class="stringliteral">&#39;module_ra_cam: aer_optics_initialize: Can not find unused fortran unit to read in lookup table.&#39;</span> )</div>
<div class="line"><a id="l03615" name="l03615"></a><span class="lineno"> 3615</span><span class="keywordflow">      ENDIF</span></div>
<div class="line"><a id="l03616" name="l03616"></a><span class="lineno"> 3616</span> </div>
<div class="line"><a id="l03617" name="l03617"></a><span class="lineno"> 3617</span>        <span class="keywordflow">IF</span> ( wrf_dm_on_monitor() ) <span class="keywordflow">THEN</span></div>
<div class="line"><a id="l03618" name="l03618"></a><span class="lineno"> 3618</span>          <span class="keyword">OPEN</span>(cam_aer_unit,file=<span class="stringliteral">&#39;CAM_AEROPT_DATA&#39;</span>,                  &amp;</div>
<div class="line"><a id="l03619" name="l03619"></a><span class="lineno"> 3619</span>               form=<span class="stringliteral">&#39;UNFORMATTED&#39;</span>,status=<span class="stringliteral">&#39;OLD&#39;</span>,err=9010)</div>
<div class="line"><a id="l03620" name="l03620"></a><span class="lineno"> 3620</span>          <span class="keyword">call </span>wrf_debug(50,<span class="stringliteral">&#39;reading CAM_AEROPT_DATA&#39;</span>)</div>
<div class="line"><a id="l03621" name="l03621"></a><span class="lineno"> 3621</span><span class="keywordflow">        ENDIF</span></div>
<div class="line"><a id="l03622" name="l03622"></a><span class="lineno"> 3622</span> </div>
<div class="line"><a id="l03623" name="l03623"></a><span class="lineno"> 3623</span><span class="preprocessor">#define DM_BCAST_MACRO(A) CALL wrf_dm_bcast_bytes ( A , size ( A ) * r8 )</span></div>
<div class="line"><a id="l03624" name="l03624"></a><span class="lineno"> 3624</span><span class="preprocessor"></span> </div>
<div class="line"><a id="l03625" name="l03625"></a><span class="lineno"> 3625</span>         <span class="keywordflow">IF</span> ( wrf_dm_on_monitor() ) <span class="keywordflow">then</span></div>
<div class="line"><a id="l03626" name="l03626"></a><span class="lineno"> 3626</span>         <span class="keyword">READ</span> (cam_aer_unit,err=9010) dummy</div>
<div class="line"><a id="l03627" name="l03627"></a><span class="lineno"> 3627</span>         <span class="keyword">READ</span> (cam_aer_unit,err=9010) rh_opac </div>
<div class="line"><a id="l03628" name="l03628"></a><span class="lineno"> 3628</span>         <span class="keyword">READ</span> (cam_aer_unit,err=9010) ksul_opac </div>
<div class="line"><a id="l03629" name="l03629"></a><span class="lineno"> 3629</span>         <span class="keyword">READ</span> (cam_aer_unit,err=9010) wsul_opac </div>
<div class="line"><a id="l03630" name="l03630"></a><span class="lineno"> 3630</span>         <span class="keyword">READ</span> (cam_aer_unit,err=9010) gsul_opac </div>
<div class="line"><a id="l03631" name="l03631"></a><span class="lineno"> 3631</span>         <span class="keyword">READ</span> (cam_aer_unit,err=9010) kssam_opac </div>
<div class="line"><a id="l03632" name="l03632"></a><span class="lineno"> 3632</span>         <span class="keyword">READ</span> (cam_aer_unit,err=9010) wssam_opac </div>
<div class="line"><a id="l03633" name="l03633"></a><span class="lineno"> 3633</span>         <span class="keyword">READ</span> (cam_aer_unit,err=9010) gssam_opac </div>
<div class="line"><a id="l03634" name="l03634"></a><span class="lineno"> 3634</span>         <span class="keyword">READ</span> (cam_aer_unit,err=9010) ksscm_opac </div>
<div class="line"><a id="l03635" name="l03635"></a><span class="lineno"> 3635</span>         <span class="keyword">READ</span> (cam_aer_unit,err=9010) wsscm_opac </div>
<div class="line"><a id="l03636" name="l03636"></a><span class="lineno"> 3636</span>         <span class="keyword">READ</span> (cam_aer_unit,err=9010) gsscm_opac</div>
<div class="line"><a id="l03637" name="l03637"></a><span class="lineno"> 3637</span>         <span class="keyword">READ</span> (cam_aer_unit,err=9010) kcphil_opac </div>
<div class="line"><a id="l03638" name="l03638"></a><span class="lineno"> 3638</span>         <span class="keyword">READ</span> (cam_aer_unit,err=9010) wcphil_opac </div>
<div class="line"><a id="l03639" name="l03639"></a><span class="lineno"> 3639</span>         <span class="keyword">READ</span> (cam_aer_unit,err=9010) gcphil_opac </div>
<div class="line"><a id="l03640" name="l03640"></a><span class="lineno"> 3640</span>         <span class="keyword">READ</span> (cam_aer_unit,err=9010) <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#aeda61c0a1796f1009ab1ae2aaa2b11b7">kcb</a> </div>
<div class="line"><a id="l03641" name="l03641"></a><span class="lineno"> 3641</span>         <span class="keyword">READ</span> (cam_aer_unit,err=9010) <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a93c8608518cbf7ff45ee5f58d8e6a7be">wcb</a> </div>
<div class="line"><a id="l03642" name="l03642"></a><span class="lineno"> 3642</span>         <span class="keyword">READ</span> (cam_aer_unit,err=9010) <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a47269dd12293e86f1bb796d58d63fc8d">gcb</a> </div>
<div class="line"><a id="l03643" name="l03643"></a><span class="lineno"> 3643</span>         <span class="keyword">READ</span> (cam_aer_unit,err=9010) <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a03ea99448698668710d5d8c1bfb893c7">kdst</a> </div>
<div class="line"><a id="l03644" name="l03644"></a><span class="lineno"> 3644</span>         <span class="keyword">READ</span> (cam_aer_unit,err=9010) <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a94051f36288fce3a6dd41f8190fd5743">wdst</a> </div>
<div class="line"><a id="l03645" name="l03645"></a><span class="lineno"> 3645</span>         <span class="keyword">READ</span> (cam_aer_unit,err=9010) <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a7339eabd703a5c422dea9f3771fa52ac">gdst</a> </div>
<div class="line"><a id="l03646" name="l03646"></a><span class="lineno"> 3646</span>         <span class="keyword">READ</span> (cam_aer_unit,err=9010) <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a7333bd6e64880f7c8a34daa55e2a9007">kbg</a> </div>
<div class="line"><a id="l03647" name="l03647"></a><span class="lineno"> 3647</span>         <span class="keyword">READ</span> (cam_aer_unit,err=9010) <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a61a7b14a17925acd1b5ee1ef5b89af87">wbg</a> </div>
<div class="line"><a id="l03648" name="l03648"></a><span class="lineno"> 3648</span>         <span class="keyword">READ</span> (cam_aer_unit,err=9010) <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a79996b6b720ac8bae0022f7597e0d185">gbg</a></div>
<div class="line"><a id="l03649" name="l03649"></a><span class="lineno"> 3649</span>         <span class="keyword">READ</span> (cam_aer_unit,err=9010) <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ab9dd87c1ef6ee3ff07ca0030fd642122">kvolc</a> </div>
<div class="line"><a id="l03650" name="l03650"></a><span class="lineno"> 3650</span>         <span class="keyword">READ</span> (cam_aer_unit,err=9010) <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#afc14045c968e1826a6cecfe78f987844">wvolc</a> </div>
<div class="line"><a id="l03651" name="l03651"></a><span class="lineno"> 3651</span>         <span class="keyword">READ</span> (cam_aer_unit,err=9010) <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a8c0779f635e8038371f30b2e384cedca">gvolc</a></div>
<div class="line"><a id="l03652" name="l03652"></a><span class="lineno"> 3652</span><span class="keywordflow">         endif</span></div>
<div class="line"><a id="l03653" name="l03653"></a><span class="lineno"> 3653</span> </div>
<div class="line"><a id="l03654" name="l03654"></a><span class="lineno"> 3654</span>         dm_bcast_macro(rh_opac)</div>
<div class="line"><a id="l03655" name="l03655"></a><span class="lineno"> 3655</span>         dm_bcast_macro(ksul_opac)</div>
<div class="line"><a id="l03656" name="l03656"></a><span class="lineno"> 3656</span>         dm_bcast_macro(wsul_opac)</div>
<div class="line"><a id="l03657" name="l03657"></a><span class="lineno"> 3657</span>         dm_bcast_macro(gsul_opac)</div>
<div class="line"><a id="l03658" name="l03658"></a><span class="lineno"> 3658</span>         dm_bcast_macro(kssam_opac)</div>
<div class="line"><a id="l03659" name="l03659"></a><span class="lineno"> 3659</span>         dm_bcast_macro(wssam_opac)</div>
<div class="line"><a id="l03660" name="l03660"></a><span class="lineno"> 3660</span>         dm_bcast_macro(gssam_opac)</div>
<div class="line"><a id="l03661" name="l03661"></a><span class="lineno"> 3661</span>         dm_bcast_macro(ksscm_opac)</div>
<div class="line"><a id="l03662" name="l03662"></a><span class="lineno"> 3662</span>         dm_bcast_macro(wsscm_opac)</div>
<div class="line"><a id="l03663" name="l03663"></a><span class="lineno"> 3663</span>         dm_bcast_macro(gsscm_opac)</div>
<div class="line"><a id="l03664" name="l03664"></a><span class="lineno"> 3664</span>         dm_bcast_macro(kcphil_opac)</div>
<div class="line"><a id="l03665" name="l03665"></a><span class="lineno"> 3665</span>         dm_bcast_macro(wcphil_opac)</div>
<div class="line"><a id="l03666" name="l03666"></a><span class="lineno"> 3666</span>         dm_bcast_macro(gcphil_opac)</div>
<div class="line"><a id="l03667" name="l03667"></a><span class="lineno"> 3667</span>         dm_bcast_macro(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#aeda61c0a1796f1009ab1ae2aaa2b11b7">kcb</a>)</div>
<div class="line"><a id="l03668" name="l03668"></a><span class="lineno"> 3668</span>         dm_bcast_macro(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a93c8608518cbf7ff45ee5f58d8e6a7be">wcb</a>)</div>
<div class="line"><a id="l03669" name="l03669"></a><span class="lineno"> 3669</span>         dm_bcast_macro(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a47269dd12293e86f1bb796d58d63fc8d">gcb</a>)</div>
<div class="line"><a id="l03670" name="l03670"></a><span class="lineno"> 3670</span>         dm_bcast_macro(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ab9dd87c1ef6ee3ff07ca0030fd642122">kvolc</a>)</div>
<div class="line"><a id="l03671" name="l03671"></a><span class="lineno"> 3671</span>         dm_bcast_macro(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#afc14045c968e1826a6cecfe78f987844">wvolc</a>)</div>
<div class="line"><a id="l03672" name="l03672"></a><span class="lineno"> 3672</span>         dm_bcast_macro(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a03ea99448698668710d5d8c1bfb893c7">kdst</a>)</div>
<div class="line"><a id="l03673" name="l03673"></a><span class="lineno"> 3673</span>         dm_bcast_macro(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a94051f36288fce3a6dd41f8190fd5743">wdst</a>)</div>
<div class="line"><a id="l03674" name="l03674"></a><span class="lineno"> 3674</span>         dm_bcast_macro(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a7339eabd703a5c422dea9f3771fa52ac">gdst</a>)</div>
<div class="line"><a id="l03675" name="l03675"></a><span class="lineno"> 3675</span>         dm_bcast_macro(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a7333bd6e64880f7c8a34daa55e2a9007">kbg</a>)</div>
<div class="line"><a id="l03676" name="l03676"></a><span class="lineno"> 3676</span>         dm_bcast_macro(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a61a7b14a17925acd1b5ee1ef5b89af87">wbg</a>)</div>
<div class="line"><a id="l03677" name="l03677"></a><span class="lineno"> 3677</span>         dm_bcast_macro(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a79996b6b720ac8bae0022f7597e0d185">gbg</a>)</div>
<div class="line"><a id="l03678" name="l03678"></a><span class="lineno"> 3678</span> </div>
<div class="line"><a id="l03679" name="l03679"></a><span class="lineno"> 3679</span>         <span class="keywordflow">IF</span> ( wrf_dm_on_monitor() ) <span class="keyword">CLOSE</span> (cam_aer_unit)</div>
<div class="line"><a id="l03680" name="l03680"></a><span class="lineno"> 3680</span> </div>
<div class="line"><a id="l03681" name="l03681"></a><span class="lineno"> 3681</span>    <span class="comment">! map OPAC aerosol species onto CAM aerosol species</span></div>
<div class="line"><a id="l03682" name="l03682"></a><span class="lineno"> 3682</span>    <span class="comment">! CAM name             OPAC name</span></div>
<div class="line"><a id="l03683" name="l03683"></a><span class="lineno"> 3683</span>    <span class="comment">! sul   or SO4         = suso                  sulfate soluble</span></div>
<div class="line"><a id="l03684" name="l03684"></a><span class="lineno"> 3684</span>    <span class="comment">! sslt  or SSLT        = 1/7 ssam + 6/7 sscm   sea-salt accumulation/coagulation mode</span></div>
<div class="line"><a id="l03685" name="l03685"></a><span class="lineno"> 3685</span>    <span class="comment">! cphil or CPHI        = waso                  water soluble (carbon)</span></div>
<div class="line"><a id="l03686" name="l03686"></a><span class="lineno"> 3686</span>    <span class="comment">! cphob or CPHO        = waso @ rh = 0</span></div>
<div class="line"><a id="l03687" name="l03687"></a><span class="lineno"> 3687</span>    <span class="comment">! cb    or BCPHI/BCPHO = soot</span></div>
<div class="line"><a id="l03688" name="l03688"></a><span class="lineno"> 3688</span> </div>
<div class="line"><a id="l03689" name="l03689"></a><span class="lineno"> 3689</span>    ksslt_opac(:,:) = (1.0 - wgt_sscm) * kssam_opac(:,:) + wgt_sscm * ksscm_opac(:,:)</div>
<div class="line"><a id="l03690" name="l03690"></a><span class="lineno"> 3690</span> </div>
<div class="line"><a id="l03691" name="l03691"></a><span class="lineno"> 3691</span>    wsslt_opac(:,:) = ( (1.0 - wgt_sscm) * kssam_opac(:,:) * wssam_opac(:,:) &amp;</div>
<div class="line"><a id="l03692" name="l03692"></a><span class="lineno"> 3692</span>                  + wgt_sscm * ksscm_opac(:,:) * wsscm_opac(:,:) ) &amp;</div>
<div class="line"><a id="l03693" name="l03693"></a><span class="lineno"> 3693</span>                  / ksslt_opac(:,:)</div>
<div class="line"><a id="l03694" name="l03694"></a><span class="lineno"> 3694</span> </div>
<div class="line"><a id="l03695" name="l03695"></a><span class="lineno"> 3695</span>    gsslt_opac(:,:) = ( (1.0 - wgt_sscm) * kssam_opac(:,:) * wssam_opac(:,:) * gssam_opac(:,:) &amp;</div>
<div class="line"><a id="l03696" name="l03696"></a><span class="lineno"> 3696</span>                  + wgt_sscm * ksscm_opac(:,:) * wsscm_opac(:,:) * gsscm_opac(:,:) ) &amp;</div>
<div class="line"><a id="l03697" name="l03697"></a><span class="lineno"> 3697</span>                   / ( ksslt_opac(:,:) * wsslt_opac(:,:) )</div>
<div class="line"><a id="l03698" name="l03698"></a><span class="lineno"> 3698</span> </div>
<div class="line"><a id="l03699" name="l03699"></a><span class="lineno"> 3699</span>    <span class="keywordflow">do</span> i=1,nspint</div>
<div class="line"><a id="l03700" name="l03700"></a><span class="lineno"> 3700</span>    <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ab9698de3d9583b47b9f0f79888243a02">kcphob</a>(i) = kcphil_opac(1,i)</div>
<div class="line"><a id="l03701" name="l03701"></a><span class="lineno"> 3701</span>    <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ac9af610840dfd4a05d682ad8299a849e">wcphob</a>(i) = wcphil_opac(1,i)</div>
<div class="line"><a id="l03702" name="l03702"></a><span class="lineno"> 3702</span>    <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a66ee794a307b383eda1904b5304cfd73">gcphob</a>(i) = gcphil_opac(1,i)</div>
<div class="line"><a id="l03703" name="l03703"></a><span class="lineno"> 3703</span><span class="keywordflow">    end do</span></div>
<div class="line"><a id="l03704" name="l03704"></a><span class="lineno"> 3704</span> </div>
<div class="line"><a id="l03705" name="l03705"></a><span class="lineno"> 3705</span>    <span class="comment">! interpolate optical properties of hygrospopic aerosol species</span></div>
<div class="line"><a id="l03706" name="l03706"></a><span class="lineno"> 3706</span>    <span class="comment">!   onto a uniform relative humidity grid</span></div>
<div class="line"><a id="l03707" name="l03707"></a><span class="lineno"> 3707</span> </div>
<div class="line"><a id="l03708" name="l03708"></a><span class="lineno"> 3708</span>    nbnd = nspint</div>
<div class="line"><a id="l03709" name="l03709"></a><span class="lineno"> 3709</span> </div>
<div class="line"><a id="l03710" name="l03710"></a><span class="lineno"> 3710</span>    <span class="keywordflow">do</span> krh = 1, <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#af8b5f8546f90cdfab31c24668e0996c2">nrh</a></div>
<div class="line"><a id="l03711" name="l03711"></a><span class="lineno"> 3711</span>      rh = 1.0_r8 / <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#af8b5f8546f90cdfab31c24668e0996c2">nrh</a> * (krh - 1)</div>
<div class="line"><a id="l03712" name="l03712"></a><span class="lineno"> 3712</span>      <span class="keywordflow">do</span> kbnd = 1, nbnd</div>
<div class="line"><a id="l03713" name="l03713"></a><span class="lineno"> 3713</span>        <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a6547194c35aef1b906c011b0ba56e4cf">ksul</a>(krh, kbnd) = <a class="code hl_function" href="namespacemodule__ra__cam__support.html#a46342ec26656238d58f64d5d8be63d97">exp_interpol</a>( rh_opac, &amp;</div>
<div class="line"><a id="l03714" name="l03714"></a><span class="lineno"> 3714</span>          ksul_opac(:, kbnd) / ksul_opac(1, kbnd), rh ) * ksul_opac(1, kbnd)</div>
<div class="line"><a id="l03715" name="l03715"></a><span class="lineno"> 3715</span>        <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ae509dcf829ddf2991fb22062c1800de9">wsul</a>(krh, kbnd) = <a class="code hl_function" href="namespacemodule__ra__cam__support.html#a68912f8cfcb40aec718139f5eca9014c">lin_interpol</a>( rh_opac, &amp;</div>
<div class="line"><a id="l03716" name="l03716"></a><span class="lineno"> 3716</span>          wsul_opac(:, kbnd) / wsul_opac(1, kbnd), rh ) * wsul_opac(1, kbnd)</div>
<div class="line"><a id="l03717" name="l03717"></a><span class="lineno"> 3717</span>        <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ab0a88e85acf8aacb2a33d58a5c490d3e">gsul</a>(krh, kbnd) = <a class="code hl_function" href="namespacemodule__ra__cam__support.html#a68912f8cfcb40aec718139f5eca9014c">lin_interpol</a>( rh_opac, &amp;</div>
<div class="line"><a id="l03718" name="l03718"></a><span class="lineno"> 3718</span>          gsul_opac(:, kbnd) / gsul_opac(1, kbnd), rh ) * gsul_opac(1, kbnd)</div>
<div class="line"><a id="l03719" name="l03719"></a><span class="lineno"> 3719</span>        <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a20408f7ac63d867f91e77786c442a6d0">ksslt</a>(krh, kbnd) = <a class="code hl_function" href="namespacemodule__ra__cam__support.html#a46342ec26656238d58f64d5d8be63d97">exp_interpol</a>( rh_opac, &amp;</div>
<div class="line"><a id="l03720" name="l03720"></a><span class="lineno"> 3720</span>          ksslt_opac(:, kbnd) / ksslt_opac(1, kbnd), rh ) * ksslt_opac(1, kbnd)</div>
<div class="line"><a id="l03721" name="l03721"></a><span class="lineno"> 3721</span>        <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a013d9c7b7e12d40bf7c4beae240c71a5">wsslt</a>(krh, kbnd) = <a class="code hl_function" href="namespacemodule__ra__cam__support.html#a68912f8cfcb40aec718139f5eca9014c">lin_interpol</a>( rh_opac, &amp;</div>
<div class="line"><a id="l03722" name="l03722"></a><span class="lineno"> 3722</span>          wsslt_opac(:, kbnd) / wsslt_opac(1, kbnd), rh ) * wsslt_opac(1, kbnd)</div>
<div class="line"><a id="l03723" name="l03723"></a><span class="lineno"> 3723</span>        <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a597b13016a0f27c53709bafdf3a4169a">gsslt</a>(krh, kbnd) = <a class="code hl_function" href="namespacemodule__ra__cam__support.html#a68912f8cfcb40aec718139f5eca9014c">lin_interpol</a>( rh_opac, &amp;</div>
<div class="line"><a id="l03724" name="l03724"></a><span class="lineno"> 3724</span>          gsslt_opac(:, kbnd) / gsslt_opac(1, kbnd), rh ) * gsslt_opac(1, kbnd)</div>
<div class="line"><a id="l03725" name="l03725"></a><span class="lineno"> 3725</span>        <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a119e6bcbd1c35c9fa8e6bd724e6da1b7">kcphil</a>(krh, kbnd) = <a class="code hl_function" href="namespacemodule__ra__cam__support.html#a46342ec26656238d58f64d5d8be63d97">exp_interpol</a>( rh_opac, &amp;</div>
<div class="line"><a id="l03726" name="l03726"></a><span class="lineno"> 3726</span>          kcphil_opac(:, kbnd) / kcphil_opac(1, kbnd), rh ) * kcphil_opac(1, kbnd)</div>
<div class="line"><a id="l03727" name="l03727"></a><span class="lineno"> 3727</span>        <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ac19f8c9902dc190eda33b665d428806f">wcphil</a>(krh, kbnd) = <a class="code hl_function" href="namespacemodule__ra__cam__support.html#a68912f8cfcb40aec718139f5eca9014c">lin_interpol</a>( rh_opac, &amp;</div>
<div class="line"><a id="l03728" name="l03728"></a><span class="lineno"> 3728</span>          wcphil_opac(:, kbnd) / wcphil_opac(1, kbnd), rh ) * wcphil_opac(1, kbnd)</div>
<div class="line"><a id="l03729" name="l03729"></a><span class="lineno"> 3729</span>        <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a417d3c687b803b9fa520768498503e07">gcphil</a>(krh, kbnd) = <a class="code hl_function" href="namespacemodule__ra__cam__support.html#a68912f8cfcb40aec718139f5eca9014c">lin_interpol</a>( rh_opac, &amp;</div>
<div class="line"><a id="l03730" name="l03730"></a><span class="lineno"> 3730</span>          gcphil_opac(:, kbnd) / gcphil_opac(1, kbnd), rh )  * gcphil_opac(1, kbnd)</div>
<div class="line"><a id="l03731" name="l03731"></a><span class="lineno"> 3731</span><span class="keywordflow">      end do</span></div>
<div class="line"><a id="l03732" name="l03732"></a><span class="lineno"> 3732</span><span class="keywordflow">    end do</span></div>
<div class="line"><a id="l03733" name="l03733"></a><span class="lineno"> 3733</span> </div>
<div class="line"><a id="l03734" name="l03734"></a><span class="lineno"> 3734</span>     <span class="keywordflow">RETURN</span></div>
<div class="line"><a id="l03735" name="l03735"></a><span class="lineno"> 3735</span>9010 <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a id="l03736" name="l03736"></a><span class="lineno"> 3736</span>     <span class="keyword">WRITE</span>( errmess , <span class="stringliteral">&#39;(A35,I4)&#39;</span> ) <span class="stringliteral">&#39;module_ra_cam: error reading unit &#39;</span>,cam_aer_unit</div>
<div class="line"><a id="l03737" name="l03737"></a><span class="lineno"> 3737</span>     <span class="keyword">CALL </span>wrf_error_fatal(errmess)</div>
<div class="line"><a id="l03738" name="l03738"></a><span class="lineno"> 3738</span> </div>
<div class="line"><a id="l03739" name="l03739"></a><span class="lineno"> 3739</span><span class="keyword">END subroutine </span>aer_optics_initialize</div>
<div class="line"><a id="l03740" name="l03740"></a><span class="lineno"> 3740</span> </div>
<div class="line"><a id="l03741" name="l03741"></a><span class="lineno"> 3741</span> </div>
<div class="line"><a id="l03742" name="l03742"></a><span class="lineno"><a class="line" href="namespacemodule__ra__cam__support.html#a2af0fd853e4699d3fa7d4e1cabfea362"> 3742</a></span><span class="keyword">subroutine </span>radaeini( pstdx, mwdryx, mwco2x )</div>
<div class="line"><a id="l03743" name="l03743"></a><span class="lineno"> 3743</span> </div>
<div class="line"><a id="l03744" name="l03744"></a><span class="lineno"> 3744</span><span class="keywordtype">USE </span>module_wrf_error</div>
<div class="line"><a id="l03745" name="l03745"></a><span class="lineno"> 3745</span> </div>
<div class="line"><a id="l03746" name="l03746"></a><span class="lineno"> 3746</span><span class="comment">!</span></div>
<div class="line"><a id="l03747" name="l03747"></a><span class="lineno"> 3747</span><span class="comment">! Initialize radae module data</span></div>
<div class="line"><a id="l03748" name="l03748"></a><span class="lineno"> 3748</span><span class="comment">!</span></div>
<div class="line"><a id="l03749" name="l03749"></a><span class="lineno"> 3749</span><span class="comment">!</span></div>
<div class="line"><a id="l03750" name="l03750"></a><span class="lineno"> 3750</span><span class="comment">! Input variables</span></div>
<div class="line"><a id="l03751" name="l03751"></a><span class="lineno"> 3751</span><span class="comment">!</span></div>
<div class="line"><a id="l03752" name="l03752"></a><span class="lineno"> 3752</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: pstdx   <span class="comment">! Standard pressure (dynes/cm^2)</span></div>
<div class="line"><a id="l03753" name="l03753"></a><span class="lineno"> 3753</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: mwdryx  <span class="comment">! Molecular weight of dry air </span></div>
<div class="line"><a id="l03754" name="l03754"></a><span class="lineno"> 3754</span><span class="keywordtype">   real</span>(r8), <span class="keywordtype">intent(in)</span> :: mwco2x  <span class="comment">! Molecular weight of carbon dioxide</span></div>
<div class="line"><a id="l03755" name="l03755"></a><span class="lineno"> 3755</span><span class="comment">!</span></div>
<div class="line"><a id="l03756" name="l03756"></a><span class="lineno"> 3756</span><span class="comment">!      Variables for loading absorptivity/emissivity</span></div>
<div class="line"><a id="l03757" name="l03757"></a><span class="lineno"> 3757</span><span class="comment">!</span></div>
<div class="line"><a id="l03758" name="l03758"></a><span class="lineno"> 3758</span>   <span class="keywordtype">integer</span> ncid_ae                <span class="comment">! NetCDF file id for abs/ems file</span></div>
<div class="line"><a id="l03759" name="l03759"></a><span class="lineno"> 3759</span> </div>
<div class="line"><a id="l03760" name="l03760"></a><span class="lineno"> 3760</span>   <span class="keywordtype">integer</span> pdimid                 <span class="comment">! pressure dimension id</span></div>
<div class="line"><a id="l03761" name="l03761"></a><span class="lineno"> 3761</span>   <span class="keywordtype">integer</span> psize                  <span class="comment">! pressure dimension size</span></div>
<div class="line"><a id="l03762" name="l03762"></a><span class="lineno"> 3762</span> </div>
<div class="line"><a id="l03763" name="l03763"></a><span class="lineno"> 3763</span>   <span class="keywordtype">integer</span> tpdimid                <span class="comment">! path temperature dimension id</span></div>
<div class="line"><a id="l03764" name="l03764"></a><span class="lineno"> 3764</span>   <span class="keywordtype">integer</span> tpsize                 <span class="comment">! path temperature size</span></div>
<div class="line"><a id="l03765" name="l03765"></a><span class="lineno"> 3765</span> </div>
<div class="line"><a id="l03766" name="l03766"></a><span class="lineno"> 3766</span>   <span class="keywordtype">integer</span> tedimid                <span class="comment">! emission temperature dimension id</span></div>
<div class="line"><a id="l03767" name="l03767"></a><span class="lineno"> 3767</span>   <span class="keywordtype">integer</span> tesize                 <span class="comment">! emission temperature size</span></div>
<div class="line"><a id="l03768" name="l03768"></a><span class="lineno"> 3768</span> </div>
<div class="line"><a id="l03769" name="l03769"></a><span class="lineno"> 3769</span>   <span class="keywordtype">integer</span> udimid                 <span class="comment">! u (H2O path) dimension id</span></div>
<div class="line"><a id="l03770" name="l03770"></a><span class="lineno"> 3770</span>   <span class="keywordtype">integer</span> usize                  <span class="comment">! u (H2O path) dimension size</span></div>
<div class="line"><a id="l03771" name="l03771"></a><span class="lineno"> 3771</span> </div>
<div class="line"><a id="l03772" name="l03772"></a><span class="lineno"> 3772</span>   <span class="keywordtype">integer</span> rhdimid                <span class="comment">! relative humidity dimension id</span></div>
<div class="line"><a id="l03773" name="l03773"></a><span class="lineno"> 3773</span>   <span class="keywordtype">integer</span> rhsize                 <span class="comment">! relative humidity dimension size</span></div>
<div class="line"><a id="l03774" name="l03774"></a><span class="lineno"> 3774</span> </div>
<div class="line"><a id="l03775" name="l03775"></a><span class="lineno"> 3775</span>   <span class="keywordtype">integer</span>    ah2onwid            <span class="comment">! var. id for non-wndw abs.</span></div>
<div class="line"><a id="l03776" name="l03776"></a><span class="lineno"> 3776</span>   <span class="keywordtype">integer</span>    eh2onwid            <span class="comment">! var. id for non-wndw ems.</span></div>
<div class="line"><a id="l03777" name="l03777"></a><span class="lineno"> 3777</span>   <span class="keywordtype">integer</span>    ah2owid             <span class="comment">! var. id for wndw abs. (adjacent layers)</span></div>
<div class="line"><a id="l03778" name="l03778"></a><span class="lineno"> 3778</span>   <span class="keywordtype">integer</span> cn_ah2owid             <span class="comment">! var. id for continuum trans. for wndw abs.</span></div>
<div class="line"><a id="l03779" name="l03779"></a><span class="lineno"> 3779</span>   <span class="keywordtype">integer</span> cn_eh2owid             <span class="comment">! var. id for continuum trans. for wndw ems.</span></div>
<div class="line"><a id="l03780" name="l03780"></a><span class="lineno"> 3780</span>   <span class="keywordtype">integer</span> ln_ah2owid             <span class="comment">! var. id for line trans. for wndw abs.</span></div>
<div class="line"><a id="l03781" name="l03781"></a><span class="lineno"> 3781</span>   <span class="keywordtype">integer</span> ln_eh2owid             <span class="comment">! var. id for line trans. for wndw ems.</span></div>
<div class="line"><a id="l03782" name="l03782"></a><span class="lineno"> 3782</span>   </div>
<div class="line"><a id="l03783" name="l03783"></a><span class="lineno"> 3783</span><span class="comment">!  character*(NF_MAX_NAME) tmpname! dummy variable for var/dim names</span></div>
<div class="line"><a id="l03784" name="l03784"></a><span class="lineno"> 3784</span>   <span class="keywordtype">character(len=256)</span> locfn       <span class="comment">! local filename</span></div>
<div class="line"><a id="l03785" name="l03785"></a><span class="lineno"> 3785</span>   <span class="keywordtype">integer</span> tmptype                <span class="comment">! dummy variable for variable type</span></div>
<div class="line"><a id="l03786" name="l03786"></a><span class="lineno"> 3786</span>   <span class="keywordtype">integer</span> ndims                  <span class="comment">! number of dimensions</span></div>
<div class="line"><a id="l03787" name="l03787"></a><span class="lineno"> 3787</span><span class="comment">!  integer dims(NF_MAX_VAR_DIMS)  ! vector of dimension ids</span></div>
<div class="line"><a id="l03788" name="l03788"></a><span class="lineno"> 3788</span>   <span class="keywordtype">integer</span> natt                   <span class="comment">! number of attributes</span></div>
<div class="line"><a id="l03789" name="l03789"></a><span class="lineno"> 3789</span><span class="comment">!</span></div>
<div class="line"><a id="l03790" name="l03790"></a><span class="lineno"> 3790</span><span class="comment">! Variables for setting up H2O table</span></div>
<div class="line"><a id="l03791" name="l03791"></a><span class="lineno"> 3791</span><span class="comment">!</span></div>
<div class="line"><a id="l03792" name="l03792"></a><span class="lineno"> 3792</span>   <span class="keywordtype">integer</span> t                     <span class="comment">! path temperature</span></div>
<div class="line"><a id="l03793" name="l03793"></a><span class="lineno"> 3793</span>   <span class="keywordtype">integer</span> tmin                  <span class="comment">! mininum path temperature</span></div>
<div class="line"><a id="l03794" name="l03794"></a><span class="lineno"> 3794</span>   <span class="keywordtype">integer</span> tmax                  <span class="comment">! maximum path temperature</span></div>
<div class="line"><a id="l03795" name="l03795"></a><span class="lineno"> 3795</span>   <span class="keywordtype">integer</span> itype                 <span class="comment">! type of sat. pressure (=0 -&gt; H2O only)</span></div>
<div class="line"><a id="l03796" name="l03796"></a><span class="lineno"> 3796</span>   <span class="keywordtype">integer</span> i</div>
<div class="line"><a id="l03797" name="l03797"></a><span class="lineno"> 3797</span><span class="keywordtype">   real</span>(r8) tdbl</div>
<div class="line"><a id="l03798" name="l03798"></a><span class="lineno"> 3798</span> </div>
<div class="line"><a id="l03799" name="l03799"></a><span class="lineno"> 3799</span>      <span class="keywordtype">LOGICAL</span>                 :: opened</div>
<div class="line"><a id="l03800" name="l03800"></a><span class="lineno"> 3800</span>      <span class="keywordtype">LOGICAL</span> , <span class="keywordtype">EXTERNAL</span>      :: wrf_dm_on_monitor</div>
<div class="line"><a id="l03801" name="l03801"></a><span class="lineno"> 3801</span> </div>
<div class="line"><a id="l03802" name="l03802"></a><span class="lineno"> 3802</span>      <span class="keywordtype">CHARACTER*80</span> errmess</div>
<div class="line"><a id="l03803" name="l03803"></a><span class="lineno"> 3803</span>      <span class="keywordtype">INTEGER</span> cam_abs_unit</div>
<div class="line"><a id="l03804" name="l03804"></a><span class="lineno"> 3804</span> </div>
<div class="line"><a id="l03805" name="l03805"></a><span class="lineno"> 3805</span><span class="comment">!</span></div>
<div class="line"><a id="l03806" name="l03806"></a><span class="lineno"> 3806</span><span class="comment">! Constants to set</span></div>
<div class="line"><a id="l03807" name="l03807"></a><span class="lineno"> 3807</span><span class="comment">!</span></div>
<div class="line"><a id="l03808" name="l03808"></a><span class="lineno"> 3808</span>   <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a1bb9cc2ee75f4fa1900929f2ce84f756">p0</a>     = pstdx</div>
<div class="line"><a id="l03809" name="l03809"></a><span class="lineno"> 3809</span>   <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ad454810cad51890d5647d6d88d3c468d">amd</a>    = mwdryx</div>
<div class="line"><a id="l03810" name="l03810"></a><span class="lineno"> 3810</span>   <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#abbfa35151362a083fe9ec53131b7c960">amco2</a>  = mwco2x</div>
<div class="line"><a id="l03811" name="l03811"></a><span class="lineno"> 3811</span><span class="comment">!</span></div>
<div class="line"><a id="l03812" name="l03812"></a><span class="lineno"> 3812</span><span class="comment">! Coefficients for h2o emissivity and absorptivity for overlap of H2O </span></div>
<div class="line"><a id="l03813" name="l03813"></a><span class="lineno"> 3813</span><span class="comment">!    and trace gases.</span></div>
<div class="line"><a id="l03814" name="l03814"></a><span class="lineno"> 3814</span><span class="comment">!</span></div>
<div class="line"><a id="l03815" name="l03815"></a><span class="lineno"> 3815</span>   <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ad3fcaf53dce141c715c1280f85a18a57">c16</a>  = <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a2fcd0e1d72a765566ee6f0e4f9aeb071">coefj</a>(3,1)/<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a2fcd0e1d72a765566ee6f0e4f9aeb071">coefj</a>(2,1)</div>
<div class="line"><a id="l03816" name="l03816"></a><span class="lineno"> 3816</span>   <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#acbd9c87ec89867da86831dddc3c84346">c17</a>  = <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a0cf8abb99d0e97c5cefb8c8a80b6ac24">coefk</a>(3,1)/<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a0cf8abb99d0e97c5cefb8c8a80b6ac24">coefk</a>(2,1)</div>
<div class="line"><a id="l03817" name="l03817"></a><span class="lineno"> 3817</span>   <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a91608f04c175c53bf3e87fbf7f71b476">c26</a>  = <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a2fcd0e1d72a765566ee6f0e4f9aeb071">coefj</a>(3,2)/<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a2fcd0e1d72a765566ee6f0e4f9aeb071">coefj</a>(2,2)</div>
<div class="line"><a id="l03818" name="l03818"></a><span class="lineno"> 3818</span>   <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a7ae868238a2cdfc0aa70b65d1596dafe">c27</a>  = <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a0cf8abb99d0e97c5cefb8c8a80b6ac24">coefk</a>(3,2)/<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a0cf8abb99d0e97c5cefb8c8a80b6ac24">coefk</a>(2,2)</div>
<div class="line"><a id="l03819" name="l03819"></a><span class="lineno"> 3819</span>   <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a0b6730ade826553952e2962a79766017">c28</a>  = .5</div>
<div class="line"><a id="l03820" name="l03820"></a><span class="lineno"> 3820</span>   <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ad9b75c3e27e4a2ed773f89f9e8ab0a3f">c29</a>  = .002053</div>
<div class="line"><a id="l03821" name="l03821"></a><span class="lineno"> 3821</span>   <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a07f134f5565dcff0d054824cfe1113c7">c30</a>  = .1</div>
<div class="line"><a id="l03822" name="l03822"></a><span class="lineno"> 3822</span>   <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a3dbef7f2c9ce5cd74b83171c4c8f9de5">c31</a>  = 3.0e-5</div>
<div class="line"><a id="l03823" name="l03823"></a><span class="lineno"> 3823</span><span class="comment">!</span></div>
<div class="line"><a id="l03824" name="l03824"></a><span class="lineno"> 3824</span><span class="comment">! Initialize further longwave constants referring to far wing</span></div>
<div class="line"><a id="l03825" name="l03825"></a><span class="lineno"> 3825</span><span class="comment">! correction for overlap of H2O and trace gases; R&amp;D refers to:</span></div>
<div class="line"><a id="l03826" name="l03826"></a><span class="lineno"> 3826</span><span class="comment">!</span></div>
<div class="line"><a id="l03827" name="l03827"></a><span class="lineno"> 3827</span><span class="comment">!            Ramanathan, V. and  P.Downey, 1986: A Nonisothermal</span></div>
<div class="line"><a id="l03828" name="l03828"></a><span class="lineno"> 3828</span><span class="comment">!            Emissivity and Absorptivity Formulation for Water Vapor</span></div>
<div class="line"><a id="l03829" name="l03829"></a><span class="lineno"> 3829</span><span class="comment">!            Journal of Geophysical Research, vol. 91., D8, pp 8649-8666</span></div>
<div class="line"><a id="l03830" name="l03830"></a><span class="lineno"> 3830</span><span class="comment">!</span></div>
<div class="line"><a id="l03831" name="l03831"></a><span class="lineno"> 3831</span>   <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a2f304c7866466736faac432614d5483c">fwcoef</a> = .1           <span class="comment">! See eq(33) R&amp;D</span></div>
<div class="line"><a id="l03832" name="l03832"></a><span class="lineno"> 3832</span>   <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a087748a09967fff52683677c502cc639">fwc1</a>   = .30          <span class="comment">! See eq(33) R&amp;D</span></div>
<div class="line"><a id="l03833" name="l03833"></a><span class="lineno"> 3833</span>   <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a0ac4d7c3fe1cd44ede623405b82b40b9">fwc2</a>   = 4.5          <span class="comment">! See eq(33) and eq(34) in R&amp;D</span></div>
<div class="line"><a id="l03834" name="l03834"></a><span class="lineno"> 3834</span>   <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#ae0a6100d31d7cf309cb86c7352961d4b">fc1</a>    = 2.6          <span class="comment">! See eq(34) R&amp;D</span></div>
<div class="line"><a id="l03835" name="l03835"></a><span class="lineno"> 3835</span> </div>
<div class="line"><a id="l03836" name="l03836"></a><span class="lineno"> 3836</span>      <span class="keywordflow">IF</span> ( wrf_dm_on_monitor() ) <span class="keywordflow">THEN</span></div>
<div class="line"><a id="l03837" name="l03837"></a><span class="lineno"> 3837</span>        <span class="keywordflow">DO</span> i = 10,99</div>
<div class="line"><a id="l03838" name="l03838"></a><span class="lineno"> 3838</span>          <span class="keyword">INQUIRE</span> ( i , opened = opened )</div>
<div class="line"><a id="l03839" name="l03839"></a><span class="lineno"> 3839</span>          <span class="keywordflow">IF</span> ( .NOT. opened ) <span class="keywordflow">THEN</span></div>
<div class="line"><a id="l03840" name="l03840"></a><span class="lineno"> 3840</span>            cam_abs_unit = i</div>
<div class="line"><a id="l03841" name="l03841"></a><span class="lineno"> 3841</span>            <span class="keywordflow">GOTO</span> 2010</div>
<div class="line"><a id="l03842" name="l03842"></a><span class="lineno"> 3842</span><span class="keywordflow">          ENDIF</span></div>
<div class="line"><a id="l03843" name="l03843"></a><span class="lineno"> 3843</span><span class="keywordflow">        ENDDO</span></div>
<div class="line"><a id="l03844" name="l03844"></a><span class="lineno"> 3844</span>        cam_abs_unit = -1</div>
<div class="line"><a id="l03845" name="l03845"></a><span class="lineno"> 3845</span> 2010   <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a id="l03846" name="l03846"></a><span class="lineno"> 3846</span><span class="keywordflow">      ENDIF</span></div>
<div class="line"><a id="l03847" name="l03847"></a><span class="lineno"> 3847</span>      <span class="keyword">CALL </span>wrf_dm_bcast_bytes ( cam_abs_unit , iwordsize )</div>
<div class="line"><a id="l03848" name="l03848"></a><span class="lineno"> 3848</span>      <span class="keywordflow">IF</span> ( cam_abs_unit &lt; 0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a id="l03849" name="l03849"></a><span class="lineno"> 3849</span>        <span class="keyword">CALL </span>wrf_error_fatal ( <span class="stringliteral">&#39;module_ra_cam: radaeinit: Can not find unused fortran unit to read in lookup table.&#39;</span> )</div>
<div class="line"><a id="l03850" name="l03850"></a><span class="lineno"> 3850</span><span class="keywordflow">      ENDIF</span></div>
<div class="line"><a id="l03851" name="l03851"></a><span class="lineno"> 3851</span> </div>
<div class="line"><a id="l03852" name="l03852"></a><span class="lineno"> 3852</span>        <span class="keywordflow">IF</span> ( wrf_dm_on_monitor() ) <span class="keywordflow">THEN</span></div>
<div class="line"><a id="l03853" name="l03853"></a><span class="lineno"> 3853</span>          <span class="keyword">OPEN</span>(cam_abs_unit,file=<span class="stringliteral">&#39;CAM_ABS_DATA&#39;</span>,                  &amp;</div>
<div class="line"><a id="l03854" name="l03854"></a><span class="lineno"> 3854</span>               form=<span class="stringliteral">&#39;UNFORMATTED&#39;</span>,status=<span class="stringliteral">&#39;OLD&#39;</span>,err=9010)</div>
<div class="line"><a id="l03855" name="l03855"></a><span class="lineno"> 3855</span>          <span class="keyword">call </span>wrf_debug(50,<span class="stringliteral">&#39;reading CAM_ABS_DATA&#39;</span>)</div>
<div class="line"><a id="l03856" name="l03856"></a><span class="lineno"> 3856</span><span class="keywordflow">        ENDIF</span></div>
<div class="line"><a id="l03857" name="l03857"></a><span class="lineno"> 3857</span> </div>
<div class="line"><a id="l03858" name="l03858"></a><span class="lineno"> 3858</span><span class="preprocessor">#define DM_BCAST_MACRO(A) CALL wrf_dm_bcast_bytes ( A , size ( A ) * r8 )</span></div>
<div class="line"><a id="l03859" name="l03859"></a><span class="lineno"> 3859</span><span class="preprocessor"></span> </div>
<div class="line"><a id="l03860" name="l03860"></a><span class="lineno"> 3860</span>         <span class="keywordflow">IF</span> ( wrf_dm_on_monitor() ) <span class="keywordflow">then</span></div>
<div class="line"><a id="l03861" name="l03861"></a><span class="lineno"> 3861</span>         <span class="keyword">READ</span> (cam_abs_unit,err=9010) <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#aac6a79b831ca54a536990b02b931911d">ah2onw</a></div>
<div class="line"><a id="l03862" name="l03862"></a><span class="lineno"> 3862</span>         <span class="keyword">READ</span> (cam_abs_unit,err=9010) <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a08e2e0a2a63d08f3ac7e0f7be4a624c0">eh2onw</a> </div>
<div class="line"><a id="l03863" name="l03863"></a><span class="lineno"> 3863</span>         <span class="keyword">READ</span> (cam_abs_unit,err=9010) <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a42d26f57bb7571b24fa14953d728e81f">ah2ow</a> </div>
<div class="line"><a id="l03864" name="l03864"></a><span class="lineno"> 3864</span>         <span class="keyword">READ</span> (cam_abs_unit,err=9010) <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#add3ef9cf636adb1adb208324bcab8dff">cn_ah2ow</a> </div>
<div class="line"><a id="l03865" name="l03865"></a><span class="lineno"> 3865</span>         <span class="keyword">READ</span> (cam_abs_unit,err=9010) <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a2105f6a3c7e4c2675255dfeba4840206">cn_eh2ow</a> </div>
<div class="line"><a id="l03866" name="l03866"></a><span class="lineno"> 3866</span>         <span class="keyword">READ</span> (cam_abs_unit,err=9010) <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#aec3b699656f159d10f9f19feafa18ab4">ln_ah2ow</a> </div>
<div class="line"><a id="l03867" name="l03867"></a><span class="lineno"> 3867</span>         <span class="keyword">READ</span> (cam_abs_unit,err=9010) <a class="code hl_variable" href="namespacemodule__ra__cam__support.html#aba5fb70a3463906359ac16c4389cbd35">ln_eh2ow</a> </div>
<div class="line"><a id="l03868" name="l03868"></a><span class="lineno"> 3868</span> </div>
<div class="line"><a id="l03869" name="l03869"></a><span class="lineno"> 3869</span><span class="keywordflow">         endif</span></div>
<div class="line"><a id="l03870" name="l03870"></a><span class="lineno"> 3870</span> </div>
<div class="line"><a id="l03871" name="l03871"></a><span class="lineno"> 3871</span>         dm_bcast_macro(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#aac6a79b831ca54a536990b02b931911d">ah2onw</a>)</div>
<div class="line"><a id="l03872" name="l03872"></a><span class="lineno"> 3872</span>         dm_bcast_macro(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a08e2e0a2a63d08f3ac7e0f7be4a624c0">eh2onw</a>)</div>
<div class="line"><a id="l03873" name="l03873"></a><span class="lineno"> 3873</span>         dm_bcast_macro(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a42d26f57bb7571b24fa14953d728e81f">ah2ow</a>)</div>
<div class="line"><a id="l03874" name="l03874"></a><span class="lineno"> 3874</span>         dm_bcast_macro(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#add3ef9cf636adb1adb208324bcab8dff">cn_ah2ow</a>)</div>
<div class="line"><a id="l03875" name="l03875"></a><span class="lineno"> 3875</span>         dm_bcast_macro(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a2105f6a3c7e4c2675255dfeba4840206">cn_eh2ow</a>)</div>
<div class="line"><a id="l03876" name="l03876"></a><span class="lineno"> 3876</span>         dm_bcast_macro(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#aec3b699656f159d10f9f19feafa18ab4">ln_ah2ow</a>)</div>
<div class="line"><a id="l03877" name="l03877"></a><span class="lineno"> 3877</span>         dm_bcast_macro(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#aba5fb70a3463906359ac16c4389cbd35">ln_eh2ow</a>)</div>
<div class="line"><a id="l03878" name="l03878"></a><span class="lineno"> 3878</span> </div>
<div class="line"><a id="l03879" name="l03879"></a><span class="lineno"> 3879</span>         <span class="keywordflow">IF</span> ( wrf_dm_on_monitor() ) <span class="keyword">CLOSE</span> (cam_abs_unit)</div>
<div class="line"><a id="l03880" name="l03880"></a><span class="lineno"> 3880</span>      </div>
<div class="line"><a id="l03881" name="l03881"></a><span class="lineno"> 3881</span><span class="comment">! Set up table of H2O saturation vapor pressures for use in calculation</span></div>
<div class="line"><a id="l03882" name="l03882"></a><span class="lineno"> 3882</span><span class="comment">!     effective path RH.  Need separate table from table in wv_saturation </span></div>
<div class="line"><a id="l03883" name="l03883"></a><span class="lineno"> 3883</span><span class="comment">!     because:</span></div>
<div class="line"><a id="l03884" name="l03884"></a><span class="lineno"> 3884</span><span class="comment">!     (1. Path temperatures can fall below minimum of that table; and</span></div>
<div class="line"><a id="l03885" name="l03885"></a><span class="lineno"> 3885</span><span class="comment">!     (2. Abs/Emissivity tables are derived with RH for water only.</span></div>
<div class="line"><a id="l03886" name="l03886"></a><span class="lineno"> 3886</span><span class="comment">!</span></div>
<div class="line"><a id="l03887" name="l03887"></a><span class="lineno"> 3887</span>      tmin = nint(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a05e16d6e3700a843bf571654f96df2bf">min_tp_h2o</a>)</div>
<div class="line"><a id="l03888" name="l03888"></a><span class="lineno"> 3888</span>      tmax = nint(<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a58b17088862aad966a0754297dccecce">max_tp_h2o</a>)+1</div>
<div class="line"><a id="l03889" name="l03889"></a><span class="lineno"> 3889</span>      itype = 0</div>
<div class="line"><a id="l03890" name="l03890"></a><span class="lineno"> 3890</span>      <span class="keywordflow">do</span> t = tmin, tmax</div>
<div class="line"><a id="l03891" name="l03891"></a><span class="lineno"> 3891</span><span class="comment">!        call gffgch(dble(t),estblh2o(t-tmin),itype)</span></div>
<div class="line"><a id="l03892" name="l03892"></a><span class="lineno"> 3892</span>         tdbl = t</div>
<div class="line"><a id="l03893" name="l03893"></a><span class="lineno"> 3893</span>         <span class="keyword">call </span><a class="code hl_function" href="namespacemodule__ra__cam__support.html#acbc7ddcbc2ec8b0b8f4b5dba23f0df96">gffgch</a>(tdbl,<a class="code hl_variable" href="namespacemodule__ra__cam__support.html#a3ce1d55cd319df40cff8150984cc7e91">estblh2o</a>(t-tmin),itype)</div>
<div class="line"><a id="l03894" name="l03894"></a><span class="lineno"> 3894</span><span class="keywordflow">      end do</span></div>
<div class="line"><a id="l03895" name="l03895"></a><span class="lineno"> 3895</span> </div>
<div class="line"><a id="l03896" name="l03896"></a><span class="lineno"> 3896</span>     <span class="keywordflow">RETURN</span></div>
<div class="line"><a id="l03897" name="l03897"></a><span class="lineno"> 3897</span>9010 <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a id="l03898" name="l03898"></a><span class="lineno"> 3898</span>     <span class="keyword">WRITE</span>( errmess , <span class="stringliteral">&#39;(A35,I4)&#39;</span> ) <span class="stringliteral">&#39;module_ra_cam: error reading unit &#39;</span>,cam_abs_unit</div>
<div class="line"><a id="l03899" name="l03899"></a><span class="lineno"> 3899</span>     <span class="keyword">CALL </span>wrf_error_fatal(errmess)</div>
<div class="line"><a id="l03900" name="l03900"></a><span class="lineno"> 3900</span><span class="keyword">end subroutine </span>radaeini</div>
<div class="line"><a id="l03901" name="l03901"></a><span class="lineno"> 3901</span> </div>
<div class="line"><a id="l03902" name="l03902"></a><span class="lineno"> 3902</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l03903" name="l03903"></a><span class="lineno"> 3903</span><span class="preprocessor"></span><span class="comment">!ldf end (05-01-2011).</span></div>
<div class="line"><a id="l03904" name="l03904"></a><span class="lineno"> 3904</span> </div>
<div class="line"><a id="l03905" name="l03905"></a><span class="lineno"> 3905</span><span class="keyword">end MODULE </span><a class="code hl_namespace" href="namespacemodule__ra__cam__support.html">module_ra_cam_support</a></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html"><div class="ttname"><a href="namespacemodule__ra__cam__support.html">module_ra_cam_support</a></div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00001">module_ra_cam_support.F:1</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a013d9c7b7e12d40bf7c4beae240c71a5"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a013d9c7b7e12d40bf7c4beae240c71a5">module_ra_cam_support::wsslt</a></div><div class="ttdeci">real(r8), dimension(:,:), allocatable wsslt</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00233">module_ra_cam_support.F:233</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a0183c64b88e8ab41234d01725523454f"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a0183c64b88e8ab41234d01725523454f">module_ra_cam_support::carscl</a></div><div class="ttdeci">real(r8) carscl</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00059">module_ra_cam_support.F:59</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a027edc99883f6383db3e8108e2d28bce"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a027edc99883f6383db3e8108e2d28bce">module_ra_cam_support::idxvolc</a></div><div class="ttdeci">integer idxvolc</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00032">module_ra_cam_support.F:32</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a02a6fd3379ca9f88aedc856917d393ee"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a02a6fd3379ca9f88aedc856917d393ee">module_ra_cam_support::rga</a></div><div class="ttdeci">real(r8) rga</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00178">module_ra_cam_support.F:178</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a02a9ac601d0bc3f5408141218044d38e"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a02a9ac601d0bc3f5408141218044d38e">module_ra_cam_support::ssltscl</a></div><div class="ttdeci">real(r8) ssltscl</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00060">module_ra_cam_support.F:60</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a03ea99448698668710d5d8c1bfb893c7"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a03ea99448698668710d5d8c1bfb893c7">module_ra_cam_support::kdst</a></div><div class="ttdeci">real(r8), dimension(ndstsz, nspint) kdst</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00252">module_ra_cam_support.F:252</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a05e16d6e3700a843bf571654f96df2bf"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a05e16d6e3700a843bf571654f96df2bf">module_ra_cam_support::min_tp_h2o</a></div><div class="ttdeci">real(r8), parameter min_tp_h2o</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00085">module_ra_cam_support.F:85</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a07f134f5565dcff0d054824cfe1113c7"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a07f134f5565dcff0d054824cfe1113c7">module_ra_cam_support::c30</a></div><div class="ttdeci">real(r8) c30</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00107">module_ra_cam_support.F:107</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a087748a09967fff52683677c502cc639"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a087748a09967fff52683677c502cc639">module_ra_cam_support::fwc1</a></div><div class="ttdeci">real(r8) fwc1</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00109">module_ra_cam_support.F:109</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a08e2e0a2a63d08f3ac7e0f7be4a624c0"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a08e2e0a2a63d08f3ac7e0f7be4a624c0">module_ra_cam_support::eh2onw</a></div><div class="ttdeci">real(r8), dimension(:,:,:,:,:), allocatable eh2onw</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00117">module_ra_cam_support.F:117</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a0902f94f024705cbfd239e44b64f8883"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a0902f94f024705cbfd239e44b64f8883">module_ra_cam_support::cyr</a></div><div class="ttdeci">integer, parameter cyr</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00267">module_ra_cam_support.F:267</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a09f581223422f76e63d062171eea6d90"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a09f581223422f76e63d062171eea6d90">module_ra_cam_support::rair</a></div><div class="ttdeci">real(r8) rair</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00200">module_ra_cam_support.F:200</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a0a79238bc77c689eec9388903e00babb"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a0a79238bc77c689eec9388903e00babb">module_ra_cam_support::esinti</a></div><div class="ttdeci">subroutine esinti(epslon, latvap, latice, rh2o, cpair, tmelt)</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l02775">module_ra_cam_support.F:2776</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a0a9ae8d88dbd86e1bed5948a3bc5224e"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a0a9ae8d88dbd86e1bed5948a3bc5224e">module_ra_cam_support::lin_interpol2</a></div><div class="ttdeci">real function lin_interpol2(x, f, y)</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l02478">module_ra_cam_support.F:2479</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a0ac4d7c3fe1cd44ede623405b82b40b9"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a0ac4d7c3fe1cd44ede623405b82b40b9">module_ra_cam_support::fwc2</a></div><div class="ttdeci">real(r8) fwc2</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00109">module_ra_cam_support.F:109</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a0b6730ade826553952e2962a79766017"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a0b6730ade826553952e2962a79766017">module_ra_cam_support::c28</a></div><div class="ttdeci">real(r8) c28</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00107">module_ra_cam_support.F:107</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a0bdd4bd6e389e15e2c8f955f8b37870a"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a0bdd4bd6e389e15e2c8f955f8b37870a">module_ra_cam_support::trcmix</a></div><div class="ttdeci">subroutine trcmix(lchnk, ncol, pcols, pver, pmid, clat, n2o, ch4, cfc11, cfc12)</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l01290">module_ra_cam_support.F:1293</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a0bedf61bf2aa689f1fe7d40c1fb2421c"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a0bedf61bf2aa689f1fe7d40c1fb2421c">module_ra_cam_support::findvalue</a></div><div class="ttdeci">integer function findvalue(ix, n, ain, indxa)</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l03105">module_ra_cam_support.F:3106</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a0cf8abb99d0e97c5cefb8c8a80b6ac24"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a0cf8abb99d0e97c5cefb8c8a80b6ac24">module_ra_cam_support::coefk</a></div><div class="ttdeci">real(r8), dimension(3, 2) coefk</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00140">module_ra_cam_support.F:140</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a0f42e6165f18772a89612e762798b41e"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a0f42e6165f18772a89612e762798b41e">module_ra_cam_support::dayspy</a></div><div class="ttdeci">real(r8) dayspy</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00188">module_ra_cam_support.F:188</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a119e6bcbd1c35c9fa8e6bd724e6da1b7"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a119e6bcbd1c35c9fa8e6bd724e6da1b7">module_ra_cam_support::kcphil</a></div><div class="ttdeci">real(r8), dimension(:,:), allocatable kcphil</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00235">module_ra_cam_support.F:235</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a130c6997ed212e28b4c576707a7e82ad"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a130c6997ed212e28b4c576707a7e82ad">module_ra_cam_support::idxdustfirst</a></div><div class="ttdeci">integer idxdustfirst</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00025">module_ra_cam_support.F:25</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a14789330a713385f62a77c3f58d63d74"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a14789330a713385f62a77c3f58d63d74">module_ra_cam_support::min_p_h2o</a></div><div class="ttdeci">real(r8), parameter min_p_h2o</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00099">module_ra_cam_support.F:99</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a1a12feb1033e5148328277eb0a083ab3"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a1a12feb1033e5148328277eb0a083ab3">module_ra_cam_support::ntoplw</a></div><div class="ttdeci">integer ntoplw</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00340">module_ra_cam_support.F:340</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a1b3671cb014fbdf0e5cf156dbd5bd316"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a1b3671cb014fbdf0e5cf156dbd5bd316">module_ra_cam_support::dustscl</a></div><div class="ttdeci">real(r8) dustscl</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00061">module_ra_cam_support.F:61</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a1bb9cc2ee75f4fa1900929f2ce84f756"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a1bb9cc2ee75f4fa1900929f2ce84f756">module_ra_cam_support::p0</a></div><div class="ttdeci">real(r8) p0</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00113">module_ra_cam_support.F:113</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a1c7bb97c83a485602d50b5b1a89acae0"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a1c7bb97c83a485602d50b5b1a89acae0">module_ra_cam_support::co2</a></div><div class="ttdeci">real(r8), dimension(cyr) co2</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00306">module_ra_cam_support.F:306</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a1d3aedbb07ddd76fbe919f80ad7d8f40"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a1d3aedbb07ddd76fbe919f80ad7d8f40">module_ra_cam_support::stebol</a></div><div class="ttdeci">real(r8) stebol</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00184">module_ra_cam_support.F:184</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a2007fbc8d58c13c4e5ba46f0f7f8bc31"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a2007fbc8d58c13c4e5ba46f0f7f8bc31">module_ra_cam_support::cldclw</a></div><div class="ttdeci">subroutine cldclw(lchnk, ncol, pcols, pver, pverp, zi, clwp, tpw, hl)</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l02231">module_ra_cam_support.F:2232</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a201fd10fb05cb12f2ad93ec9539aebc8"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a201fd10fb05cb12f2ad93ec9539aebc8">module_ra_cam_support::o_fa</a></div><div class="ttdeci">integer, parameter o_fa</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00146">module_ra_cam_support.F:146</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a20408f7ac63d867f91e77786c442a6d0"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a20408f7ac63d867f91e77786c442a6d0">module_ra_cam_support::ksslt</a></div><div class="ttdeci">real(r8), dimension(:,:), allocatable ksslt</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00232">module_ra_cam_support.F:232</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a2105f6a3c7e4c2675255dfeba4840206"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a2105f6a3c7e4c2675255dfeba4840206">module_ra_cam_support::cn_eh2ow</a></div><div class="ttdeci">real(r8), dimension(:,:,:,:,:), allocatable cn_eh2ow</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00120">module_ra_cam_support.F:120</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a23c78317414125c627ac5c180f91a508"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a23c78317414125c627ac5c180f91a508">module_ra_cam_support::masterproc</a></div><div class="ttdeci">logical masterproc</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00342">module_ra_cam_support.F:342</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a24d476dd94afaa7f4e36e5856f37194c"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a24d476dd94afaa7f4e36e5856f37194c">module_ra_cam_support::idxbcpho</a></div><div class="ttdeci">integer idxbcpho</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00028">module_ra_cam_support.F:28</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a24f95ffae31c24f1e91116ff45710b90"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a24f95ffae31c24f1e91116ff45710b90">module_ra_cam_support::naer_all</a></div><div class="ttdeci">integer, parameter naer_all</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00019">module_ra_cam_support.F:19</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a281f8f573adfae5e50a6d3d6cd879792"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a281f8f573adfae5e50a6d3d6cd879792">module_ra_cam_support::f12vmr</a></div><div class="ttdeci">real(r8) f12vmr</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00265">module_ra_cam_support.F:265</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a2a77d630c6bbf754a49438adeee81233"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a2a77d630c6bbf754a49438adeee81233">module_ra_cam_support::r_universal</a></div><div class="ttdeci">real(r8) r_universal</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00202">module_ra_cam_support.F:202</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a2f304c7866466736faac432614d5483c"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a2f304c7866466736faac432614d5483c">module_ra_cam_support::fwcoef</a></div><div class="ttdeci">real(r8) fwcoef</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00108">module_ra_cam_support.F:108</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a2f81c5a52f48e33d222b077587809d66"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a2f81c5a52f48e33d222b077587809d66">module_ra_cam_support::min_lp_h2o</a></div><div class="ttdeci">real(r8), parameter min_lp_h2o</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00098">module_ra_cam_support.F:98</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a2fcd0e1d72a765566ee6f0e4f9aeb071"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a2fcd0e1d72a765566ee6f0e4f9aeb071">module_ra_cam_support::coefj</a></div><div class="ttdeci">real(r8), dimension(3, 2) coefj</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00136">module_ra_cam_support.F:136</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a3302213173442f385c5ddb46d252c41f"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a3302213173442f385c5ddb46d252c41f">module_ra_cam_support::dpfo3</a></div><div class="ttdeci">real(r8) dpfo3</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00186">module_ra_cam_support.F:186</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a35f5066746b13db0893d19b839574bc9"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a35f5066746b13db0893d19b839574bc9">module_ra_cam_support::idxcarbonfirst</a></div><div class="ttdeci">integer idxcarbonfirst</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00026">module_ra_cam_support.F:26</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a362aff727bf79120acd003d8242e216b"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a362aff727bf79120acd003d8242e216b">module_ra_cam_support::strat_volcanic</a></div><div class="ttdeci">logical strat_volcanic</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00350">module_ra_cam_support.F:350</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a3641bbffc5b9d01322506476442a962a"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a3641bbffc5b9d01322506476442a962a">module_ra_cam_support::idx_lw_0800_1000</a></div><div class="ttdeci">integer, parameter idx_lw_0800_1000</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00067">module_ra_cam_support.F:67</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a36a1b928736da9a5af232513245cc91c"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a36a1b928736da9a5af232513245cc91c">module_ra_cam_support::ixcldice</a></div><div class="ttdeci">integer ixcldice</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00014">module_ra_cam_support.F:14</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a38c37461e43d0edd8fe972d628baab63"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a38c37461e43d0edd8fe972d628baab63">module_ra_cam_support::n_te</a></div><div class="ttdeci">integer, parameter n_te</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00105">module_ra_cam_support.F:105</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a390a0bf0137854ad1b9f0e455aab7503"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a390a0bf0137854ad1b9f0e455aab7503">module_ra_cam_support::tauback</a></div><div class="ttdeci">real(r8) tauback</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00054">module_ra_cam_support.F:54</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a3c5fc31d42f05094136cd2dec4f563ec"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a3c5fc31d42f05094136cd2dec4f563ec">module_ra_cam_support::mwh2o</a></div><div class="ttdeci">real(r8) mwh2o</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00194">module_ra_cam_support.F:194</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a3c649ff81a5df618b4dda31c33db3bae"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a3c649ff81a5df618b4dda31c33db3bae">module_ra_cam_support::fh2oself</a></div><div class="ttdeci">real(r8) function fh2oself(temp)</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l02743">module_ra_cam_support.F:2744</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a3ce1d55cd319df40cff8150984cc7e91"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a3ce1d55cd319df40cff8150984cc7e91">module_ra_cam_support::estblh2o</a></div><div class="ttdeci">real(r8), dimension(0:ntemp) estblh2o</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00145">module_ra_cam_support.F:145</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a3dbef7f2c9ce5cd74b83171c4c8f9de5"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a3dbef7f2c9ce5cd74b83171c4c8f9de5">module_ra_cam_support::c31</a></div><div class="ttdeci">real(r8) c31</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00107">module_ra_cam_support.F:107</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a4098d4672dba23f66f732f3e0195dfd1"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a4098d4672dba23f66f732f3e0195dfd1">module_ra_cam_support::sulscl_rf</a></div><div class="ttdeci">real(r8) sulscl_rf</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00046">module_ra_cam_support.F:46</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a417d3c687b803b9fa520768498503e07"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a417d3c687b803b9fa520768498503e07">module_ra_cam_support::gcphil</a></div><div class="ttdeci">real(r8), dimension(:,:), allocatable gcphil</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00237">module_ra_cam_support.F:237</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a42d26f57bb7571b24fa14953d728e81f"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a42d26f57bb7571b24fa14953d728e81f">module_ra_cam_support::ah2ow</a></div><div class="ttdeci">real(r8), dimension(:,:,:,:,:), allocatable ah2ow</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00118">module_ra_cam_support.F:118</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a4446dd561840717c0510f977776013a7"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a4446dd561840717c0510f977776013a7">module_ra_cam_support::psi</a></div><div class="ttdeci">real(r8) function psi(tpx, iband)</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l02664">module_ra_cam_support.F:2665</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a44b597fef2b9c66cd7f1e345ca48b2db"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a44b597fef2b9c66cd7f1e345ca48b2db">module_ra_cam_support::ozncyc</a></div><div class="ttdeci">logical ozncyc</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00343">module_ra_cam_support.F:343</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a455077c905b075fb0c227ed4d0e73e09"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a455077c905b075fb0c227ed4d0e73e09">module_ra_cam_support::mwdry</a></div><div class="ttdeci">real(r8) mwdry</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00190">module_ra_cam_support.F:190</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a45931081332eeb6af5a457003dfc59bc"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a45931081332eeb6af5a457003dfc59bc">module_ra_cam_support::dustscl_rf</a></div><div class="ttdeci">real(r8) dustscl_rf</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00049">module_ra_cam_support.F:49</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a46342ec26656238d58f64d5d8be63d97"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a46342ec26656238d58f64d5d8be63d97">module_ra_cam_support::exp_interpol</a></div><div class="ttdeci">real(r8) function exp_interpol(x, f, y)</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l02386">module_ra_cam_support.F:2387</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a47269dd12293e86f1bb796d58d63fc8d"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a47269dd12293e86f1bb796d58d63fc8d">module_ra_cam_support::gcb</a></div><div class="ttdeci">real(r8), dimension(nspint) gcb</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00247">module_ra_cam_support.F:247</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a4888774864252c2e557495881ddbaa40"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a4888774864252c2e557495881ddbaa40">module_ra_cam_support::co2mmr</a></div><div class="ttdeci">real(r8) co2mmr</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00192">module_ra_cam_support.F:192</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a49bd824d487a1d945b332a79c956d68e"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a49bd824d487a1d945b332a79c956d68e">module_ra_cam_support::vert_interpolate</a></div><div class="ttdeci">subroutine vert_interpolate(Match_ps, aerosolc, m_hybi, paerlev, naer_c, pint, n, AEROSOL_mmr, pcols, pver, pverp, ncol, c)</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l01909">module_ra_cam_support.F:1910</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a4ba37464e5da87a20bbbbd42eb6ff761"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a4ba37464e5da87a20bbbbd42eb6ff761">module_ra_cam_support::cldovrlap</a></div><div class="ttdeci">subroutine cldovrlap(lchnk, ncol, pcols, pver, pverp, pint, cld, nmxrgn, pmxrgn)</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l02153">module_ra_cam_support.F:2154</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a4e848e3e0511ebba4d1541494c416613"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a4e848e3e0511ebba4d1541494c416613">module_ra_cam_support::tmelt</a></div><div class="ttdeci">real(r8) tmelt</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00201">module_ra_cam_support.F:201</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a4efde24139c790af90e4d1221ee24787"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a4efde24139c790af90e4d1221ee24787">module_ra_cam_support::background</a></div><div class="ttdeci">subroutine background(lchnk, ncol, pint, pcols, pverr, pverrp, mmr)</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l01787">module_ra_cam_support.F:1788</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a4fc00dfce828f96801018ff9aa3df540"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a4fc00dfce828f96801018ff9aa3df540">module_ra_cam_support::ixcldliq</a></div><div class="ttdeci">integer ixcldliq</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00013">module_ra_cam_support.F:13</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a5015a287bd422630ce9207d3cf048d9e"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a5015a287bd422630ce9207d3cf048d9e">module_ra_cam_support::latvap</a></div><div class="ttdeci">real(r8) latvap</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00203">module_ra_cam_support.F:203</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a521884c838130d3a7fce69511e4708a0"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a521884c838130d3a7fce69511e4708a0">module_ra_cam_support::idxsslt</a></div><div class="ttdeci">integer idxsslt</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00024">module_ra_cam_support.F:24</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a54962ae853da73335f745d7f188d8aa2"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a54962ae853da73335f745d7f188d8aa2">module_ra_cam_support::mwco2</a></div><div class="ttdeci">real(r8) mwco2</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00193">module_ra_cam_support.F:193</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a54ecd7cfe228dfaee0defa871d2ab152"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a54ecd7cfe228dfaee0defa871d2ab152">module_ra_cam_support::cappa</a></div><div class="ttdeci">real(r8) cappa</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00199">module_ra_cam_support.F:199</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a55540415fe1cc156dd9204bb7129de14"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a55540415fe1cc156dd9204bb7129de14">module_ra_cam_support::retab</a></div><div class="ttdeci">real(r8), dimension(95), save retab</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00352">module_ra_cam_support.F:352</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a58b17088862aad966a0754297dccecce"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a58b17088862aad966a0754297dccecce">module_ra_cam_support::max_tp_h2o</a></div><div class="ttdeci">real(r8), parameter max_tp_h2o</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00086">module_ra_cam_support.F:86</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a5971b22b001ecc165f9c3eb2222b9225"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a5971b22b001ecc165f9c3eb2222b9225">module_ra_cam_support::ssltscl_rf</a></div><div class="ttdeci">real(r8) ssltscl_rf</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00048">module_ra_cam_support.F:48</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a597b13016a0f27c53709bafdf3a4169a"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a597b13016a0f27c53709bafdf3a4169a">module_ra_cam_support::gsslt</a></div><div class="ttdeci">real(r8), dimension(:,:), allocatable gsslt</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00234">module_ra_cam_support.F:234</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a59a5f8093c36f54b739fac17bb9f2158"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a59a5f8093c36f54b739fac17bb9f2158">module_ra_cam_support::volcscl</a></div><div class="ttdeci">real(r8) volcscl</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00062">module_ra_cam_support.F:62</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a5c7dc0d73653270f1ac4ad36d5c2d6ea"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a5c7dc0d73653270f1ac4ad36d5c2d6ea">module_ra_cam_support::validfactors</a></div><div class="ttdeci">logical function validfactors(fact1, fact2)</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l02608">module_ra_cam_support.F:2609</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a5e62f9ce314a5b32db8ca6283d47dda9"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a5e62f9ce314a5b32db8ca6283d47dda9">module_ra_cam_support::dpfco2</a></div><div class="ttdeci">real(r8) dpfco2</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00187">module_ra_cam_support.F:187</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a601da5d1916ef5ff2acfdbd3e6631643"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a601da5d1916ef5ff2acfdbd3e6631643">module_ra_cam_support::cpair</a></div><div class="ttdeci">real(r8) cpair</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00180">module_ra_cam_support.F:180</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a6169752cdbc54265aba357093feb3e77"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a6169752cdbc54265aba357093feb3e77">module_ra_cam_support::idxocpho</a></div><div class="ttdeci">integer idxocpho</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00027">module_ra_cam_support.F:27</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a61750fd4c9efc4e3d1e94b50f7c6eb97"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a61750fd4c9efc4e3d1e94b50f7c6eb97">module_ra_cam_support::max_lp_h2o</a></div><div class="ttdeci">real(r8), parameter max_lp_h2o</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00100">module_ra_cam_support.F:100</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a619b4abbc0ae813bf2c8709cef491d8e"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a619b4abbc0ae813bf2c8709cef491d8e">module_ra_cam_support::idx_lw_1000_1200</a></div><div class="ttdeci">integer, parameter idx_lw_1000_1200</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00068">module_ra_cam_support.F:68</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a61a7b14a17925acd1b5ee1ef5b89af87"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a61a7b14a17925acd1b5ee1ef5b89af87">module_ra_cam_support::wbg</a></div><div class="ttdeci">real(r8), dimension(nspint) wbg</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00240">module_ra_cam_support.F:240</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a6259bce15c4a4f5204905e9234e16336"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a6259bce15c4a4f5204905e9234e16336">module_ra_cam_support::zvir</a></div><div class="ttdeci">real(r8) zvir</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00205">module_ra_cam_support.F:205</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a6547194c35aef1b906c011b0ba56e4cf"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a6547194c35aef1b906c011b0ba56e4cf">module_ra_cam_support::ksul</a></div><div class="ttdeci">real(r8), dimension(:,:), allocatable ksul</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00229">module_ra_cam_support.F:229</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a66ee794a307b383eda1904b5304cfd73"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a66ee794a307b383eda1904b5304cfd73">module_ra_cam_support::gcphob</a></div><div class="ttdeci">real(r8), dimension(nspint) gcphob</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00244">module_ra_cam_support.F:244</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a68912f8cfcb40aec718139f5eca9014c"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a68912f8cfcb40aec718139f5eca9014c">module_ra_cam_support::lin_interpol</a></div><div class="ttdeci">real(r8) function lin_interpol(x, f, y)</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l02432">module_ra_cam_support.F:2433</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a6b84aa6684de2807653f5f8cf8784cd6"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a6b84aa6684de2807653f5f8cf8784cd6">module_ra_cam_support::trcabn</a></div><div class="ttdeci">subroutine trcabn(lchnk, ncol, pcols, pverp, k2, kn, ucfc11, ucfc12, un2o0, un2o1, uch4, uco211, uco212, uco213, uco221, uco222, uco223, tbar, bplnk, winpl, pinpl, tco2, th2o, to3, uptype, dw, s2c, up2, pnew, abstrc, uinpl, aer_trn_ngh)</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00724">module_ra_cam_support.F:732</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a6ba6e133f2dd9a8b43558a6ea0d4af0f"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a6ba6e133f2dd9a8b43558a6ea0d4af0f">module_ra_cam_support::trcab</a></div><div class="ttdeci">subroutine trcab(lchnk, ncol, pcols, pverp, k1, k2, ucfc11, ucfc12, un2o0, un2o1, uch4, uco211, uco212, uco213, uco221, uco222, uco223, bn2o0, bn2o1, bch4, to3co2, pnm, dw, pnew, s2c, uptype, dplh2o, abplnk1, tco2, th2o, to3, abstrc, aer_trn_ttl)</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00436">module_ra_cam_support.F:444</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a6baae65a4d24acd4f21fe63ec6383207"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a6baae65a4d24acd4f21fe63ec6383207">module_ra_cam_support::scon</a></div><div class="ttdeci">real(r8) scon</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00191">module_ra_cam_support.F:191</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a6c542f18b6fd92c5ef302d352efea2e8"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a6c542f18b6fd92c5ef302d352efea2e8">module_ra_cam_support::bigint</a></div><div class="ttdeci">integer, parameter bigint</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00011">module_ra_cam_support.F:11</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a6f1af3e9e0a69d213a9308ccc9d2ef73"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a6f1af3e9e0a69d213a9308ccc9d2ef73">module_ra_cam_support::max_rh_h2o</a></div><div class="ttdeci">real(r8), parameter max_rh_h2o</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00092">module_ra_cam_support.F:92</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a6f6deafe37ef978d01301e8d2fe1177b"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a6f6deafe37ef978d01301e8d2fe1177b">module_ra_cam_support::ndstsz</a></div><div class="ttdeci">integer, parameter ndstsz</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00022">module_ra_cam_support.F:22</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a7333bd6e64880f7c8a34daa55e2a9007"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a7333bd6e64880f7c8a34daa55e2a9007">module_ra_cam_support::kbg</a></div><div class="ttdeci">real(r8), dimension(nspint) kbg</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00239">module_ra_cam_support.F:239</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a7339eabd703a5c422dea9f3771fa52ac"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a7339eabd703a5c422dea9f3771fa52ac">module_ra_cam_support::gdst</a></div><div class="ttdeci">real(r8), dimension(ndstsz, nspint) gdst</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00254">module_ra_cam_support.F:254</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a73b4d94aeace16bc74068bafda784831"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a73b4d94aeace16bc74068bafda784831">module_ra_cam_support::nspint</a></div><div class="ttdeci">integer, parameter nspint</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00226">module_ra_cam_support.F:226</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a753905688ac0510d00957932c5b24c69"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a753905688ac0510d00957932c5b24c69">module_ra_cam_support::estbl</a></div><div class="ttdeci">real(r8), dimension(plenest) estbl</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00213">module_ra_cam_support.F:213</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a77341b9c752243caedf506fd54162e1c"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a77341b9c752243caedf506fd54162e1c">module_ra_cam_support::trcems</a></div><div class="ttdeci">subroutine trcems(lchnk, ncol, pcols, pverp, k, co2t, pnm, ucfc11, ucfc12, un2o0, un2o1, bn2o0, bn2o1, uch4, bch4, uco211, uco212, uco213, uco221, uco222, uco223, uptype, w, s2c, up2, emplnk, th2o, tco2, to3, emstrc, aer_trn_ttl)</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l01017">module_ra_cam_support.F:1025</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a783c25660954e30ad1debe6710645383"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a783c25660954e30ad1debe6710645383">module_ra_cam_support::yrdata</a></div><div class="ttdeci">integer, dimension(cyr) yrdata</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00269">module_ra_cam_support.F:269</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a79996b6b720ac8bae0022f7597e0d185"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a79996b6b720ac8bae0022f7597e0d185">module_ra_cam_support::gbg</a></div><div class="ttdeci">real(r8), dimension(nspint) gbg</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00241">module_ra_cam_support.F:241</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a7a5b6927fda0934eee09b020cc183820"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a7a5b6927fda0934eee09b020cc183820">module_ra_cam_support::gestbl</a></div><div class="ttdeci">subroutine gestbl(tmn, tmx, trice, ip, epsil, latvap, latice, rh2o, cpair, tmeltx)</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l02826">module_ra_cam_support.F:2828</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a7ae868238a2cdfc0aa70b65d1596dafe"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a7ae868238a2cdfc0aa70b65d1596dafe">module_ra_cam_support::c27</a></div><div class="ttdeci">real(r8) c27</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00107">module_ra_cam_support.F:107</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a7c2f0dc7751078ac5b0b47c69d3d8a60"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a7c2f0dc7751078ac5b0b47c69d3d8a60">module_ra_cam_support::fat</a></div><div class="ttdeci">real(r8), dimension(o_fa, nbands), parameter fat</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00160">module_ra_cam_support.F:160</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a7d51028d356ee61ee8035150a78772fd"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a7d51028d356ee61ee8035150a78772fd">module_ra_cam_support::abs_cff_mss_aer</a></div><div class="ttdeci">real(r8), dimension(bnd_nbr_lw) abs_cff_mss_aer</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00079">module_ra_cam_support.F:79</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a7dbaac2569bfd72fec6fb1c09a41ff04"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a7dbaac2569bfd72fec6fb1c09a41ff04">module_ra_cam_support::latice</a></div><div class="ttdeci">real(r8) latice</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00204">module_ra_cam_support.F:204</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a81065323490e9ddac085451828f92a9c"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a81065323490e9ddac085451828f92a9c">module_ra_cam_support::indirect</a></div><div class="ttdeci">logical indirect</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00346">module_ra_cam_support.F:346</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a81d6927b3227403fd19023efa755e3ee"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a81d6927b3227403fd19023efa755e3ee">module_ra_cam_support::f11vmr</a></div><div class="ttdeci">real(r8) f11vmr</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00264">module_ra_cam_support.F:264</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a83f5be2ce9583619a25730f91f3ff2f0"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a83f5be2ce9583619a25730f91f3ff2f0">module_ra_cam_support::trace_gas</a></div><div class="ttdeci">logical trace_gas</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00349">module_ra_cam_support.F:349</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a863b1d9602abdd9946b40135690a4db5"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a863b1d9602abdd9946b40135690a4db5">module_ra_cam_support::idxsul</a></div><div class="ttdeci">integer idxsul</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00023">module_ra_cam_support.F:23</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a89418dd7797528310a5f90613aad0804"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a89418dd7797528310a5f90613aad0804">module_ra_cam_support::gravmks</a></div><div class="ttdeci">real(r8) gravmks</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00179">module_ra_cam_support.F:179</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a8c0779f635e8038371f30b2e384cedca"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a8c0779f635e8038371f30b2e384cedca">module_ra_cam_support::gvolc</a></div><div class="ttdeci">real(r8), dimension(nspint) gvolc</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00250">module_ra_cam_support.F:250</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a8f71ec7909b62c1a0b0eb0e1fbd06976"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a8f71ec7909b62c1a0b0eb0e1fbd06976">module_ra_cam_support::r8</a></div><div class="ttdeci">integer, parameter r8</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00009">module_ra_cam_support.F:9</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a9084c0a881dd139972347d6c86b4a7ed"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a9084c0a881dd139972347d6c86b4a7ed">module_ra_cam_support::carscl_rf</a></div><div class="ttdeci">real(r8) carscl_rf</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00047">module_ra_cam_support.F:47</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a91608f04c175c53bf3e87fbf7f71b476"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a91608f04c175c53bf3e87fbf7f71b476">module_ra_cam_support::c26</a></div><div class="ttdeci">real(r8) c26</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00107">module_ra_cam_support.F:107</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a93c8608518cbf7ff45ee5f58d8e6a7be"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a93c8608518cbf7ff45ee5f58d8e6a7be">module_ra_cam_support::wcb</a></div><div class="ttdeci">real(r8), dimension(nspint) wcb</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00246">module_ra_cam_support.F:246</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a93ec1bf1a4e587cbf80f1fb84effc8d6"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a93ec1bf1a4e587cbf80f1fb84effc8d6">module_ra_cam_support::min_lu_h2o</a></div><div class="ttdeci">real(r8), parameter min_lu_h2o</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00094">module_ra_cam_support.F:94</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a94051f36288fce3a6dd41f8190fd5743"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a94051f36288fce3a6dd41f8190fd5743">module_ra_cam_support::wdst</a></div><div class="ttdeci">real(r8), dimension(ndstsz, nspint) wdst</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00253">module_ra_cam_support.F:253</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a973752fffe2e4a34e2f547d1058fbe37"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a973752fffe2e4a34e2f547d1058fbe37">module_ra_cam_support::min_u_h2o</a></div><div class="ttdeci">real(r8), parameter min_u_h2o</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00095">module_ra_cam_support.F:95</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a9832dcdaf6a335c97892558d45bc608d"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a9832dcdaf6a335c97892558d45bc608d">module_ra_cam_support::naer</a></div><div class="ttdeci">integer, parameter naer</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00020">module_ra_cam_support.F:20</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a98a967fd7677839c0f9325474ffd4e7d"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a98a967fd7677839c0f9325474ffd4e7d">module_ra_cam_support::max_te_h2o</a></div><div class="ttdeci">real(r8), parameter max_te_h2o</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00089">module_ra_cam_support.F:89</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a99553d746383c4fea61ef51ba54a3ce9"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a99553d746383c4fea61ef51ba54a3ce9">module_ra_cam_support::ch4vmr</a></div><div class="ttdeci">real(r8) ch4vmr</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00263">module_ra_cam_support.F:263</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a9959643d725aaab6c2bc49ef8233f17d"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a9959643d725aaab6c2bc49ef8233f17d">module_ra_cam_support::pcf</a></div><div class="ttdeci">real(r8), dimension(6) pcf</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00216">module_ra_cam_support.F:216</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a9a7551f5f201c61f375a1a1856199809"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a9a7551f5f201c61f375a1a1856199809">module_ra_cam_support::dlu_h2o</a></div><div class="ttdeci">real(r8), parameter dlu_h2o</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00097">module_ra_cam_support.F:97</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a9adf2e225e8f61abf989b024fd390325"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a9adf2e225e8f61abf989b024fd390325">module_ra_cam_support::cplol</a></div><div class="ttdeci">real(r8) cplol</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00258">module_ra_cam_support.F:258</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a9c057f8d1d1eca09482693db2df3b5e6"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a9c057f8d1d1eca09482693db2df3b5e6">module_ra_cam_support::idxbcphi</a></div><div class="ttdeci">integer idxbcphi</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00030">module_ra_cam_support.F:30</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a9e392879ac2abab803fe2a16cb920d6c"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a9e392879ac2abab803fe2a16cb920d6c">module_ra_cam_support::fet</a></div><div class="ttdeci">real(r8), dimension(o_fe, nbands), parameter fet</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00169">module_ra_cam_support.F:169</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_a9fbf8fa3ff5c3f81b52acba8c9dbba9e"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#a9fbf8fa3ff5c3f81b52acba8c9dbba9e">module_ra_cam_support::min_rh_h2o</a></div><div class="ttdeci">real(r8), parameter min_rh_h2o</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00091">module_ra_cam_support.F:91</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_aa8d90207a324d0393c24c16a30ca27c7"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#aa8d90207a324d0393c24c16a30ca27c7">module_ra_cam_support::dtp_h2o</a></div><div class="ttdeci">real(r8), parameter dtp_h2o</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00087">module_ra_cam_support.F:87</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_aac6a79b831ca54a536990b02b931911d"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#aac6a79b831ca54a536990b02b931911d">module_ra_cam_support::ah2onw</a></div><div class="ttdeci">real(r8), dimension(:,:,:,:,:), allocatable ah2onw</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00116">module_ra_cam_support.F:116</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_ab0a88e85acf8aacb2a33d58a5c490d3e"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#ab0a88e85acf8aacb2a33d58a5c490d3e">module_ra_cam_support::gsul</a></div><div class="ttdeci">real(r8), dimension(:,:), allocatable gsul</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00231">module_ra_cam_support.F:231</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_ab20c3561d003d8e16f6984f564247561"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#ab20c3561d003d8e16f6984f564247561">module_ra_cam_support::idx_lw_1200_2000</a></div><div class="ttdeci">integer, parameter idx_lw_1200_2000</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00069">module_ra_cam_support.F:69</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_ab377fd834d670fed20ad3f59d359f8a7"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#ab377fd834d670fed20ad3f59d359f8a7">module_ra_cam_support::idxbg</a></div><div class="ttdeci">integer idxbg</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00031">module_ra_cam_support.F:31</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_ab50efdf4518f1ed0df7adc0e8839b4bd"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#ab50efdf4518f1ed0df7adc0e8839b4bd">module_ra_cam_support::mxaerl</a></div><div class="ttdeci">integer mxaerl</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00034">module_ra_cam_support.F:34</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_ab587516ccf64d1db61024800e91ac542"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#ab587516ccf64d1db61024800e91ac542">module_ra_cam_support::n_u</a></div><div class="ttdeci">integer, parameter n_u</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00102">module_ra_cam_support.F:102</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_ab7607052d159e3c4918a4be06574a590"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#ab7607052d159e3c4918a4be06574a590">module_ra_cam_support::tmin</a></div><div class="ttdeci">real(r8) tmin</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00214">module_ra_cam_support.F:214</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_ab7bc2f468a9159a04d16b9500722c011"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#ab7bc2f468a9159a04d16b9500722c011">module_ra_cam_support::mwch4</a></div><div class="ttdeci">real(r8) mwch4</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00195">module_ra_cam_support.F:195</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_ab8a0687da829019bc834c68800c09a88"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#ab8a0687da829019bc834c68800c09a88">module_ra_cam_support::cplos</a></div><div class="ttdeci">real(r8) cplos</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00257">module_ra_cam_support.F:257</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_ab8d1d8a7610c7eaeeacf4a192b988181"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#ab8d1d8a7610c7eaeeacf4a192b988181">module_ra_cam_support::idx_lw_0500_0650</a></div><div class="ttdeci">integer, parameter idx_lw_0500_0650</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00065">module_ra_cam_support.F:65</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_ab9698de3d9583b47b9f0f79888243a02"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#ab9698de3d9583b47b9f0f79888243a02">module_ra_cam_support::kcphob</a></div><div class="ttdeci">real(r8), dimension(nspint) kcphob</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00242">module_ra_cam_support.F:242</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_ab971029f3ceb20868140fc1cf031221c"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#ab971029f3ceb20868140fc1cf031221c">module_ra_cam_support::sortarray</a></div><div class="ttdeci">subroutine sortarray(n, ain, indxa)</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00380">module_ra_cam_support.F:381</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_ab9dd87c1ef6ee3ff07ca0030fd642122"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#ab9dd87c1ef6ee3ff07ca0030fd642122">module_ra_cam_support::kvolc</a></div><div class="ttdeci">real(r8), dimension(nspint) kvolc</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00248">module_ra_cam_support.F:248</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_aba5fb70a3463906359ac16c4389cbd35"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#aba5fb70a3463906359ac16c4389cbd35">module_ra_cam_support::ln_eh2ow</a></div><div class="ttdeci">real(r8), dimension(:,:,:,:,:), allocatable ln_eh2ow</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00122">module_ra_cam_support.F:122</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_abbfa35151362a083fe9ec53131b7c960"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#abbfa35151362a083fe9ec53131b7c960">module_ra_cam_support::amco2</a></div><div class="ttdeci">real(r8) amco2</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00111">module_ra_cam_support.F:111</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_abc2b6b74a45ecb8c24839914fea65634"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#abc2b6b74a45ecb8c24839914fea65634">module_ra_cam_support::dlp_h2o</a></div><div class="ttdeci">real(r8), parameter dlp_h2o</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00101">module_ra_cam_support.F:101</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_abc4231d9935087dc214c8a629167ff8c"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#abc4231d9935087dc214c8a629167ff8c">module_ra_cam_support::rgsslp</a></div><div class="ttdeci">real(r8) rgsslp</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00185">module_ra_cam_support.F:185</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_abd55a533deea6b6e4f418fbdb8ab7f6f"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#abd55a533deea6b6e4f418fbdb8ab7f6f">module_ra_cam_support::sulscl</a></div><div class="ttdeci">real(r8) sulscl</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00058">module_ra_cam_support.F:58</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_ac0aaa7b85ecec3480c170d01c6ef81e3"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#ac0aaa7b85ecec3480c170d01c6ef81e3">module_ra_cam_support::cldems</a></div><div class="ttdeci">subroutine cldems(lchnk, ncol, pcols, pver, pverp, clwp, fice, rei, emis)</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l02097">module_ra_cam_support.F:2098</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_ac0fcb5c36668744361912382fd62c678"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#ac0fcb5c36668744361912382fd62c678">module_ra_cam_support::max_lu_h2o</a></div><div class="ttdeci">real(r8), parameter max_lu_h2o</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00096">module_ra_cam_support.F:96</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_ac14abc1728ad2feb7b32e3634c901fec"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#ac14abc1728ad2feb7b32e3634c901fec">module_ra_cam_support::volcscl_rf</a></div><div class="ttdeci">real(r8) volcscl_rf</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00051">module_ra_cam_support.F:51</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_ac18daa0d2170ae2a3f814fd448134dea"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#ac18daa0d2170ae2a3f814fd448134dea">module_ra_cam_support::n2ovmr</a></div><div class="ttdeci">real(r8) n2ovmr</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00262">module_ra_cam_support.F:262</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_ac19f8c9902dc190eda33b665d428806f"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#ac19f8c9902dc190eda33b665d428806f">module_ra_cam_support::wcphil</a></div><div class="ttdeci">real(r8), dimension(:,:), allocatable wcphil</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00236">module_ra_cam_support.F:236</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_ac271b0b48df7c1f38bb4ae5a507cfeb5"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#ac271b0b48df7c1f38bb4ae5a507cfeb5">module_ra_cam_support::bgscl_rf</a></div><div class="ttdeci">real(r8) bgscl_rf</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00050">module_ra_cam_support.F:50</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_ac44b8b41ab99cff1db5eedbdd196a269"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#ac44b8b41ab99cff1db5eedbdd196a269">module_ra_cam_support::idxvis</a></div><div class="ttdeci">integer, parameter idxvis</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00224">module_ra_cam_support.F:224</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_ac550f97473b686550bc1aae97e282cff"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#ac550f97473b686550bc1aae97e282cff">module_ra_cam_support::tmax</a></div><div class="ttdeci">real(r8) tmax</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00215">module_ra_cam_support.F:215</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_ac75dcc2f540085827d996bc8528ffb49"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#ac75dcc2f540085827d996bc8528ffb49">module_ra_cam_support::coefh</a></div><div class="ttdeci">real(r8), dimension(2, 4) coefh</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00130">module_ra_cam_support.F:130</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_ac9af610840dfd4a05d682ad8299a849e"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#ac9af610840dfd4a05d682ad8299a849e">module_ra_cam_support::wcphob</a></div><div class="ttdeci">real(r8), dimension(nspint) wcphob</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00243">module_ra_cam_support.F:243</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_acb962f2259880f6eff6a0e78e1f4d744"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#acb962f2259880f6eff6a0e78e1f4d744">module_ra_cam_support::trcplk</a></div><div class="ttdeci">subroutine trcplk(lchnk, ncol, pcols, pver, pverp, tint, tlayr, tplnke, emplnk, abplnk1, abplnk2)</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l01426">module_ra_cam_support.F:1429</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_acbc7ddcbc2ec8b0b8f4b5dba23f0df96"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#acbc7ddcbc2ec8b0b8f4b5dba23f0df96">module_ra_cam_support::gffgch</a></div><div class="ttdeci">subroutine gffgch(t, es, itype)</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l02959">module_ra_cam_support.F:2960</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_acbd9c87ec89867da86831dddc3c84346"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#acbd9c87ec89867da86831dddc3c84346">module_ra_cam_support::c17</a></div><div class="ttdeci">real(r8) c17</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00107">module_ra_cam_support.F:107</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_acbe8f15ae2e2e188768922ae6c0f5958"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#acbe8f15ae2e2e188768922ae6c0f5958">module_ra_cam_support::mwf12</a></div><div class="ttdeci">real(r8) mwf12</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00198">module_ra_cam_support.F:198</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_acf33ff369ebd5a597e81572072f0dc3f"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#acf33ff369ebd5a597e81572072f0dc3f">module_ra_cam_support::getfactors</a></div><div class="ttdeci">subroutine getfactors(cycflag, np1, cdayminus, cdayplus, cday, fact1, fact2)</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l02523">module_ra_cam_support.F:2525</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_acf3acb40440157c2ff3dab3ebcde1546"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#acf3acb40440157c2ff3dab3ebcde1546">module_ra_cam_support::numdust</a></div><div class="ttdeci">integer, parameter numdust</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00039">module_ra_cam_support.F:39</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_ad0a6eb33d9ec3a8364ac2a73c046e21b"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#ad0a6eb33d9ec3a8364ac2a73c046e21b">module_ra_cam_support::reltab</a></div><div class="ttdeci">subroutine reltab(ncol, pcols, pver, t, landfrac, landm, icefrac, rel, snowh)</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l02301">module_ra_cam_support.F:2302</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_ad0e87da888c73200c4c5103ff11e1641"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#ad0e87da888c73200c4c5103ff11e1641">module_ra_cam_support::n_rh</a></div><div class="ttdeci">integer, parameter n_rh</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00106">module_ra_cam_support.F:106</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_ad1a3c3e4002c37ba64642c27d7b963ba"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#ad1a3c3e4002c37ba64642c27d7b963ba">module_ra_cam_support::epsilo</a></div><div class="ttdeci">real(r8) epsilo</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00181">module_ra_cam_support.F:181</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_ad268fad53f00adfd496d699cc7b47184"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#ad268fad53f00adfd496d699cc7b47184">module_ra_cam_support::reitab</a></div><div class="ttdeci">subroutine reitab(ncol, pcols, pver, t, re)</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l02361">module_ra_cam_support.F:2362</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_ad2f718780e3faf1a8cd0d84ea66fc597"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#ad2f718780e3faf1a8cd0d84ea66fc597">module_ra_cam_support::co2vmr</a></div><div class="ttdeci">real(r8) co2vmr</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00261">module_ra_cam_support.F:261</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_ad3f1a3043da7349342bf4f8b0f4178af"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#ad3f1a3043da7349342bf4f8b0f4178af">module_ra_cam_support::gravit</a></div><div class="ttdeci">real(r8) gravit</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00177">module_ra_cam_support.F:177</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_ad3fcaf53dce141c715c1280f85a18a57"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#ad3fcaf53dce141c715c1280f85a18a57">module_ra_cam_support::c16</a></div><div class="ttdeci">real(r8) c16</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00107">module_ra_cam_support.F:107</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_ad454810cad51890d5647d6d88d3c468d"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#ad454810cad51890d5647d6d88d3c468d">module_ra_cam_support::amd</a></div><div class="ttdeci">real(r8) amd</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00112">module_ra_cam_support.F:112</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_ad4a1e2f21340939aa3c4b9dbca9177da"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#ad4a1e2f21340939aa3c4b9dbca9177da">module_ra_cam_support::radforce</a></div><div class="ttdeci">logical radforce</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00348">module_ra_cam_support.F:348</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_ad555b898a8fc2a940cac8f504a89a01a"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#ad555b898a8fc2a940cac8f504a89a01a">module_ra_cam_support::mwf11</a></div><div class="ttdeci">real(r8) mwf11</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00197">module_ra_cam_support.F:197</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_ad5b0cc3996fc6091152b094d8b4e6fe4"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#ad5b0cc3996fc6091152b094d8b4e6fe4">module_ra_cam_support::get_rf_scales</a></div><div class="ttdeci">subroutine get_rf_scales(scales)</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l02629">module_ra_cam_support.F:2630</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_ad82655074f7b9f4590d239dd3df48bf8"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#ad82655074f7b9f4590d239dd3df48bf8">module_ra_cam_support::idxocphi</a></div><div class="ttdeci">integer idxocphi</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00029">module_ra_cam_support.F:29</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_ad9b75c3e27e4a2ed773f89f9e8ab0a3f"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#ad9b75c3e27e4a2ed773f89f9e8ab0a3f">module_ra_cam_support::c29</a></div><div class="ttdeci">real(r8) c29</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00107">module_ra_cam_support.F:107</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_ada82b90edfe225a35c5388aa87963f0b"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#ada82b90edfe225a35c5388aa87963f0b">module_ra_cam_support::o_fe</a></div><div class="ttdeci">integer, parameter o_fe</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00147">module_ra_cam_support.F:147</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_adcf21b1a03a4c8b5ff94b19c220423df"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#adcf21b1a03a4c8b5ff94b19c220423df">module_ra_cam_support::drh_h2o</a></div><div class="ttdeci">real(r8), parameter drh_h2o</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00093">module_ra_cam_support.F:93</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_add3ef9cf636adb1adb208324bcab8dff"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#add3ef9cf636adb1adb208324bcab8dff">module_ra_cam_support::cn_ah2ow</a></div><div class="ttdeci">real(r8), dimension(:,:,:,:,:), allocatable cn_ah2ow</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00119">module_ra_cam_support.F:119</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_add7004a1eda30f04d0a373345ef26e17"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#add7004a1eda30f04d0a373345ef26e17">module_ra_cam_support::mwn2o</a></div><div class="ttdeci">real(r8) mwn2o</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00196">module_ra_cam_support.F:196</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_ade898261c4d5956cba8ee44692928f2b"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#ade898261c4d5956cba8ee44692928f2b">module_ra_cam_support::plenest</a></div><div class="ttdeci">integer plenest</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00206">module_ra_cam_support.F:206</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_adfcdb079e72f875038e1b90d88badd3b"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#adfcdb079e72f875038e1b90d88badd3b">module_ra_cam_support::ntemp</a></div><div class="ttdeci">integer, parameter ntemp</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00144">module_ra_cam_support.F:144</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_ae0a6100d31d7cf309cb86c7352961d4b"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#ae0a6100d31d7cf309cb86c7352961d4b">module_ra_cam_support::fc1</a></div><div class="ttdeci">real(r8) fc1</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00110">module_ra_cam_support.F:110</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_ae13281ef00b6e7a8aa0b3d1bfe08f3ee"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#ae13281ef00b6e7a8aa0b3d1bfe08f3ee">module_ra_cam_support::scale_aerosols</a></div><div class="ttdeci">subroutine scale_aerosols(AEROSOLt, pcols, pver, ncol, lchnk, scale)</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l01868">module_ra_cam_support.F:1869</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_ae1e13161e0ac9945a214464c0a5805c4"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#ae1e13161e0ac9945a214464c0a5805c4">module_ra_cam_support::get_int_scales</a></div><div class="ttdeci">subroutine get_int_scales(scales)</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l01885">module_ra_cam_support.F:1886</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_ae37da462721fdcab8b04e1bbbbdefc93"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#ae37da462721fdcab8b04e1bbbbdefc93">module_ra_cam_support::inf</a></div><div class="ttdeci">real(r8), parameter inf</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00010">module_ra_cam_support.F:10</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_ae44324bed6778856144ccf65c0b8bf34"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#ae44324bed6778856144ccf65c0b8bf34">module_ra_cam_support::numcarbon</a></div><div class="ttdeci">integer, parameter numcarbon</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00039">module_ra_cam_support.F:39</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_ae509dcf829ddf2991fb22062c1800de9"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#ae509dcf829ddf2991fb22062c1800de9">module_ra_cam_support::wsul</a></div><div class="ttdeci">real(r8), dimension(:,:), allocatable wsul</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00230">module_ra_cam_support.F:230</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_ae5789daee4a0d08666d1a0af3526f07c"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#ae5789daee4a0d08666d1a0af3526f07c">module_ra_cam_support::bnd_nbr_lw</a></div><div class="ttdeci">integer, parameter bnd_nbr_lw</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00021">module_ra_cam_support.F:21</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_ae90583401bc762ffcf004ff27792f3ef"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#ae90583401bc762ffcf004ff27792f3ef">module_ra_cam_support::idx_lw_0650_0800</a></div><div class="ttdeci">integer, parameter idx_lw_0650_0800</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00066">module_ra_cam_support.F:66</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_aeb5ccbe33dbb2a183e6407b4b8644d7b"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#aeb5ccbe33dbb2a183e6407b4b8644d7b">module_ra_cam_support::nbands</a></div><div class="ttdeci">integer, parameter nbands</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00016">module_ra_cam_support.F:16</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_aebde22bf6abee96139e2a1f6f30a32fb"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#aebde22bf6abee96139e2a1f6f30a32fb">module_ra_cam_support::trcpth</a></div><div class="ttdeci">subroutine trcpth(lchnk, ncol, pcols, pver, pverp, tnm, pnm, cfc11, cfc12, n2o, ch4, qnm, ucfc11, ucfc12, un2o0, un2o1, uch4, uco211, uco212, uco213, uco221, uco222, uco223, bn2o0, bn2o1, bch4, uptype)</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l01518">module_ra_cam_support.F:1524</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_aec3b699656f159d10f9f19feafa18ab4"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#aec3b699656f159d10f9f19feafa18ab4">module_ra_cam_support::ln_ah2ow</a></div><div class="ttdeci">real(r8), dimension(:,:,:,:,:), allocatable ln_ah2ow</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00121">module_ra_cam_support.F:121</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_aec56701dbac922ebd91bc83adcee8d1f"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#aec56701dbac922ebd91bc83adcee8d1f">module_ra_cam_support::n_p</a></div><div class="ttdeci">integer, parameter n_p</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00103">module_ra_cam_support.F:103</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_aeda61c0a1796f1009ab1ae2aaa2b11b7"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#aeda61c0a1796f1009ab1ae2aaa2b11b7">module_ra_cam_support::kcb</a></div><div class="ttdeci">real(r8), dimension(nspint) kcb</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00245">module_ra_cam_support.F:245</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_aedb55b03e1395012ec29e1914a2df7cc"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#aedb55b03e1395012ec29e1914a2df7cc">module_ra_cam_support::sslp</a></div><div class="ttdeci">real(r8) sslp</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00183">module_ra_cam_support.F:183</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_af11c957c451e4f7284f282c6424be96b"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#af11c957c451e4f7284f282c6424be96b">module_ra_cam_support::pie</a></div><div class="ttdeci">real(r8) pie</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00189">module_ra_cam_support.F:189</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_af7e662e829862c7d94128b48616ae04b"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#af7e662e829862c7d94128b48616ae04b">module_ra_cam_support::epsqs</a></div><div class="ttdeci">real(r8) epsqs</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00182">module_ra_cam_support.F:182</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_af892daaf6a02768d05d098d01bc3c101"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#af892daaf6a02768d05d098d01bc3c101">module_ra_cam_support::cldefr</a></div><div class="ttdeci">subroutine cldefr(lchnk, ncol, pcols, pver, pverp, landfrac, t, rel, rei, ps, pmid, landm, icefrac, snowh)</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l01737">module_ra_cam_support.F:1739</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_af8b5f8546f90cdfab31c24668e0996c2"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#af8b5f8546f90cdfab31c24668e0996c2">module_ra_cam_support::nrh</a></div><div class="ttdeci">integer, parameter nrh</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00225">module_ra_cam_support.F:225</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_afa6ddf6a4f220dc56902e7da006468cd"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#afa6ddf6a4f220dc56902e7da006468cd">module_ra_cam_support::estblf</a></div><div class="ttdeci">real(r8) function estblf(td)</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l03086">module_ra_cam_support.F:3087</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_afc14045c968e1826a6cecfe78f987844"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#afc14045c968e1826a6cecfe78f987844">module_ra_cam_support::wvolc</a></div><div class="ttdeci">real(r8), dimension(nspint) wvolc</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00249">module_ra_cam_support.F:249</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_afcb6aa7f6f9b2c8b6044fafb594227b3"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#afcb6aa7f6f9b2c8b6044fafb594227b3">module_ra_cam_support::min_te_h2o</a></div><div class="ttdeci">real(r8), parameter min_te_h2o</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00088">module_ra_cam_support.F:88</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_afdeaf3dafe110a840a0e153bb507d421"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#afdeaf3dafe110a840a0e153bb507d421">module_ra_cam_support::aqsat</a></div><div class="ttdeci">subroutine aqsat(t, p, es, qs, ii, ilen, kk, kstart, kend)</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l01672">module_ra_cam_support.F:1674</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_afe03c6fa755507b2c3c9d478065ddda8"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#afe03c6fa755507b2c3c9d478065ddda8">module_ra_cam_support::phi</a></div><div class="ttdeci">real(r8) function phi(tpx, iband)</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l02703">module_ra_cam_support.F:2704</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_afe5f9155c49637822e4b098ba9b0915b"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#afe5f9155c49637822e4b098ba9b0915b">module_ra_cam_support::dte_h2o</a></div><div class="ttdeci">real(r8), parameter dte_h2o</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00090">module_ra_cam_support.F:90</a></div></div>
<div class="ttc" id="anamespacemodule__ra__cam__support_html_afe6a7aacfe7cfae29eab344c2edd48d4"><div class="ttname"><a href="namespacemodule__ra__cam__support.html#afe6a7aacfe7cfae29eab344c2edd48d4">module_ra_cam_support::n_tp</a></div><div class="ttdeci">integer, parameter n_tp</div><div class="ttdef"><b>Definition:</b> <a href="module__ra__cam__support_8F_source.html#l00104">module_ra_cam_support.F:104</a></div></div>
<div class="ttc" id="anamespacempas__atmphys__utilities_html"><div class="ttname"><a href="namespacempas__atmphys__utilities.html">mpas_atmphys_utilities</a></div><div class="ttdef"><b>Definition:</b> <a href="core__atmosphere_2physics_2mpas__atmphys__utilities_8F_source.html#l00009">mpas_atmphys_utilities.F:9</a></div></div>
<div class="ttc" id="anamespacempas__atmphys__utilities_html_aa49abb89b6ebc760010e08cbdade2706"><div class="ttname"><a href="namespacempas__atmphys__utilities.html#aa49abb89b6ebc760010e08cbdade2706">mpas_atmphys_utilities::physics_error_fatal</a></div><div class="ttdeci">subroutine, public physics_error_fatal(str)</div><div class="ttdef"><b>Definition:</b> <a href="core__atmosphere_2physics_2mpas__atmphys__utilities_8F_source.html#l00044">mpas_atmphys_utilities.F:45</a></div></div>
<div class="ttc" id="aparams_8m_html_a86bdec0d61a48a8ca4da1674058837cc"><div class="ttname"><a href="params_8m.html#a86bdec0d61a48a8ca4da1674058837cc">g</a></div><div class="ttdeci">id g()</div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5
</small></address>
</body>
</html>
